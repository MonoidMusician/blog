(()=>{"use strict";var n={679:(n,e,t)=>{t.d(e,{Z:()=>i});var r=t(81),u=t.n(r),o=t(645),a=t.n(o)()(u());a.push([n.id,"@import url(https://fonts.googleapis.com/css2?family=Cormorant:ital,wght@0,600;1,600&family=Fira+Code:wght@300;400;700&family=Oswald:wght@200..700&family=Sofia&family=Amaranth:ital,wght@0,400;0,700;1,400;1,700&display=swap);"]),a.push([n.id,'body{font-size:18px;background:#043147;color:#f0e8d4;font-family:"Cormorant";margin:0}body,.parse-table>thead>tr>th:not(:first-child),.parse-table tr>th:first-child{background:#043147}::selection{background-color:rgba(3,182,140,.46);color:#fff;text-shadow:none}table{white-space:nowrap}.unusable{opacity:.45}.clickable{cursor:pointer}.widgets.focus-mode{width:100vw;height:100vh;display:grid;grid-template-columns:repeat(2, 50vw);grid-auto-flow:row;grid-auto-rows:50vh;overflow:auto;scroll-snap-type:both mandatory}@media(max-width: 760px){.widgets.focus-mode{grid-template-columns:repeat(1, 100vw)}}@media(max-height: 500px){.widgets.focus-mode{grid-auto-rows:100vh}}.widgets.focus-mode>:not(.widget){display:none}.widgets.focus-mode>.widget{flex:0 0 auto;align-self:stretch;overflow:auto;border:1px solid gray;box-sizing:border-box;scroll-snap-align:start}.widgets.focus-mode>.widget>:only-child{padding:10px;width:max-content;height:max-content}.widgets.focus-mode>.widget>table{width:max-content}.keyword{font-family:"Sofia";color:#918b8e}.keyword,.terminal,.meta,.cmd,.non-terminal,.rule,.state{line-height:1em}.terminal{font-weight:bolder;font-family:"Fira Code";color:#c2d3d3}.selected{text-decoration:underline}.terminal:not(:last-child){letter-spacing:1.5px}.terminal.clickable{padding:0 .2em}.meta{font-family:"Oswald";font-weight:300;color:#7a6565;font-size:1em;line-height:1em;margin:0 calc(.1em + 1.5px) 0 .1em}.cmd{color:#cc82a9;font-weight:600;font-family:"Cormorant";font-style:italic}.non-terminal,.rule{font-family:"Oswald";font-weight:200;color:#47cf6e;margin:0 3.5px 0 2px}.non-terminal:last-child,.rule:last-child{margin:0 2px 0 2px}.rule{font-weight:400;color:#2c9f9b}.state{font-family:"Cormorant";font-variant-numeric:lining-nums tabular-nums;color:#ccb11c}.stack .meta,.stack .rule,.stack>.terminal{margin:0;letter-spacing:normal}.stack>sub{margin:0 1px}.full.stack{display:flex;flex-direction:row}.full.stack>.terminal{border:solid .1em #7a6565;border-radius:.2em;display:inline-block;height:fit-content;margin:0 .2em .5em;padding:.1em .2em 0}.full.stack>sub{margin-top:.5em;text-decoration:underline;text-decoration-color:#ccb11c}.full.stack>:nth-last-child(2),.full.stack>.AST:nth-last-child(2)>li>.node{border-color:#90ee90}.parse-steps{position:relative;width:100%}.parse-steps>div{top:2em;position:absolute;width:100%}.parse-steps>span{position:absolute}.layer .rule,.layer .meta{margin:0}.AST ol.layer{margin:0}.AST,.AST ol,.AST li{list-style:none;margin:0;padding:0;position:relative}.AST{margin:0;text-align:center}.AST,.AST ol{display:table}.AST ol{width:100%}.AST li{display:table-cell;padding:.5em 0 0;vertical-align:top}.AST li:before{outline:solid 1px #7a6565;content:"";left:0;position:absolute;right:0;top:0}.AST .node:hover+ol li:before{outline-color:green}.AST li:first-child:before{left:50%}.AST li:last-child:before{right:50%}.AST .node{border:solid .1em #7a6565;border-radius:.2em;display:inline-block;margin:0 .2em .5em;padding:.1em .2em 0;position:relative}.AST .node:hover,.AST .node:hover+ol .node{border-color:green}.AST ol:before,.AST .node:before{outline:solid 1px #7a6565;content:"";height:.45em;left:50%;position:absolute}.AST .node:hover+ol .node:before,.AST .node:hover+ol:before,.AST .node:hover+ol ol:before{outline-color:green}.AST ol:before{top:-0.5em}.AST .node:before{top:-0.55em}.AST>li{margin-top:0;padding-top:0}.AST>li:before,.AST>li:after,.AST>li>.node:before{outline:none}td>.zipper{width:100%;display:inline-block}.zipper>.parsed:not(:last-child)>*{opacity:.45}.zipper>.parsed{line-height:2.8ex;line-color:#7a6565;background-image:linear-gradient(transparent calc(var(line-height) - 1px), var(line-color) calc(var(line-height) - 1px), var(line-color) calc(var(line-height) + 1px), transparent calc(var(line-height) + 1px))}.zipper:hover>:not(.parsed)>:first-child{outline:2px solid aqua;outline-offset:2px}.zipper:hover>.parsed:last-child{outline:2px solid #00a42f;outline-offset:2px}.zipper>:not(.parsed)::before{content:"•";font-family:"Fira Code";line-height:1em;color:aqua}.zipper.reducible::after{content:"•";font-family:"Fira Code";line-height:1em;color:#ce4e7a}.reducible>.terminal{color:#ce4e7a}.lookahead{margin-left:1em;opacity:.8}.conflict{line-height:2.8ex;line-color:#bb194f;background-image:linear-gradient(transparent calc(var(line-height) - 1px), var(line-color) calc(var(line-height) - 1px), var(line-color) calc(var(line-height) + 1px), transparent calc(var(line-height) + 1px))}.conflict .cmd{color:#bb194f}table{border-spacing:0}table.grammar .trouble{background:rgba(120,0,0,.5)}.state-table{border-spacing:0;border-collapse:collapse}.state-table>tbody.active{background-color:#463d10}.state-table>tbody.hover{background-color:#4b4731}.state-table>tbody>tr>th{text-align:right;padding-right:1em}.state-table>tbody>tr>td:last-child{padding-left:1em}.state-table>tbody>tr:last-child>td{border-bottom:1px solid rgba(175,175,175,.7607843137)}.state-table>tbody>tr:first-child>th:first-child{vertical-align:top}.state-table>tbody>tr:first-child:not(:last-child)>th:first-child .state{position:sticky;top:0}.parse-table{border-collapse:separate;border-spacing:0}.parse-table th{font-weight:inherit}.parse-table th.first,.parse-table td.first{border-left:1px solid rgba(175,175,175,.7607843137)}.parse-table>thead{position:sticky;z-index:1;top:-1px}.parse-table>thead th,.parse-table tr:last-child td:not(:first-child){border-bottom:1px solid rgba(175,175,175,.7607843137)}.parse-table>tbody>tr>th:first-child{text-align:right;padding:0 .5em;position:sticky;left:0}.parse-table>tbody>tr>th{border-right:1px solid rgba(175,175,175,.7607843137)}.parse-table>tbody>tr>td:last-child{border-right:1px solid rgba(175,175,175,.7607843137)}.parse-table>tbody>tr>td{text-align:left}.parse-table tr.active,.parse-table tr.active>th{background-color:#463d10}.parse-table tr.hover,.parse-table tr.hover>th{background-color:#4b4731}.parse-table td{padding:0 .75em}.parse-table>thead>tr>th{vertical-align:bottom}.pileup{display:flex;flex-direction:column}.pileup>:last-child{margin-top:.2em;border-top:1px solid gray;padding-top:.2em}.explorer-table tr.inactive{opacity:.65}button{font-family:"Amaranth";font-size:.9em;line-height:1.2;border-radius:1em;color:rgba(35,114,255,.73);border-color:rgba(35,114,255,.66);border-width:2px;border-style:solid;background:none;padding:0 .5em;margin:0 .25em;transition:border-color .2s,color .2s,box-shadow .1s ease-out,transform .1s ease-out;box-shadow:1px 1px .5px .5px rgba(0,0,0,0),inset 1px 1px 0px 1.5px rgba(0,0,0,0);-webkit-backface-visibility:hidden}button.big{padding-top:.2em;padding-bottom:.25em}button:not(:disabled):not(.disabled):hover{transition:border-color .1s,color .1s,box-shadow .1s ease-out,transform .1s ease-out;color:#2372ff;box-shadow:1px 1px .5px .5px rgba(35,114,255,.26),inset 1px 1px 0px 1.5px rgba(0,0,0,.1333333333)}@media(hover: hover)and (pointer: fine){button:not(:disabled):not(.disabled):not(:hover){border-color:rgba(35,114,255,.33)}}button:not(:disabled):not(.disabled):active{color:#2372ff;border-color:#2372ff;box-shadow:0px 0px 0px 0px rgba(0,0,0,0),inset 1px 1px 0px .5px rgba(0,0,0,.1333333333);transform:translate(1.1px, 1.1px)}button:focus-visible{outline:1px solid #fff;color:#2372ff}button:disabled,button.disabled{border-color:rgba(35,114,255,.33);color:rgba(0,0,0,0);background:repeating-linear-gradient(12deg, #707070, #707070 4px, #888888 4px, #888888 8px);background-clip:text;-webkit-background-clip:text}button.delete{font-family:"Amaranth";font-size:.9em;line-height:1.2;border-radius:1em;color:rgba(255,0,77,.73);border-color:rgba(255,0,77,.66);border-width:2px;border-style:solid;background:none;padding:0 .5em;margin:0 .25em;transition:border-color .2s,color .2s,box-shadow .1s ease-out,transform .1s ease-out;box-shadow:1px 1px .5px .5px rgba(0,0,0,0),inset 1px 1px 0px 1.5px rgba(0,0,0,0);-webkit-backface-visibility:hidden}button.delete.big{padding-top:.2em;padding-bottom:.25em}button.delete:not(:disabled):not(.disabled):hover{transition:border-color .1s,color .1s,box-shadow .1s ease-out,transform .1s ease-out;color:#ff004d;box-shadow:1px 1px .5px .5px rgba(255,0,77,.26),inset 1px 1px 0px 1.5px rgba(0,0,0,.1333333333)}@media(hover: hover)and (pointer: fine){button.delete:not(:disabled):not(.disabled):not(:hover){border-color:rgba(255,0,77,.33)}}button.delete:not(:disabled):not(.disabled):active{color:#ff004d;border-color:#ff004d;box-shadow:0px 0px 0px 0px rgba(0,0,0,0),inset 1px 1px 0px .5px rgba(0,0,0,.1333333333);transform:translate(1.1px, 1.1px)}button.delete:focus-visible{outline:1px solid #fff;color:#ff004d}button.delete:disabled,button.delete.disabled{border-color:rgba(255,0,77,.33);color:rgba(0,0,0,0);background:repeating-linear-gradient(12deg, #707070, #707070 4px, #888888 4px, #888888 8px);background-clip:text;-webkit-background-clip:text}button.add{font-family:"Amaranth";font-size:.9em;line-height:1.2;border-radius:1em;color:rgba(29,202,36,.73);border-color:rgba(29,202,36,.66);border-width:2px;border-style:solid;background:none;padding:0 .5em;margin:0 .25em;transition:border-color .2s,color .2s,box-shadow .1s ease-out,transform .1s ease-out;box-shadow:1px 1px .5px .5px rgba(0,0,0,0),inset 1px 1px 0px 1.5px rgba(0,0,0,0);-webkit-backface-visibility:hidden}button.add.big{padding-top:.2em;padding-bottom:.25em}button.add:not(:disabled):not(.disabled):hover{transition:border-color .1s,color .1s,box-shadow .1s ease-out,transform .1s ease-out;color:#1dca24;box-shadow:1px 1px .5px .5px rgba(29,202,36,.26),inset 1px 1px 0px 1.5px rgba(0,0,0,.1333333333)}@media(hover: hover)and (pointer: fine){button.add:not(:disabled):not(.disabled):not(:hover){border-color:rgba(29,202,36,.33)}}button.add:not(:disabled):not(.disabled):active{color:#1dca24;border-color:#1dca24;box-shadow:0px 0px 0px 0px rgba(0,0,0,0),inset 1px 1px 0px .5px rgba(0,0,0,.1333333333);transform:translate(1.1px, 1.1px)}button.add:focus-visible{outline:1px solid #fff;color:#1dca24}button.add:disabled,button.add.disabled{border-color:rgba(29,202,36,.33);color:rgba(0,0,0,0);background:repeating-linear-gradient(12deg, #707070, #707070 4px, #888888 4px, #888888 8px);background-clip:text;-webkit-background-clip:text}button.bonus{font-family:"Amaranth";font-size:.9em;line-height:1.2;border-radius:1em;color:rgba(232,109,183,.73);border-color:rgba(232,109,183,.66);border-width:2px;border-style:solid;background:none;padding:0 .5em;margin:0 .25em;transition:border-color .2s,color .2s,box-shadow .1s ease-out,transform .1s ease-out;box-shadow:1px 1px .5px .5px rgba(0,0,0,0),inset 1px 1px 0px 1.5px rgba(0,0,0,0);-webkit-backface-visibility:hidden}button.bonus.big{padding-top:.2em;padding-bottom:.25em}button.bonus:not(:disabled):not(.disabled):hover{transition:border-color .1s,color .1s,box-shadow .1s ease-out,transform .1s ease-out;color:#e86db7;box-shadow:1px 1px .5px .5px rgba(232,109,183,.26),inset 1px 1px 0px 1.5px rgba(0,0,0,.1333333333)}@media(hover: hover)and (pointer: fine){button.bonus:not(:disabled):not(.disabled):not(:hover){border-color:rgba(232,109,183,.33)}}button.bonus:not(:disabled):not(.disabled):active{color:#e86db7;border-color:#e86db7;box-shadow:0px 0px 0px 0px rgba(0,0,0,0),inset 1px 1px 0px .5px rgba(0,0,0,.1333333333);transform:translate(1.1px, 1.1px)}button.bonus:focus-visible{outline:1px solid #fff;color:#e86db7}button.bonus:disabled,button.bonus.disabled{border-color:rgba(232,109,183,.33);color:rgba(0,0,0,0);background:repeating-linear-gradient(12deg, #707070, #707070 4px, #888888 4px, #888888 8px);background-clip:text;-webkit-background-clip:text}label{margin:2px;position:relative;display:inline-block;border-radius:4px;vertical-align:bottom;transform:translateY(0.1em)}label>span:not(.error){font-family:"Amaranth";font-weight:400;font-style:italic;font-size:12px;display:block;position:absolute;padding:0 4px;top:-1px;left:5px;background:#043147;letter-spacing:normal;color:#f0e8d4;color:#2372ff;line-height:3px;pointer-events:none}label>span:not(.error):last-child{left:initial;right:4px}label>span.error{position:absolute;top:calc(100% - 1px);background:#073146;display:block;font-family:"Cormorant";font-size:80%;color:#f0e8d4;line-height:normal;letter-spacing:normal;border:1px solid rgba(255,0,77,.6666666667);border-radius:4px;padding:4px;z-index:2;transition:opacity .2s ease-out,transform .2s ease-out}label:hover>span.error{pointer-events:all;opacity:1;transform:translate(0, 0)}label:not(:hover)>span.error{pointer-events:none;opacity:0;transform:translate(0px, -10px)}label>span.error:empty{display:none}label>span.error:blank{display:none}label.range{transform:translateY(10px)}label.range>span:not(.error){top:-8px}label.text.invalid::after{content:"!";font-family:"Fira Code";font-weight:600;position:absolute;right:8px;top:calc(50% - .5em - .45em);color:#ff004d;background:linear-gradient(90deg, transparent, #073146 0.7em);padding-left:.7em;padding-bottom:.2em;padding-top:.3em;letter-spacing:normal}label>input{background:none;border:none;padding:0 8px;margin:0;font:inherit;color:inherit;height:34px;border-style:solid;border-width:1px;border-color:rgba(35,114,255,.6666666667);border-radius:4px;transition:border-color .2s}@media(hover: hover)and (pointer: fine){label>input:not([type=range]):not(:hover){border-color:rgba(35,115,255,.3333333333)}}label>input:not([type=range]):focus{outline:none;border-color:#2372ff}label>input[type=range]{border:none;padding:0;height:auto}label.invalid>input{border-color:rgba(255,0,77,.6666666667)}@media(hover: hover)and (pointer: fine){label.invalid>input:not([type=range]):not(:hover){border-color:rgba(255,0,77,.3333333333)}}label.invalid>input:not([type=range]):focus{outline:none;border-color:#ff004d}.flex{display:flex}.justify-between{justify-content:space-between}.hidden{visibility:hidden}h1{text-align:center;font-size:45px;font-weight:700;font-weight:300;font-feature-settings:"ss01" 1}h2,h3,h4,h5{font-weight:500;font-feature-settings:"ss01" 1}h2{text-align:center;font-size:34px;margin-top:2em;margin-bottom:1em;font-weight:500}h3{font-size:30px;border-bottom-width:1px;border-bottom-style:solid;line-height:.9}h4{font-size:26px;font-family:"Cormorant Upright"}h5{font-size:22px;font-style:italic;text-shadow:none;font-weight:700}h5 em{font-style:normal}.Box::before,.Example::before,.Details::before,.Error::before,.Warning::before,.Key_Idea::before,.Bonus::before,.Note::before{background:#043147}.Error{transition:border-image .4s;border-color:rgba(255,0,77,.6);border-image-source:radial-gradient(ellipse at 50% 50%, rgba(255, 0, 77, 0.3), rgba(255, 0, 77, 0.5))}.Error:hover{border-image-source:radial-gradient(ellipse at 50% 50%, #ff0055, rgba(255, 0, 77, 0.8))}.Error::before{color:#ff004d}.Error::selection,.Error *::selection{background-color:rgba(255,0,77,.4)}.Box,.Example,.Details,.Error,.Warning,.Key_Idea,.Bonus,.Note{border-style:solid;border-width:1px;border-image-slice:1;padding:8px}.Box>:first-child,.Example>:first-child,.Details>:first-child,.Error>:first-child,.Warning>:first-child,.Key_Idea>:first-child,.Bonus>:first-child,.Note>:first-child{margin-top:0}.Box>:last-child,.Example>:last-child,.Details>:last-child,.Error>:last-child,.Warning>:last-child,.Key_Idea>:last-child,.Bonus>:last-child,.Note>:last-child{margin-bottom:0}.Box[data-box-name]::before,[data-box-name].Example::before,[data-box-name].Details::before,[data-box-name].Error::before,[data-box-name].Warning::before,[data-box-name].Key_Idea::before,[data-box-name].Bonus::before,[data-box-name].Note::before{content:attr(data-box-name)}.Box::before,.Example::before,.Details::before,.Error::before,.Warning::before,.Key_Idea::before,.Bonus::before,.Note::before{font-family:"Amaranth";font-weight:400;font-style:italic;font-size:.92em;transform:translateY(-1.2em);display:block;position:absolute;padding:0 4px}.Error::before{content:"Error"}.Error[data-box-name]::before{content:attr(data-box-name)}',""]);const i=a},645:n=>{n.exports=function(n){var e=[];return e.toString=function(){return this.map((function(e){var t="",r=void 0!==e[5];return e[4]&&(t+="@supports (".concat(e[4],") {")),e[2]&&(t+="@media ".concat(e[2]," {")),r&&(t+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),t+=n(e),r&&(t+="}"),e[2]&&(t+="}"),e[4]&&(t+="}"),t})).join("")},e.i=function(n,t,r,u,o){"string"==typeof n&&(n=[[null,n,void 0]]);var a={};if(r)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(a[c]=!0)}for(var l=0;l<n.length;l++){var f=[].concat(n[l]);r&&a[f[0]]||(void 0!==o&&(void 0===f[5]||(f[1]="@layer".concat(f[5].length>0?" ".concat(f[5]):""," {").concat(f[1],"}")),f[5]=o),t&&(f[2]?(f[1]="@media ".concat(f[2]," {").concat(f[1],"}"),f[2]=t):f[2]=t),u&&(f[4]?(f[1]="@supports (".concat(f[4],") {").concat(f[1],"}"),f[4]=u):f[4]="".concat(u)),e.push(f))}},e}},81:n=>{n.exports=function(n){return n[1]}},379:n=>{var e=[];function t(n){for(var t=-1,r=0;r<e.length;r++)if(e[r].identifier===n){t=r;break}return t}function r(n,r){for(var o={},a=[],i=0;i<n.length;i++){var c=n[i],l=r.base?c[0]+r.base:c[0],f=o[l]||0,v="".concat(l," ").concat(f);o[l]=f+1;var s=t(v),d={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==s)e[s].references++,e[s].updater(d);else{var p=u(d,r);r.byIndex=i,e.splice(i,0,{identifier:v,updater:p,references:1})}a.push(v)}return a}function u(n,e){var t=e.domAPI(e);return t.update(n),function(e){if(e){if(e.css===n.css&&e.media===n.media&&e.sourceMap===n.sourceMap&&e.supports===n.supports&&e.layer===n.layer)return;t.update(n=e)}else t.remove()}}n.exports=function(n,u){var o=r(n=n||[],u=u||{});return function(n){n=n||[];for(var a=0;a<o.length;a++){var i=t(o[a]);e[i].references--}for(var c=r(n,u),l=0;l<o.length;l++){var f=t(o[l]);0===e[f].references&&(e[f].updater(),e.splice(f,1))}o=c}}},569:n=>{var e={};n.exports=function(n,t){var r=function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(n){t=null}e[n]=t}return e[n]}(n);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},216:n=>{n.exports=function(n){var e=document.createElement("style");return n.setAttributes(e,n.attributes),n.insert(e,n.options),e}},565:(n,e,t)=>{n.exports=function(n){var e=t.nc;e&&n.setAttribute("nonce",e)}},795:n=>{n.exports=function(n){var e=n.insertStyleElement(n);return{update:function(t){!function(n,e,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var u=void 0!==t.layer;u&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,u&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var o=t.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(r,n,e.options)}(e,n,t)},remove:function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(e)}}}},589:n=>{n.exports=function(n,e){if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}}},e={};function t(r){var u=e[r];if(void 0!==u)return u.exports;var o=e[r]={id:r,exports:{}};return n[r](o,o.exports,t),o.exports}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var r in e)t.o(e,r)&&!t.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:e[r]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),t.nc=void 0,(()=>{var n=t(379),e=t.n(n),r=t(795),u=t.n(r),o=t(569),a=t.n(o),i=t(565),c=t.n(i),l=t(216),f=t.n(l),v=t(589),s=t.n(v),d=t(679),p={};p.styleTagTransform=s(),p.setAttributes=c(),p.insert=a().bind(null,"head"),p.domAPI=u(),p.insertStyleElement=f(),e()(d.Z,p),d.Z&&d.Z.locals&&d.Z.locals;var m={compose:function(n){return function(e){return function(t){return n(e(t))}}}},h=function(n){return n.compose},w=function(n){return n.identity},M={identity:function(n){return n},Semigroupoid0:function(){return m}},b=function(n){return function(e){return function(t){return function(r){return n(e(t))(e(r))}}}},g=function(n){return function(e){return function(t){return n(t)(e)}}},y=function(n){return function(e){return n}},S=function(n){return function(e){return e(n)}};const A=void 0;var T=function(){function n(){}return n.value=new n,n}(),x=function(n){return n.map},E=function(n){return function(e){return function(t){return x(n)(t)(e)}}},F=function(n){return x(n)(y(A))},N=function(n){return function(e){return function(t){return x(n)(y(t))(e)}}},k=function(n){return function(e){return x(n)(y(e))}},B={map:h(m)},P={map:function(n){return function(e){for(var t=e.length,r=new Array(t),u=0;u<t;u++)r[u]=n(e[u]);return r}}},q=function(n){return function(e){return function(t){return x(n)((function(n){return n(t)}))(e)}}},C=function(n){return n.zero},I={add:function(n){return function(e){return n+e}},zero:0,mul:function(n){return function(e){return n*e}},one:1},D={add:function(n){return function(e){return n+e|0}},zero:0,mul:function(n){return function(e){return n*e|0}},one:1},R=function(n){return n.mul},z=function(n){return n.add},O={sub:function(n){return function(e){return n-e}},Semiring0:function(){return I}},_={sub:function(n){return function(e){return n-e|0}},Semiring0:function(){return D}},L={Ring0:function(){return O}},W={Ring0:function(){return _}},j=function(n){return function(e){return n===e}},U=function(n){return n.reflectSymbol};const $=function(n){return function(e){return e[n]}},Y=function(n){return function(e){return function(t){var r={};for(var u in t)({}).hasOwnProperty.call(t,u)&&(r[u]=t[u]);return r[n]=e,r}}};var V={eq:j},K={eqRecord:function(n){return function(n){return function(n){return!0}}}},H=function(n){return n.eqRecord},J=function(){return function(n){return{eq:H(n)(T.value)}}},Z={eq:j},G={eq:j},Q={eq:j},X={eq:j},nn=function(n){return n.eq},en=function(n){return{eq:(e=nn(n),function(n){return function(t){if(n.length!==t.length)return!1;for(var r=0;r<n.length;r++)if(!e(n[r])(t[r]))return!1;return!0}})};var e},tn=function(n){return function(){return function(e){return function(t){return{eqRecord:function(r){return function(r){return function(u){var o=H(n)(T.value)(r)(u),a=U(e)(T.value),i=$(a);return nn(t)(i(r))(i(u))&&o}}}}}}}},rn=function(n){return function(e){return function(t){return nn(X)(nn(n)(e)(t))(!1)}}},un=function(n){return n.mod},on={degree:function(n){return 1},div:function(n){return function(e){return n/e}},mod:function(n){return function(n){return 0}},CommutativeRing0:function(){return L}},an={degree:function(n){return Math.min(Math.abs(n),2147483647)},div:function(n){return function(e){return 0===e?0:e>0?Math.floor(n/e):-Math.floor(n/-e)}},mod:function(n){return function(e){if(0===e)return 0;var t=Math.abs(e);return(n%t+t)%t}},CommutativeRing0:function(){return W}},cn=function(n){return n.div},ln=function(){function n(){}return n.value=new n,n}(),fn=function(){function n(){}return n.value=new n,n}(),vn=function(){function n(){}return n.value=new n,n}(),sn={append:function(n){return function(e){if(n instanceof ln)return ln.value;if(n instanceof fn)return fn.value;if(n instanceof vn)return e;throw new Error("Failed pattern match at Data.Ordering (line 21, column 1 - line 24, column 18): "+[n.constructor.name,e.constructor.name])}}},dn={eq:function(n){return function(e){return n instanceof ln&&e instanceof ln||n instanceof fn&&e instanceof fn||n instanceof vn&&e instanceof vn}}},pn={append:function(n){return function(n){return A}}},mn={append:function(n){return function(e){return n+e}}},hn={appendRecord:function(n){return function(n){return function(n){return{}}}}},wn={append:function(n){return function(e){return 0===n.length?e:0===e.length?n:n.concat(e)}}},Mn=function(n){return n.appendRecord},bn=function(n){return n.append},gn=function(n){return{append:function(e){return function(t){return function(r){return bn(n)(e(r))(t(r))}}}}},yn={mempty:A,Semigroup0:function(){return pn}},Sn={mempty:"",Semigroup0:function(){return mn}},An={memptyRecord:function(n){return{}},SemigroupRecord0:function(){return hn}},Tn={mempty:[],Semigroup0:function(){return wn}},xn=function(n){return n.memptyRecord},En=function(n){return n.mempty},Fn=function(n){return function(e){return function(){return function(t){return{memptyRecord:function(r){var u=xn(t)(T.value),o=U(n)(T.value);return Y(o)(En(e))(u)},SemigroupRecord0:function(){return function(n){return function(){return function(e){return function(t){return{appendRecord:function(r){return function(r){return function(u){var o=Mn(e)(T.value)(r)(u),a=U(n)(T.value),i=Y(a),c=$(a);return i(bn(t)(c(r))(c(u)))(o)}}}}}}}}(n)()(t.SemigroupRecord0())(e.Semigroup0())}}}}}},Nn=function(n){return{always:w(M),Monoid0:function(){return n}}},kn=function(n){return n.always},Bn={alt:bn(wn),Functor0:function(){return P}},Pn=function(n){return n.alt},qn={apply:function(n){return function(e){return function(t){return n(t)(e(t))}}},Functor0:function(){return B}},Cn={apply:function(n){return function(e){for(var t=n.length,r=e.length,u=new Array(t*r),o=0,a=0;a<t;a++)for(var i=n[a],c=0;c<r;c++)u[o++]=i(e[c]);return u}},Functor0:function(){return P}},In=function(n){return n.apply},Dn=function(n){return function(e){return function(t){return In(n)(x(n.Functor0())(y(w(M)))(e))(t)}}},Rn=function(n){return function(e){return function(t){return function(r){return In(n)(x(n.Functor0())(e)(t))(r)}}}};const zn=String.fromCharCode(65535),On=String.fromCharCode(0);Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY;var _n=function(n){return function(e){return function(t){return function(r){return function(u){return r<u?n:r===u?e:t}}}}};const Ln=_n,Wn=_n,jn=_n,Un=_n;var $n=function(){return{compare:jn(ln.value)(vn.value)(fn.value),Eq0:function(){return V}}}(),Yn=function(){return{compare:Wn(ln.value)(vn.value)(fn.value),Eq0:function(){return Z}}}(),Vn=function(){return{compare:Ln(ln.value)(vn.value)(fn.value),Eq0:function(){return G}}}(),Kn=function(){return{compare:Un(ln.value)(vn.value)(fn.value),Eq0:function(){return Q}}}(),Hn=function(n){return n.compare},Jn=function(n){return function(e){return function(t){var r=Hn(n)(e)(t);if(r instanceof ln)return t;if(r instanceof vn)return e;if(r instanceof fn)return e;throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[r.constructor.name])}}},Zn=function(n){return function(e){return function(t){var r=Hn(n)(e)(t);if(r instanceof ln)return e;if(r instanceof vn)return e;if(r instanceof fn)return t;throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[r.constructor.name])}}},Gn=function(n){return n.top},Qn={top:2147483647,bottom:-2147483648,Ord0:function(){return Vn}},Xn={top:zn,bottom:On,Ord0:function(){return Kn}},ne=function(n){return n.bottom},ee={show:function(n){var e=n.toString();return isNaN(e+".0")?e:e+".0"}},te={show:function(n){return n.toString()}},re={show:function(n){if(n)return"true";if(!n)return"false";throw new Error("Failed pattern match at Data.Show (line 23, column 1 - line 25, column 23): "+[n.constructor.name])}},ue=function(n){return n.show},oe=function(n){return n.pure},ae=function(n){return function(e){return function(t){if(e)return t;if(!e)return oe(n)(A);throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[e.constructor.name,t.constructor.name])}}},ie={pure:function(n){return function(e){return n}},Apply0:function(){return qn}},ce={pure:function(n){return[n]},Apply0:function(){return Cn}},le=function(){function n(){}return n.value=new n,n}(),fe=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ve=function(n){return{append:function(e){return function(t){if(e instanceof le)return t;if(t instanceof le)return e;if(e instanceof fe&&t instanceof fe)return new fe(bn(n)(e.value0)(t.value0));throw new Error("Failed pattern match at Data.Maybe (line 182, column 1 - line 185, column 43): "+[e.constructor.name,t.constructor.name])}}}},se=function(n){return{mempty:le.value,Semigroup0:function(){return ve(n)}}},de=function(n){return function(e){return function(t){if(t instanceof le)return n;if(t instanceof fe)return e(t.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},pe=de(!0)(y(!1)),me=de(!1)(y(!0)),he={map:function(n){return function(e){return e instanceof fe?new fe(n(e.value0)):le.value}}},we=function(n){return de(n)(w(M))},Me=function(){return function(n){if(n instanceof fe)return n.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[n.constructor.name])}},be=function(n){return{eq:function(e){return function(t){return e instanceof le&&t instanceof le||e instanceof fe&&t instanceof fe&&nn(n)(e.value0)(t.value0)}}}},ge={apply:function(n){return function(e){if(n instanceof fe)return x(he)(n.value0)(e);if(n instanceof le)return le.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[n.constructor.name,e.constructor.name])}},Functor0:function(){return he}},ye={bind:function(n){return function(e){if(n instanceof fe)return e(n.value0);if(n instanceof le)return le.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[n.constructor.name,e.constructor.name])}},Apply0:function(){return ge}},Se=function(){return{pure:fe.create,Apply0:function(){return ge}}}(),Ae={Applicative0:function(){return Se},Bind1:function(){return ye}},Te={alt:function(n){return function(e){return n instanceof le?e:n}},Functor0:function(){return he}},xe=function(){return{empty:le.value,Alt0:function(){return Te}}}(),Ee={Applicative0:function(){return Se},Plus1:function(){return xe}},Fe=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Ne=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ke=function(n){return de(new Fe(n))(Ne.create)},Be={map:function(n){return function(e){if(e instanceof Fe)return new Fe(e.value0);if(e instanceof Ne)return new Ne(n(e.value0));throw new Error("Failed pattern match at Data.Either (line 0, column 0 - line 0, column 0): "+[e.constructor.name])}}},Pe=function(n){return function(e){return function(t){if(t instanceof Fe)return n(t.value0);if(t instanceof Ne)return e(t.value0);throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},qe=function(){return Pe(y(le.value))(fe.create)}(),Ce={apply:function(n){return function(e){if(n instanceof Fe)return new Fe(n.value0);if(n instanceof Ne)return x(Be)(n.value0)(e);throw new Error("Failed pattern match at Data.Either (line 70, column 1 - line 72, column 30): "+[n.constructor.name,e.constructor.name])}},Functor0:function(){return Be}},Ie={bind:Pe((function(n){return function(e){return new Fe(n)}}))((function(n){return function(e){return e(n)}})),Apply0:function(){return Ce}},De=function(){return{pure:Ne.create,Apply0:function(){return Ce}}}(),Re={empty:[],Alt0:function(){return Bn}},ze=function(n){return n.empty},Oe=function(n){return n.discard},_e={bind:function(n){return function(e){return function(t){return e(n(t))(t)}}},Apply0:function(){return qn}},Le={bind:function(n){return function(e){for(var t=[],r=0,u=n.length;r<u;r++)Array.prototype.push.apply(t,e(n[r]));return t}},Apply0:function(){return Cn}},We=function(n){return n.bind},je=function(n){return g(We(n))},Ue=function(n){return function(e){return function(t){return function(r){return We(n)(e(r))(t)}}}},$e={discard:function(n){return We(n)}},Ye=function(n){return function(e){return We(n)(e)(w(M))}},Ve=function(n){return n.not},Ke=function(n){return n.ff},He=function(n){return n.disj},Je={ff:!1,tt:!0,implies:function(n){return function(e){return He(Je)(Ve(Je)(n))(e)}},conj:function(n){return function(e){return n&&e}},disj:function(n){return function(e){return n||e}},not:function(n){return!n}},Ze=function(n){return{ff:function(e){return Ke(n)},tt:function(e){return n.tt},implies:function(e){return function(t){return function(r){return n.implies(e(r))(t(r))}}},conj:function(e){return function(t){return function(r){return n.conj(e(r))(t(r))}}},disj:function(e){return function(t){return function(r){return He(n)(e(r))(t(r))}}},not:function(e){return function(t){return Ve(n)(e(t))}}}},Ge=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Qe=function(n){return n.value1},Xe=function(n){return function(e){return{append:function(t){return function(r){return new Ge(bn(n)(t.value0)(r.value0),bn(e)(t.value1)(r.value1))}}}}},nt=function(n){return function(e){return{mempty:new Ge(En(n),En(e)),Semigroup0:function(){return Xe(n.Semigroup0())(e.Semigroup0())}}}},et={map:function(n){return function(e){return new Ge(e.value0,n(e.value1))}}},tt=function(n){return n.value0},rt=function(n){return n.bimap},ut=function(n){return function(e){return rt(n)(e)(w(M))}},ot={bimap:function(n){return function(e){return function(t){return new Ge(n(t.value0),e(t.value1))}}}},at={bimap:function(n){return function(e){return function(t){if(t instanceof Fe)return new Fe(n(t.value0));if(t instanceof Ne)return new Ne(e(t.value0));throw new Error("Failed pattern match at Data.Bifunctor (line 32, column 1 - line 34, column 36): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}}},it=function(n){return{mempty:w(n),Semigroup0:function(){return e=n.Semigroupoid0(),{append:function(n){return function(t){return h(e)(n)(t)}}};var e}}};const ct=function(n){return n};var lt=function(){return ct},ft=lt,vt=function(){return function(){return function(n){return lt()}}},st=function(n){return n.foldr},dt=function(n){return function(e){return st(n)(Pn(e.Alt0()))(ze(e))}},pt=function(n){return function(e){return function(t){return st(n)((r=Pn(e.Alt0()),function(n){return r(t(n))}))(ze(e));var r}}},mt=function(n){return function(e){return function(t){return st(e)((r=Dn(n.Apply0()),function(n){return r(t(n))}))(oe(n)(A));var r}}},ht=function(n){return function(e){return g(mt(n)(e))}},wt=function(n){return function(e){return mt(n)(e)(w(M))}},Mt=function(n){return n.foldl},bt=function(n){return function(e){return Mt(n)((function(n){return function(t){return z(e)(e.one)(n)}}))(C(e))}},gt=function(n){return function(e){return Mt(n)(z(e))(C(e))}},yt={foldr:function(n){return function(e){return function(t){if(t instanceof le)return e;if(t instanceof fe)return n(t.value0)(e);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},foldl:function(n){return function(e){return function(t){if(t instanceof le)return e;if(t instanceof fe)return n(e)(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},foldMap:function(n){return function(e){return function(t){if(t instanceof le)return En(n);if(t instanceof fe)return e(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[e.constructor.name,t.constructor.name])}}}},St={foldr:function(n){return function(e){return function(t){for(var r=e,u=t.length-1;u>=0;u--)r=n(t[u])(r);return r}}},foldl:function(n){return function(e){return function(t){for(var r=e,u=t.length,o=0;o<u;o++)r=n(r)(t[o]);return r}}},foldMap:function(n){return(e=St,function(n){return function(t){return st(e)((function(e){return function(r){return bn(n.Semigroup0())(t(e))(r)}}))(En(n))}})(n);var e}},At=function(n){return n.foldMap},Tt=function(n){return function(e){return lt()(At(n)(function(n){return{mempty:Ke(n),Semigroup0:function(){return function(n){return{append:function(e){return function(t){return He(n)(e)(t)}}}}(n)}}}(e)))}},xt={map:function(n){return function(e){return n(e)}}},Et={apply:function(n){return function(e){return n(e)}},Functor0:function(){return xt}},Ft={bind:function(n){return function(e){return e(n)}},Apply0:function(){return Et}},Nt={pure:function(n){return n},Apply0:function(){return Et}},kt={Applicative0:function(){return Nt},Bind1:function(){return Ft}},Bt=function(n){return n.mapWithIndex},Pt={mapWithIndex:function(n){return function(e){for(var t=e.length,r=Array(t),u=0;u<t;u++)r[u]=n(u)(e[u]);return r}},Functor0:function(){return P}},qt=function(n){return n.foldrWithIndex},Ct=function(n){return n.foldlWithIndex},It={foldrWithIndex:function(n){return function(e){var t=st(St)((function(e){return function(t){return n(e.value0)(e.value1)(t)}}))(e),r=Bt(Pt)(Ge.create);return function(n){return t(r(n))}}},foldlWithIndex:function(n){return function(e){var t=Mt(St)((function(e){return function(t){return n(t.value0)(e)(t.value1)}}))(e),r=Bt(Pt)(Ge.create);return function(n){return t(r(n))}}},foldMapWithIndex:function(n){return(e=It,function(n){return function(t){return qt(e)((function(e){return function(r){return function(u){return bn(n.Semigroup0())(t(e)(r))(u)}}}))(En(n))}})(n);var e},Foldable0:function(){return St}},Dt=function(n){return n.foldMapWithIndex};const Rt=function(){function n(n){return[n]}function e(n){return function(e){return[n,e]}}function t(n){return function(e){return function(t){return[n,e,t]}}}function r(n){return function(e){return n.concat(e)}}return function(u){return function(o){return function(a){return function(i){return function(c){return function l(f,v){switch(v-f){case 0:return a([]);case 1:return o(n)(i(c[f]));case 2:return u(o(e)(i(c[f])))(i(c[f+1]));case 3:return u(u(o(t)(i(c[f])))(i(c[f+1])))(i(c[f+2]));default:var s=f+2*Math.floor((v-f)/4);return u(o(r)(l(f,s)))(l(s,v))}}(0,c.length)}}}}}}();var zt={map:function(n){return function(e){return function(t){var r=e(t);return{accum:r.accum,value:n(r.value)}}}}},Ot={apply:function(n){return function(e){return function(t){var r=n(t),u=e(r.accum);return{accum:u.accum,value:r.value(u.value)}}}},Functor0:function(){return zt}},_t={pure:function(n){return function(e){return{accum:e,value:n}}},Apply0:function(){return Ot}},Lt=function(n){return n.traverse},Wt={traverse:function(n){return function(e){return function(t){if(t instanceof le)return oe(n)(le.value);if(t instanceof fe)return x(n.Apply0().Functor0())(fe.create)(e(t.value0));throw new Error("Failed pattern match at Data.Traversable (line 115, column 1 - line 119, column 33): "+[e.constructor.name,t.constructor.name])}}},sequence:function(n){return function(e){if(e instanceof le)return oe(n)(le.value);if(e instanceof fe)return x(n.Apply0().Functor0())(fe.create)(e.value0);throw new Error("Failed pattern match at Data.Traversable (line 115, column 1 - line 119, column 33): "+[e.constructor.name])}},Functor0:function(){return he},Foldable1:function(){return yt}},jt={traverse:function(n){return Rt(In(n.Apply0()))(x(n.Apply0().Functor0()))(oe(n))},sequence:function(n){return(e=jt,function(n){return Lt(e)(n)(w(M))})(n);var e},Functor0:function(){return P},Foldable1:function(){return St}},Ut=function(n){return n.sequence},$t=function(n){return function(e){return function(t){return function(r){return Lt(n)(_t)((function(n){return function(t){return e(t)(n)}}))(r)(t)}}}},Yt={traverseWithIndex:function(n){return(e=Yt,function(n){return function(t){var r=Ut(e.Traversable2())(n),u=Bt(e.FunctorWithIndex0())(t);return function(n){return r(u(n))}}})(n);var e},FunctorWithIndex0:function(){return Pt},FoldableWithIndex1:function(){return It},Traversable2:function(){return jt}};const Vt=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){for(var a=[],i=o;;){var c=u(i);if(n(c))return a;var l=e(c);a.push(t(l)),i=r(l)}}}}}}},Kt=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){for(var a=[],i=o;;){var c=u(i);a.push(t(c));var l=r(c);if(n(l))return a;i=e(l)}}}}}}};var Ht={unfoldr1:Kt(pe)(Me())(tt)(Qe)},Jt=function(n){return n.unfoldr},Zt={unfoldr:Vt(pe)(Me())(tt)(Qe),Unfoldable10:function(){return Ht}},Gt=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Qt=function(){function n(){}return n.value=new n,n}(),Xt=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),nr={map:function(n){var e;return e=Qt.value,function(t){var r,u=e,o=!1;function a(e,r){return r instanceof Xt&&r.value1 instanceof Xt&&r.value1.value1 instanceof Xt?(u=new Xt(r,e),void(t=r.value1.value1.value1)):(o=!0,(i=e,function(e){for(var t,r,u,o=i,a=!1;!a;)u=e,t=(r=o)instanceof Xt&&r.value0 instanceof Xt&&r.value0.value1 instanceof Xt&&r.value0.value1.value1 instanceof Xt?(o=r.value1,void(e=new Xt(n(r.value0.value0),new Xt(n(r.value0.value1.value0),new Xt(n(r.value0.value1.value1.value0),u))))):(a=!0,u);return t})((a=r)instanceof Xt&&a.value1 instanceof Xt&&a.value1.value1 instanceof Qt?new Xt(n(a.value0),new Xt(n(a.value1.value0),Qt.value)):a instanceof Xt&&a.value1 instanceof Qt?new Xt(n(a.value0),Qt.value):Qt.value));var a,i}for(;!o;)r=a(u,t);return r}}},er={foldr:function(n){return function(e){var t,r=(t=Qt.value,function(n){var e,r=t,u=!1;function o(e,t){if(t instanceof Qt)return u=!0,e;if(t instanceof Xt)return r=new Xt(t.value0,e),void(n=t.value1);throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[e.constructor.name,t.constructor.name])}for(;!u;)e=o(r,n);return e}),u=Mt(er)(g(n))(e);return function(n){return u(r(n))}}},foldl:function(n){return function(e){return function(t){var r,u=e,o=!1;function a(e,r){if(r instanceof Qt)return o=!0,e;if(r instanceof Xt)return u=n(e)(r.value0),void(t=r.value1);throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[r.constructor.name])}for(;!o;)r=a(u,t);return r}}},foldMap:function(n){return function(e){return Mt(er)((function(t){var r=bn(n.Semigroup0())(t);return function(n){return r(e(n))}}))(En(n))}}},tr={traverse:function(n){return function(e){var t=x(n.Apply0().Functor0())(Mt(er)(g(Xt.create))(Qt.value)),r=Mt(er)((function(t){var r=Rn(n.Apply0())(g(Xt.create))(t);return function(n){return r(e(n))}}))(oe(n)(Qt.value));return function(n){return t(r(n))}}},sequence:function(n){return Lt(tr)(n)(w(M))},Functor0:function(){return nr},Foldable1:function(){return er}},rr={unfoldr1:function(n){return function(e){var t;return(t=e,function(e){var r,u=t,o=!1;function a(t,r){var a=n(t);if(a.value1 instanceof fe)return u=a.value1.value0,void(e=new Xt(a.value0,r));if(a.value1 instanceof le)return o=!0,Mt(er)(g(Xt.create))(Qt.value)(new Xt(a.value0,r));throw new Error("Failed pattern match at Data.List.Types (line 135, column 22 - line 137, column 61): "+[a.constructor.name])}for(;!o;)r=a(u,e);return r})(Qt.value)}}},ur={unfoldr:function(n){return function(e){var t;return(t=e,function(e){var r,u=t,o=!1;function a(t,r){var a=n(t);if(a instanceof le)return o=!0,Mt(er)(g(Xt.create))(Qt.value)(r);if(a instanceof fe)return u=a.value0.value1,void(e=new Xt(a.value0.value0,r));throw new Error("Failed pattern match at Data.List.Types (line 142, column 22 - line 144, column 52): "+[a.constructor.name])}for(;!o;)r=a(u,e);return r})(Qt.value)}},Unfoldable10:function(){return rr}};const or=function(n){throw new Error(n)};var ar=function(n){return function(){return or(n)}()};function ir(n){return n.charCodeAt(0)}var cr=function(n){return function(e){if(e)return oe(n.Applicative0())(A);if(!e)return ze(n.Plus1());throw new Error("Failed pattern match at Control.Alternative (line 48, column 1 - line 48, column 54): "+[e.constructor.name])}},lr=function(n){return n.fromEnum},fr=function(n){return function(e){return function(t){return n(e(t)+1|0)}}},vr=function(n){return function(e){return function(t){return n(e(t)-1|0)}}},sr=function(n){return n>=ne(Qn)&&n<=Gn(Qn)?new fe((e=n,String.fromCharCode(e))):le.value;var e},dr={succ:fr(sr)(ir),pred:vr(sr)(ir),Ord0:function(){return Kn}},pr=function(){return{cardinality:ir(Gn(Xn))-ir(ne(Xn))|0,toEnum:sr,fromEnum:ir,Bounded0:function(){return Xn},Enum1:function(){return dr}}}();const mr=function(n){return function(e){return function(t){return function(r){return n(e,t,r)}}}};var hr=m,wr=M,Mr={mapRecordWithIndexBuilder:function(n){return function(n){return w(wr)}}},br=function(n){return n.mapRecordWithIndexBuilder},gr=function(n){return function(e){return function(t){return function(){return function(){return{mapRecordWithIndexBuilder:function(r){return function(r){return h(hr)(function(n){return function(e){return function(t){return function(r){return function(n){return function(e){return function(t){return t[n]=e(t[n]),t}}}(U(n)(e))(t)(r)}}}}(n)(T.value)(e.mappingWithIndex(r)(T.value)))(br(t)(T.value)(r))}}}}}}}},yr=function(){return function(n){return{hmap:(e=br(n)(T.value),function(n){return function(n){return function(e){return n(function(n){var e={};for(var t in n)({}).hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}(e))}}(e(n))})};var e}},Sr=function(n){return{mappingWithIndex:function(e){return function(t){return n.mapping(e)}}}},Ar=function(){function n(){}return n.value=new n,n}(),Tr=function(n){return{mapping:function(e){return x(B)(kn(n))}}},xr=function(n){return n.hmap(Ar.value)},Er=function(n){return{mapping:function(e){return xr(n)}}},Fr=ct;const Nr=function(n){return function(e){return function(){for(var t=0,r=n.length;t<r;t++)e(n[t])()}}};function kr(n){return function(){return{value:n}}}const Br=function(n){return function(){return n.value}},Pr=function(n){return function(e){return function(){return e.value=n}}};var qr=function(n){return function(e){return function(t){return We(n.Bind1())(e)((function(e){return We(n.Bind1())(t)((function(t){return oe(n.Applicative0())(e(t))}))}))}}};const Cr=function(n){return function(){return n}};var Ir=function(n,e,t){var r,u=0;return function(o){if(2===u)return r;if(1===u)throw new ReferenceError(n+" was needed before it finished initializing (module "+e+", line "+o+")",e,o);return u=1,r=t(),u=2,r}},Dr={Applicative0:function(){return zr},Bind1:function(){return Rr}},Rr={bind:function(n){return function(e){return function(){return e(n())()}}},Apply0:function(){return _r(0)}},zr={pure:Cr,Apply0:function(){return _r(0)}},Or=Ir("functorEffect","Effect",(function(){return{map:(n=zr,function(e){return function(t){return In(n.Apply0())(oe(n)(e))(t)}})};var n})),_r=Ir("applyEffect","Effect",(function(){return{apply:qr(Dr),Functor0:function(){return Or(0)}}})),Lr=Or(20),Wr=_r(23),jr=function(n){return{append:Rn(Wr)(bn(n))}},Ur=function(n){return{mempty:Cr(En(n)),Semigroup0:function(){return jr(n.Semigroup0())}}};const $r=function(n){return function(){return n.value}};var Yr=function(n){return function(){return{value:n}}},Vr=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Kr=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Hr=function(n){return n.tailRecM},Jr={tailRecM:function(n){var e=function(n){return function(e){return function(e){var t,r=!1;function u(t){if(!(t instanceof Vr)){if(t instanceof Kr)return r=!0,t.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 93, column 3 - line 93, column 25): "+[t.constructor.name])}e=n(t.value0)}for(;!r;)t=u(e);return t}(n(e))}}((function(e){return n(e)}));return function(n){return e(n)}},Monad0:function(){return kt}},Zr=function(n,e,t){var r,u=0;return function(o){if(2===u)return r;if(1===u)throw new ReferenceError(n+" was needed before it finished initializing (module "+e+", line "+o+")",e,o);return u=1,r=t(),u=2,r}},Gr=function(n){return function(n){return function(e){return function(){var t=n(e.value);return e.value=t.state,t.value}}}((function(e){var t=n(e);return{state:t,value:t}}))},Qr={map:function(n){return function(e){return function(){return n(e())}}}},Xr={Applicative0:function(){return eu},Bind1:function(){return nu}},nu={bind:function(n){return function(e){return function(){return e(n())()}}},Apply0:function(){return tu(0)}},eu={pure:function(n){return function(){return n}},Apply0:function(){return tu(0)}},tu=Zr("applyST","Control.Monad.ST.Internal",(function(){return{apply:qr(Xr),Functor0:function(){return Qr}}})),ru=tu(46),uu={liftST:Fr,Monad0:function(){return Dr}},ou=function(n){return n.liftST};Array.prototype.fill;const au=function(){function n(n,e){this.head=n,this.tail=e}var e={};function t(e){return function(t){return new n(e,t)}}return function(n){return function(r){return function(n){for(var t=[],r=0,u=n;u!==e;)t[r++]=u.head,u=u.tail;return t}(n(t)(e)(r))}}}(),iu=function(n){return n.length},cu=function(n){return function(e){return function(t){return 0===t.length?n({}):e(t[0])(t.slice(1))}}},lu=function(n){return function(e){return e.filter(n)}},fu=function(n){return function(e){for(var t=[],r=[],u=0;u<e.length;u++){var o=e[u];n(o)?t.push(o):r.push(o)}return{yes:t,no:r}}},vu=function(){function n(e,t,r,u,o,a){var i,c,l,f,v,s;for((i=o+(a-o>>1))-o>1&&n(e,t,u,r,o,i),a-i>1&&n(e,t,u,r,i,a),c=o,l=i,f=o;c<i&&l<a;)v=u[c],s=u[l],t(e(v)(s))>0?(r[f++]=s,++l):(r[f++]=v,++c);for(;c<i;)r[f++]=u[c++];for(;l<a;)r[f++]=u[l++]}return function(e){return function(t){return function(r){var u;return r.length<2?r:(u=r.slice(0),n(e,t,u,r.slice(0),0,r.length),u)}}}}(),su=function(n){return function(e){return function(t){return t.slice(n,e)}}},du=function(n){return function(e){return n[e]}},pu=function(n){return function(){return n}};const mu=function(n){return function(){return n.slice()}};var hu=function(n){return e=[n],function(n){return function(){return n.push.apply(n,e)}};var e},wu=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Mu=function(n){return function(){var e=Br(n.value1)();return n.value0(e)}},bu=function(n){return function(){var e=Br(n.value1)();return Gr((function(n){return n+1|0}))(n.value1)(),n.value0(e)}},gu=function(n){return x(Qr)(wu.create(n))(kr(0))},yu=function(n){return function(e){return function(){for(var t=kr(!1)();x(Qr)(Ve(Je))(Br(t))();)!function(){var r=bu(n)();if(r instanceof fe)return e(r.value0)();if(r instanceof le)return F(Qr)(Pr(!0)(t))();throw new Error("Failed pattern match at Data.Array.ST.Iterator (line 42, column 5 - line 44, column 47): "+[r.constructor.name])}();return{}}}},Su=function(){return du},Au=function(){return cu(y(le.value))((function(n){return function(e){return new fe({head:n,tail:e})}}))}(),Tu=function(n){return vu(n)((function(n){if(n instanceof fn)return 1;if(n instanceof vn)return 0;if(n instanceof ln)return-1;throw new Error("Failed pattern match at Data.Array (line 829, column 31 - line 832, column 11): "+[n.constructor.name])}))},xu=function(n){return[n]},Eu=function(n){return 0===iu(n)},Fu=function(n){return function(n){return function(e){return t=[],Nr(e)((function(e){return function(){var r,u,o,a=x(Qr)((r=Ve(Je),o=function(t){return n(t)(e)},u=function(n){for(var e=n.length,t=0;t<e;t++)if(o(n[t]))return!0;return!1},function(n){return r(u(n))}))(pu(t))();return ae(eu)(a)(F(Qr)(hu(e)(t)))()}}))(),pu(t)();var t}}(nn(n))},Nu=function(n){return function(e){return function(n){return function(e){return function(t){for(var r=e.length<t.length?e.length:t.length,u=new Array(r),o=0;o<r;o++)u[o]=n(e[o])(t[o]);return u}}}(n)((0,function(n){for(var e=0>n?-1:1,t=new Array(e*(n-0)+1),r=0,u=0;r!==n;)t[u++]=r,r+=e;return t[u]=r,t})(iu(e)-1|0))(e)}},ku=function(n){return(e=St,function(n){return function(t){return function(r){return Mt(e)((function(e){return function(r){return e.init?{init:!1,acc:r}:{init:!1,acc:bn(n.Semigroup0())(e.acc)(bn(n.Semigroup0())(t)(r))}}}))({init:!0,acc:En(n)})(r).acc}}})(n);var e},Bu=function(){return(n=fe.create,function(e){return function(t){return function(r){return r<0||r>=t.length?e:n(t[r])}}})(le.value);var n}(),Pu=function(n){return Bu(n)(iu(n)-1|0)},qu=function(n){return In(ge)(x(he)((function(n){return function(e){return{init:n,last:e}}}))(function(n){return Eu(n)?le.value:new fe(su(0)(iu(n)-1|0)(n))}(n)))(Pu(n))},Cu=function(n){return Bu(n)(0)},Iu=function(n){return e=Hn(n),function(n){var t,r=Tu((function(n){return function(t){return e(Qe(n))(Qe(t))}}))(Nu(Ge.create)(n)),u=Cu(r);if(u instanceof le)return[];if(u instanceof fe)return x(P)(Qe)(function(n){return function(e){return Tu(function(n){return function(e){return function(t){return function(r){return Hn(n)(e(t))(e(r))}}}}(n)(e))}}(Vn)(tt)((t=function(n){return function(){return n}}(xu(u.value0))(),Nr(r)((function(n){return function(){var r,u,o=x(Qr)((r=Me(),u=function(n){return r(Pu(n))},function(n){return Qe(u(n))}))(pu(t))();return ae(eu)(rn(dn)(e(o)(n.value1))(vn.value))(F(Qr)(hu(n)(t)))()}}))(),pu(t)())));throw new Error("Failed pattern match at Data.Array (line 1044, column 17 - line 1052, column 29): "+[u.constructor.name])};var e},Du=function(n){return function(e){return t=[],r=gu((function(n){return Bu(e)(n)}))(),yu(r)((function(e){return F(Qr)((function(){var u,o=[];hu(e)(o)(),(u=n(e),function(n){return function(e){return function(){for(var t,r=kr(!1)();x(Qr)(Ve(Je))(Br(r))();)(t=Mu(n)())instanceof fe&&u(t.value0)?(hu(t.value0)(e)(),F(Qr)(bu(n))()):F(Qr)(Pr(!0)(r))();return{}}}})(r)(o)();var a=pu(o)();return hu(a)(t)()}))}))(),pu(t)();var t,r}},Ru=function(n){var e=Du((function(e){return function(t){return nn(dn)(n(e)(t))(vn.value)}})),t=Tu(n);return function(n){return e(t(n))}},zu=st(St),Ou=Mt(St),_u=function(n){return At(St)(n)},Lu=function(n){return function(e){return function(t){return cu((function(e){return oe(n.Applicative0())(t)}))((function(r){return function(u){return We(n.Bind1())(e(t)(r))((function(t){return Lu(n)(e)(t)(u)}))}}))}}},Wu=function(){return(n=fe.create,function(e){return function(t){return function(r){for(var u=0,o=r.length;u<o;u++)if(t(r[u]))return n(u);return e}}})(le.value);var n}(),ju=function(n){return function(e){return x(he)(Su()(e))(Wu(n)(e))}},Uu=function(n){return function(e){return n<1?e:su(n)(iu(e))(e)}},$u=function(){return(n=fe.create,function(e){return function(t){return function(r){if(t<0||t>=r.length)return e;var u=r.slice();return u.splice(t,1),n(u)}}})(le.value);var n}(),Yu=function(n){return function(e){return function(t){return 0===t.length?[]:de(t)((function(n){return Me()($u(n)(t))}))(Wu(n(e))(t))}}},Vu=g(We(Le)),Ku=function(n){return Vu((e=de([])(xu),function(t){return e(n(t))}));var e},Hu=function(){return n=Qt.value,function(e){var t,r=n,u=!1;function o(n,t){if(t instanceof Qt)return u=!0,n;if(t instanceof Xt)return r=new Xt(t.value0,n),void(e=t.value1);throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[n.constructor.name,t.constructor.name])}for(;!u;)t=o(r,e);return t};var n}(),Ju=function(){function n(){}return n.value=new n,n}(),Zu=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}},n}(),Gu=function(){function n(n,e,t,r,u,o,a){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=o,this.value6=a}return n.create=function(e){return function(t){return function(r){return function(u){return function(o){return function(a){return function(i){return new n(e,t,r,u,o,a,i)}}}}}}},n}(),Qu=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),Xu=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),no=function(){function n(n,e,t,r,u,o){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=o}return n.create=function(e){return function(t){return function(r){return function(u){return function(o){return function(a){return new n(e,t,r,u,o,a)}}}}}},n}(),eo=function(){function n(n,e,t,r,u,o){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=o}return n.create=function(e){return function(t){return function(r){return function(u){return function(o){return function(a){return new n(e,t,r,u,o,a)}}}}}},n}(),to=function(){function n(n,e,t,r,u,o){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=o}return n.create=function(e){return function(t){return function(r){return function(u){return function(o){return function(a){return new n(e,t,r,u,o,a)}}}}}},n}(),ro=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}},n}(),uo=function(n){return function(e){return new Zu(Ju.value,n,e,Ju.value)}},oo=function(n){return function(e){return Jt(n)((function(n){var e,t=!1;function r(e){if(e instanceof Qt)return t=!0,le.value;if(e instanceof Xt){if(e.value0 instanceof Ju)return void(n=e.value1);if(e.value0 instanceof Zu&&e.value0.value0 instanceof Ju&&e.value0.value3 instanceof Ju)return t=!0,new fe(new Ge(new Ge(e.value0.value1,e.value0.value2),e.value1));if(e.value0 instanceof Zu&&e.value0.value0 instanceof Ju)return t=!0,new fe(new Ge(new Ge(e.value0.value1,e.value0.value2),new Xt(e.value0.value3,e.value1)));if(e.value0 instanceof Zu)return void(n=new Xt(e.value0.value0,new Xt(uo(e.value0.value1)(e.value0.value2),new Xt(e.value0.value3,e.value1))));if(e.value0 instanceof Gu)return void(n=new Xt(e.value0.value0,new Xt(uo(e.value0.value1)(e.value0.value2),new Xt(e.value0.value3,new Xt(uo(e.value0.value4)(e.value0.value5),new Xt(e.value0.value6,e.value1))))));throw new Error("Failed pattern match at Data.Map.Internal (line 624, column 18 - line 633, column 71): "+[e.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 623, column 3 - line 623, column 19): "+[e.constructor.name])}for(;!t;)e=r(n);return e}))(new Xt(e,Qt.value))}},ao=function(n){return function(e){var t=Hn(n);return function(n){var r,u=!1;function o(r){if(r instanceof Ju)return u=!0,le.value;if(r instanceof Zu){var o=t(e)(r.value1);return o instanceof vn?(u=!0,new fe(r.value2)):o instanceof ln?void(n=r.value0):void(n=r.value3)}if(r instanceof Gu){var a=t(e)(r.value1);if(a instanceof vn)return u=!0,new fe(r.value2);var i=t(e)(r.value4);return i instanceof vn?(u=!0,new fe(r.value5)):a instanceof ln?void(n=r.value0):i instanceof fn?void(n=r.value6):void(n=r.value3)}throw new Error("Failed pattern match at Data.Map.Internal (line 241, column 5 - line 241, column 22): "+[r.constructor.name])}for(;!u;)r=o(n);return r}}},io=function(n){return function(e){return function(t){return me(ao(n)(e)(t))}}},co={map:function(n){return function(e){if(e instanceof Ju)return Ju.value;if(e instanceof Zu)return new Zu(x(co)(n)(e.value0),e.value1,n(e.value2),x(co)(n)(e.value3));if(e instanceof Gu)return new Gu(x(co)(n)(e.value0),e.value1,n(e.value2),x(co)(n)(e.value3),e.value4,n(e.value5),x(co)(n)(e.value6));throw new Error("Failed pattern match at Data.Map.Internal (line 116, column 1 - line 119, column 110): "+[n.constructor.name,e.constructor.name])}}},lo=function(n){return function(e){return function(t){var r,u=n,o=e,a=!1;function i(n,e,r){if(e instanceof Qt)return a=!0,r;if(e instanceof Xt){if(e.value0 instanceof Qu)return u=n,o=e.value1,void(t=new Zu(r,e.value0.value0,e.value0.value1,e.value0.value2));if(e.value0 instanceof Xu)return u=n,o=e.value1,void(t=new Zu(e.value0.value0,e.value0.value1,e.value0.value2,r));if(e.value0 instanceof no)return u=n,o=e.value1,void(t=new Gu(r,e.value0.value0,e.value0.value1,e.value0.value2,e.value0.value3,e.value0.value4,e.value0.value5));if(e.value0 instanceof eo)return u=n,o=e.value1,void(t=new Gu(e.value0.value0,e.value0.value1,e.value0.value2,r,e.value0.value3,e.value0.value4,e.value0.value5));if(e.value0 instanceof to)return u=n,o=e.value1,void(t=new Gu(e.value0.value0,e.value0.value1,e.value0.value2,e.value0.value3,e.value0.value4,e.value0.value5,r));throw new Error("Failed pattern match at Data.Map.Internal (line 462, column 3 - line 467, column 88): "+[e.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 459, column 1 - line 459, column 80): "+[e.constructor.name,r.constructor.name])}for(;!a;)r=i(u,o,t);return r}}},fo=function(n){return function(e){return function(t){var r,u=Hn(n);return r=Qt.value,function(o){var a,i=r,c=!1;function l(r,a){if(a instanceof Ju)return c=!0,function(e){return function(t){var r,u=e,o=!1;function a(e,r){if(e instanceof Qt)return o=!0,new Zu(r.value0,r.value1,r.value2,r.value3);if(e instanceof Xt){if(e.value0 instanceof Qu)return o=!0,lo(n)(e.value1)(new Gu(r.value0,r.value1,r.value2,r.value3,e.value0.value0,e.value0.value1,e.value0.value2));if(e.value0 instanceof Xu)return o=!0,lo(n)(e.value1)(new Gu(e.value0.value0,e.value0.value1,e.value0.value2,r.value0,r.value1,r.value2,r.value3));if(e.value0 instanceof no)return u=e.value1,void(t=new ro(new Zu(r.value0,r.value1,r.value2,r.value3),e.value0.value0,e.value0.value1,new Zu(e.value0.value2,e.value0.value3,e.value0.value4,e.value0.value5)));if(e.value0 instanceof eo)return u=e.value1,void(t=new ro(new Zu(e.value0.value0,e.value0.value1,e.value0.value2,r.value0),r.value1,r.value2,new Zu(r.value3,e.value0.value3,e.value0.value4,e.value0.value5)));if(e.value0 instanceof to)return u=e.value1,void(t=new ro(new Zu(e.value0.value0,e.value0.value1,e.value0.value2,e.value0.value3),e.value0.value4,e.value0.value5,new Zu(r.value0,r.value1,r.value2,r.value3)));throw new Error("Failed pattern match at Data.Map.Internal (line 498, column 5 - line 503, column 108): "+[e.value0.constructor.name,r.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 495, column 3 - line 495, column 56): "+[e.constructor.name,r.constructor.name])}for(;!o;)r=a(u,t);return r}}(r)(new ro(Ju.value,e,t,Ju.value));if(a instanceof Zu){var l=u(e)(a.value1);return l instanceof vn?(c=!0,lo(n)(r)(new Zu(a.value0,e,t,a.value3))):l instanceof ln?(i=new Xt(new Qu(a.value1,a.value2,a.value3),r),void(o=a.value0)):(i=new Xt(new Xu(a.value0,a.value1,a.value2),r),void(o=a.value3))}if(a instanceof Gu){var f=u(e)(a.value1);if(f instanceof vn)return c=!0,lo(n)(r)(new Gu(a.value0,e,t,a.value3,a.value4,a.value5,a.value6));var v=u(e)(a.value4);return v instanceof vn?(c=!0,lo(n)(r)(new Gu(a.value0,a.value1,a.value2,a.value3,e,t,a.value6))):f instanceof ln?(i=new Xt(new no(a.value1,a.value2,a.value3,a.value4,a.value5,a.value6),r),void(o=a.value0)):f instanceof fn&&v instanceof ln?(i=new Xt(new eo(a.value0,a.value1,a.value2,a.value4,a.value5,a.value6),r),void(o=a.value3)):(i=new Xt(new to(a.value0,a.value1,a.value2,a.value3,a.value4,a.value5),r),void(o=a.value6))}throw new Error("Failed pattern match at Data.Map.Internal (line 478, column 3 - line 478, column 55): "+[r.constructor.name,a.constructor.name])}for(;!c;)a=l(i,o);return a}}}},vo={foldr:function(n){return function(e){return function(t){if(t instanceof Ju)return e;if(t instanceof Zu)return st(vo)(n)(n(t.value2)(st(vo)(n)(e)(t.value3)))(t.value0);if(t instanceof Gu)return st(vo)(n)(n(t.value2)(st(vo)(n)(n(t.value5)(st(vo)(n)(e)(t.value6)))(t.value3)))(t.value0);throw new Error("Failed pattern match at Data.Map.Internal (line 133, column 17 - line 136, column 85): "+[t.constructor.name])}}},foldl:function(n){return function(e){return function(t){if(t instanceof Ju)return e;if(t instanceof Zu)return Mt(vo)(n)(n(Mt(vo)(n)(e)(t.value0))(t.value2))(t.value3);if(t instanceof Gu)return Mt(vo)(n)(n(Mt(vo)(n)(n(Mt(vo)(n)(e)(t.value0))(t.value2))(t.value3))(t.value5))(t.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 137, column 17 - line 140, column 85): "+[t.constructor.name])}}},foldMap:function(n){return function(e){return function(t){if(t instanceof Ju)return En(n);if(t instanceof Zu)return bn(n.Semigroup0())(At(vo)(n)(e)(t.value0))(bn(n.Semigroup0())(e(t.value2))(At(vo)(n)(e)(t.value3)));if(t instanceof Gu)return bn(n.Semigroup0())(At(vo)(n)(e)(t.value0))(bn(n.Semigroup0())(e(t.value2))(bn(n.Semigroup0())(At(vo)(n)(e)(t.value3))(bn(n.Semigroup0())(e(t.value5))(At(vo)(n)(e)(t.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 141, column 17 - line 144, column 93): "+[t.constructor.name])}}}},so={foldrWithIndex:function(n){return function(e){return function(t){if(t instanceof Ju)return e;if(t instanceof Zu)return qt(so)(n)(n(t.value1)(t.value2)(qt(so)(n)(e)(t.value3)))(t.value0);if(t instanceof Gu)return qt(so)(n)(n(t.value1)(t.value2)(qt(so)(n)(n(t.value4)(t.value5)(qt(so)(n)(e)(t.value6)))(t.value3)))(t.value0);throw new Error("Failed pattern match at Data.Map.Internal (line 147, column 26 - line 150, column 120): "+[t.constructor.name])}}},foldlWithIndex:function(n){return function(e){return function(t){if(t instanceof Ju)return e;if(t instanceof Zu)return Ct(so)(n)(n(t.value1)(Ct(so)(n)(e)(t.value0))(t.value2))(t.value3);if(t instanceof Gu)return Ct(so)(n)(n(t.value4)(Ct(so)(n)(n(t.value1)(Ct(so)(n)(e)(t.value0))(t.value2))(t.value3))(t.value5))(t.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 151, column 26 - line 154, column 120): "+[t.constructor.name])}}},foldMapWithIndex:function(n){return function(e){return function(t){if(t instanceof Ju)return En(n);if(t instanceof Zu)return bn(n.Semigroup0())(Dt(so)(n)(e)(t.value0))(bn(n.Semigroup0())(e(t.value1)(t.value2))(Dt(so)(n)(e)(t.value3)));if(t instanceof Gu)return bn(n.Semigroup0())(Dt(so)(n)(e)(t.value0))(bn(n.Semigroup0())(e(t.value1)(t.value2))(bn(n.Semigroup0())(Dt(so)(n)(e)(t.value3))(bn(n.Semigroup0())(e(t.value4)(t.value5))(Dt(so)(n)(e)(t.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 155, column 26 - line 158, column 128): "+[t.constructor.name])}}},Foldable0:function(){return vo}},po={traverse:function(n){return function(e){return function(t){if(t instanceof Ju)return oe(n)(Ju.value);if(t instanceof Zu)return In(n.Apply0())(In(n.Apply0())(In(n.Apply0())(x(n.Apply0().Functor0())(Zu.create)(Lt(po)(n)(e)(t.value0)))(oe(n)(t.value1)))(e(t.value2)))(Lt(po)(n)(e)(t.value3));if(t instanceof Gu)return In(n.Apply0())(In(n.Apply0())(In(n.Apply0())(In(n.Apply0())(In(n.Apply0())(In(n.Apply0())(x(n.Apply0().Functor0())(Gu.create)(Lt(po)(n)(e)(t.value0)))(oe(n)(t.value1)))(e(t.value2)))(Lt(po)(n)(e)(t.value3)))(oe(n)(t.value4)))(e(t.value5)))(Lt(po)(n)(e)(t.value6));throw new Error("Failed pattern match at Data.Map.Internal (line 160, column 1 - line 175, column 31): "+[e.constructor.name,t.constructor.name])}}},sequence:function(n){return Lt(po)(n)(w(M))},Functor0:function(){return co},Foldable1:function(){return vo}},mo=function(){return Ju.value}(),ho=function(n){return function(e){return Mt(e)((function(e){return function(t){return fo(n)(t.value0)(t.value1)(e)}}))(mo)}},wo=function(n){return function(e){return function(t){return function(r){var u=e(ao(n)(t)(r));if(u instanceof le)return function(n){return function(e){return function(t){return de(t)(Qe)(function(n){return function(e){var t,r=function(e){return function(t){var r,u=e,o=!1;function a(e,r){if(e instanceof Qt)return o=!0,r;if(e instanceof Xt)return e.value0 instanceof Qu&&e.value0.value2 instanceof Ju&&r instanceof Ju?(o=!0,lo(n)(e.value1)(new Zu(Ju.value,e.value0.value0,e.value0.value1,Ju.value))):e.value0 instanceof Xu&&e.value0.value0 instanceof Ju&&r instanceof Ju?(o=!0,lo(n)(e.value1)(new Zu(Ju.value,e.value0.value1,e.value0.value2,Ju.value))):e.value0 instanceof Qu&&e.value0.value2 instanceof Zu?(u=e.value1,void(t=new Gu(r,e.value0.value0,e.value0.value1,e.value0.value2.value0,e.value0.value2.value1,e.value0.value2.value2,e.value0.value2.value3))):e.value0 instanceof Xu&&e.value0.value0 instanceof Zu?(u=e.value1,void(t=new Gu(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3,e.value0.value1,e.value0.value2,r))):e.value0 instanceof Qu&&e.value0.value2 instanceof Gu?(o=!0,lo(n)(e.value1)(new Zu(new Zu(r,e.value0.value0,e.value0.value1,e.value0.value2.value0),e.value0.value2.value1,e.value0.value2.value2,new Zu(e.value0.value2.value3,e.value0.value2.value4,e.value0.value2.value5,e.value0.value2.value6)))):e.value0 instanceof Xu&&e.value0.value0 instanceof Gu?(o=!0,lo(n)(e.value1)(new Zu(new Zu(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3),e.value0.value0.value4,e.value0.value0.value5,new Zu(e.value0.value0.value6,e.value0.value1,e.value0.value2,r)))):e.value0 instanceof no&&e.value0.value2 instanceof Ju&&e.value0.value5 instanceof Ju&&r instanceof Ju?(o=!0,lo(n)(e.value1)(new Gu(Ju.value,e.value0.value0,e.value0.value1,Ju.value,e.value0.value3,e.value0.value4,Ju.value))):e.value0 instanceof eo&&e.value0.value0 instanceof Ju&&e.value0.value5 instanceof Ju&&r instanceof Ju?(o=!0,lo(n)(e.value1)(new Gu(Ju.value,e.value0.value1,e.value0.value2,Ju.value,e.value0.value3,e.value0.value4,Ju.value))):e.value0 instanceof to&&e.value0.value0 instanceof Ju&&e.value0.value3 instanceof Ju&&r instanceof Ju?(o=!0,lo(n)(e.value1)(new Gu(Ju.value,e.value0.value1,e.value0.value2,Ju.value,e.value0.value4,e.value0.value5,Ju.value))):e.value0 instanceof no&&e.value0.value2 instanceof Zu?(o=!0,lo(n)(e.value1)(new Zu(new Gu(r,e.value0.value0,e.value0.value1,e.value0.value2.value0,e.value0.value2.value1,e.value0.value2.value2,e.value0.value2.value3),e.value0.value3,e.value0.value4,e.value0.value5))):e.value0 instanceof eo&&e.value0.value0 instanceof Zu?(o=!0,lo(n)(e.value1)(new Zu(new Gu(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3,e.value0.value1,e.value0.value2,r),e.value0.value3,e.value0.value4,e.value0.value5))):e.value0 instanceof eo&&e.value0.value5 instanceof Zu?(o=!0,lo(n)(e.value1)(new Zu(e.value0.value0,e.value0.value1,e.value0.value2,new Gu(r,e.value0.value3,e.value0.value4,e.value0.value5.value0,e.value0.value5.value1,e.value0.value5.value2,e.value0.value5.value3)))):e.value0 instanceof to&&e.value0.value3 instanceof Zu?(o=!0,lo(n)(e.value1)(new Zu(e.value0.value0,e.value0.value1,e.value0.value2,new Gu(e.value0.value3.value0,e.value0.value3.value1,e.value0.value3.value2,e.value0.value3.value3,e.value0.value4,e.value0.value5,r)))):e.value0 instanceof no&&e.value0.value2 instanceof Gu?(o=!0,lo(n)(e.value1)(new Gu(new Zu(r,e.value0.value0,e.value0.value1,e.value0.value2.value0),e.value0.value2.value1,e.value0.value2.value2,new Zu(e.value0.value2.value3,e.value0.value2.value4,e.value0.value2.value5,e.value0.value2.value6),e.value0.value3,e.value0.value4,e.value0.value5))):e.value0 instanceof eo&&e.value0.value0 instanceof Gu?(o=!0,lo(n)(e.value1)(new Gu(new Zu(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3),e.value0.value0.value4,e.value0.value0.value5,new Zu(e.value0.value0.value6,e.value0.value1,e.value0.value2,r),e.value0.value3,e.value0.value4,e.value0.value5))):e.value0 instanceof eo&&e.value0.value5 instanceof Gu?(o=!0,lo(n)(e.value1)(new Gu(e.value0.value0,e.value0.value1,e.value0.value2,new Zu(r,e.value0.value3,e.value0.value4,e.value0.value5.value0),e.value0.value5.value1,e.value0.value5.value2,new Zu(e.value0.value5.value3,e.value0.value5.value4,e.value0.value5.value5,e.value0.value5.value6)))):e.value0 instanceof to&&e.value0.value3 instanceof Gu?(o=!0,lo(n)(e.value1)(new Gu(e.value0.value0,e.value0.value1,e.value0.value2,new Zu(e.value0.value3.value0,e.value0.value3.value1,e.value0.value3.value2,e.value0.value3.value3),e.value0.value3.value4,e.value0.value3.value5,new Zu(e.value0.value3.value6,e.value0.value4,e.value0.value5,r)))):(o=!0,ar("The impossible happened in partial function `up`."));throw new Error("Failed pattern match at Data.Map.Internal (line 552, column 5 - line 573, column 86): "+[e.constructor.name])}for(;!o;)r=a(u,t);return r}},u=function(n){return function(e){for(var t,u,o,a=n,i=!1;!i;)u=a,t=(o=e)instanceof Zu&&o.value0 instanceof Ju&&o.value3 instanceof Ju?(i=!0,r(u)(Ju.value)):o instanceof Zu?(a=new Xt(new Xu(o.value0,o.value1,o.value2),u),void(e=o.value3)):o instanceof Gu&&o.value0 instanceof Ju&&o.value3 instanceof Ju&&o.value6 instanceof Ju?(i=!0,r(new Xt(new Xu(Ju.value,o.value1,o.value2),u))(Ju.value)):o instanceof Gu?(a=new Xt(new to(o.value0,o.value1,o.value2,o.value3,o.value4,o.value5),u),void(e=o.value6)):(i=!0,ar("The impossible happened in partial function `removeMaxNode`."));return t}},o=function(n){var e,t=!1;function r(e){if(e instanceof Zu&&e.value3 instanceof Ju)return t=!0,{key:e.value1,value:e.value2};if(e instanceof Zu)n=e.value3;else{if(e instanceof Gu&&e.value6 instanceof Ju)return t=!0,{key:e.value4,value:e.value5};if(!(e instanceof Gu))return t=!0,ar("The impossible happened in partial function `maxNode`.");n=e.value6}}for(;!t;)e=r(n);return e},a=Hn(n);return t=Qt.value,function(i){var c,l=t,f=!1;function v(t,c){if(c instanceof Ju)return f=!0,le.value;if(c instanceof Zu){var v=a(e)(c.value1);if(c.value3 instanceof Ju&&v instanceof vn)return f=!0,new fe(new Ge(c.value2,r(t)(Ju.value)));if(v instanceof vn){var s=o(c.value0);return f=!0,new fe(new Ge(c.value2,u(new Xt(new Qu(s.key,s.value,c.value3),t))(c.value0)))}return v instanceof ln?(l=new Xt(new Qu(c.value1,c.value2,c.value3),t),void(i=c.value0)):(l=new Xt(new Xu(c.value0,c.value1,c.value2),t),void(i=c.value3))}if(c instanceof Gu){var d=c.value0 instanceof Ju&&c.value3 instanceof Ju&&c.value6 instanceof Ju,p=(v=a(e)(c.value4),a(e)(c.value1));return d&&p instanceof vn?(f=!0,new fe(new Ge(c.value2,lo(n)(t)(new Zu(Ju.value,c.value4,c.value5,Ju.value))))):d&&v instanceof vn?(f=!0,new fe(new Ge(c.value5,lo(n)(t)(new Zu(Ju.value,c.value1,c.value2,Ju.value))))):p instanceof vn?(s=o(c.value0),f=!0,new fe(new Ge(c.value2,u(new Xt(new no(s.key,s.value,c.value3,c.value4,c.value5,c.value6),t))(c.value0)))):v instanceof vn?(s=o(c.value3),f=!0,new fe(new Ge(c.value5,u(new Xt(new eo(c.value0,c.value1,c.value2,s.key,s.value,c.value6),t))(c.value3)))):p instanceof ln?(l=new Xt(new no(c.value1,c.value2,c.value3,c.value4,c.value5,c.value6),t),void(i=c.value0)):p instanceof fn&&v instanceof ln?(l=new Xt(new eo(c.value0,c.value1,c.value2,c.value4,c.value5,c.value6),t),void(i=c.value3)):(l=new Xt(new to(c.value0,c.value1,c.value2,c.value3,c.value4,c.value5),t),void(i=c.value6))}throw new Error("Failed pattern match at Data.Map.Internal (line 525, column 16 - line 548, column 80): "+[c.constructor.name])}for(;!f;)c=v(l,i);return c}}}(n)(e)(t))}}}(n)(t)(r);if(u instanceof fe)return fo(n)(t)(u.value0)(r);throw new Error("Failed pattern match at Data.Map.Internal (line 596, column 15 - line 598, column 25): "+[u.constructor.name])}}}},Mo=function(n){return function(e){return function(t){return function(r){return Ct(so)((function(t){return function(r){return function(u){return wo(n)((o=de(u)(e(u)),function(n){return fe.create(o(n))}))(t)(r);var o}}}))(r)(t)}}}},bo={compact:function(n){return t=[],r=gu((function(e){return Bu(n)(e)}))(),yu(r)((e=F(Qr),function(n){return e(function(n){if(n instanceof le)return oe(eu)(0);if(n instanceof fe)return hu(n.value0)(t);throw new Error("Failed pattern match at Data.Compactable (line 111, column 34 - line 113, column 35): "+[n.constructor.name])}(n))}))(),pu(t)();var e,t,r},separate:function(n){return t=[],r=[],u=gu((function(e){return Bu(n)(e)}))(),yu(u)((e=F(Qr),function(n){return e(function(n){if(n instanceof Fe)return hu(n.value0)(t);if(n instanceof Ne)return hu(n.value0)(r);throw new Error("Failed pattern match at Data.Compactable (line 122, column 34 - line 124, column 31): "+[n.constructor.name])}(n))}))(),In(ru)(x(Qr)((function(n){return function(e){return{left:n,right:e}}}))(pu(t)))(pu(r))();var e,t,r,u}},go=function(n){return n.compact},yo={partitionMap:function(n){return Mt(St)((function(e){return function(t){var r=n(t);if(r instanceof Fe)return{left:bn(wn)(e.left)([r.value0]),right:e.right};if(r instanceof Ne)return{right:bn(wn)(e.right)([r.value0]),left:e.left};throw new Error("Failed pattern match at Data.Filterable (line 149, column 16 - line 151, column 50): "+[r.constructor.name])}}))({left:[],right:[]})},partition:fu,filterMap:Ku,filter:lu,Compactable0:function(){return bo},Functor1:function(){return P}},So=function(n){return n.filterMap},Ao={dimap:function(n){return function(e){return function(t){return function(r){return e(t(n(r)))}}}}},To=function(n){return n.dimap},xo=function(n){return function(e){return To(n)(e)(w(M))}},Eo=function(n){return function(e){return function(t){return function(n){return Mo(n)(y)}(n)(e)(t)}}},Fo=function(n){return function(e){return function(t){return io(n)(e)(t)}}},No=function(n){return function(e){return function(t){return fo(n)(e)(A)(t)}}},ko=mo,Bo=function(n){return{mempty:ko,Semigroup0:function(){return function(n){return{append:Eo(n)}}(n)}}},Po=function(n){return n.sampleOn},qo=function(n){return n.keepLatest},Co=function(n){return n.fold},Io=function(n){return function(e){return function(t){return function(r){return So(n.Filterable1())(Qe)(Co(n)((function(n){return function(t){return x(et)(oe(Se))(e(n)(t.value0))}}))(t)(new Ge(r,le.value)))}}}},Do=function(n){return function(e){return function(t){return Pn(n.Plus0().Alt0())(Po(n)(e)(t))(Po(n)(t)(x(n.Filterable1().Functor1())(S)(e)))}}},Ro=function(n){return n.bang},zo=function(n){return function(e){return n===e}},Oo=function(n){return function(e){return function(t){return function(r){return To(Ao)((function(e){return function(r){return ft()(kn(n)(y(e(r))))(oe(t)(A))}}))(kn(e))(r)}}}},_o=function(n){return function(e){return n(e)}},Lo=function(n){return function(e){return function(t){return function(r){return function(u){return We(n.Monad0().Bind1())(ou(n)(kr(le.value)))((function(o){return We(n.Monad0().Bind1())(t((function(e){return ou(n)(F(Qr)(Pr(new fe(e))(o)))})))((function(t){return We(n.Monad0().Bind1())(r((function(t){return We(n.Monad0().Bind1())(ou(n)(Br(o)))(mt(e)(yt)((function(n){return u(t(n))})))})))((function(n){return oe(e)(Dn(e.Apply0())(t)(n))}))}))}))}}}}},Wo=function(n){return n},jo=function(n){return function(e){return function(t){return We(n.Monad0().Bind1())(ou(n)(kr(le.value)))((function(r){return We(n.Monad0().Bind1())(e((function(e){return Oe($e)(n.Monad0().Bind1())(We(n.Monad0().Bind1())(ou(n)(Br(r)))(wt(n.Monad0().Applicative0())(yt)))((function(){return We(n.Monad0().Bind1())(_o(e)(t))((function(e){return ou(n)(F(Qr)(Pr(new fe(e))(r)))}))}))})))((function(e){return oe(n.Monad0().Applicative0())(Oe($e)(n.Monad0().Bind1())(We(n.Monad0().Bind1())(ou(n)(Br(r)))(wt(n.Monad0().Applicative0())(yt)))((function(){return e})))}))}))}}},Uo={map:function(n){return function(e){return function(t){return e((function(e){return t(n(e))}))}}}},$o=function(n){return function(e){return function(t){return function(r){return To(Ao)(x(B)(kn(n)))((function(n){return ft()(kn(e)(y(n)))(oe(t)(oe(t)(A)))}))(r)}}}},Yo=function(n){return function(e){return function(t){return function(r){return function(u){return We(n.Monad0().Bind1())(ou(n)(kr(r)))((function(r){return t((function(t){return We(n.Monad0().Bind1())(ou(n)(Gr(e(t))(r)))(u)}))}))}}}}},Vo=function(n){return function(e){return function(t){return function(r){return t((function(t){var u=e(t);if(u instanceof fe)return r(u.value0);if(u instanceof le)return oe(n)(A);throw new Error("Failed pattern match at FRP.Event (line 131, column 13 - line 133, column 27): "+[u.constructor.name])}))}}}},Ko=function(n){return function(e){return Vo(n)((function(n){var t=e(n);if(t)return new fe(n);if(!t)return le.value;throw new Error("Failed pattern match at FRP.Event (line 89, column 13 - line 91, column 25): "+[t.constructor.name])}))}},Ho=function(n){return function(e){return We(n.Monad0().Bind1())(ou(n)(kr([])))((function(t){return oe(n.Monad0().Applicative0())({event:function(n){return We(e.Monad0().Bind1())(ou(e)(Gr((function(e){return bn(wn)(e)([n])}))(t)))((function(){return oe(e.Monad0().Applicative0())(We(e.Monad0().Bind1())(ou(e)(Gr(Yu(zo)(n))(t)))((function(){return oe(e.Monad0().Applicative0())(A)})))}))},push:function(n){return We(e.Monad0().Bind1())(ou(e)(Br(t)))(mt(e.Monad0().Applicative0())(St)((function(e){return e(n)})))}})}))}},Jo=function(n){return function(e){return function(t){return function(r){return We(e.Bind1())(Ho(n)(n))((function(n){var u=t(n.event);return We(e.Bind1())(_o(u.input)(n.push))((function(n){return We(e.Bind1())(_o(u.output)(r))((function(t){return oe(e.Applicative0())(Dn(e.Bind1().Apply0())(n)(t))}))}))}))}}}},Zo=function(n){return function(e){return function(t){return function(r){return We(n.Monad0().Bind1())(Ho(n)(n))((function(u){return Oe($e)(n.Monad0().Bind1())(r(t(u.event)))((function(){return _o(e)(u.push)}))}))}}}},Go=function(n){return{compact:Vo(n)(w(M)),separate:function(e){return{left:Vo(n)((function(n){if(n instanceof Fe)return new fe(n.value0);if(n instanceof Ne)return le.value;throw new Error("Failed pattern match at FRP.Event (line 72, column 13 - line 74, column 33): "+[n.constructor.name])}))(e),right:Vo(n)((function(n){if(n instanceof Ne)return new fe(n.value0);if(n instanceof Fe)return le.value;throw new Error("Failed pattern match at FRP.Event (line 79, column 13 - line 81, column 32): "+[n.constructor.name])}))(e)}}}},Qo=function(n){return{filter:Ko(n),filterMap:Vo(n),partition:function(e){return function(t){return{yes:Ko(n)(e)(t),no:Ko(n)((r=Ve(Je),function(n){return r(e(n))}))(t)};var r}},partitionMap:function(e){return function(t){return{left:So(Qo(n))((r=Pe(fe.create)(y(le.value)),function(n){return r(e(n))}))(t),right:So(Qo(n))((function(n){return qe(e(n))}))(t)};var r}},Compactable0:function(){return Go(n)},Functor1:function(){return Uo}}},Xo=function(n){return function(e){return function(t){return x(n.Apply0().Functor0())((function(e){return oe(n)(A)}))(t(e))}}},na=function(n){return{alt:function(e){return function(t){return function(r){return In(n.Apply0())(x(n.Apply0().Functor0())((function(e){return function(t){return Dn(n.Apply0())(e)(t)}}))(e(r)))(t(r))}}},Functor0:function(){return Uo}}},ea=function(n){return{empty:function(e){return oe(n)(oe(n)(A))},Alt0:function(){return na(n)}}},ta=function(n){return{fold:Yo(n),keepLatest:jo(n),sampleOn:Lo(n)(n.Monad0().Applicative0()),fix:Jo(n)(n.Monad0()),bang:Xo(n.Monad0().Applicative0()),Plus0:function(){return ea(n.Monad0().Applicative0())},Filterable1:function(){return Qo(n.Monad0().Applicative0())}}};const ra="_____$__$_$$_vbus";var ua=function(n){return function(){return function(){return function(e){return function(t){return function(r){return Y(U(n)(e))(t)(r)}}}}}},oa={vb:function(n){return function(n){return function(n){return{}}}}},aa=function(n){return n.vb},ia=function(n){return function(){return function(){return function(){return function(e){return function(t){return function(){return function(){return function(){return function(){return{vb:function(r){return function(r){return function(r){return ua(n)()()(T.value)(((u=aa(e)(T.value)(T.value)(T.value))._____$__$_$$_vbus=ra,u))(aa(t)(T.value)(T.value)(T.value));var u}}}}}}}}}}}}}},ca=function(n){return function(){return function(){return function(e){return function(){return function(){return function(){return function(){return{vb:function(t){return function(t){return function(t){return ua(n)()()(T.value)(A)(aa(e)(T.value)(T.value)(T.value))}}}}}}}}}}}},la=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),fa=function(){function n(){}return n.value=new n,n}(),va=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),sa=function(){function n(){}return n.value=new n,n}(),da=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),pa=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ma=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ha=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),wa=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Ma={eq:function(n){return function(e){return n instanceof la&&e instanceof la?n.value0===e.value0:n instanceof fa&&e instanceof fa}}},ba=function(n){return new ma(n)},ga=function(n){return new ha(n)},ya={Always0:function(){return Nn(Ur(yn))},Always1:function(){return Nn(Ur(Ur(yn)))},Always2:function(){return Nn(Ur(yn))},Always3:function(){return Nn(it(M))},Always4:function(){return Nn(it(M))},MonadST5:function(){return uu}},Sa=function(){return function(n){return function(){return function(e){return function(t){return function(r){return function(u){return new ha((o=n.MonadST5(),function(n){return function(e){return function(e){var t=aa(n)(T.value)(T.value)(T.value);return function(n){return We(o.Monad0().Bind1())((r=t,()=>{const n=(e,t,r,u)=>{const o=Object.keys(u);for(var a=0;a<o.length;a++)if(u[o[a]]instanceof Object&&u[o[a]]._____$__$_$$_vbus===ra){const i={},c={};n(e,i,c,u[o[a]]),t[o[a]]=i,r[o[a]]=c}else{const n=`${Math.random()}`;e[n]={},t[o[a]]=t=>()=>{const r=Object.values(e[n]);for(var u=0;u<r.length;u++)r[u](t)()},r[o[a]]=t=>()=>{const r=`${Math.random()}`;return e[n][r]=t,()=>{delete e[n][r]}}}},e={},t={},u={};return n(e,t,u,r),{p:t,e:u,s:e}}))((function(t){return Oe($e)(o.Monad0().Bind1())(n(e(t.p)(t.e)))((function(){return oe(o.Monad0().Applicative0())((n=t.s,()=>{for(const e in n)delete n[e]}));var n}))}));var r}}}})(t)(r)(xo(Ao)(xr(yr()(e)))(u)));var o}}}}}}},Aa=function(n){return function(e){return function(t){return(r=n.MonadST5(),function(n){return function(e){return We(r.Monad0().Bind1())(Ho(r)(r))((function(t){return Oe($e)(r.Monad0().Bind1())(e(n(t.push)(t.event)))((function(){return oe(r.Monad0().Applicative0())(oe(r.Monad0().Applicative0())(A))}))}))}})(xo(Ao)(x(B)(kn(e)))(t));var r}}};const Ta={};function xa(n){return function(e){return function(t){return function(r){var u=t;function o(n){return function(t){return e(t)(n)(r[n])}}for(var a in r)hasOwnProperty.call(r,a)&&(u=n(u)(o(a)));return u}}}}function Ea(n){return function(e){var t=[];for(var r in e)hasOwnProperty.call(e,r)&&t.push(n(r)(e[r]));return t}}Object.keys||Ea((function(n){return function(){return n}}));var Fa=Ea((function(n){return function(n){return n}})),Na=function(n){return function(){var e={};for(var t in n)hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}},ka=function(n){return function(e){return function(n){return n()}((function(){var t=Na(e)();return n(t)(),t}))}},Ba=function(n){return function(e){return ka(function(n){return function(e){return function(t){return function(){return t[n]=e,t}}}}(n)(e))}},Pa=xa(S),qa={foldl:function(n){return Pa((function(e){return function(t){return n(e)}}))},foldr:function(n){return function(e){return function(t){return st(St)(n)(e)(Fa(t))}}},foldMap:function(n){return function(e){return function(n){return function(e){return Pa((function(t){return function(r){return function(u){return bn(n.Semigroup0())(t)(e(r)(u))}}}))(En(n))}}(n)(y(e))}}},Ca=function(n){return ka(function(n){return function(e){return function(){return delete e[n],e}}}(n))},Ia=function(){function n(){}return n.value=new n,n}(),Da=function(){function n(){}return n.value=new n,n}(),Ra=function(){function n(){}return n.value=new n,n}(),za=function(n){return function(e){return function(t){var r;return new pa(qo(ta(n))(Zo(n)((r=t,Io(ta(n))((function(n){return function(e){return new Ge(e+1|0,new Ge(n,e))}}))(r)(0)))((function(t){return x(Uo)((function(r){return Pn(na(n.Monad0().Applicative0()))(Ro(ta(n))(new va(e(r.value0))))(x(Uo)(y(sa.value))(Qo(n.Monad0().Applicative0()).filter((u=nn(G)(r.value1+1|0),function(n){return u(Qe(n))}))(t)));var u}))(t)}))))}}},Oa=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){if(o instanceof ma)return pt(St)(ea(n))(Oa(n)(e)(t)(r)(u))(o.value0);if(o instanceof ha)return qo(ta(e))(x(Uo)(Oa(n)(e)(t)(r)(u))(o.value0));if(o instanceof wa)return function(n){return n(r)(u)}(t.toElt(o.value0));if(o instanceof pa)return function(a){return We(e.Monad0().Bind1())(ou(e)(kr(Ta)))((function(i){return We(e.Monad0().Bind1())(_o(o.value0)((function(o){return We(e.Monad0().Bind1())(t.ids(u))((function(c){return We(e.Monad0().Bind1())(ou(e)(kr(oe(n)(A))))((function(l){return We(e.Monad0().Bind1())(t.ids(u))((function(f){return We(e.Monad0().Bind1())(ou(e)(kr(oe(n)(A))))((function(v){return We(e.Monad0().Bind1())(ou(e)(kr([])))((function(s){return We(e.Monad0().Bind1())(ou(e)(kr(oe(n)(A))))((function(d){return We(e.Monad0().Bind1())(x(n.Apply0().Functor0())(la.create)(t.ids(u)))((function(p){return We(e.Monad0().Bind1())(ou(e)(kr(Ia.value)))((function(m){return We(e.Monad0().Bind1())(_o(o)((function(o){return We(e.Monad0().Bind1())(ou(e)(Br(m)))((function(h){return o instanceof da&&h instanceof Da?We(e.Monad0().Bind1())(ou(e)(Br(s)))(mt(n)(St)((w=t.doLogic(o.value0)(u),function(n){return a(w(n))}))):o instanceof sa&&h instanceof Da?Oe($e)(e.Monad0().Bind1())(F(n.Apply0().Functor0())(ou(e)(Pr(Ra.value)(m))))((function(){var o=Dn(n.Apply0())(Dn(n.Apply0())(Dn(n.Apply0())(Dn(n.Apply0())(We(e.Monad0().Bind1())(ou(e)(Br(s)))(mt(n)(St)((function(e){return ht(n)(yt)(r.parent)((function(n){return a(t.disconnectElement(u)({id:e,parent:n,scope:p}))}))}))))(Ye(e.Monad0().Bind1())(ou(e)(Br(l)))))(Ye(e.Monad0().Bind1())(ou(e)(Br(v)))))(F(n.Apply0().Functor0())(ou(e)(Gr(Ca(c))(i)))))(F(n.Apply0().Functor0())(ou(e)(Gr(Ca(f))(i))));return Dn(n.Apply0())(F(n.Apply0().Functor0())(ou(e)(Pr(o)(d))))(o)})):o instanceof va&&h instanceof Ia?Oe($e)(e.Monad0().Bind1())(F(n.Apply0().Functor0())(ou(e)(Pr(Da.value)(m))))((function(){return We(e.Monad0().Bind1())(_o(Oa(n)(e)(t)({parent:r.parent,scope:p,raiseId:function(t){return F(n.Apply0().Functor0())(ou(e)(Gr(bn(wn)([t]))(s)))}})(u)(o.value0))(a))((function(t){return Oe($e)(e.Monad0().Bind1())(F(n.Apply0().Functor0())(ou(e)(Gr(Ba(f)(t))(i))))((function(){return F(n.Apply0().Functor0())(ou(e)(Pr(t)(v)))}))}))})):oe(n)(A);var w}))})))((function(t){return Oe($e)(e.Monad0().Bind1())(F(n.Apply0().Functor0())(ou(e)(Pr(t)(l))))((function(){return Oe($e)(e.Monad0().Bind1())(F(n.Apply0().Functor0())(ou(e)(Gr(Ba(c)(t))(i))))((function(){return Ye(e.Monad0().Bind1())(ou(e)(Br(d)))}))}))}))}))}))}))}))}))}))}))}))})))((function(t){return oe(n)(Oe($e)(e.Monad0().Bind1())(We(e.Monad0().Bind1())(ou(e)(Br(i)))(Mt(qa)(Dn(n.Apply0()))(oe(n)(A))))((function(){return t})))}))}))};throw new Error("Failed pattern match at Bolson.Control (line 521, column 17 - line 604, column 20): "+[o.constructor.name])}}}}}},_a=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),La=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Wa=lt(),ja=function(){return _a.create}(),Ua=function(){return La.create}(),$a=function(){var n=x(B)(x(Lr)(y(!0)));return function(e){return n(e)}}(),Ya=function(n){return n.attr},Va=function(n){return n.makeText},Ka=function(n){return function(e){return function(t){return x(Uo)((function(t){return n.setText({id:e,text:t})}))(t)}}},Ha=function(n){return function(e){return function(t){return x(Uo)((function(t){return function(t){if(t.value instanceof _a)return n.setProp({id:e,key:t.key,value:t.value.value0});if(t.value instanceof La)return n.setCb({id:e,key:t.key,value:t.value.value0});throw new Error("Failed pattern match at Deku.Control (line 75, column 26 - line 77, column 45): "+[t.value.constructor.name])}(Wa(t))}))(t)}}},Ja=function(n){return n.makeElement},Za=function(n){return n.attributeParent},Ga=function(n){return function(e){return new wa((function(t){return function(r){return function(u){return We(n.Bind1())(r.ids)((function(o){return Oe($e)(n.Bind1())(t.raiseId(o))((function(){return x(n.Bind1().Apply0().Functor0())(Dn(n.Bind1().Apply0())(u(r.deleteFromCache({id:o}))))(_o(dt(St)(ea(n.Applicative0()))([Xo(n.Applicative0())(Va(r)({id:o,parent:t.parent,scope:t.scope})),Ka(r)(o)(e)]))(u))}))}))}}}))}},Qa=function(n){return function(e){return Ga(n)(Xo(n.Applicative0())(e))}},Xa=function(n){return Oa(n.MonadST5().Monad0().Applicative0())(n.MonadST5())({doLogic:function(n){return function(e){return function(t){return e.sendToPos({id:t,pos:n})}}},ids:(t=ft(e),function(n){return t(n).ids}),disconnectElement:function(n){return function(e){return n.disconnectElement({id:e.id,scope:e.scope,parent:e.parent,scopeEq:nn(Ma)})}},toElt:function(n){return n}});var e,t},ni=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){return function(a){return We(n.MonadST5().Monad0().Bind1())(o.ids)((function(i){return Oe($e)(n.MonadST5().Monad0().Bind1())(u.raiseId(i))((function(){return x(n.MonadST5().Monad0().Bind1().Apply0().Functor0())(Dn(n.MonadST5().Monad0().Bind1().Apply0())(a(o.deleteFromCache({id:i}))))(_o(Pn(na(n.MonadST5().Monad0().Applicative0()))(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))(bn(wn)([Xo(n.MonadST5().Monad0().Applicative0())(Ja(o)({id:i,parent:u.parent,scope:u.scope,tag:e})),Ha(o)(i)(t)])(de([])((function(e){return[Xo(n.MonadST5().Monad0().Applicative0())(Za(o)({id:i,parent:e}))]}))(u.parent))))(Xa(n)({parent:new fe(i),scope:u.scope,raiseId:function(e){return oe(n.MonadST5().Monad0().Applicative0())(A)}})(o)(r)))(a))}))}))}}}}}}};const ei=(n,e,t,r)=>{n((n=>r.units[n].main.appendChild(r.units[e].main)))(t)},ti=n=>e=>()=>{e.units[n.id].main.parentNode||e.units[n.parent].main.appendChild(e.units[n.id].main)},ri=n=>e=>t=>r=>()=>{var u,o=t.id;if(r.scopes[t.scope]||(r.scopes[t.scope]=[]),r.scopes[t.scope].push(o),r.hydrating&&n&&t.parent.value0&&(u=document.body.querySelectorAll("[data-deku-ssr-"+t.parent.value0+"]").item(0))){var a=0;if(1===u.childNodes.length)u.prepend(document.createTextNode(""));else for(a=0;a<u.childNodes.length;a++)if(8===u.childNodes[a].nodeType&&u.childNodes[a].nodeValue===o){a-=1;break}r.units[o]={main:u.childNodes[a],parent:t.parent,scope:t.scope}}else r.units[o]={main:document.createTextNode(""),parent:t.parent,scope:t.scope},ei(e,o,t.parent,r)},ui=n=>e=>t=>()=>{var r=e.id,u=e.value;t.hydrating&&n&&!t.units[r]&&(dom=document.body.querySelectorAll("[data-deku-ssr-"+r+"]").item(0))&&(t.units[r]={listeners:{},parent:e.parent,scope:e.scope,main:dom},t.scopes[e.scope]||(t.scopes[e.scope]=[]),t.scopes[e.scope].push(r)),"INPUT"===t.units[r].main.tagName&&"value"===e.key?t.units[r].main.value=u:"INPUT"===t.units[r].main.tagName&&"checked"===e.key?t.units[r].main.checked="true"===u:t.units[r].main.setAttribute(e.key,u)},oi=n=>e=>t=>()=>{var r=e.id,u=e.value;if(t.hydrating&&n&&!t.units[r]&&(dom=document.body.querySelectorAll("[data-deku-ssr-"+r+"]").item(0))&&(t.units[r]={listeners:{},parent:e.parent,scope:e.scope,main:dom},t.scopes[e.scope]||(t.scopes[e.scope]=[]),t.scopes[e.scope].push(r)),"@self@"===e.key)u(t.units[r].main)();else{t.units[r].listeners[e.key]&&t.units[r].main.removeEventListener(e.key,t.units[r].listeners[e.key]);var o=n=>u(n)();t.units[r].main.addEventListener(e.key,o),t.units[r].listeners[e.key]=o}},ai=n=>e=>()=>{var t=n.id;e.units[t].main.nodeValue=n.text},ii=n=>e=>t=>r=>()=>{var u,o,a=t.id,i=t.html,c=t.verb,l=t.cache,f=t.parent,v=t.scope,s=t.pxScope;if(r.hydrating&&n&&t.parent.value0&&(u=document.body.querySelectorAll("[data-deku-ssr-"+a+"]").item(0)))r.units[a]={listeners:{},scope:v,parent:f,main:u};else{const n=Object.entries(l);for(var d=0;d<n.length;d++){const e=n[d][0];i=!0===n[d][1]?i.replace(c+e+c,'data-deku-attr-internal="'+e+'"'):i.replace(c+e+c,'<span style="display:contents;" data-deku-elt-internal="'+e+'"></span>')}(o=document.createElement("div")).innerHTML=i.trim(),r.units[a]={listeners:{},scope:v,parent:f,main:o.firstChild}}r.scopes[v]||(r.scopes[v]=[]),r.scopes[v].push(a),o||(o=u),o.querySelectorAll("[data-deku-attr-internal]").forEach((function(n){const e=n.getAttribute("data-deku-attr-internal")+s;r.units[e]={listeners:{},main:n,scope:v},r.scopes[v].push(e)})),o.querySelectorAll("[data-deku-elt-internal]").forEach((function(n){var e=n.getAttribute("data-deku-elt-internal");const t=e+s;r.units[e+s]={listeners:{},main:n,scope:v},r.scopes[v].push(t)})),u||ei(e,a,f,r)},ci=n=>e=>()=>{var t=n.id;e.units[t]={main:n.root}},li=n=>e=>()=>{var t=n.id,r=n.parent;e.units[t].containingScope=n.scope,e.units[r].main.prepend(e.units[t].main)},fi=n=>e=>()=>{var t=n.id;e.units[t].noop||e.units[t].containingScope&&!n.scopeEq(e.units[t].containingScope)(n.scope)||e.units[t].main.remove()},vi=n=>e=>()=>{delete e.units[n.id]},si=n=>e=>()=>{var t=n.id,r=n.pos,u=e.units[t].main.parentNode;u.insertBefore(e.units[t].main,u.children.length<=r?u.children[u.children.length-1]:r<0?u.children[0]:u.children[r])},di=function(n){return n},pi=(isNaN,isFinite);Math.abs,Math.acos,Math.asin,Math.atan,Math.ceil,Math.cos,Math.exp;const mi=Math.floor,hi=(Math.log,function(n){return function(e){return n%e}}),wi=Math.round;Math.sign&&Math.sign,Math.sin,Math.sqrt,Math.tan,Math.trunc&&Math.trunc;var Mi=function(){return(n=fe.create,function(e){return function(t){return(0|t)===t?n(t):e}})(le.value);var n}(),bi=function(n){return pi(n)?n>=Gn(Qn)?Gn(Qn):n<=ne(Qn)?ne(Qn):we(0)(Mi(n)):0},gi=function(n){return bi(wi(n))},yi=function(n){return bi(mi(n))};const Si=Math.random;var Ai=function(n){return function(e){return function(){var t=Si();return yi((e-n+1)*t+n)}}},Ti=2147483647,xi=function(){return Ti-1|0}(),Ei=function(n){return function(n){return function(e){var t=n-1|0,r=un(an)(e)(t);return r<1?r+n|0:r}}(xi)(n)},Fi=x(Lr)(Ei)(Ai(1)(xi)),Ni=function(n){return function(e){return Me()(Mi(hi(48271*e+n)(Ti)))}},ki=Ni(0),Bi=function(n){return n.resize},Pi=function(n){return n},qi={append:function(n){return function(n){return n}}},Ci=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Ii=function(){function n(){}return n.value=new n,n}(),Di=wn,Ri=P,zi=St,Oi={foldMap1:function(n){return(e=Oi,function(n){return function(t){return function(r){var u=e.foldl1(bn(t)),o=x(n)(r);return function(n){return u(o(n))}}}})(Ri)(n);var e},foldr1:function(n){return function(e){for(var t=e[e.length-1],r=e.length-2;r>=0;r--)t=n(e[r])(t);return t}},foldl1:function(n){return function(e){for(var t=e[0],r=e.length,u=1;u<r;u++)t=n(t)(e[u]);return t}},Foldable0:function(){return zi}},_i=function(n){return xu(n)},Li=function(n){return iu(n)>0?new fe(n):le.value},Wi=function(n){var e=Me();return function(t){return e(n(t))}}(Cu),ji=function(n){return function(e){return n(e)}},Ui=ji(iu),$i=function(n){return e=Ru(n),t=ji(e),function(n){return t(n)};var e,t};const Yi=function(n){return n.length},Vi=function(n){return function(e){return e.substring(n)}};var Ki=function(){return(n=fe.create,function(e){return function(t){return function(r){var u=r.indexOf(t);return-1===u?e:n(u)}}})(le.value);var n}(),Hi=function(n){return""===n},Ji=$n,Zi=function(n){return""===n?le.value:new fe(n)},Gi=V,Qi=function(n){return n.state},Xi=function(n){return Qi(n)((function(n){return new Ge(n,n)}))},nc={liftEffect:w(M),Monad0:function(){return Dr}},ec=function(n){return n.liftEffect},tc=function(n){return{map:function(e){return function(t){return function(r){return x(n)((function(n){return new Ge(e(n.value0),n.value1)}))(t(r))}}}}},rc=function(n){return{Applicative0:function(){return ac(n)},Bind1:function(){return uc(n)}}},uc=function(n){return{bind:function(e){return function(t){return function(r){return We(n.Bind1())(e(r))((function(n){return t(n.value0)(n.value1)}))}}},Apply0:function(){return oc(n)}}},oc=function(n){return{apply:qr(rc(n)),Functor0:function(){return tc(n.Bind1().Apply0().Functor0())}}},ac=function(n){return{pure:function(e){return function(t){return oe(n.Applicative0())(new Ge(e,t))}},Apply0:function(){return oc(n)}}},ic=function(n){return{tailRecM:function(e){return function(t){var r=function(t){var r=e(t.value0);return We(n.Monad0().Bind1())(r(t.value1))((function(e){return oe(n.Monad0().Applicative0())(function(){if(e.value0 instanceof Vr)return new Vr(new Ge(e.value0.value0,e.value1));if(e.value0 instanceof Kr)return new Kr(new Ge(e.value0.value0,e.value1));throw new Error("Failed pattern match at Control.Monad.State.Trans (line 87, column 16 - line 89, column 40): "+[e.value0.constructor.name])}())}))};return function(e){return Hr(n)(r)(new Ge(t,e))}}},Monad0:function(){return rc(n.Monad0())}}},cc=function(n){return{state:function(e){var t=oe(n.Applicative0());return function(n){return t(e(n))}},Monad0:function(){return rc(n)}}},lc=function(n){return e=n,t=ft(),function(n){return t(e(n))};var e,t},fc=function(n){return function(n){return Qi(cc(kt))((function(e){return lc(n(e))(e)}))}((function(e){return n(e.size)}))},vc=function(n){return function(e){return function(t){return e<=0?oe(n.Monad0().Applicative0())(Qt.value):Hr(n)((function(e){return 0===e.value1?oe(n.Monad0().Applicative0())(new Kr(e.value0)):E(n.Monad0().Bind1().Apply0().Functor0())(t)((function(n){return new Vr(new Ge(new Xt(n,e.value0),e.value1-1|0))}))}))(new Ge(Qt.value,e))}}},sc=ic(Jr),dc=rc(kt),pc=vc(sc),mc=function(){return Qi(cc(kt))((function(n){return new Ge(n.newSeed,function(){var e={};for(var t in n)({}).hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.newSeed=ki(n.newSeed),e}())}))}(),hc=tc(xt),wc=x(hc)((function(n){return n/Ti}))(mc),Mc=function(n){return function(e){return x(hc)(Jt(Zt)((function(n){return x(he)((function(n){return new Ge(n.head,n.tail)}))(function(n){if(n instanceof Qt)return le.value;if(n instanceof Xt)return new fe({head:n.value0,tail:n.value1});throw new Error("Failed pattern match at Data.List (line 259, column 1 - line 259, column 66): "+[n.constructor.name])}(n))})))(pc(n)(e))}},bc=function(n){return e=n,function(n){return e(n).value0};var e},gc=function(n){return function(){var e=Fi();return bc(n)({newSeed:e,size:10})}},yc=function(n){return function(e){return function(t){return bc(Mc(e)(t))({newSeed:n,size:e})}}},Sc=oc(kt),Ac=function(n){return function(e){var t=e,r=n,u=x(hc)(di)(mc),o=In(Sc)(x(hc)(z(I))(u))(x(hc)(R(I)(2))(u));return x(hc)((function(n){return yi(r+hi(n)(t-r+1))}))(o)}},Tc=function(n){return function(e){return n<=e?Ac(n)(e):Ac(e)(n)}},xc={chooseInt:Tc,chooseFloat:function(n){return function(e){var t,r,u=function(n){return.5*n},o=u(Zn(Yn)(n)(e)),a=u(Jn(Yn)(n)(e));return x(hc)((t=z(I)(o),r=R(I)(a-o),function(n){return 2*t(r(n))}))(wc)}},chooseBool:x(hc)((function(n){return n<.5}))(wc),resize:function(n){return function(e){return fc((function(t){return(r=n(t),function(n){return Qi(cc(kt))((function(e){return x(et)((function(n){return{size:e.size,newSeed:n.newSeed}}))(lc(n)({newSeed:e.newSeed,size:r}))}))})(e);var r}))}},sized:fc,Monad0:function(){return dc}},Ec=function(){return{arbitrary:Tc(-1e6)(1e6)}}(),Fc=function(n){return function(e){return function(n,e,t,r){if("undefined"!=typeof window){var u=window[t];if(null!=u&&r instanceof u)return e(r)}for(var o=r;null!=o;){var a=Object.getPrototypeOf(o),i=a.constructor.name;if(i===t)return e(r);if("Object"===i)return n;o=a}return n}(le.value,fe.create,n,e)}},Nc=function(n){return e=n,t=le.value,r=fe.create,null==e?t:r(e);var e,t,r},kc=function(){var n=x(Lr)(Nc);return function(e){return n((t=e,function(){return t.body}));var t}}(),Bc=ct;function Pc(n){return function(){return n.value}}function qc(n){return function(){return n.valueAsNumber}}var Cc=Fc("HTMLInputElement");function Ic(n){return function(){return n.document}}var Dc=ct;const Rc=function(){return window};var zc=function(n){return function(e){return function(){var t,r,u={units:{},scopes:{}},o=E(Lr)(Yr(0))((r=(t=ya,function(n){return function(e){return function(r){return function(u){return We(t.MonadST5().Monad0().Bind1())(r.ids)((function(o){return _o(Pn(na(t.MonadST5().Monad0().Applicative0()))(Xo(t.MonadST5().Monad0().Applicative0())(r.makeRoot({id:o,root:n})))(Xa(t)({parent:new fe(o),scope:new la("rootScope"),raiseId:function(n){return oe(t.MonadST5().Monad0().Applicative0())(A)}})(r)(e)))(u)}))}}}})(n)(e),function(n){return r((e=n,{ids:function(){var n,t=$r(e)(),r=ue(te)(bc(Ec.arbitrary)({newSeed:Ei(t),size:5}));return F(Lr)((n=z(D)(1),function(n){return function(e){return function(){var t=n(e.value);return e.value=t.state,t.value}}}((function(e){var t=n(e);return{state:t,value:t}})))(e))(),r},makeElement:n=>e=>()=>{var t=n.id;e.scopes[n.scope]||(e.scopes[n.scope]=[]),e.scopes[n.scope].push(t),e.hydrating,e.units[t]={listeners:{},parent:n.parent,scope:n.scope,main:document.createElement(n.tag)}},attributeParent:ti,makeRoot:ci,makeText:ri(!1)(de(A)),makePursx:ii(!1)(de(A)),setProp:ui(!1),setCb:oi(!1),setText:ai,sendToPos:si,deleteFromCache:vi,giveNewParent:li,disconnectElement:fi}));var e}))();return _o(o)((function(n){return n(u)}))()}}},Oc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),_c=function(){return new Oc(Qt.value,Qt.value)}(),Lc=function(){function n(){}return n.value=new n,n}(),Wc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),jc=function(n){return function(e){if(n instanceof Lc)return e;if(e instanceof Lc)return n;if(n instanceof Wc)return new Wc(n.value0,function(n){return function(e){return new Oc(n.value0,new Xt(e,n.value1))}}(n.value1)(e));throw new Error("Failed pattern match at Data.CatList (line 108, column 1 - line 108, column 54): "+[n.constructor.name,e.constructor.name])}},Uc=function(n){return function(e){return function(t){var r;return(r=t,function(t){var u,o=r,a=!1;function i(r,u){var i,c=function(n){var e,t=!1;function r(e){if(e.value0 instanceof Qt&&e.value1 instanceof Qt)return t=!0,le.value;if(!(e.value0 instanceof Qt)){if(e.value0 instanceof Xt)return t=!0,new fe(new Ge(e.value0.value0,new Oc(e.value0.value1,e.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 82, column 1 - line 82, column 63): "+[e.constructor.name])}n=new Oc(Hu(e.value1),Qt.value)}for(;!t;)e=r(n);return e}(r);if(c instanceof le)return a=!0,(i=function(n){return function(e){return e(n)}},function(n){return function(e){var t,r=i,u=n,o=!1;function a(n,t,a){if(a instanceof Qt)return o=!0,t;if(a instanceof Xt)return r=n,u=n(t)(a.value0),void(e=a.value1);throw new Error("Failed pattern match at Data.CatList (line 124, column 3 - line 124, column 59): "+[n.constructor.name,t.constructor.name,a.constructor.name])}for(;!o;)t=a(r,u,e);return t}})(e)(u);if(c instanceof fe)return o=c.value0.value1,void(t=new Xt(n(c.value0.value0),u));throw new Error("Failed pattern match at Data.CatList (line 120, column 14 - line 122, column 67): "+[c.constructor.name])}for(;!a;)u=i(o,t);return u})(Qt.value)}}},$c=function(n){if(n instanceof Lc)return le.value;if(n instanceof Wc)return new fe(new Ge(n.value0,function(n){return n.value0 instanceof Qt&&n.value1 instanceof Qt}(n.value1)?Lc.value:Uc(jc)(Lc.value)(n.value1)));throw new Error("Failed pattern match at Data.CatList (line 99, column 1 - line 99, column 61): "+[n.constructor.name])},Yc=function(){return Lc.value}(),Vc=jc,Kc={append:Vc},Hc=function(n,e,t){var r,u=0;return function(o){if(2===u)return r;if(1===u)throw new ReferenceError(n+" was needed before it finished initializing (module "+e+", line "+o+")",e,o);return u=1,r=t(),u=2,r}},Jc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Zc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Gc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Qc=function(n){return function(e){return function(t){var r,u=!1;function o(r){var o=function(n){var e,t=!1;function r(e){var r=function(n){return function(e){return new Jc(n.value0,bn(Kc)(n.value1)(e))}};if(e.value0 instanceof Zc){var u=$c(e.value1);if(u instanceof le)return t=!0,new Zc(e.value0.value0);if(u instanceof fe)return void(n=r((0,u.value0.value0)(e.value0.value0))(u.value0.value1));throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[u.constructor.name])}if(e.value0 instanceof Gc)return t=!0,new Gc(e.value0.value0,(function(n){return r(e.value0.value1(n))(e.value1)}));throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[e.value0.constructor.name])}for(;!t;)e=r(n);return e}(r);if(o instanceof Zc)return u=!0,o.value0;if(!(o instanceof Gc))throw new Error("Failed pattern match at Control.Monad.Free (line 178, column 10 - line 180, column 33): "+[o.constructor.name]);t=e(x(n)(o.value1)(o.value0))}for(;!u;)r=o(t);return r}}},Xc={Applicative0:function(){return tl},Bind1:function(){return el}},nl={map:function(n){return function(e){return je(el)((t=oe(tl),function(e){return t(n(e))}))(e);var t}}},el={bind:function(n){return function(e){return new Jc(n.value0,(t=n.value1,function(n){return Vc(t)(new Wc(n,_c))})(e));var t}},Apply0:function(){return rl(0)}},tl={pure:function(n){return e=Zc.create(n),new Jc(e,Yc);var e},Apply0:function(){return rl(0)}},rl=Hc("freeApply","Control.Monad.Free",(function(){return{apply:qr(Xc),Functor0:function(){return nl}}})),ul={proof:function(n){return n},Coercible0:function(){}},ol=function(n){return n.proof((function(n){return n}))},al=function(n){return function(n){return y(n)}},il=function(n){return{apply:function(e){return function(t){return function(r){return In(n)(e(r))(t(r))}}},Functor0:function(){return e=n.Functor0(),{map:(t=x(e),function(n){return e=t(n),function(n){return function(t){return e(n(t))}};var e})};var e,t}}},cl=function(n){return{Applicative0:function(){return e=n.Applicative0(),{pure:(t=oe(e),function(n){return y(t(n))}),Apply0:function(){return il(e.Apply0())}};var e,t},Bind1:function(){return e=n.Bind1(),{bind:function(n){return function(t){return function(r){return We(e)(n(r))((function(n){return t(n)(r)}))}}},Apply0:function(){return il(e.Apply0())}};var e}}},ll=function(n){return{liftEffect:(e=al(n.Monad0()),t=ec(n),function(n){return e(t(n))}),Monad0:function(){return cl(n.Monad0())}};var e,t},fl=Qc(B)((function(n){return n(A)}));function vl(n,e,t,r,u,o,a){return null==a?n():"boolean"==typeof a?e(a):"number"==typeof a?t(a):"string"==typeof a?r(a):"[object Array]"===Object.prototype.toString.call(a)?u(a):o(a)}var sl=function(){return(n=le.value,function(e){return function(t){return t(n)(e)}})(fe.create);var n}(),dl=sl((function(n){return function(e){return function(t){return vl(y(n),y(n),y(n),e,y(n),y(n),t)}}})),pl=sl((function(n){return function(e){return function(t){return vl(y(n),y(n),y(n),y(n),e,y(n),t)}}})),ml=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),hl=function(){var n=ut(at)((function(n){return new ml("JSON")}));return function(e){return n((t=e,function(n,e,t){try{return e(JSON.parse(t))}catch(e){return n(e.message)}}(Fe.create,Ne.create,t)));var t}}(),wl=function(n){return n},Ml=function(n){return n},bl=po,gl=function(n){return function(e){return{append:function(t){return function(r){return Mo(n)(bn(e))(t)(r)}}}}},yl=function(n){return function(e){return{mempty:mo,Semigroup0:function(){return gl(n)(e)}}}},Sl=co,Al="function"==typeof Array.from,Tl="undefined"!=typeof Symbol&&null!=Symbol&&void 0!==Symbol.iterator&&"function"==typeof String.prototype[Symbol.iterator],xl="function"==typeof String.prototype.fromCodePoint,El="function"==typeof String.prototype.codePointAt;const Fl=function(n){return xl?function(e){return e.length<1e4?String.fromCodePoint.apply(String,e):e.map(n).join("")}:function(e){return e.map(n).join("")}},Nl=function(n){return xl?String.fromCodePoint:n},kl=function(n){return function(e){return Tl?function(n){for(var t="",r=n[Symbol.iterator](),u=0;u<e;++u){var o=r.next();if(o.done)return t;t+=o.value}return t}:n(e)}},Bl=function(n){return function(e){return Al?function(n){return Array.from(n,e)}:n}},Pl=function(n){return function(e){if(n>=0&&n<e.length)return e.charAt(n);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var ql=function(n){return function(e){return 65536+((1024*(n-55296|0)|0)+(e-56320|0)|0)|0}},Cl=function(n){return 56320<=n&&n<=57343},Il=function(n){return 55296<=n&&n<=56319},Dl=function(n){var e=Yi(n);if(0===e)return le.value;if(1===e)return new fe({head:lr(pr)(Pl(0)(n)),tail:""});var t=lr(pr)(Pl(1)(n)),r=lr(pr)(Pl(0)(n)),u=Il(r)&&Cl(t);return new fe(u?{head:ql(r)(t),tail:Vi(2)(n)}:{head:r,tail:Vi(1)(n)})},Rl=function(n){return x(he)((function(n){return new Ge(n.head,n.tail)}))(Dl(n))},zl=function(n){return Jt(Zt)(Rl)(n)},Ol=function(n){return El?function(n){return n.codePointAt(0)}:n}((function(n){var e=lr(pr)(Pl(0)(n));if(Il(e)&&Yi(n)>1){var t=lr(pr)(Pl(1)(n));return Cl(t)?ql(e)(t):e}return e})),_l=Bl(zl)(Ol),Ll=function(n){return iu(_l(n))},Wl=function(){var n,e=(n=pr,function(e){return function(t){return function(r){var u=n.toEnum(r);if(u instanceof fe)return u.value0;if(u instanceof le)return r<lr(n)(ne(n.Bounded0()))?e:t;throw new Error("Failed pattern match at Data.Enum (line 158, column 33 - line 160, column 62): "+[u.constructor.name])}}})(ne(Xn))(Gn(Xn));return function(n){return e(n)}}(),jl=function(n){if(n<=65535)return Wl(n);var e=cn(an)(n-65536|0)(1024)+55296|0,t=un(an)(n-65536|0)(1024)+56320|0;return Wl(e)+Wl(t)},Ul=Fl(jl),$l=Nl(jl),Yl=function(n){return function(e){if(n<1)return"";var t=Dl(e);return t instanceof fe?$l(t.value0.head)+Yl(n-1|0)(t.value0.tail):e}},Vl=kl(Yl),Kl={eq:function(n){return function(e){return n===e}}},Hl={compare:function(n){return function(e){return Hn(Vn)(n)(e)}},Eq0:function(){return Kl}},Jl=function(n){return function(e){return Vi(Yi(Vl(n)(e)))(e)}},Zl=function(){var n=lr(pr);return function(e){return n(e)}}(),Gl=function(n){return n},Ql=function(n){return Gl($l(n))},Xl=function(n){return Ll(n)},nf=function(){function n(){}return n.value=new n,n}(),ef={attr:function(n){return function(n){return{key:"checked",value:ja(n)}}}},tf=function(){function n(){}return n.value=new n,n}(),rf={attr:function(n){return function(n){return{key:"class",value:ja(n)}}}},uf={attr:function(n){return function(n){return{key:"class",value:ja(n)}}}},of={attr:function(n){return function(n){return{key:"class",value:ja(n)}}}},af={attr:function(n){return function(n){return{key:"class",value:ja(n)}}}},cf={attr:function(n){return function(n){return{key:"class",value:ja(n)}}}},lf={attr:function(n){return function(n){return{key:"class",value:ja(n)}}}},ff={attr:function(n){return function(n){return{key:"class",value:ja(n)}}}},vf={attr:function(n){return function(n){return{key:"class",value:ja(n)}}}},sf={attr:function(n){return function(n){return{key:"class",value:ja(n)}}}},df={attr:function(n){return function(n){return{key:"class",value:ja(n)}}}},pf={attr:function(n){return function(n){return{key:"class",value:ja(n)}}}},mf={attr:function(n){return function(n){return{key:"class",value:ja(n)}}}},hf=function(){function n(){}return n.value=new n,n}(),wf={attr:function(n){return function(n){return{key:"max",value:ja(n)}}}},Mf=function(){function n(){}return n.value=new n,n}(),bf={attr:function(n){return function(n){return{key:"min",value:ja(n)}}}},gf=function(){function n(){}return n.value=new n,n}(),yf={attr:function(n){return function(n){return{key:"name",value:ja(n)}}}},Sf=function(){function n(){}return n.value=new n,n}(),Af={attr:function(n){return function(n){return{key:"click",value:Ua(y(N(Lr)(n)(!0)))}}}},Tf={attr:function(n){return function(n){return{key:"click",value:Ua(n)}}}},xf=function(){function n(){}return n.value=new n,n}(),Ef={attr:function(n){return function(n){return{key:"input",value:Ua(n)}}}},Ff=function(){function n(){}return n.value=new n,n}(),Nf={attr:function(n){return function(n){return{key:"mouseenter",value:Ua(y(N(Lr)(n)(!0)))}}}},kf=function(){function n(){}return n.value=new n,n}(),Bf={attr:function(n){return function(n){return{key:"mouseleave",value:Ua(y(N(Lr)(n)(!0)))}}}},Pf=function(){function n(){}return n.value=new n,n}(),qf={attr:function(n){return function(n){return{key:"placeholder",value:ja(n)}}}},Cf=function(){function n(){}return n.value=new n,n}(),If={attr:function(n){return function(n){return{key:"rowspan",value:ja(n)}}}},Df=function(){function n(){}return n.value=new n,n}(),Rf={attr:function(n){return function(n){return{key:"style",value:ja(n)}}}},zf=function(){function n(){}return n.value=new n,n}(),Of={attr:function(n){return function(n){return{key:"value",value:ja(n)}}}},_f=function(){function n(){}return n.value=new n,n}(),Lf={attr:function(n){return function(n){return{key:"type",value:ja(n)}}}},Wf=function(n){return function(n){return function(e){return function(t){return new wa(ni(n)("br")(e)(ba(t)))}}}(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},jf=function(n){return function(e){return function(t){return new wa(ni(n)("button")(e)(ba(t)))}}},Uf=function(n){return function(e){return function(t){return new wa(ni(n)("div")(e)(ba(t)))}}},$f=function(n){return Uf(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},Yf=function(n){return function(n){return function(e){return function(t){return new wa(ni(n)("em")(e)(ba(t)))}}}(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},Vf=function(n){return function(n){return function(e){return function(t){return new wa(ni(n)("h2")(e)(ba(t)))}}}(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},Kf=function(n){return function(e){return function(t){return new wa(ni(n)("input")(e)(ba(t)))}}},Hf=function(n){return function(e){return function(t){return new wa(ni(n)("label")(e)(ba(t)))}}},Jf=function(n){return Hf(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},Zf=function(n){return function(e){return function(t){return new wa(ni(n)("li")(e)(ba(t)))}}},Gf=function(n){return Zf(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},Qf=function(n){return function(e){return function(t){return new wa(ni(n)("ol")(e)(ba(t)))}}},Xf=function(n){return function(e){return function(t){return new wa(ni(n)("span")(e)(ba(t)))}}},nv=function(n){return Xf(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},ev=function(n){return function(n){return function(e){return function(t){return new wa(ni(n)("sub")(e)(ba(t)))}}}(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},tv=function(n){return function(e){return function(t){return new wa(ni(n)("table")(e)(ba(t)))}}},rv=function(n){return function(e){return function(t){return new wa(ni(n)("tbody")(e)(ba(t)))}}},uv=function(n){return rv(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},ov=function(n){return function(e){return function(t){return new wa(ni(n)("td")(e)(ba(t)))}}},av=function(n){return ov(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},iv=function(n){return function(e){return function(t){return new wa(ni(n)("th")(e)(ba(t)))}}},cv=function(n){return function(n){return function(e){return function(t){return new wa(ni(n)("thead")(e)(ba(t)))}}}(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},lv=function(n){return function(e){return function(t){return new wa(ni(n)("tr")(e)(ba(t)))}}},fv=function(n){return lv(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},vv=function(n){return function(n){return function(e){return function(t){return new wa(ni(n)("ul")(e)(ba(t)))}}}(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))},sv=function(n){return Nc(n.target)},dv=function(n){var e=Pn(na(n))(Xo(n)(Ya(Lf)(_f.value)("range"))),t=x(Uo)((function(n){return Ya(Ef)(xf.value)($a((function(e){return ht(zr)(yt)(We(ye)(sv(e))(Cc))(Ue(Rr)(qc)(n))})))}));return function(n){return e(t(n))}},pv=function(n){var e=ec(n);return function(n){return e((t=n,function(){console.log(t)}));var t}};function mv(){return Date.now()}var hv=Wo((function(n){return function(){var e,t=Rc(),r=Yr(!1)(),u=function(e,o,a){var i,c=0;return function(e){if(2===c)return i;if(1===c)throw new ReferenceError("loop was needed before it finished initializing (module "+o+", line "+e+")",o,e);return c=1,i=F(Lr)((a=function(){return n(A)(),(e=Dr,function(n){return function(t){return We(e.Bind1())(n)((function(n){return(r=e.Applicative0(),function(n){return function(e){if(!n)return e;if(n)return oe(r)(A);throw new Error("Failed pattern match at Control.Applicative (line 68, column 1 - line 68, column 65): "+[n.constructor.name,e.constructor.name])}})(n)(t);var r}))}})($r(r))(u(19))();var e},function(n){return function(){return n.requestAnimationFrame(a)}})(t)),c=2,i;var a}}(0,"FRP.Event.AnimationFrame");return u(16)(),(e=!0,function(n){return function(){n.value=e}})(r)}})),wv=function(n){return{map:function(e){return function(t){return function(r){return t(x(n)((function(n){return function(t){return n(e(t))}}))(r))}}}}},Mv=function(n){return function(e){return _o(n)((function(n){return function(){var t=mv();return e({time:t,value:n})()}}))}},bv=function(n){return n}((function(n){return x(Uo)((function(n){return n.value(n.time)}))(Mv(n))})),gv=function(n){return function(e){return Io(ta(uu))((function(n){return function(e){var t=we(0)(e.prevTime),r=we(0)(e.prevBeats),u=vt()()(wl)(O.sub)(n.acTime)(t),o=vt()()(wl)(cn(on))(u)(n.behaviors.clength),a=ft()(o)+ft()(r);return new Ge({prevTime:new fe(n.acTime),prevBeats:new fe(a)},{prevTime:e.prevTime,prevBeats:e.prevBeats,time:n.acTime,beats:a,epochTime:n.behaviors.epochTime})}}))((t=Uo,function(n){return function(e){return function(r){return function(n){return function(e){return n(e)}}(x(wv(t))(n)(e))(x(t)(S)(r))}}})((function(n){return function(e){return{behaviors:n,acTime:e}}}))(In(function(n){return{apply:function(e){return function(t){return function(r){return t(e(x(n)(h(m))(r)))}}},Functor0:function(){return wv(n)}}}(Uo))(x(wv(Uo))((function(n){return function(e){return{clength:n,epochTime:e}}}))(n))(x(wv(Uo))(Ml)(bv)))(e))({prevTime:le.value,prevBeats:le.value});var t}},yv=function(){function n(){this.head=null,this.last=null,this.size=0}function e(n,e){this.queue=n,this.value=e,this.next=null,this.prev=null}function t(e){this.draining=!1,this.error=null,this.value=e,this.takes=new n,this.reads=new n,this.puts=new n}var r={};function u(n){try{n()}catch(n){setTimeout((function(){throw n}),0)}}function o(n){var e;switch(n.size){case 0:return null;case 1:e=n.head,n.head=null;break;case 2:e=n.last,n.head.next=null,n.last=null;break;default:e=n.last,n.last=e.prev,n.last.next=null}return e.prev=null,e.queue=null,n.size--,e.value}function a(n){var e;switch(n.size){case 0:return null;case 1:e=n.head,n.head=null;break;case 2:e=n.head,n.last.prev=null,n.head=n.last,n.last=null;break;default:e=n.head,n.head=e.next,n.head.prev=null}return e.next=null,e.queue=null,n.size--,e.value}return t.EMPTY=r,t.putLast=function(n,t){var r=new e(n,t);switch(n.size){case 0:n.head=r;break;case 1:r.prev=n.head,n.head.next=r,n.last=r;break;default:r.prev=n.last,n.last.next=r,n.last=r}return n.size++,r},t.takeLast=o,t.takeHead=a,t.deleteCell=function(n){null!==n.queue&&(n.queue.last!==n?n.queue.head!==n?(n.prev&&(n.prev.next=n.next),n.next&&(n.next.prev=n.prev),n.queue.size--,n.queue=null,n.value=null,n.next=null,n.prev=null):a(n.queue):o(n.queue))},t.drainVar=function(n,e){if(!e.draining){var t,o,i,c,l,f=e.puts,v=e.takes,s=e.reads;for(e.draining=!0;;){if(t=null,o=null,i=null,c=e.value,l=s.size,null!==e.error){for(c=n.left(e.error);t=a(f);)u(t.cb(c));for(;o=a(s);)u(o(c));for(;i=a(v);)u(i(c));break}if(c===r&&(t=a(f))&&(e.value=c=t.value),c!==r){for(i=a(v);l--&&(o=a(s));)u(o(n.right(c)));null!==i&&(e.value=r,u(i(n.right(c))))}if(null!==t&&u(t.cb(n.right(void 0))),e.value===r&&0===f.size||e.value!==r&&0===v.size)break}e.draining=!1}},t}(),Sv=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Av=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Tv=function(){function n(){}return n.value=new n,n}(),xv=function(){return{left:Fe.create,right:Ne.create,nothing:le.value,just:fe.create,killed:Sv.create,filled:Av.create,empty:Tv.value}}(),Ev=function(n){return function(e){return function(t){return function(){var r=new yv(yv.EMPTY),u=_o(n)((function(n){return F(Lr)(Dn(Wr)(function(n,e){return function(){var t=e.value;return t===yv.EMPTY?n.nothing:(e.value=yv.EMPTY,yv.drainVar(n,e),n.just(t))}}(xv,r))(function(n){return function(e){return function(n,e,t){return function(){return t.value===yv.EMPTY&&null===t.error&&(t.value=e,yv.drainVar(n,t),!0)}}(xv,n,e)}}(n)(r)))}))(),o=_o(e)((function(n){return t(n(r))}))();return Dn(Wr)(u)(o)}}}},Fv=function(n){return function(e){return function(t){return function(r){return $o(e.Always2())(e.Always3())(e.MonadST5().Monad0().Applicative0())(Ev(Oo(e.Always4())(e.Always1())(e.MonadST5().Monad0().Applicative0())(t))(Oo(e.Always4())(e.Always1())(e.MonadST5().Monad0().Applicative0())(x(Uo)(function(n){return function(e){return function(t){return We(n.Monad0().Bind1())(ec(n)(function(n,e){return function(){return e.value===yv.EMPTY?n.nothing:n.just(e.value)}}(xv,t)))(mt(n.Monad0().Applicative0())(yt)(e))}}}(n))(r))))}}}},Nv=function(n){return n.readersT},kv=function(n){return{readersT:(e=x(B)(Nv(n)),function(n){return e(n)})};var e};Array.isArray;var Bv=ct;const Pv=function(n,e,t){try{return e(function(n){return n.replace(/[!'()*]/g,(function(n){return"%"+n.charCodeAt(0).toString(16)}))}(encodeURIComponent(t)))}catch(e){return n(e)}};function qv(n,e,t){try{return e(decodeURIComponent(t))}catch(e){return n(e)}}var Cv=function(){return mr(Pv)(y(le.value))(fe.create)}(),Iv=function(){return mr(qv)(y(le.value))(fe.create)}(),Dv=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Rv=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),zv=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Ov=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),_v=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),Lv=function(n){if(n instanceof Dv)return n.value0;if(n instanceof Rv)return n.value2;throw new Error("Failed pattern match at Parser.Proto (line 22, column 1 - line 22, column 52): "+[n.constructor.name])},Wv=function(n){return function(e){return function(t){var r=function(e){var t=function(n){return function(e){if(e.inputs instanceof Qt)return new Fe(new fe(e.stack));if(e.inputs instanceof Xt){var t=n.step(Lv(e.stack))(e.inputs.value0);if(t instanceof le)return new Fe(le.value);if(t instanceof fe&&t.value0 instanceof Fe){var r=new Rv(e.stack,n.promote(e.inputs.value0),t.value0.value0);return new Ne({next:{stack:r,inputs:e.inputs.value1},action:new Fe(e.inputs.value0)})}if(t instanceof fe&&t.value0 instanceof Ne){var u=n.goto(t.value0.value0)(e.stack);if(u instanceof le)return new Fe(le.value);if(u instanceof fe)return new Ne({next:{stack:u.value0,inputs:e.inputs},action:new Ne(t.value0.value0)});throw new Error("Failed pattern match at Parser.Proto (line 65, column 9 - line 67, column 95): "+[u.constructor.name])}throw new Error("Failed pattern match at Parser.Proto (line 59, column 24 - line 67, column 95): "+[t.constructor.name])}throw new Error("Failed pattern match at Parser.Proto (line 57, column 3 - line 67, column 95): "+[e.inputs.constructor.name])}}(n)(e);if(t instanceof Fe&&t.value0 instanceof le)return new zv(e);if(t instanceof Fe&&t.value0 instanceof fe)return new Ov(e,t.value0.value0);if(t instanceof Ne)return new _v(e,t.value0.action,r(t.value0.next));throw new Error("Failed pattern match at Parser.Proto (line 73, column 15 - line 76, column 67): "+[t.constructor.name])},u=function(n){return function(e){return{stack:new Dv(e),inputs:n}}}(e)(t);return r(u)}}};function jv(n){return function(){return n.search}}var Uv,$v,Yv,Vv,Kv,Hv,Jv,Zv=function(){function n(){}return n.value=new n,n}(),Gv=function(){function n(){}return n.value=new n,n}(),Qv=function(){function n(){}return n.value=new n,n}(),Xv=function(){function n(){}return n.value=new n,n}(),ns=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),es=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ts=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),rs=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),us=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),os=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),as=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),is=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),cs=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ls=function(){function n(){}return n.value=new n,n}(),fs=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),vs=function(){function n(){}return n.value=new n,n}(),ss=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),ds=function(n){return n},ps=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ms=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),hs=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),ws=function(n){return $a((function(e){return ht(zr)(yt)(We(ye)(sv(e))(Cc))(Ue(Rr)(Pc)(n))}))},Ms=function(n){return n instanceof us?new fe(n.value0):le.value},bs=function(n){if(n instanceof ns)return new fe(n.value0);if(n instanceof ts)return new fe(n.value0);if(n instanceof es)return le.value;throw new Error("Failed pattern match at Parser.Main (line 559, column 1 - line 559, column 50): "+[n.constructor.name])},gs=function(n){return function(n){if(n instanceof us)return Ql(n.value0);if(n instanceof rs)return n.value0;throw new Error("Failed pattern match at Parser.Main (line 662, column 1 - line 662, column 36): "+[n.constructor.name])}(n)},ys=At(St)(Sn)((function(n){if(n instanceof rs)return n.value0;if(n instanceof us)return $l(n.value0);throw new Error("Failed pattern match at Parser.Main (line 956, column 29 - line 958, column 39): "+[n.constructor.name])})),Ss=function(n){return n instanceof rs?new fe(n.value0):le.value},As=function(n){return Cu(n.value1)},Ts={append:function(n){return function(e){if(n instanceof ns&&e instanceof ns)return new ns(n.value0);if(n instanceof ns&&e instanceof ts)return new ts(n.value0,e.value1);if(n instanceof ts&&e instanceof ns)return new ts(n.value0,n.value1);if(n instanceof ts&&e instanceof ts)return new ts(n.value0,bn(Di)(n.value1)(e.value1));if(n instanceof ns&&e instanceof es)return new ts(n.value0,e.value0);if(n instanceof es&&e instanceof ns)return new ts(e.value0,n.value0);if(n instanceof es&&e instanceof es)return new es(bn(Di)(n.value0)(e.value0));if(n instanceof ts&&e instanceof es)return new ts(n.value0,bn(Di)(n.value1)(e.value0));if(n instanceof es&&e instanceof ts)return new ts(e.value0,bn(Di)(n.value0)(e.value1));throw new Error("Failed pattern match at Parser.Main (line 565, column 1 - line 575, column 72): "+[n.constructor.name,e.constructor.name])}}},xs=function(n){if(n instanceof ps)return new Fe(n.value0);if(n instanceof ms)return new Ne(new hs(n.value0,Ku((function(n){return qe(xs(n))}))(n.value1)));throw new Error("Failed pattern match at Parser.Main (line 852, column 1 - line 852, column 55): "+[n.constructor.name])},Es=function(n){return function(e){return ba(x(P)((t=function(n){return function(n){return function(e){return function(t){return new wa(ni(n)("p")(e)(ba(t)))}}}(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))}(e),r=oe(ce),u=Qa(e.MonadST5().Monad0()),function(n){return t(r(u(n)))}))(n));var t,r,u}},Fs=function(n){return function(e){var t=Dl(e);if(t instanceof fe){var r=function(n){return function(e){return ju((function(n){return Vl(Xl(n))(e)===n}))(n)}}(n)(e);if(r instanceof fe)return bn(wn)([new rs(r.value0)])(Fs(n)(Jl(Xl(r.value0))(e)));if(r instanceof le)return bn(wn)([new us(t.value0.head)])(Fs(n)(t.value0.tail));throw new Error("Failed pattern match at Parser.Main (line 950, column 5 - line 952, column 58): "+[r.constructor.name])}if(t instanceof le)return[];throw new Error("Failed pattern match at Parser.Main (line 948, column 25 - line 953, column 16): "+[t.constructor.name])}},Ns=function(n){return 1===n.length?new fe(n[0]):le.value},ks=function(n){var e=Au(n.rule.value1);if(e instanceof le)return{nonTerminal:mo,terminal:mo};if(e instanceof fe){var t=oe(ce)({pName:n.pName,rName:n.rName,rule:new ss(bn(wn)(n.rule.value0)([e.value0.head]),e.value0.tail),lookahead:n.lookahead});if(e.value0.head instanceof rs)return{nonTerminal:uo(e.value0.head.value0)(t),terminal:mo};if(e.value0.head instanceof us)return{nonTerminal:mo,terminal:uo(e.value0.head.value0)(t)};throw new Error("Failed pattern match at Parser.Main (line 766, column 7 - line 774, column 12): "+[e.value0.head.constructor.name])}throw new Error("Failed pattern match at Parser.Main (line 752, column 47 - line 774, column 12): "+[e.constructor.name])},Bs=function(n){return function(e){return function(t){return _u((r=Fn({reflectSymbol:function(){return"nonTerminal"}})(yl(n)(wn))()(Fn({reflectSymbol:function(){return"terminal"}})(yl(e)(wn))()(An)),{mempty:xn(r)(T.value),Semigroup0:function(){return n=r.SemigroupRecord0(),{append:Mn(n)(T.value)};var n}}))(ks)(t);var r}}},Ps=function(n){return function(n){return function(e){return function(t){return function(r){return function(u){return We(n.Monad0().Bind1())(Ho(n)(n))((function(o){return We(n.Monad0().Bind1())(ou(n)(kr(t)))((function(t){var a=function(e){return Oe($e)(n.Monad0().Bind1())(We(n.Monad0().Bind1())(ou(n)(Br(t)))(e))((function(){return _o(o.event)(e)}))};return Oe($e)(n.Monad0().Bind1())(u(r(a)))((function(){return _o(e)(o.push)}))}))}))}}}}}},qs=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){return Zo(e)(Co(ta(e))(t)(r)(u))((function(e){return o(Pn(na(n))(Xo(n)(u))(e))}))}}}}}},Cs=function(n){return function(e){return function(t){return function(r){if(r instanceof fe)return Xo(n)(Ya(e)(t)(r.value0));if(r instanceof le)return ze(ea(n));throw new Error("Failed pattern match at Parser.Main (line 969, column 1 - line 969, column 100): "+[t.constructor.name,r.constructor.name])}}}},Is=function(n){return function(e){return function(t){return function(r){return x(n)((function(n){return Ya(e)(t)(n)}))(r)}}}},Ds=function(){var n=Tu(bn(gn(gn(sn)))(b(g(Hn(Vn)))(Xl))(Hn(Ji))),e=Iu(Ji);return function(t){return n(e(t))}}(),Rs=function(n){var e=Ds(E(P)(n)((function(n){return n.pName}))),t=Fs(e);return E(P)(n)((function(n){var e={};for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e.rule=t(n.rule),e}))},zs=function(){var n=Ku((function(n){return E(he)(Zi(n.pName))((function(e){return{pName:e,rule:n.rule,rName:n.rName}}))}));return function(e){return Rs(n(e))}}(),Os=function(n){return function(e){var t=function(n){return au(st(n))}(e);return function(e){return function(e){if(1===e.length)return[e[0]];if(2===e.length)return[e[0],Qa(n.MonadST5().Monad0())(" & "),e[1]];var t=qu(e);if(t instanceof le)return[];if(t instanceof fe)return bn(wn)(ku(Tn)([Qa(n.MonadST5().Monad0())(", ")])(x(P)(oe(ce))(t.value0.init)))([Qa(n.MonadST5().Monad0())(" & "),t.value0.last]);throw new Error("Failed pattern match at Parser.Main (line 1704, column 9 - line 1707, column 72): "+[t.constructor.name])}(t(e))}}},_s=function(n){var e,t=!1;function r(e){if(e instanceof zv)return t=!0,Lv(e.value0.stack);if(e instanceof Ov)return t=!0,Lv(e.value1);if(!(e instanceof _v))throw new Error("Failed pattern match at Parser.Main (line 1971, column 1 - line 1971, column 33): "+[e.constructor.name]);n=e.value2}for(;!t;)e=r(n);return e},Ls=function(n){return n instanceof rs},Ws=function(n){var e,t=(e=Ls,function(n){var t=function(t){var r,u=!1;function o(r){var o=Bu(n)(r);if(o instanceof fe)return e(o.value0)?void(t=r+1|0):(u=!0,new fe(r));if(o instanceof le)return u=!0,le.value;throw new Error("Failed pattern match at Data.Array (line 964, column 5 - line 966, column 25): "+[o.constructor.name])}for(;!u;)r=o(t);return r}(0);if(t instanceof fe&&0===t.value0)return{init:[],rest:n};if(t instanceof fe)return{init:su(0)(t.value0)(n),rest:su(t.value0)(iu(n))(n)};if(t instanceof le)return{init:n,rest:[]};throw new Error("Failed pattern match at Data.Array (line 951, column 3 - line 957, column 30): "+[t.constructor.name])})(n);return{following:Ku(Ss)(t.init),continue:We(ye)(Cu(t.rest))(Ms)}},js=function(){var n;return{encode:function(n){return E(P)(ft()(n.augmented))((function(n){return[n.pName,ys(n.rule),n.rName]}))},decode:(n=ye,function(e){return function(t){return function(r){return je(n)(e)(t(r))}}})((function(n){return e=Rs(n),We(ye)(Bu(e)(0))((function(n){return 2===n.rule.length&&n.rule[0]instanceof rs&&n.rule[1]instanceof us?new fe({augmented:e,entry:n.rule[0].value0,eof:n.rule[1].value0,start:{lookahead:[],pName:n.pName,rName:n.rName,rule:new ss([],n.rule)}}):le.value}));var e}))(Ue(ye)(pl)(Ue(ye)(Lt(jt)(Se)(pl))(Lt(jt)(Se)((function(n){return In(ge)(In(ge)(x(he)((function(n){return function(e){return function(t){return{pName:n,rule:e,rName:t}}}}))(je(ye)(Zi)(je(ye)(dl)(Bu(n)(0)))))(je(ye)(dl)(Bu(n)(1))))(je(ye)(dl)(Bu(n)(2)))})))))}}(),Us=function(n){return function(n){return function(e){return We(uc(Xc))(Xi(cc(Xc)))((function(t){return Oe($e)(uc(Xc))((r=cc(Xc),function(n){return Qi(r)((function(e){return new Ge(A,n)}))})(t+1|0))((function(){return oe(ac(Xc))((function(r){return new Ge(t,E(Uo)(r(t))((function(t){return Ya(n)(tf.value)(e+(t?"":" hidden"))})))}))}));var r}))}}},$s=function(n){return function(n){return Us()(n)("")}},Ys=function(n){return function(n){return We(uc(Xc))(Xi(cc(Xc)))((function(e){return oe(ac(Xc))((function(t){return new Ge(e,E(Uo)(t(e))((function(e){return Ya(n)(tf.value)(e?"":" hidden")})))}))}))}},Vs=function(n){var e=function(n){return function(e){return _u(Bo(n))((function(e){return(t=St,function(n){return Mt(t)((function(e){return function(t){return No(n)(t)(e)}}))(ko)})(n)(Ku(Ms)(e.rule));var t}))(e)}}(n);return function(t){return r=e(t),function(e){return Fo(n)(e)(r)?new fe(e):le.value};var r}},Ks={map:function(n){return function(e){if(e instanceof ns)return new ns(e.value0);if(e instanceof es)return new es(x(Ri)(n)(e.value0));if(e instanceof ts)return new ts(e.value0,x(Ri)(n)(e.value1));throw new Error("Failed pattern match at Parser.Main (line 0, column 0 - line 0, column 0): "+[e.constructor.name])}}},Hs={map:function(n){return function(e){return new hs(n(e.value0),x(P)(x(Hs)(n))(e.value1))}}},Js=function(n){var e,t,r,u,o=(t=Hl,r=Lt(tr)(Se),u=Vs(t),function(n){return r(u(n))})(n.augmented),a=(e=ur,function(n){var t=iu(n);return Jt(e)((function(e){return e<t?new fe(new Ge(Su()(n)(e),e+1|0)):le.value}))(0)});return function(n){return o(a(_l(n)))}},Zs=function(n){var e=Js(n),t=Ye(_e)((function(e){var t,r;return(t=$l(n.eof),r=Ki(t),function(n){return me(r(n))})(e)?w(M):g(bn(mn))($l(n.eof))}));return function(n){return e(t(n))}},Gs=function(n){return function(e){return function(t){return function(r){return function(u){var o={pName:n,rName:e,rule:[new rs(u),new us(t)]};return{augmented:bn(wn)([o])(r),start:{pName:n,rName:e,rule:new ss([],o.rule),lookahead:[]},eof:t,entry:u}}}}}},Qs=function(n){return function(e){return We(Ie)(ke(vs.value)(Cu(e)))((function(t){var r,u=Ds(bn(wn)([n.top])(E(P)(e)((function(n){return n.pName})))),o=Fs(u),a=g($t(jt))(ko)((function(n){return function(e){var t,r=""!==e.rName?e.rName:(t=n,function(n){return function(e){for(var r,u,o,a,i,c=t,l=n,f=!1;!f;)u=c,a=e,void 0,i=(o=l)+ue(te)(a),r=Fo($n)(i)(u)?(c=u,l=o,void(e=a+1|0)):(f=!0,i);return r}})(e.pName)(1);return{value:{rule:o(e.rule),rName:r,pName:e.pName},accum:No($n)(r)(n)}}}))(e).value,i=(r=Ji,function(n){return ft()(_u(yl(r)(Di))((function(n){return At((e=St,{foldMap:function(n){return function(t){return function(r){return bn(n.Semigroup0())(t(r.value0))(At(e)(n)(t)(r.value1))}}},foldl:function(n){return function(t){return function(r){return Mt(e)(n)(n(t)(r.value0))(r.value1)}}},foldr:function(n){return function(t){return function(r){return n(r.value0)(st(e)(n)(t)(r.value1))}}}}))(yl(r)(Di))((function(e){return uo(e)(_i(n.rName))}))(new Gt(n.pName,Ku(Ss)(n.rule)));var e}))(n))})(a),c=function(n){return function(e){return ft()(_u(yl(n)(Di))((function(e){return At(St)(yl(n)(Di))((function(n){return uo(n)(_i(e.rName))}))(Ku(Ms)(e.rule))}))(e))}}(Hl)(a),l=Ql(n.eof),f=we(t.pName)(n.entry),v={pName:n.top,rName:n.topName,rule:[new rs(f),new us(n.eof)]},s={pName:v.pName,rName:v.rName,rule:new ss([],v.rule),lookahead:[]},d=So(yo)((function(n){return Ui(n)>1?new fe(Wi(n)):le.value}))(function(n){return Ru(Hn(n))}($n)(bn(wn)(E(P)(a)((function(n){return n.rName})))([n.topName])));return Oe($e)(Ie)(nn(Gi)(n.top)(f)?new Fe(ls.value):oe(De)(A))((function(){return Oe($e)(Ie)(function(){var n=Li(d);if(n instanceof fe)return new Fe(new fs(n.value0));if(n instanceof le)return oe(De)(A);throw new Error("Failed pattern match at Parser.Main (line 1670, column 3 - line 1672, column 25): "+[n.constructor.name])}())((function(){return Oe($e)(Ie)((r=Ve(Ze(Je))(me)(ju((t=nn(Gi)(f),function(n){return t(function(n){return n.pName}(n))}))(e)),r?new Fe(new cs(f)):oe(De)(A)))((function(){return Oe($e)(Ie)(function(){var e=ao(Ji)(n.top)(i);if(e instanceof fe)return new Fe(new is(e.value0));if(e instanceof le)return oe(De)(A);throw new Error("Failed pattern match at Parser.Main (line 1675, column 3 - line 1677, column 25): "+[e.constructor.name])}())((function(){return Oe($e)(Ie)(function(){var n=Li(So(yo)((function(n){return nn(Gi)(n.pName)(l)?new fe(n.rName):le.value}))(a));if(n instanceof fe)return new Fe(new as(n.value0));if(n instanceof le)return oe(De)(A);throw new Error("Failed pattern match at Parser.Main (line 1678, column 3 - line 1680, column 25): "+[n.constructor.name])}())((function(){return Oe($e)(Ie)(function(){var e=bn(ve(Di))(ao(Hl)(n.eof)(c))(ao(Ji)(l)(i));if(e instanceof fe)return new Fe(new os(e.value0));if(e instanceof le)return oe(De)(A);throw new Error("Failed pattern match at Parser.Main (line 1681, column 3 - line 1683, column 25): "+[e.constructor.name])}())((function(){return oe(De)({augmented:bn(wn)([v])(a),start:s,eof:n.eof,entry:f})}))}))}))}));var t,r}))}))}))}},Xs=function(n){return function(e){return{eq:function(t){return function(r){return t instanceof rs&&r instanceof rs?nn(n)(t.value0)(r.value0):t instanceof us&&r instanceof us&&nn(e)(t.value0)(r.value0)}}}}},nd=function(n){return function(e){return{eq:function(t){return function(r){return nn(en(Xs(n)(e)))(t.value0)(r.value0)&&nn(en(Xs(n)(e)))(t.value1)(r.value1)}}}}},ed=function(n){return function(e){return function(t){var r=Ou((function(r){return function(u){var o=$t(jt)((function(r){return function(o){return nn(e)(o.rName)(u.rName)&&nn(nd(n)(t))(o.rule)(u.rule)?{accum:!0,value:{rName:o.rName,pName:o.pName,rule:o.rule,lookahead:Fu(t)(bn(wn)(o.lookahead)(u.lookahead))}}:{accum:r,value:o}}}))(!1)(r);return o.accum?o.value:bn(wn)(o.value)([u])}}))([]);return function(n){return r(n)}}}},td=function(n){return function(e){return function(t){return{eq:function(r){return function(u){return nn(en(J()(tn(tn(tn(tn(K)()({reflectSymbol:function(){return"rule"}})(nd(n)(t)))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n))()({reflectSymbol:function(){return"lookahead"}})(en(t)))))(r)(u)||(o=ed(n)(e)(t)(r),a=ed(n)(e)(t)(u),i=ed(n)(e)(t)(bn(wn)(o)(a)),c=ed(n)(e)(t)(bn(wn)(a)(o)),nn(en(J()(tn(tn(tn(tn(K)()({reflectSymbol:function(){return"rule"}})(nd(n)(t)))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n))()({reflectSymbol:function(){return"lookahead"}})(en(t)))))(o)(i)&&nn(en(J()(tn(tn(tn(tn(K)()({reflectSymbol:function(){return"rule"}})(nd(n)(t)))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n))()({reflectSymbol:function(){return"lookahead"}})(en(t)))))(a)(c));var o,a,i,c}}}}}},rd=function(n){return function(e){return function(t){return function(r){var u=function(u){var o=function(n){return zu(function(n){return Yu(nn(n))}(n))}(J()(tn(tn(tn(K)()({reflectSymbol:function(){return"rule"}})(en(Xs(n)(t))))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n)))(r)(x(P)((function(n){return n.production}))(u)),a=So(yo)((function(e){return x(he)((function(n){return{production:e,produced:Ye(Le)(n)}}))(Lt(jt)(Se)((t=u,function(e){if(e instanceof rs)return E(he)(ju((r=nn(n)(e.value0),function(n){return r(n.production.pName)}))(t))((function(n){return n.produced}));var r;if(e instanceof us)return oe(Se)([e.value0]);throw new Error("Failed pattern match at Parser.Main (line 180, column 3 - line 181, column 76): "+[t.constructor.name,e.constructor.name])}))(e.rule));var t}))(o);return bn(wn)(u)(a)};return function(r){var o,a=!1;function i(o){var i=u(o);if(nn(en(J()(tn(tn(K)()({reflectSymbol:function(){return"production"}})(J()(tn(tn(tn(K)()({reflectSymbol:function(){return"rule"}})(en(Xs(n)(t))))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n))))()({reflectSymbol:function(){return"produced"}})(en(t)))))(i)(o))return a=!0,o;r=i}for(;!a;)o=i(r);return o}([])}}}},ud=function(n){return function(e){return function(t){return In(qn)((function(n){return function(e){return{grammar:n,produced:e}}}))((r=rd(n)(e)(t),function(n){return r(n.augmented)}));var r}}},od=Me()(Zi("TOP")),ad=Zl("␄"),id=Gs(od)("TOP")(ad)(zs([{pName:"Additive",rName:"A:Add",rule:"Additive+Multiplicative"},{pName:"Additive",rName:"A<-M",rule:"Multiplicative"},{pName:"Multiplicative",rName:"M:Mul",rule:"Multiplicative*Unit"},{pName:"Multiplicative",rName:"M<-U",rule:"Unit"},{pName:"Unit",rName:"U:Val",rule:"Number"},{pName:"Unit",rName:"U<-A",rule:"(Additive)"},{pName:"Number",rName:"N<-D",rule:"Digit"},{pName:"Digit",rName:"0",rule:"0"},{pName:"Digit",rName:"1",rule:"1"},{pName:"Digit",rName:"2",rule:"2"}]))(Me()(Zi("Additive"))),cd=function(n){return function(e){return function(t){return function(r){return go(Go(e))(Io(ta(t))((function(e){return function(t){var r=new fe(e);return new Ge(r,nn(be(X))(In(ge)(x(he)(n)(t))(r))(new fe(!0))?le.value:new fe(e))}}))(r)(le.value))}}}},ld=function(n){if(n instanceof ns)return new fe(new Fe(n.value0));if(n instanceof ts)return new fe(new Fe(n.value0));if(n instanceof es)return 1===Ui(n.value0)?new fe(new Ne(Wi(n.value0))):le.value;throw new Error("Failed pattern match at Parser.Main (line 939, column 1 - line 939, column 60): "+[n.constructor.name])},fd=function(n){return function(e){return function(t){return function(r){return function(u){var o=ho(n)(St)(Bt(Pt)((function(n){return function(e){return new Ge(e.sName,n)}}))(u)),a=function(e){return We(ye)(ao(n)(e)(o))(Bu(u))};return{promote:ps.create,step:function(n){return function(e){return We(ye)(We(ye)(a(n))(function(n){return function(e){return ao(r)(n)(e.advance)}}(e)))(ld)}},goto:function(n){return function(u){return We(ye)(a(Lv(u)))((function(o){return We(ye)((i=n,function(n){return pt(St)(xe)((function(n){return 0===n.rule.value1.length&&nn(e.Eq0())(n.pName)(i.value0)&&nn(t)(n.rName)(i.value1)?new fe(n.rule.value0):le.value}))(n.items)})(o))(function(n){return function(t){return function(u){return We(ye)(Lu(Ae)((function(n){return function(t){if(t instanceof us)return n.value1 instanceof Rv&&n.value1.value1 instanceof ps&&nn(r.Eq0())(t.value0)(n.value1.value1.value0)?new fe(new Ge(bn(wn)([n.value1.value1])(n.value0),n.value1.value0)):ar("expected token on stack");if(t instanceof rs)return n.value1 instanceof Rv&&n.value1.value1 instanceof ms&&nn(e.Eq0())(n.value1.value1.value0.value0)(t.value0)?new fe(new Ge(bn(wn)([n.value1.value1])(n.value0),n.value1.value0)):ar("expected terminal on stack");throw new Error("Failed pattern match at Parser.Main (line 875, column 34 - line 883, column 62): "+[t.constructor.name])}}))(new Ge([],t))(u.slice().reverse()))((function(t){return x(he)(Rv.create(t.value1)(new ms(n,t.value0)))(function(n){return function(t){return We(ye)(a(t))((r=ao(e)(n.value0),function(n){return r(n.receive)}));var r}}(n)(Lv(t.value1)))}))}}}(n)(u));var i}))}}}}}}}},vd=function(){var n=gt(St)(D),e=x(P)((function(n){return n instanceof us?1:0}));return function(t){return n(e(t))}}(),sd=function(){var n=gt(St)(D),e=x(P)((function(n){return Ls(n)?1:0}));return function(t){return n(e(t))}}(),dd=function(n){return function(e){return function(t){return function(r){return function(u){var o,a=n,i=e,c=t,l=r,f=!1;function v(n,e,t,r,o){var v=function(n){return function(e){return function(t){return je(Le)(function(n){return function(e){return function(t){var r,u=function(n){return We(ye)(Au(n.value1))((function(n){if(n.head instanceof rs){var e=Ws(n.tail);return new fe({nonterminal:n.head.value0,following:e.following,continue:e.continue})}return le.value}))}(t.rule);if(u instanceof le)return[];if(u instanceof fe)return function(n){return function(e){return function(t){var r=lu((function(e){return nn(n)(e.pName)(t)}))(e);return function(n){return E(P)(r)((function(e){return{pName:e.pName,rName:e.rName,rule:new ss([],e.rule),lookahead:n}}))}}}}(n)(e)(u.value0.nonterminal)(function(n){return function(e){return function(t){return function(r){var u=function(n){return function(e){return function(t){var r=Au(e);return r instanceof fe?o(n)(r.value0.head)(r.value0.tail)(t):t}}},o=function(e){return function(t){return function(r){return function(o){var a=fu((function(e){return nn(n)(e.pName)(t)}))(e);return We(Le)(a.yes)((function(n){return function(n){if(n.continue instanceof fe)return u(a.no)(n.following)([n.continue.value0]);if(n.continue instanceof le)return u(a.no)(bn(wn)(n.following)(r))(o);throw new Error("Failed pattern match at Parser.Main (line 742, column 9 - line 744, column 65): "+[n.continue.constructor.name])}(Ws(n.rule))}))}}}};return u(e)(t)(r)}}}}(n)(e)(u.value0.following)((r=u.value0.continue,function(n){if(r instanceof fe)return[r.value0];if(r instanceof le)return n;throw new Error("Failed pattern match at Parser.Main (line 690, column 33 - line 692, column 23): "+[r.constructor.name])})(t.lookahead)));throw new Error("Failed pattern match at Parser.Main (line 702, column 26 - line 706, column 68): "+[u.constructor.name])}}}(n)(e))(t)}}}(e)(r)(o);if(Eu(v))return f=!0,o;var s=bn(function(n){return function(e){return function(t){return{append:function(r){return function(u){return ed(n)(e)(t)(bn(wn)(r)(u))}}}}}}(e)(n)(t))(o)(v);if(nn(td(e)(n)(t))(s)(o))return f=!0,o;a=n,i=e,c=t,l=r,u=s}for(;!f;)o=v(a,i,c,l,u);return o}}}}},pd=function(n){return function(e){return function(t){return function(r){return function(u){var o,a=n,i=e,c=t,l=r,f=!1;function v(n,e,t,r,o){var v=function(n){return function(e){return function(t){return function(r){return function(u){return Fu(td(n.Eq0())(e)(t.Eq0()))(bn(wn)(u)(We(Le)(u)(function(n){return function(e){return function(t){return function(r){return function(u){return Fu(td(n.Eq0())(e)(t.Eq0()))(x(P)((o=dd(e)(n.Eq0())(t.Eq0())(r),a=ed(n.Eq0())(e)(t.Eq0()),function(n){return o(a(Qe(n)))}))(function(n){return function(e){return function(t){var r=Bs(n)(e)(t);return Pn(Bn)(x(P)(ut(ot)(us.create))(oo(Zt)(r.terminal)))(x(P)(ut(ot)(rs.create))(oo(Zt)(r.nonTerminal)))}}}(n)(t)(u)));var o,a}}}}}(n)(e)(t)(r))))}}}}}(n)(e)(t)(r)(o);if(nn(en(td(n.Eq0())(e)(t.Eq0())))(v)(o))return f=!0,o;a=n,i=e,c=t,l=r,u=v}for(;!f;)o=v(a,i,c,l,u);return o}}}}},md=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){return x(Be)(ds)(Yt.traverseWithIndex(De)((function(a){return function(i){var c,l=x(Sl)(es.create)(function(n){return function(e){return At(St)(yl(n)(Di))((function(e){return x(Sl)(_i)(function(n){return function(e){return 0===e.rule.value1.length?ho(n)(St)(q(P)(x(P)(Ge.create)(e.lookahead))(new Ge(e.pName,e.rName))):mo}}(n)(e))}))(e)}}(t)(i)),f=Bs(n)(t)(i),v=function(a){return ke(a)(x(he)(r)(Wu(nn(td(n.Eq0())(e)(t.Eq0()))(dd(e)(n.Eq0())(t.Eq0())(u)(ed(n.Eq0())(e)(t.Eq0())(a))))(o)))};return In(Ce)(x(Be)((function(n){return function(e){return{sName:r(a),items:i,advance:bn(gl(t)(Ts))(n)(l),receive:e}}}))(Lt(bl)(De)((c=x(Be)(ns.create),function(n){return c(v(n))}))(f.terminal)))(Lt(po)(De)(v)(ft()(f.nonTerminal)))}}))(o))}}}}}},hd=function(n){return function(e){return function(t){return function(r){return x(he)((function(n){return e.sized((function(t){return function(n){return function(e){return function(t){return We(n.Monad0().Bind1())(n.chooseInt(0)(bt(e.Foldable0())(D)(t)-1|0))((function(r){return oe(n.Monad0().Applicative0())(function(n){return function(e){return function(t){return(r=e,function(e){var u,o=r,a=!1;function i(r,u){if(u instanceof Ci&&u.value1 instanceof Ii)return a=!0,u.value0;if(u instanceof Ci&&r<=0)return a=!0,u.value0;if(u instanceof Ci)return o=r-1|0,void(e=u.value1);if(u instanceof Ii)return a=!0,ft()(n.foldMap1(qi)(Pi)(t));throw new Error("Failed pattern match at Control.Monad.Gen (line 128, column 5 - line 128, column 26): "+[r.constructor.name,u.constructor.name])}for(;!a;)u=i(o,e);return u})(st(n.Foldable0())(Ci.create)(Ii.value)(t));var r}}}(e)(r)(t))}))}}}(e)(Oi)((r=t,function(n){var e=E(Ri)(n)((function(n){return new Ge(sd(n.rule),n)})),t=Li(ji(lu((function(n){return n.value0<=r})))(e));if(t instanceof le)return x(Ri)(Qe)(Wi($i(bn(gn(gn(sn)))(b(Hn(Vn))(tt))(b(Hn(Vn))((function(n){return iu(Qe(n).rule)}))))(e)));if(t instanceof fe)return x(Ri)(Qe)(t.value0);throw new Error("Failed pattern match at Parser.Main (line 142, column 5 - line 148, column 30): "+[t.constructor.name])})(n));var r}))}))(Li(function(n){return function(e){return function(t){return So(yo)((function(e){return rn(n)(e.production.pName)(t)?le.value:new fe({rule:e.production.rule,produced:e.produced})}))(e)}}}(n)(t)(r)))}}}},wd=function(n){return function(e){return function(t){return function(r){return E(he)(hd(n)(e)(t)(r))((function(r){return We(e.Monad0().Bind1())(r)((function(r){return function(n){return function(e){return Bi(n)((function(n){return t=n-e|0,cn(an)(t)(2);var t}))}}(e)(vd(r.rule))(Md(n)(e)(t)(r))}))}))}}}},Md=function(n){return function(e){return function(t){return function(r){return we(oe(e.Monad0().Applicative0())(r.produced))(function(n){return function(e){return function(t){return function(r){return x(he)((o=x(e.Monad0().Bind1().Apply0().Functor0())(Ye(Le)),a=Ut(jt)(e.Monad0().Applicative0()),function(n){return o(a(n))}))((u=Se,function(n){return function(e){return function(t){return Lt(n)(u)(t)(e)}}})(jt)(r)((function(r){if(r instanceof us)return new fe(oe(e.Monad0().Applicative0())([r.value0]));if(r instanceof rs)return wd(n)(e)(t)(r.value0);throw new Error("Failed pattern match at Parser.Main (line 233, column 14 - line 235, column 41): "+[r.constructor.name])})));var u,o,a}}}}(n)(e)(t)(r.rule))}}}},bd=function(){var n,e=de("")(Ul),t=(n=Gi,function(e){return function(e){return function(e){return q(he)(x(he)(bc)(wd(n)(xc)(e.produced)(e.grammar.entry)))({size:15,newSeed:Ei(12345678)})}}})(V)(Kl);return function(n){return e(t(n))}}(),gd=function(n){return function(e){return function(t){return function(r){return(u=e.Monad0().Applicative0(),function(n){return function(e){return function(t){return function(r){return Pn(na(u))(Xo(u)(r))(Co(ta(n))(e)(t)(r))}}}})(e)((function(e){return function(e){return Ve(n)(e)}}))(r)(t);var u}}}},yd=function(n){return function(e){return function(t){return function(r){return function(u){var o,a=(o=ta(e),function(n){return So(o.Filterable1())(w(M))(Co(o)((function(n){return function(e){if(e instanceof le)return new fe({now:n,last:le.value});if(e instanceof fe)return new fe({now:n,last:new fe(e.value0.now)});throw new Error("Failed pattern match at FRP.Event.Class (line 56, column 3 - line 56, column 50): "+[n.constructor.name,e.constructor.name])}}))(n)(le.value))})(r),i=qo(ta(e))(E(Uo)(a)((function(t){return nn(be(n.Eq0()))(t.last)(new fe(t.now))?ze(ea(e.Monad0().Applicative0())):Pn(na(e.Monad0().Applicative0()))(pt(yt)(ea(e.Monad0().Applicative0()))(Xo(e.Monad0().Applicative0()))(t.last))(Xo(e.Monad0().Applicative0())(t.now))})));return function(n){return function(e){return function(t){return function(r){return function(u){return We(e.Monad0().Bind1())(ou(e)(kr(mo)))((function(o){return Oe($e)(e.Monad0().Bind1())(u(r((function(t){return function(r){return Oe($e)(e.Monad0().Bind1())(F(e.Monad0().Bind1().Apply0().Functor0())(ou(e)(Gr(wo(n)((function(n){if(n instanceof le)return new fe([r]);if(n instanceof fe)return new fe(bn(wn)(n.value0)([r]));throw new Error("Failed pattern match at FRP.Event (line 243, column 44 - line 245, column 37): "+[n.constructor.name])}))(t))(o))))((function(){return oe(e.Monad0().Applicative0())(F(e.Monad0().Bind1().Apply0().Functor0())(ou(e)(Gr(wo(n)((function(n){if(n instanceof le)return le.value;if(n instanceof fe)return new fe(Yu(zo)(r)(n.value0));throw new Error("Failed pattern match at FRP.Event (line 246, column 51 - line 248, column 53): "+[n.constructor.name])}))(t))(o))))}))}}))))((function(){return We(e.Monad0().Bind1())(_o(t)((function(t){return We(e.Monad0().Bind1())(ou(e)(Br(o)))((function(r){var u=ao(n)(t)(r);if(u instanceof le)return oe(e.Monad0().Applicative0())(A);if(u instanceof fe)return ht(e.Monad0().Applicative0())(St)(u.value0)((function(n){return n(A)}));throw new Error("Failed pattern match at FRP.Event (line 251, column 5 - line 253, column 38): "+[u.constructor.name])}))})))((function(n){return oe(e.Monad0().Applicative0())(Oe($e)(e.Monad0().Bind1())(F(e.Monad0().Bind1().Apply0().Functor0())(ou(e)(Pr(mo)(o))))((function(){return n})))}))}))}))}}}}}(n)(e)(i)((function(n){return u((function(r){return gd(Je)(e)(t)(n(r))}))}))}}}}},Sd=function(n){return function(e){return function(t){return function(r){return Xo(n)(Ya(e)(t)(r))}}}},Ad=function(n){return function(e){return function(t){return function(r){return function(u){return nn(n)(u)(r)?Sd(e)(t)(tf.value)("first"):ze(ea(e))}}}}},Td=function(n){return function(e){return function(t){return function(r){return function(u){return Hf(n)(Sd(n.MonadST5().Monad0().Applicative0())(sf)(tf.value)("text"))([nv(n)([Qa(n.MonadST5().Monad0())(e)]),Kf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([Is(Uo)(qf)(Pf.value)(""===t?ze(ea(n.MonadST5().Monad0().Applicative0())):Xo(n.MonadST5().Monad0().Applicative0())(t)),Is(Uo)(Of)(zf.value)(r),Sd(n.MonadST5().Monad0().Applicative0())(Ef)(xf.value)(ws(u))]))([])])}}}}},xd=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){return function(a){return Hf(n)(x(Uo)(Is(B)(sf)(tf.value)((i=bn(mn)("text"),c=nn(V)(""),function(n){return i(c(n)?"":" invalid")})))(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(""))(o)))([nv(n)([Qa(n.MonadST5().Monad0())(t)]),Kf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([Is(Uo)(qf)(Pf.value)(""===r?ze(ea(n.MonadST5().Monad0().Applicative0())):Xo(n.MonadST5().Monad0().Applicative0())(r)),Is(Uo)(Of)(zf.value)(""===u?ze(ea(n.MonadST5().Monad0().Applicative0())):Xo(n.MonadST5().Monad0().Applicative0())(u)),Sd(n.MonadST5().Monad0().Applicative0())(Ef)(xf.value)(ws(a)),Sd(n.MonadST5().Monad0().Applicative0())(df)(tf.value)(e)]))([]),Xf(n)(Sd(n.MonadST5().Monad0().Applicative0())(lf)(tf.value)("error"))([Ga(n.MonadST5().Monad0())(o)])]);var i,c}}}}}}},Ed=function(n){return function(e){return function(t){return Xf(t)(Pn(na(t.MonadST5().Monad0().Applicative0()))(Cs(t.MonadST5().Monad0().Applicative0())(Af)(Sf.value)(n))(Sd(t.MonadST5().Monad0().Applicative0())(lf)(tf.value)("cmd"+(me(n)?" clickable":""))))([Qa(t.MonadST5().Monad0())(e)])}}},Fd=function(n){return function(e){return function(t){return Xf(t)(Pn(na(t.MonadST5().Monad0().Applicative0()))(Cs(t.MonadST5().Monad0().Applicative0())(Af)(Sf.value)(n))(Sd(t.MonadST5().Monad0().Applicative0())(lf)(tf.value)("meta"+(me(n)?" clickable":""))))([Qa(t.MonadST5().Monad0())(e)])}}},Nd=function(n){return function(e){return function(t){return Xf(t)(Pn(na(t.MonadST5().Monad0().Applicative0()))(Cs(t.MonadST5().Monad0().Applicative0())(Af)(Sf.value)(n))(Sd(t.MonadST5().Monad0().Applicative0())(lf)(tf.value)("non-terminal"+(me(n)?" clickable":""))))([Qa(t.MonadST5().Monad0())(e)])}}},kd=function(n){return function(e){return function(t){return Xf(t)(Pn(na(t.MonadST5().Monad0().Applicative0()))(Cs(t.MonadST5().Monad0().Applicative0())(Af)(Sf.value)(n))(Sd(t.MonadST5().Monad0().Applicative0())(lf)(tf.value)("rule"+(me(n)?" clickable":""))))([Qa(t.MonadST5().Monad0())(e)])}}},Bd=function(n){return function(e){if(n instanceof vs)return Qa(e.MonadST5().Monad0())("Need at least one rule in the grammar.");if(n instanceof os)return ba(bn(wn)([Qa(e.MonadST5().Monad0())("The final token must only be referenced in the top rule, but it was also referenced in ")])(bn(wn)(Os(e)(zi)(x(Ri)((function(n){return ba([Fd(En(se(jr(pn))))("#")(e),kd(En(se(jr(pn))))(n)(e)])}))(n.value0)))([Qa(e.MonadST5().Monad0())(".")])));if(n instanceof as)return ba(bn(wn)([Qa(e.MonadST5().Monad0())("The final token must not be a nonterminal, but it appeared in ")])(bn(wn)(Os(e)(zi)(x(Ri)((function(n){return ba([Fd(En(se(jr(pn))))("#")(e),kd(En(se(jr(pn))))(n)(e)])}))(n.value0)))([Qa(e.MonadST5().Monad0())(".")])));if(n instanceof is)return ba(bn(wn)([Qa(e.MonadST5().Monad0())("The top nonterminal must not appear in the rest of the grammar, but it was also referenced in ")])(bn(wn)(Os(e)(zi)(x(Ri)((function(n){return ba([Fd(En(se(jr(pn))))("#")(e),kd(En(se(jr(pn))))(n)(e)])}))(n.value0)))([Qa(e.MonadST5().Monad0())(".")])));if(n instanceof cs)return ba([Qa(e.MonadST5().Monad0())("Entry point "),Nd(En(se(jr(pn))))(n.value0)(e),Qa(e.MonadST5().Monad0())(" is not present as a nonterminal in the grammar.")]);if(n instanceof ls)return Qa(e.MonadST5().Monad0())("Entry point must be different from the top rule.");if(n instanceof fs)return ba(bn(wn)([Qa(e.MonadST5().Monad0())("Rule names must be unique, but ")])(bn(wn)(Os(e)(zi)(x(Ri)((function(n){return ba([Fd(En(se(jr(pn))))("#")(e),kd(En(se(jr(pn))))(n)(e)])}))(n.value0)))([Qa(e.MonadST5().Monad0())(" "),Qa(e.MonadST5().Monad0())((t=zi,function(n){return function(e){return function(r){return bt(t)(D)(n)>1?r:e}}})(n.value0)("was")("were")),Qa(e.MonadST5().Monad0())(" duplicated")])));var t;throw new Error("Failed pattern match at Parser.Main (line 1719, column 1 - line 1719, column 46): "+[n.constructor.name])}},Pd=function(n){return function(e){return function(t){return Xf(t)(Pn(na(t.MonadST5().Monad0().Applicative0()))(Cs(t.MonadST5().Monad0().Applicative0())(Af)(Sf.value)(n))(Sd(t.MonadST5().Monad0().Applicative0())(lf)(tf.value)("state"+(me(n)?" clickable":""))))([Qa(t.MonadST5().Monad0())(ue(te)(e))])}}},qd=function(n){return function(e){return function(t){return Xf(t)(Pn(na(t.MonadST5().Monad0().Applicative0()))(Cs(t.MonadST5().Monad0().Applicative0())(Af)(Sf.value)(n))(Sd(t.MonadST5().Monad0().Applicative0())(lf)(tf.value)("terminal"+(me(n)?" clickable":""))))([Qa(t.MonadST5().Monad0())($l(e))])}}},Cd=function(n){return function(e){return function(t){return Sa()(n)()(gr({reflectSymbol:function(){return"amt"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"randomMany"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"size"}})(Sr(Tr(n.Always2())))(Mr)()())()())()())(ca({reflectSymbol:function(){return"amt"}})()()(ca({reflectSymbol:function(){return"randomMany"}})()()(ca({reflectSymbol:function(){return"size"}})()()(oa)()()()())()()()())()()()())(T.value)((function(r){return function(u){var o,a=de([])(yc(Ei(1234))(15))(wd(Gi)(xc)(e.produced)(e.grammar.start.pName));return $f(n)([$f(n)([Hf(n)(Sd(n.MonadST5().Monad0().Applicative0())(sf)(tf.value)("range"))([nv(n)([Qa(n.MonadST5().Monad0())("Simple")]),Kf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([Sd(n.MonadST5().Monad0().Applicative0())(Lf)(_f.value)("range"),Sd(n.MonadST5().Monad0().Applicative0())(bf)(Mf.value)("0"),Sd(n.MonadST5().Monad0().Applicative0())(wf)(hf.value)("100"),dv(n.MonadST5().Monad0().Applicative0())(Xo(n.MonadST5().Monad0().Applicative0())((function(n){return r.size(gi(n))})))]))([]),nv(n)([Qa(n.MonadST5().Monad0())("Complex")])]),Hf(n)(Sd(n.MonadST5().Monad0().Applicative0())(sf)(tf.value)("range"))([nv(n)([Qa(n.MonadST5().Monad0())("Few")]),Kf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([Sd(n.MonadST5().Monad0().Applicative0())(Lf)(_f.value)("range"),Sd(n.MonadST5().Monad0().Applicative0())(bf)(Mf.value)("1"),Sd(n.MonadST5().Monad0().Applicative0())(wf)(hf.value)("30"),Sd(n.MonadST5().Monad0().Applicative0())(Of)(zf.value)("15"),dv(n.MonadST5().Monad0().Applicative0())(Xo(n.MonadST5().Monad0().Applicative0())((function(n){return r.amt(gi(n))})))]))([]),nv(n)([Qa(n.MonadST5().Monad0())("Many")])]),jf(n)(Pn(na(n.MonadST5().Monad0().Applicative0()))(Sd(n.MonadST5().Monad0().Applicative0())(mf)(tf.value)(""))(Is(Uo)(Af)(Sf.value)(Do(ta(n.MonadST5()))(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(15))(u.amt))(E(Uo)(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(50))(u.size))((function(n){return function(t){return je(Rr)(mt(zr)(yt)(r.randomMany))((u=e.grammar.start.pName,function(n){return function(t){return Lt(Wt)(zr)((r=t,o=function(n){return function(){var e=Fi();return yc(e)(r)(n)}},a=Bi(xc)(y(n)),function(n){return o(a(n))}))(wd(Gi)(xc)(e.produced)(u));var r,o,a}})(n)(t));var u}}))))))([Qa(n.MonadST5().Monad0())("Random")])]),vv(n)(oe(ce)(za(n.MonadST5())((o=x(P)((function(e){return Zf(n)(Pn(na(n.MonadST5().Monad0().Applicative0()))(Sd(n.MonadST5().Monad0().Applicative0())(vf)(tf.value)("clickable"))(Sd(n.MonadST5().Monad0().Applicative0())(Af)(Sf.value)(t(e))))(x(P)((function(e){return qd(En(se(jr(pn))))(e)(n)}))(e))})),function(n){return ba(o(n))}))(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(a))(u.randomMany))))])}}))}}},Id=function(n){return function(e){if(n instanceof ps)return[Xf(e)(Sd(e.MonadST5().Monad0().Applicative0())(lf)(tf.value)("leaf node"))([qd(En(se(jr(pn))))(n.value0)(e)])];if(n instanceof ms)return[Xf(e)(Sd(e.MonadST5().Monad0().Applicative0())(lf)(tf.value)("node"))([kd(En(se(jr(pn))))(n.value0.value1)(e)]),Qf(e)(Sd(e.MonadST5().Monad0().Applicative0())(ff)(tf.value)("layer"))(E(P)(n.value1)((function(n){return Gf(e)(Id(n)(e))})))];throw new Error("Failed pattern match at Parser.Main (line 1166, column 1 - line 1166, column 31): "+[n.constructor.name])}},Dd=function(n){return function(e){return Qf(e)(Sd(e.MonadST5().Monad0().Applicative0())(ff)(tf.value)("AST CST"))([Gf(e)(Id(n)(e))])}},Rd=function(n){return function(e){return function(t){return function(r){return function(n){return function(e){return function(t){return new ha(Aa(n)(e)(t))}}}(n)(n.Always2())((function(u){return function(o){var a,i=Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(le.value))(o),c=(a=Ji,function(n){return function(e){var t=function(n){if(n instanceof rs)return new Ge([],[n.value0]);if(n instanceof us)return new Ge([n.value0],[]);throw new Error("Failed pattern match at Parser.Main (line 1040, column 3 - line 1040, column 43): "+[n.constructor.name])};return rt(ot)(Iu(n))(Iu(a))(At(St)(nt(Tn)(Tn))((function(n){return At(St)(nt(Tn)(Tn))((function(n){return bn(Xe(wn)(wn))(new Ge([],[n.pName]))((e=t,function(n){return bn(Xe(wn)(wn))(At(St)(nt(Tn)(Tn))(e)(n.value0))(At(St)(nt(Tn)(Tn))(e)(n.value1))})(n.rule));var e}))(n.items)}))(e))}})(Hl)(r),l=function(e){return Xf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([Sd(n.MonadST5().Monad0().Applicative0())(lf)(tf.value)("state hoverable"),Sd(n.MonadST5().Monad0().Applicative0())(Nf)(Ff.value)(u(new fe(e))),Sd(n.MonadST5().Monad0().Applicative0())(Bf)(kf.value)(u(le.value))]))([Qa(n.MonadST5().Monad0())(ue(te)(e))])},f=fv(n)(Bt(Pt)((function(e){var t=iv(n)(Ad(G)(n.MonadST5().Monad0().Applicative0())(uf)(iu(c.value0)+1|0)(e)),r=oe(ce);return function(n){return t(r(n))}}))(bn(wn)([Qa(n.MonadST5().Monad0())("")])(bn(wn)(x(P)((function(e){return qd(En(se(jr(pn))))(e)(n)}))(c.value0))(x(P)((function(e){return Uf(n)(Sd(n.MonadST5().Monad0().Applicative0())(pf)(tf.value)("pileup"))(bn(wn)(x(P)((function(e){return kd(En(se(jr(pn))))(e)(n)}))((r=e,So(yo)((function(n){return nn(Gi)(n.pName)(r)?new fe(n.rName):le.value}))(t))))([Nd(En(se(jr(pn))))(e)(n)]));var r}))(c.value1))))),v=E(P)(r)((function(t){return lv(n)(Is(Uo)(rf)(tf.value)((u=t.sName,Do(ta(n.MonadST5()))(x(Uo)((function(n){return n?" active ":""}))(e.getCurrentState(u)))(E(Uo)(i)((function(n){return bn(mn)(nn(be(G))(n)(new fe(u))?" hover ":"")}))))))((r=function(n){return iv(n)(ze(ea(n.MonadST5().Monad0().Applicative0())))}(n)([l(t.sName)]),function(n){return bn(wn)([r])(n)})(Bt(Pt)((function(e){return ov(n)(Ad(G)(n.MonadST5().Monad0().Applicative0())(of)(iu(c.value0))(e))}))(function(e){var t;return bn(wn)(x(P)((t=oe(ce),function(r){return t(function(e){if(e instanceof le)return ba([]);if(e instanceof fe&&e.value0 instanceof ns)return nv(n)([Ed(En(se(jr(pn))))("s")(n),l(e.value0.value0)]);if(e instanceof fe&&e.value0 instanceof es)return Xf(n)(Ui(e.value0.value0)>1?Sd(n.MonadST5().Monad0().Applicative0())(lf)(tf.value)("conflict"):ze(ea(n.MonadST5().Monad0().Applicative0())))(At(zi)(Tn)((function(e){return[Ed(En(se(jr(pn))))("r")(n),kd(En(se(jr(pn))))(e)(n)]}))(e.value0.value0));if(e instanceof fe&&e.value0 instanceof ts)return Xf(n)(Sd(n.MonadST5().Monad0().Applicative0())(lf)(tf.value)("conflict"))(bn(wn)([Ed(En(se(jr(pn))))("s")(n),l(e.value0.value0)])(At(zi)(Tn)((function(e){return[Ed(En(se(jr(pn))))("r")(n),kd(En(se(jr(pn))))(e)(n)]}))(e.value0.value1)));throw new Error("Failed pattern match at Parser.Main (line 1075, column 7 - line 1075, column 43): "+[e.constructor.name])}((u=r,x(he)(x(Ks)(Qe))(ao(Hl)(u)(ft()(e.advance))))));var u}))(c.value0))(x(P)((function(t){return function(e){if(e instanceof le)return[];if(e instanceof fe)return[Ed(En(se(jr(pn))))("g")(n),l(e.value0)];throw new Error("Failed pattern match at Parser.Main (line 1083, column 7 - line 1083, column 30): "+[e.constructor.name])}((r=t,ao(Ji)(r)(e.receive)));var r}))(c.value1))}(t))));var r,u}));return tv(n)(Sd(n.MonadST5().Monad0().Applicative0())(cf)(tf.value)("parse-table"))([cv(n)([f]),uv(n)(v)])}}))}}}},zd=function(n){return function(e){return function(t){if(e instanceof rs)return Nd(n)(e.value0)(t);if(e instanceof us)return qd(n)(e.value0)(t);throw new Error("Failed pattern match at Parser.Main (line 1568, column 1 - line 1568, column 74): "+[n.constructor.name,e.constructor.name])}}},Od=function(n){return function(e){return function(t){return Sa()(n)()(gr({reflectSymbol:function(){return"focus"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"select"}})(Sr(Tr(n.Always2())))(Mr)()())()())(ca({reflectSymbol:function(){return"focus"}})()()(ca({reflectSymbol:function(){return"select"}})()()(oa)()()()())()()()())(T.value)((function(r){return function(u){return ga(Ps(n.MonadST5().Monad0().Applicative0())(n.MonadST5())(u.select)([new rs(e.grammar.start.pName)])((function(o){var a,i=(a=Dt(It)(Tn)((function(n){return function(e){return de([])((function(e){return[new Ge(n,e)]}))(Ss(e))}})),function(n){return Cu(a(n))});return ga(Ps(n.MonadST5().Monad0().Applicative0())(n.MonadST5())(Pn(na(n.MonadST5().Monad0().Applicative0()))(u.focus)(x(Uo)(i)(o)))(new fe(new Ge(0,e.grammar.start.pName)))((function(u){var a,i,c=E(Uo)(o)((function(n){var e=Lt(jt)(Se)(Ms)(n);if(e instanceof le)return le.value;if(e instanceof fe)return new fe(t(e.value0));throw new Error("Failed pattern match at Parser.Main (line 2007, column 13 - line 2009, column 46): "+[e.constructor.name])}));return $f(n)([nv(n)([za(n.MonadST5())((i=Bt(Pt)((function(e){return function(t){if(t instanceof rs)return Xf(n)(Is(Uo)(lf)(tf.value)(E(Uo)(u)((a=Tt(yt)(Je)((o=nn(G)(e),function(n){return o(tt(n))})),function(n){return a(n)?"selected":""}))))([Nd(new fe(r.focus(new fe(new Ge(e,t.value0)))))(t.value0)(n)]);var o,a;if(t instanceof us)return qd(En(se(jr(pn))))(t.value0)(n);throw new Error("Failed pattern match at Parser.Main (line 2001, column 11 - line 2004, column 67): "+[e.constructor.name,t.constructor.name])}})),function(n){return ba(i(n))}))(o)]),jf(n)(Pn(na(n.MonadST5().Monad0().Applicative0()))(x(Uo)(Is(B)(mf)(tf.value)(de("disabled")(En((a=Sn,{mempty:function(n){return En(a)},Semigroup0:function(){return gn(a.Semigroup0())}})))))(c))(x(Uo)(Is(B)(Af)(Sf.value)(wt(zr)(yt)))(c)))([Qa(n.MonadST5().Monad0())("Send")]),jf(n)(Pn(na(n.MonadST5().Monad0().Applicative0()))(Sd(n.MonadST5().Monad0().Applicative0())(mf)(tf.value)("delete"))(Sd(n.MonadST5().Monad0().Applicative0())(Af)(Sf.value)(r.select([new rs(e.grammar.start.pName)]))))([Qa(n.MonadST5().Monad0())("Reset")]),tv(n)(Sd(n.MonadST5().Monad0().Applicative0())(cf)(tf.value)("explorer-table"))([uv(n)(E(P)(e.grammar.augmented)((function(t){var a,i,c,l,f=Po(ta(n.MonadST5()))(o)(E(Uo)(u)((function(n){return function(e){return We(ye)(n)((function(n){return Oe($e)(ye)(cr(Ee)(nn(Gi)(n.value1)(t.pName)))((function(){return Oe($e)(ye)(cr(Ee)(n.value0<=iu(e)))((function(){return oe(Se)(bn(wn)((r=n.value0,function(n){return r<1?[]:su(0)(r)(n)})(e))(bn(wn)(t.rule)(Uu(n.value0+1|0)(e))));var r}))}))}))}}))),v=x(Uo)(Tt(yt)(Je)((a=nn(Gi)(t.pName),function(n){return a(Qe(n))})))(u);return lv(n)(Is(Uo)(rf)(tf.value)((l=v,E(Uo)(l)((function(n){return n?"active":"inactive"})))))(x(P)((i=av(n),c=oe(ce),function(n){return i(c(n))}))([Nd(En(se(jr(pn))))(t.pName)(n),Fd(En(se(jr(pn))))(" : ")(n),ba(x(P)((function(e){return zd(En(se(jr(pn))))(e)(n)}))(t.rule)),nv(n)([Fd(En(se(jr(pn))))(" #")(n),kd(En(se(jr(pn))))(t.rName)(n)]),nv(n)([Qa(n.MonadST5().Monad0())(" "),jf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([x(Uo)(x(B)(Is(B)(mf)(tf.value)(bn(mn)("select")))((function(n){return n?En(Sn):" disabled"})))(v),x(Uo)(Is(B)(Af)(Sf.value)(mt(zr)(yt)(r.select)))(f)]))([Qa(n.MonadST5().Monad0())("Choose")])]),function(){var r,u=ju((r=nn(J()(tn(tn(tn(K)()({reflectSymbol:function(){return"rule"}})(en(Xs(Gi)(Kl))))()({reflectSymbol:function(){return"rName"}})(V))()({reflectSymbol:function(){return"pName"}})(Gi)))(t),function(n){return r(n.production)}))(e.produced);if(u instanceof le)return Qa(n.MonadST5().Monad0())("Unproduceable");if(u instanceof fe)return nv(n)([Yf(n)([Qa(n.MonadST5().Monad0())("e.g. ")]),ba(x(P)((function(e){return qd(En(se(jr(pn))))(e)(n)}))(u.value0.produced))]);throw new Error("Failed pattern match at Parser.Main (line 2051, column 23 - line 2057, column 30): "+[u.constructor.name])}()]))})))])])})))})))}}))}}},_d=function(n){return function(e){return function(t){return function(r){return function(u){return g(za(n.MonadST5()))(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(t))($o(n.Always2())(n.Always3())(n.MonadST5().Monad0().Applicative0())(r)))((function(t){return Sa()(n)()(gr({reflectSymbol:function(){return"entry"}})(Sr(Er(yr()(gr({reflectSymbol:function(){return"error"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"value"}})(Sr(Tr(n.Always2())))(Mr)()())()()))))(gr({reflectSymbol:function(){return"eof"}})(Sr(Er(yr()(gr({reflectSymbol:function(){return"error"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"value"}})(Sr(Tr(n.Always2())))(Mr)()())()()))))(gr({reflectSymbol:function(){return"pName"}})(Sr(Er(yr()(gr({reflectSymbol:function(){return"error"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"value"}})(Sr(Tr(n.Always2())))(Mr)()())()()))))(gr({reflectSymbol:function(){return"rName"}})(Sr(Er(yr()(gr({reflectSymbol:function(){return"error"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"value"}})(Sr(Tr(n.Always2())))(Mr)()())()()))))(gr({reflectSymbol:function(){return"rule"}})(Sr(Er(yr()(gr({reflectSymbol:function(){return"error"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"value"}})(Sr(Tr(n.Always2())))(Mr)()())()()))))(gr({reflectSymbol:function(){return"top"}})(Sr(Er(yr()(gr({reflectSymbol:function(){return"error"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"value"}})(Sr(Tr(n.Always2())))(Mr)()())()()))))(gr({reflectSymbol:function(){return"topName"}})(Sr(Er(yr()(gr({reflectSymbol:function(){return"error"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"value"}})(Sr(Tr(n.Always2())))(Mr)()())()()))))(Mr)()())()())()())()())()())()())()())(ia({reflectSymbol:function(){return"entry"}})()()()(ca({reflectSymbol:function(){return"error"}})()()(ca({reflectSymbol:function(){return"value"}})()()(oa)()()()())()()()())(ia({reflectSymbol:function(){return"eof"}})()()()(ca({reflectSymbol:function(){return"error"}})()()(ca({reflectSymbol:function(){return"value"}})()()(oa)()()()())()()()())(ia({reflectSymbol:function(){return"pName"}})()()()(ca({reflectSymbol:function(){return"error"}})()()(ca({reflectSymbol:function(){return"value"}})()()(oa)()()()())()()()())(ia({reflectSymbol:function(){return"rName"}})()()()(ca({reflectSymbol:function(){return"error"}})()()(ca({reflectSymbol:function(){return"value"}})()()(oa)()()()())()()()())(ia({reflectSymbol:function(){return"rule"}})()()()(ca({reflectSymbol:function(){return"error"}})()()(ca({reflectSymbol:function(){return"value"}})()()(oa)()()()())()()()())(ia({reflectSymbol:function(){return"top"}})()()()(ca({reflectSymbol:function(){return"error"}})()()(ca({reflectSymbol:function(){return"value"}})()()(oa)()()()())()()()())(ia({reflectSymbol:function(){return"topName"}})()()()(ca({reflectSymbol:function(){return"error"}})()()(ca({reflectSymbol:function(){return"value"}})()()(oa)()()()())()()()())(oa)()()()())()()()())()()()())()()()())()()()())()()()())()()()())(T.value)((function(r){return function(o){return Sa()(n)()(gr({reflectSymbol:function(){return"addRule"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"errorMessage"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"removeRule"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"troubleRules"}})(Sr(Tr(n.Always2())))(Mr)()())()())()())()())(ca({reflectSymbol:function(){return"addRule"}})()()(ca({reflectSymbol:function(){return"errorMessage"}})()()(ca({reflectSymbol:function(){return"removeRule"}})()()(ca({reflectSymbol:function(){return"troubleRules"}})()()(oa)()()()())()()()())()()()())()()()())(T.value)((function(a){return function(i){var c,l=Pn(na(n.MonadST5().Monad0().Applicative0()))(x(Uo)(Fe.create)(i.addRule))(x(Uo)(Ne.create)(i.removeRule)),f=(c=Cu(ft()(t.augmented)))instanceof fe&&2===c.value0.rule.length&&c.value0.rule[0]instanceof rs&&c.value0.rule[1]instanceof us?{top:c.value0.pName,entry:c.value0.rule[0].value0,eof:$l(c.value0.rule[1].value0),topName:c.value0.rName}:{top:od,entry:"",eof:$l(ad),topName:"TOP"},v=Bt(Pt)((function(n){return function(e){return new Ge(n,{rule:At(St)(Sn)(gs)(e.rule),pName:e.pName,rName:e.rName})}}))(Uu(1)(ft()(t.augmented))),s=Do(ta(n.MonadST5()))(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(f.top))(o.top.value))(Do(ta(n.MonadST5()))(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(f.entry))(o.entry.value))(Do(ta(n.MonadST5()))(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(f.eof))(o.eof.value))(Do(ta(n.MonadST5()))(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(f.topName))(o.topName.value))(Xo(n.MonadST5().Monad0().Applicative0())((function(n){return function(e){return function(t){return function(r){return{topName:n,eof:e,entry:t,top:r}}}}})))))),d=Do(ta(n.MonadST5()))(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(""))(o.pName.value))(Do(ta(n.MonadST5()))(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(""))(o.rule.value))(E(Uo)(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(""))(o.rName.value))((function(n){return function(e){return function(t){return{rName:n,rule:e,pName:t}}}})))),p=x(Uo)(z(D)(iu(v)))(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(0))(x(Uo)(x(B)(z(D)(1))(tt))(i.addRule)));return ga(qs(n.MonadST5().Monad0().Applicative0())(n.MonadST5())((function(n){return function(e){if(n instanceof Fe)return(t=e,function(n){return(e=hu(n),function(n){return function(){var t=mu(n)();return e(t)(),pu(t)()}})(t)();var e})(n.value0);var t,r;if(n instanceof Ne)return lu((r=Ve(Ze(Ze(Je)))(nn(G))(n.value0),function(n){return r(tt(n))}))(e);throw new Error("Failed pattern match at Parser.Main (line 1754, column 17 - line 1756, column 77): "+[n.constructor.name])}}))(l)(v)((function(t){var c,l,m,h,w,M,b=Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())([]))(i.troubleRules),g=Do(ta(n.MonadST5()))(t)(E(Uo)(s)((function(n){return function(e){return{top:we(od)(Zi(n.top)),entry:Pn(Te)(Zi(n.entry))(E(he)(Cu(e))((function(n){return function(n){return n.pName}(Qe(n))}))),eof:we(ad)(Ns(_l(n.eof))),topName:n.topName}}}))),S=(M=en(Gi),function(n){return function(e){return cd(nn(M))(n)(e)}})(n.MonadST5().Monad0().Applicative0())(n.MonadST5())(x(Uo)(Ds)(Do(ta(n.MonadST5()))(x(Uo)(x(P)((function(n){return function(n){return n.pName}(Qe(n))})))(t))(x(Uo)((c=bn(wn),l=oe(ce),m=we(od),function(n){return c(l(m(Zi(n))))}))(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(f.top))(o.top.value))))),T=Do(ta(n.MonadST5()))(x(Uo)(x(P)(Qe))(t))(E(Uo)(g)(Qs));return $f(n)([$f(n)([Ye(_e)(xd(n)("non-terminal")("Top name"))(f.top)(o.top.error)(bn(gn(jr(pn)))(y(r.top.error("")))(r.top.value)),xd(n)("non-terminal")("Entry point")("")(f.entry)(o.entry.error)(bn(gn(jr(pn)))(y(r.entry.error("")))(r.entry.value)),Ye(_e)(xd(n)("terminal")("Final token"))(f.eof)(o.eof.error)(bn(gn(jr(pn)))((function(n){return r.eof.error(Ll(n)<=1?"":"Must be a single character (Unicode code point)")}))(r.eof.value)),Ye(_e)(xd(n)("rule")("Top rule name"))(f.topName)(o.topName.error)(bn(gn(jr(pn)))(y(r.topName.error("")))(r.topName.value))]),tv(n)(Sd(n.MonadST5().Monad0().Applicative0())(cf)(tf.value)("grammar"))([fv(n)([av(n)([za(n.MonadST5())((function(e){return Nd(En(se(jr(pn))))(e)(n)}))(E(Uo)(g)((function(n){return n.top})))]),av(n)([Fd(En(se(jr(pn))))(" : ")(n)]),av(n)([nv(n)([za(n.MonadST5())(de(Qa(n.MonadST5().Monad0())("—"))((function(e){return Nd(En(se(jr(pn))))(e)(n)})))(E(Uo)(g)((function(n){return n.entry})))]),nv(n)([za(n.MonadST5())((function(e){return qd(En(se(jr(pn))))(e)(n)}))(E(Uo)(g)((function(n){return n.eof})))])]),av(n)([Fd(En(se(jr(pn))))(" #")(n),nv(n)([za(n.MonadST5())((function(e){return kd(En(se(jr(pn))))(e)(n)}))(E(Uo)(g)((function(n){return n.topName})))])])]),uv(n)(oe(ce)((w=x(Uo)((function(e){return qo(ta(n.MonadST5()))(Aa(n)(n.Always2())((function(t){return function(r){return Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(new va(lv(n)(Is(Uo)(rf)(tf.value)(E(Uo)(b)((function(n){var t=function(n){return function(e){return function(t){return me(function(n){return function(e){return Wu((function(t){return nn(n)(t)(e)}))}}(n)(e)(t))}}}(V)(e.value1.rName)(n);return t?"trouble":""}))))(x(P)((u=av(n),o=oe(ce),function(n){return u(o(n))}))([Nd(En(se(jr(pn))))(e.value1.pName)(n),Fd(En(se(jr(pn))))(" : ")(n),nv(n)([za(n.MonadST5())((function(t){return ba(x(P)((function(e){return zd(En(se(jr(pn))))(e)(n)}))(Fs(t)(e.value1.rule)))}))(S)]),nv(n)([Fd(En(se(jr(pn))))(" #")(n),kd(En(se(jr(pn))))(e.value1.rName)(n)]),nv(n)([Qa(n.MonadST5().Monad0())(" "),jf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([Sd(n.MonadST5().Monad0().Applicative0())(mf)(tf.value)("delete"),Sd(n.MonadST5().Monad0().Applicative0())(Af)(Sf.value)(Dn(Wr)(Dn(Wr)(t(sa.value))(a.removeRule(e.value0)))(a.troubleRules([])))]))([Qa(n.MonadST5().Monad0())("Delete")])])])))))(r);var u,o}})))}))(Pn(na(n.MonadST5().Monad0().Applicative0()))(pt(St)(ea(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0()))(v))(i.addRule)),new pa(w))))]),$f(n)([xd(n)("non-terminal")("Nonterminal name")("")("")(o.pName.error)(bn(gn(jr(pn)))(y(r.pName.error("")))(r.pName.value)),Fd(En(se(jr(pn))))(" : ")(n),xd(n)("terminal")("Value")("")("")(o.rule.error)(bn(gn(jr(pn)))(y(r.rule.error("")))(r.rule.value)),Fd(En(se(jr(pn))))(" #")(n),xd(n)("rule")("Rule name")("")("")(o.rName.error)(bn(gn(jr(pn)))(y(r.rName.error("")))(r.rName.value)),jf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([Sd(n.MonadST5().Monad0().Applicative0())(mf)(tf.value)("big add"),Is(Uo)(Af)(Sf.value)(Fv(nc)(n)(d)(Fv(ll(nc))(n)(p)(x(Uo)(Nv(kv(kv((h=ul,{readersT:ol(h)})))))(Xo(n.MonadST5().Monad0().Applicative0())((function(n){return function(e){var t=Zi(e.pName);if(t instanceof le)return r.pName.error("Name for non-terminal must be non-empty.");if(t instanceof fe)return function(){return a.errorMessage(le.value)(),r.pName.error("")(),r.rule.error("")(),r.rName.error("")(),a.troubleRules([])(),a.addRule(new Ge(n,function(){var n={};for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n.pName=t.value0,n}()))()};throw new Error("Failed pattern match at Parser.Main (line 1873, column 37 - line 1883, column 88): "+[t.constructor.name])}}))))))]))([Qa(n.MonadST5().Monad0())("Add rule")])]),Wf(n)([]),""===e?ba([]):$f(n)(oe(ce)(jf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([Sd(n.MonadST5().Monad0().Applicative0())(mf)(tf.value)("big"),E(Uo)(T)((function(n){return Ya(Af)(Sf.value)((function(){if(a.errorMessage(le.value)(),r.pName.error("")(),r.rule.error("")(),r.rName.error("")(),r.top.error("")(),r.entry.error("")(),r.eof.error("")(),r.topName.error("")(),a.troubleRules([])(),n instanceof Fe){if(a.errorMessage(new fe(n.value0))(),a.troubleRules(function(n){if(n instanceof vs)return[];if(n instanceof os)return n.value0;if(n instanceof as)return n.value0;if(n instanceof is)return n.value0;if(n instanceof cs)return[];if(n instanceof ls)return[];if(n instanceof fs)return n.value0;throw new Error("Failed pattern match at Parser.Main (line 1710, column 16 - line 1717, column 45): "+[n.constructor.name])}(n.value0))(),n.value0 instanceof vs)return A;if(n.value0 instanceof os)return r.eof.error("Must not appear in the rest of the grammar")();if(n.value0 instanceof as)return r.eof.error("Cannot appear as nonterminal")();if(n.value0 instanceof is)return r.top.error("Must not appear in the rest of the grammar")();if(n.value0 instanceof cs)return r.entry.error("Must name a nonterminal in the grammar")();if(n.value0 instanceof ls)return r.entry.error("Cannot be the top rule itself")();if(n.value0 instanceof fs)return A;throw new Error("Failed pattern match at Parser.Main (line 1908, column 33 - line 1922, column 46): "+[n.value0.constructor.name])}if(n instanceof Ne)return u(n.value0)();throw new Error("Failed pattern match at Parser.Main (line 1904, column 29 - line 1924, column 47): "+[n.constructor.name])}))}))]))([Qa(n.MonadST5().Monad0())(e)]))),$f(n)([za(n.MonadST5())((function(e){if(e instanceof le)return ga(ze(ea(n.MonadST5().Monad0().Applicative0())));if(e instanceof fe)return ba([Wf(n)([]),Uf(n)(Sd(n.MonadST5().Monad0().Applicative0())(pf)(tf.value)("Error"))([Bd(e.value0)(n)])]);throw new Error("Failed pattern match at Parser.Main (line 1929, column 64 - line 1934, column 26): "+[e.constructor.name])}))(i.errorMessage)])])})))}}))}}))}))}}}}},Ld=function(n){return function(e){return Xf(e)(Sd(e.MonadST5().Monad0().Applicative0())(lf)(tf.value)("zipper"+(Eu(n.value1)?" reducible":"")))([Xf(e)(Sd(e.MonadST5().Monad0().Applicative0())(lf)(tf.value)("parsed"))(E(P)(n.value0)((function(n){return zd(En(se(jr(pn))))(n)(e)}))),Eu(n.value1)?ba(ze(Re)):Xf(e)(ze(ea(e.MonadST5().Monad0().Applicative0())))(E(P)(n.value1)((function(n){return zd(En(se(jr(pn))))(n)(e)})))])}},Wd=function(n){return function(e){return function(t){return tv(n)(Sd(n.MonadST5().Monad0().Applicative0())(cf)(tf.value)("state-table"))(E(P)(t)((function(t){return rv(n)(Is(Uo)(af)(tf.value)((a=t.sName,x(Uo)((function(n){return n?"active":""}))(e.getCurrentState(a)))))((r=(o=t,function(n){return function(e){return Bt(Pt)((function(n){return function(t){return function(n){return function(e){return function(t){return function(r){return[0===e?Pd(En(se(jr(pn))))(n.sName)(r):Qa(r.MonadST5().Monad0())(""),Nd(En(se(jr(pn))))(t.pName)(r),Fd(En(se(jr(pn))))(": ")(r),Ld(t.rule)(r),(u=Eu(t.rule.value1)?" reducible":"",function(n){return function(e){return Xf(e)(Sd(e.MonadST5().Monad0().Applicative0())(lf)(tf.value)("lookahead"+u))(bn(wn)([Fd(En(se(jr(pn))))("{ ")(e)])(bn(wn)(ku(Tn)([Fd(En(se(jr(pn))))(", ")(e)])(E(P)(n)((function(n){return[qd(En(se(jr(pn))))(n)(e)]}))))([Fd(En(se(jr(pn))))(" }")(e)])))}})(t.lookahead)(r),ba([Fd(En(se(jr(pn))))(" #")(r),kd(En(se(jr(pn))))(t.rName)(r)]),function(){var e,u=(e=Ji,function(n){return function(t){return Ue(ye)(As)((function(r){if(r instanceof rs)return ao(e)(r.value0)(t.receive);if(r instanceof us)return We(ye)(ao(n)(r.value0)(ft()(t.advance)))(bs);throw new Error("Failed pattern match at Parser.Main (line 630, column 50 - line 632, column 62): "+[r.constructor.name])}))}})(Hl)(n)(t.rule);if(u instanceof le)return ba([]);if(u instanceof fe)return ba([Fd(En(se(jr(pn))))(" —> ")(r),Pd(En(se(jr(pn))))(u.value0)(r)]);throw new Error("Failed pattern match at Parser.Main (line 1315, column 5 - line 1317, column 72): "+[u.constructor.name])}()];var u}}}}(o)(n)(t)(e)}}))(n)}})(t.items)(n),u=iu(r),Bt(Pt)((function(e){var t=fv(n),r=Bt(Pt)((function(t){var r,o=(r=u,function(e){return function(t){return 0===e&&0===t?iv(n)(Sd(n.MonadST5().Monad0().Applicative0())(If)(Cf.value)(ue(te)(r))):0===t?y(ba([])):av(n)}})(e)(t),a=oe(ce);return function(n){return o(a(n))}}));return function(n){return t(r(n))}}))(r)));var r,u,o,a})))}}},jd=function(n){return function(e){var t,r,u=(t=function(e){return function(n){return function(e){if(e.value1 instanceof Fe)return E(tc(nl))(Ys(n.MonadST5())(lf))(x(B)((function(t){return Xf(n)(t.value1)([Ed(En(se(jr(pn))))("s")(n),Pd(En(se(jr(pn))))(e.value0)(n)])})));if(e.value1 instanceof Ne)return E(tc(nl))(Ys(n.MonadST5())(lf))(x(B)((function(t){return Xf(n)(t.value1)([Ed(En(se(jr(pn))))("r")(n),kd(En(se(jr(pn))))(e.value1.value0.value1)(n),Fd(En(se(jr(pn))))(" —> ")(n),Ed(En(se(jr(pn))))("g")(n),Pd(En(se(jr(pn))))(e.value0)(n)])})));throw new Error("Failed pattern match at Parser.Main (line 1251, column 1 - line 1255, column 43): "+[e.constructor.name])}}(n)(e)},r=function(e){return function(n){return function(e){if(e instanceof Fe&&e.value0 instanceof le)return E(tc(nl))($s(n.MonadST5())(pf))(x(B)((function(e){return Uf(n)(e.value1)([Qa(n.MonadST5().Monad0())("Step "+ue(te)(e.value0)+": Parse error")])})));if(e instanceof Fe&&e.value0 instanceof fe)return E(tc(nl))($s(n.MonadST5())(pf))(x(B)((function(t){var r=function(n){return n instanceof Rv&&n.value0 instanceof Rv&&n.value0.value0 instanceof Dv&&n.value0.value1 instanceof ms&&n.value1 instanceof ps?new fe(n.value0.value1):le.value}(e.value0.value0);return r instanceof fe&&x(Be)(x(Hs)(Qe))(xs(r.value0))instanceof Ne?Uf(n)(t.value1)([Qa(n.MonadST5().Monad0())("Step the last: "),Dd(r.value0)(n)]):Uf(n)(t.value1)([Qa(n.MonadST5().Monad0())("Step the last: Something went wrong")])})));if(e instanceof Ne)return E(tc(nl))(Us(n.MonadST5())(pf)("flex justify-between"))(x(B)((function(t){return Uf(n)(t.value1)([$f(n)([Qa(n.MonadST5().Monad0())("Step "+ue(te)(t.value0)+": "),(r=e.value0.stack,function(n){var e=function(t){if(t instanceof Dv)return[ev(n)([Pd(En(se(jr(pn))))(t.value0)(n)])];if(t instanceof Rv)return bn(wn)(e(t.value0))(bn(wn)([Dd(t.value1)(n)])([ev(n)([Pd(En(se(jr(pn))))(t.value2)(n)])]));throw new Error("Failed pattern match at Parser.Main (line 1125, column 3 - line 1125, column 57): "+[t.constructor.name])};return Xf(n)(Sd(n.MonadST5().Monad0().Applicative0())(lf)(tf.value)("full stack"))(e(r))})(n)]),$f(n)(At(er)(Tn)((function(e){return[qd(En(se(jr(pn))))(e)(n)]}))(e.value0.inputs))]);var r})));throw new Error("Failed pattern match at Parser.Main (line 1228, column 1 - line 1236, column 43): "+[e.constructor.name])}}(n)(e)},function(n){if(n instanceof zv)return In(oc(Xc))(x(tc(nl))(Rn(qn)((function(n){return function(e){return[n,e]}})))(r(new Ne(n.value0))))(r(new Fe(le.value)));if(n instanceof Ov)return In(oc(Xc))(x(tc(nl))(Rn(qn)((function(n){return function(e){return[n,e]}})))(r(new Ne(n.value0))))(r(new Fe(new fe(n.value1))));if(n instanceof _v)return In(oc(Xc))(In(oc(Xc))(x(tc(nl))((e=qn,function(n){return function(t){return function(r){return function(u){return In(e)(In(e)(x(e.Functor0())(n)(t))(r))(u)}}}})((function(n){return function(e){return function(t){return bn(wn)([n,e])(t)}}})))(r(new Ne(n.value0))))(t(new Ge(function(n){if(n instanceof zv)return Lv(n.value0.stack);if(n instanceof Ov)return Lv(n.value0.stack);if(n instanceof _v)return Lv(n.value0.stack);throw new Error("Failed pattern match at Parser.Main (line 1976, column 1 - line 1976, column 34): "+[n.constructor.name])}(n.value2),n.value1))))(u(n.value2));var e;throw new Error("Failed pattern match at Parser.Main (line 1277, column 7 - line 1283, column 107): "+[n.constructor.name])});return x(tc(nl))(x(B)(ba))(u(e))}},Ud=function(n){return function(e){return function(t){return function(r){return Sa()(n)()(gr({reflectSymbol:function(){return"changeText"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"errorMessage"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"focusMode"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"grammar"}})(Sr(Tr(n.Always2())))(Mr)()())()())()())()())(ca({reflectSymbol:function(){return"changeText"}})()()(ca({reflectSymbol:function(){return"errorMessage"}})()()(ca({reflectSymbol:function(){return"focusMode"}})()()(ca({reflectSymbol:function(){return"grammar"}})()()(oa)()()()())()()()())()()()())()()()())(T.value)((function(u){return function(o){return ga(qs(n.MonadST5().Monad0().Applicative0())(n.MonadST5())(y)(Pn(na(n.MonadST5().Monad0().Applicative0()))($o(n.Always2())(n.Always3())(n.MonadST5().Monad0().Applicative0())(t))(o.grammar))(e)((function(a){var i,c,l,f,v=function(e){return function(t){return Uf(n)(Pn(na(n.MonadST5().Monad0().Applicative0()))(Sd(n.MonadST5().Monad0().Applicative0())(pf)(tf.value)("widget"))(Sd(n.MonadST5().Monad0().Applicative0())(Rf)(Df.value)("order: "+ue(te)(e))))([$f(n)([jf(n)(Pn(na(n.MonadST5().Monad0().Applicative0()))(Sd(n.MonadST5().Monad0().Applicative0())(Af)(Sf.value)(u.focusMode(A)))(Sd(n.MonadST5().Monad0().Applicative0())(mf)(tf.value)("big bonus")))([Qa(n.MonadST5().Monad0())("Toggle dashboard mode")]),Wf(n)([]),Wf(n)([]),t])])}},s=function(n){return u.changeText(new Ge(!0,Ul(n)))},d=bd(ud(Gi)(V)(Kl)(e)),p=Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(d))(So(Qo(n.MonadST5().Monad0().Applicative0()))((function(n){return n.value0?new fe(n.value1):le.value}))(o.changeText)),m=Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(d))(x(Uo)(Qe)(o.changeText)),h=x(Uo)(Pe(y([]))(w(M)))(E(Uo)(a)((function(n){return md(Ji)(V)(Hl)(z(D)(1))(n.augmented)(function(n){return function(e){return function(t){return function(r){return function(u){return pd(n)(e)(t)(r)([dd(e)(n.Eq0())(t.Eq0())(r)(ed(n.Eq0())(e)(t.Eq0())([u]))])}}}}}(Ji)(V)(Hl)(n.augmented)(n.start))}))),S=x(Uo)(fd(Vn)(Ji)(V)(Hl))(h),B=x(Uo)(ud(Gi)(V)(Kl))(a),C=x(Uo)((i=Hl,c=function(n){return Iu(i)(_u(Tn)((function(n){return Ku(Ms)(n.rule)}))(n))},function(n){return c(n.augmented)}))(a),I=x(Uo)((l=function(n){return function(e){return Iu(n)(_u(Tn)((function(n){return bn(wn)([n.pName])(Ku(Ss)(n.rule))}))(e))}}(Ji),function(n){return l(n.augmented)}))(a),R=x(Uo)(Js)(a),O=Do(ta(n.MonadST5()))(m)(R),_=Po(ta(n.MonadST5()))(S)(E(Uo)(O)((function(n){return function(e){return q(he)(x(he)(Wv(e))(n))(1)}}))),L=x(Uo)(de(0)(_s))(_),W=x(Uo)(Zs)(a),j=Do(ta(n.MonadST5()))(m)(W),U=Po(ta(n.MonadST5()))(S)(E(Uo)(j)((function(n){return function(e){return q(he)(x(he)(Wv(e))(n))(1)}})));return ga((f=n.MonadST5().Monad0().Applicative0(),function(n){return function(e){return function(t){return function(r){return Zo(n)(e)((function(n){return r(Pn(na(f))(Xo(f)(t))(n))}))}}}})(n.MonadST5())(L)(0)((function(i){return ga(Zo(n.MonadST5())(h)((function(c){var l=qo(ta(n.MonadST5()))(N(Uo)(c)(yd(Vn)(n.MonadST5())(!1)(i)(w(M))));return ga(Zo(n.MonadST5())(Po(ta(n.MonadST5()))(l)(x(Uo)(Ge.create)(c)))((function(l){var f=Po(ta(n.MonadST5()))(c)(E(Uo)(i)((function(n){return function(e){return ju((t=nn(G)(n),function(n){return t(n.sName)}))(e);var t}}))),d=E(Uo)(f)((function(n){if(n instanceof le)return mo;if(n instanceof fe)return n.value0.receive;throw new Error("Failed pattern match at Parser.Main (line 2274, column 38 - line 2276, column 47): "+[n.constructor.name])})),h=function(e){var t=E(Uo)(d)(io(Ji)(e)),r=Fv(nc)(n)(B)(Fv(ll(nc))(n)(m)(Xo(n.MonadST5().Monad0().Applicative0())((function(n){return function(t){return function(){var r=x(Lr)(de("")(Ul))(Ut(Wt)(zr)(x(he)(gc)(wd(Gi)(xc)(t.produced)(e))))();return u.changeText(new Ge(!0,n+r))()}}}))));return function(n){return function(e){return function(t){return function(r){return Xf(n)(Pn(na(n.MonadST5().Monad0().Applicative0()))(Is(Uo)(Af)(Sf.value)(So(Qo(n.MonadST5().Monad0().Applicative0()))(w(M))(t)))(Is(Uo)(lf)(tf.value)(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())("non-terminal"))(x(Uo)(bn(mn)("non-terminal "))(e)))))([Qa(n.MonadST5().Monad0())(r)])}}}}(n)(x(Uo)(bn(mn)("clickable"))(E(Uo)(t)((function(n){return n?"":" unusable"}))))(x(Uo)(fe.create)(r))(e)},S=E(Uo)(f)((function(n){if(n instanceof le)return mo;if(n instanceof fe)return n.value0.advance;throw new Error("Failed pattern match at Parser.Main (line 2270, column 38 - line 2272, column 60): "+[n.constructor.name])})),N=function(e){var t=function(){if(e instanceof fe)return E(Uo)(S)(io(Hl)(e.value0));if(e instanceof le)return E(Uo)(m)(Ve(Ze(Je))(Hi));throw new Error("Failed pattern match at Parser.Main (line 2284, column 27 - line 2286, column 64): "+[e.constructor.name])}(),r=function(){if(e instanceof le)return Zl("⌫");if(e instanceof fe)return e.value0;throw new Error("Failed pattern match at Parser.Main (line 2287, column 29 - line 2289, column 36): "+[e.constructor.name])}(),o=Fv(nc)(n)(m)(Xo(n.MonadST5().Monad0().Applicative0())((function(n){return u.changeText(new Ge(!0,function(){if(e instanceof fe)return n+$l(e.value0);if(e instanceof le)return Vl(Ll(n)-1|0)(n);throw new Error("Failed pattern match at Parser.Main (line 2281, column 47 - line 2283, column 69): "+[e.constructor.name])}()))})));return function(n){return function(e){return function(t){return function(r){return Xf(n)(Pn(na(n.MonadST5().Monad0().Applicative0()))(Is(Uo)(Af)(Sf.value)(So(Qo(n.MonadST5().Monad0().Applicative0()))(w(M))(t)))(Is(Uo)(lf)(tf.value)(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())("terminal"))(x(Uo)(bn(mn)("terminal "))(e)))))([Qa(n.MonadST5().Monad0())($l(r))])}}}}(n)(x(Uo)(bn(mn)("clickable"))(E(Uo)(t)((function(n){return n?"":" unusable"}))))(x(Uo)(fe.create)(o))(r)};return Uf(n)(Is(Uo)(pf)(tf.value)(x(Uo)(bn(mn)("widgets"))(x(Uo)((function(n){return n?" focus-mode":""}))(gd(Je)(n.MonadST5())(!1)(o.focusMode)))))([$f(n)([za(n.MonadST5())((function(e){if(e instanceof le)return ga(ze(ea(n.MonadST5().Monad0().Applicative0())));if(e instanceof fe)return Uf(n)(Sd(n.MonadST5().Monad0().Applicative0())(pf)(tf.value)("Error"))([Qa(n.MonadST5().Monad0())(e.value0)]);throw new Error("Failed pattern match at Parser.Main (line 2301, column 58 - line 2303, column 72): "+[e.constructor.name])}))(o.errorMessage)]),Vf(n)([Qa(n.MonadST5().Monad0())("Input a grammar")]),Es(["Craft a grammar out of a set of rules. Each rule consists of a nonterminal name, then a colon followed by a sequence of nonterminals and terminals. Each rule must also have a unique name, which will be used to refer to it during parsing and when displaying parse trees. If ommitted, an automatic rule name will be supplied based on the nonterminal name.","The top rule is controlled by the upper input boxes (LR(1) grammars often require a top rule that contains a unique terminal to terminate each input), while the lower input boxes are for adding a new rule. The nonterminals are automatically parsed out of the entered rule, which is otherwise assumed to consist of terminals.","Click “Use grammar” to see the current set of rules in action! It may take a few seconds, depending on the size of the grammar and how many states it produces."])(n),v(1)(_d(n)("Use grammar")(e)(t)(bn(gn(jr(pn)))(u.grammar)(r))),Vf(n)([Qa(n.MonadST5().Monad0())("Generate random matching inputs")]),Es(["This will randomly generate some inputs that conform to the grammar. Click on one to send it to be tested down below!"])(n),v(5)(za(n.MonadST5())(g(Cd(n))(s))(B)),Vf(n)([Qa(n.MonadST5().Monad0())("List of parsing states")]),Es(["To construct the LR(1) parse table, the possible states are enumerated. Each state represents partial progress of some rules in the grammar. The center dot “•” represents the dividing line between already-parsed and about-to-be-parsed.","Each state starts from a few seed rules, which are then closed by adding all nonterminals that could be parsed next. Then new states are explored by advancing on terminals or nonterminals, each of which generates some new seed items. That is, if multiple rules will advance on the same (non)terminal, they will collectively form the seed items for a state. (This state may have been recorded already, in which case nothing further is done.)","When a full rule is parsed, it is eligible to be reduced, but this is only done when one of its lookaheads come next (highlighted in red)."])(n),v(3)(za(n.MonadST5())((function(e){return Wd(n)({getCurrentState:e.value1})(e.value0)}))(l)),Vf(n)([Qa(n.MonadST5().Monad0())("Table of states and parse actions")]),Es(["Once the states are enumerated, the table of parse actions can be read off:","Terminals can be “shifted” onto the stack, transitioning to a new state seeded by pushing through that terminal in all applicable rules in the current state.","Completely parsed rules will be “reduced” when their lookahead appears, popping the values matching the rule off of the stack and replacing it with the corresponding nonterminal, which then is received by the last state not involved in the rule.","Nonterminals received from another state trigger “gotos” to indicate the next state.","Two types of conflicts may occur: if a terminal indicates both a shift and reduce actions (shift–reduce conflict) or multiple reduce actions (reduce–reduce conflict). Note that there cannot be multiple shift actions at once, so most implementations (including this one) choose to do the shift action in the case of shift–reduce conflict."])(n),v(4)(za(n.MonadST5())((function(e){return Rd(n)({getCurrentState:e.value1.value1})(e.value0)(e.value1.value0)}))(Po(ta(n.MonadST5()))(x(Uo)((function(n){return n.augmented}))(a))(x(Uo)(g(Ge.create))(l)))),Vf(n)([Qa(n.MonadST5().Monad0())("Explore building trees in the grammar")]),Es(["Each rule can be read as a transition: “this nonterminal may be replaced with this sequence of terminals and nonterminals”. Build a tree by following these state transitions, and when it consists of only terminals, send it off to be parsed below!"])(n),v(6)(za(n.MonadST5())(g(Od(n))(s))(B)),Vf(n)([Qa(n.MonadST5().Monad0())("Input custom text to see parsing step-by-step")]),Es(["Text entered here (which may also be generated by the above widgets) will be parsed step-by-step, and the final parse tree displayed if the parse succeeded. (Note that the closing terminal is automatically appended, if necessary.) Check the state tables above to see what state the current input ends up in, and the valid next terminals will be highlighted for entry."])(n),v(2)($f(n)([$f(n)([nv(n)(oe(ce)(za(n.MonadST5())((function(n){return ba(E(P)(bn(wn)([le.value])(x(P)(fe.create)(n)))(N))}))(C))),nv(n)(oe(ce)(za(n.MonadST5())((function(n){return ba(E(P)(n)(h))}))(I)))]),$f(n)([Xf(n)(Sd(n.MonadST5().Monad0().Applicative0())(lf)(tf.value)("terminal"))([Td(n)("Source text")("")(p)((function(n){return u.changeText(new Ge(!1,n))}))])]),$f(n)(oe(ce)(g(za(n.MonadST5()))(U)((function(e){var t=function(n){return function(e){if(e instanceof le)return oe(ac(Xc))(oe(ie)(Qa(n.MonadST5().Monad0())("Parse error")));if(e instanceof fe)return jd(n)(e.value0);throw new Error("Failed pattern match at Parser.Main (line 1187, column 1 - line 1187, column 121): "+[e.constructor.name])}}(n)(e),r=fl(t(0));return Sa()(n)()(gr({reflectSymbol:function(){return"animationTick"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"rate"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"slider"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"startState"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"toggleLeft"}})(Sr(Tr(n.Always2())))(gr({reflectSymbol:function(){return"toggleRight"}})(Sr(Tr(n.Always2())))(Mr)()())()())()())()())()())()())(ca({reflectSymbol:function(){return"animationTick"}})()()(ca({reflectSymbol:function(){return"rate"}})()()(ca({reflectSymbol:function(){return"slider"}})()()(ca({reflectSymbol:function(){return"startState"}})()()(ca({reflectSymbol:function(){return"toggleLeft"}})()()(ca({reflectSymbol:function(){return"toggleRight"}})()()(oa)()()()())()()()())()()()())()()()())()()()())()()()())(T.value)((function(e){return function(t){var u=Pn(na(n.MonadST5().Monad0().Applicative0()))(t.startState)(Xo(n.MonadST5().Monad0().Applicative0())(le.value)),o=Pn(na(n.MonadST5().Monad0().Applicative0()))(t.rate)(Xo(n.MonadST5().Monad0().Applicative0())(1)),a=go(Go(n.MonadST5().Monad0().Applicative0()))(Io(ta(n.MonadST5()))((function(n){return function(e){var t=n.value0?0:e.target;return t>n.value1.beats?new Ge({target:t},le.value):new Ge({target:t+1},new fe(n))}}))(t.animationTick)({target:0})),i=cd(b(nn(G))(tt))(n.MonadST5().Monad0().Applicative0())(n.MonadST5())(Pn(na(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0())(new Ge(0,Zv.value)))(Io(ta(n.MonadST5()))((function(n){return function(e){var t=function(n){return function(e){return function(t){return function(r){return Zn(n)(t)(Jn(n)(e)(r))}}}}(Vn)(0)(r.value1-1|0)(n.value0(e));return new Ge(t,new Ge(t,n.value1))}}))(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([k(Uo)(new Ge((function(n){return n-1|0}),Gv.value))(t.toggleLeft),k(Uo)(new Ge((function(n){return n+1|0}),Gv.value))(t.toggleRight),x(Uo)((function(n){return n.value0?new Ge((function(n){return n===(r.value1-1|0)?0:n+1|0}),Xv.value):new Ge((function(n){return n+1|0}),Xv.value)}))(a),x(Uo)((function(n){return e=y(yi(n)),new Ge(e,Qv.value);var e}))(t.slider)]))(0)));return ga(qo(ta(n.MonadST5()))(Zo(n.MonadST5())(i)((function(a){return yd(Vn)(n.MonadST5())(!1)(x(Uo)(tt)(a))((function(c){var l,f=r.value0(c);return $f(n)([$f(n)([jf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([E(Uo)(Do(ta(n.MonadST5()))(o)(x(Uo)(Ge.create)(u)))((function(u){return Ya(Af)(Sf.value)(function(){if(u.value0 instanceof fe)return function(){return u.value0.value0(),e.startState(le.value)()};if(u.value0 instanceof le){var o=(a=ft(),function(n){return a(n)/1e3});return function(){var a,c,l=x(Lr)(o)(mv)(),f=_o((a=uu,function(n){return function(e){return function(t){return function(r){return We(a.Monad0().Bind1())(ou(a)(kr(oe(a.Monad0().Applicative0())(A))))((function(u){return We(a.Monad0().Bind1())(_o(t)((function(t){return n(t)?Dn(a.Monad0().Bind1().Apply0())(Ye(a.Monad0().Bind1())(ou(a)(Br(u))))(e):r(t)})))((function(n){return Oe($e)(a.Monad0().Bind1())(F(a.Monad0().Bind1().Apply0().Functor0())(ou(a)(Pr(n)(u))))((function(){return oe(a.Monad0().Applicative0())(Ye(a.Monad0().Bind1())(ou(a)(Br(u))))}))}))}))}}}})((function(n){return tt(n.value1)===(r.value1-1|0)&&!n.value0.value0}))(e.startState(le.value))(Po(ta(uu))(Oo(n.Always4())(n.Always1())(n.MonadST5().Monad0().Applicative0())(i))(x(Uo)(Ge.create)(Io(ta(uu))((function(n){return function(e){return new Ge(!1,new Ge(e,n))}}))(gv((c=ta(uu),function(n){return function(e){return Po(c)(Pn(c.Plus0().Alt0())(Ro(c)(n))(e))}})(u.value1)(Oo(n.Always4())(n.Always1())(n.MonadST5().Monad0().Applicative0())(t.rate)))(x(Uo)((function(n){return o(n.time)-l}))(Mv(hv))))(!0)))))((function(n){return e.animationTick(n.value0)}))();return e.startState(new fe(f))()}}var a;throw new Error("Failed pattern match at Parser.Main (line 2405, column 53 - line 2428, column 84): "+[u.value0.constructor.name])}())}))]))([Ga(n.MonadST5().Monad0())(E(Uo)(u)((function(n){if(n instanceof fe)return"Pause";if(n instanceof le)return"Play";throw new Error("Failed pattern match at Parser.Main (line 2432, column 66 - line 2434, column 70): "+[n.constructor.name])})))])]),$f(n)([Qa(n.MonadST5().Monad0())("Speed"),nv(n)(Ye(Le)(x(P)((function(t){return[Kf(n)(pt(St)(ea(n.MonadST5().Monad0().Applicative0()))(Xo(n.MonadST5().Monad0().Applicative0()))([Ya(Lf)(_f.value)("radio"),Ya(ef)(nf.value)(ue(re)("1x"===t.value1)),Ya(yf)(gf.value)("speed"),Ya(Of)(zf.value)(ue(ee)(t.value0)),Ya(Tf)(Sf.value)($a((function(n){return e.rate(t.value0)})))]))([]),Jf(n)([Qa(n.MonadST5().Monad0())(t.value1)])]}))([new Ge(1,"1x"),new Ge(.36787944117144233,"ex"),new Ge(.3183098861837907,"pix")])))]),$f(n)([Kf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([Sd(n.MonadST5().Monad0().Applicative0())(Lf)(_f.value)("range"),Sd(n.MonadST5().Monad0().Applicative0())(bf)(Mf.value)("0"),Sd(n.MonadST5().Monad0().Applicative0())(wf)(hf.value)(ue(te)(r.value1-1|0)),Sd(n.MonadST5().Monad0().Applicative0())(Of)(zf.value)("0"),E(Uo)(So(Qo(n.MonadST5().Monad0().Applicative0()))((function(n){return n.value1 instanceof Qv?le.value:new fe(n.value0)}))(a))((function(n){return Ya(Of)(zf.value)(ue(te)(n))})),dv(n.MonadST5().Monad0().Applicative0())(E(Uo)(u)((function(n){if(n instanceof le)return e.slider;if(n instanceof fe)return function(t){return Dn(Wr)(Dn(Wr)(e.slider(t))(n.value0))(e.startState(le.value))};throw new Error("Failed pattern match at Parser.Main (line 2469, column 75 - line 2473, column 82): "+[n.constructor.name])})))]))([])]),(l=function(n){return(t=Uo,function(n){return x(t)(Ya(n)(Sf.value))})(Af)(E(Uo)(u)((function(t){if(t instanceof le)return n(A);if(t instanceof fe)return Dn(Wr)(Dn(Wr)(n(A))(t.value0))(e.startState(le.value));throw new Error("Failed pattern match at Parser.Main (line 2481, column 47 - line 2485, column 78): "+[t.constructor.name])})));var t},$f(n)([jf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([l(e.toggleLeft)]))([Qa(n.MonadST5().Monad0())("<")]),jf(n)(dt(St)(ea(n.MonadST5().Monad0().Applicative0()))([l(e.toggleRight)]))([Qa(n.MonadST5().Monad0())(">")])])),Uf(n)(Sd(n.MonadST5().Monad0().Applicative0())(pf)(tf.value)("parse-steps"))([f])])}))}))))}}))}))))]))])})))})))})))})))}}))}}}};Yv=Rc(),Vv=function(n){var e=function(n){return JSON.stringify(n)}(js.encode(n)),t=Me()(Cv(e));return function(){var n,r=function(n){return function(){return n.history}}(Yv)();return(n=Bv(e),function(e){return function(t){return function(r){return function(){return r.pushState(n,e,t)}}}})("")("?grammar="+t)(r)()}},Kv=function(){var n=We(Rr)(function(n){return function(){return n.location}}(Yv))(jv)(),e=function(n){return x(he)((function(e){return Ll((t=e,function(n){return n.substr(0,t)})(n));var t}))(Ki("grammar=")(n))}(n);if(e instanceof le)return k(Lr)(le.value)(pv(nc)("No grammar in query"))();if(e instanceof fe){var t=Jl(e.value0+Ll("grammar=")|0)(n),r=Iv(t);if(r instanceof le)return k(Lr)(le.value)(pv(nc)("Failed to decode URL"))();if(r instanceof fe){var u=hl(r.value0);if(u instanceof Fe)return k(Lr)(le.value)(pv(nc)("Failed to parse JSON: "+r.value0))();if(u instanceof Ne){var o=js.decode(u.value0);if(o instanceof le)return k(Lr)(le.value)(pv(nc)("Failed to decode"))();if(o instanceof fe)return new fe(o.value0);throw new Error("Failed pattern match at Parser.Main (line 2199, column 19 - line 2201, column 44): "+[o.constructor.name])}throw new Error("Failed pattern match at Parser.Main (line 2196, column 15 - line 2201, column 44): "+[u.constructor.name])}throw new Error("Failed pattern match at Parser.Main (line 2193, column 11 - line 2201, column 44): "+[r.constructor.name])}throw new Error("Failed pattern match at Parser.Main (line 2187, column 7 - line 2201, column 44): "+[e.constructor.name])},Hv=function(n){return function(){var e,t,r=(e=function(e){return je(Rr)(mt(zr)(yt)(n))(Kv)},function(){return function(n){return e()()}})();return(t=r,function(n){return function(e){return function(){return e.addEventListener("popstate",t,n)}}})(!1)(Dc(Yv))(),function(n){return function(e){return function(t){return function(){return t.removeEventListener("popstate",n,e)}}}}(r)(!1)(Dc(Yv))}},Jv=x(Lr)(we(id))(Kv)(),(Uv=function(n){return Ud(n)(Jv)(Hv)(Vv)}(ya),F(Lr)(($v=Uv,function(){var n=We(Rr)(We(Rr)(Rc)(Ic))(kc)();return de(En(Ur(Ur(yn))))((function(n){return zc(n)($v)}))(x(he)(Bc)(n))()})))()})()})();