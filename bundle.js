(()=>{"use strict";var n=function(n){return function(e){return function(t){return function(u){return function(r){return u<r?n:u===r?e:t}}}}};const e=n,t=n;var u=function(n){return function(e){return n===e}};const r=u,a=u,o=u;var i=function(n){return n.reflectSymbol};const c=function(n){return function(e){return e[n]}},f=function(n){return function(e){return function(t){var u={};for(var r in t)({}).hasOwnProperty.call(t,r)&&(u[r]=t[r]);return u[n]=e,u}}};var l=function(){function n(){}return n.value=new n,n}(),v={eqRecord:function(n){return function(n){return function(n){return!0}}}},s=function(n){return n.eqRecord},p=function(){return function(n){return{eq:s(n)(l.value)}}},d={eq:a},m={eq:o},w={eq:r},h=function(n){return n.eq},M=function(n){return{eq:(e=h(n),function(n){return function(t){if(n.length!==t.length)return!1;for(var u=0;u<n.length;u++)if(!e(n[u])(t[u]))return!1;return!0}})};var e},y=function(n){return function(){return function(e){return function(t){return{eqRecord:function(u){return function(u){return function(r){var a=s(n)(l.value)(u)(r),o=i(e)(l.value),f=c(o);return h(t)(f(u))(f(r))&&a}}}}}}}},g=function(){function n(){}return n.value=new n,n}(),E=function(){function n(){}return n.value=new n,n}(),S=function(){function n(){}return n.value=new n,n}(),A={eq:function(n){return function(e){return n instanceof g&&e instanceof g||n instanceof E&&e instanceof E||n instanceof S&&e instanceof S}}};const F=void 0;var b={add:function(n){return function(e){return n+e}},zero:0,mul:function(n){return function(e){return n*e}},one:1},k={add:function(n){return function(e){return n+e|0}},zero:0,mul:function(n){return function(e){return n*e|0}},one:1},T=function(n){return n.add},P={sub:function(n){return function(e){return n-e}},Semiring0:function(){return b}},_={sub:function(n){return function(e){return n-e|0}},Semiring0:function(){return k}},B=function(){return{compare:e(g.value)(S.value)(E.value),Eq0:function(){return d}}}(),q=function(){return{compare:t(g.value)(S.value)(E.value),Eq0:function(){return m}}}(),N=function(n){return n.compare},R={compose:function(n){return function(e){return function(t){return n(e(t))}}}},x=function(n){return n.compose},L=function(n){return n.identity},D={identity:function(n){return n},Semigroupoid0:function(){return R}},I=function(n){return function(e){return function(t){return n(t)(e)}}},C=function(n){return function(e){return n}},O=function(n){return function(e){return e(n)}},z=function(n){return n.map},j=function(n){return function(e){return function(t){return z(n)(t)(e)}}},W=function(n){return z(n)(C(F))},$=function(n){return function(e){return z(n)(C(e))}},G={map:x(R)},V={map:function(n){return function(e){for(var t=e.length,u=new Array(t),r=0;r<t;r++)u[r]=n(e[r]);return u}}},Y=function(n){return function(e){return function(t){return z(n)((function(n){return n(t)}))(e)}}},U={apply:function(n){return function(e){return function(t){return n(t)(e(t))}}},Functor0:function(){return G}},H={apply:function(n){return function(e){for(var t=n.length,u=e.length,r=new Array(t*u),a=0,o=0;o<t;o++)for(var i=n[o],c=0;c<u;c++)r[a++]=i(e[c]);return r}},Functor0:function(){return V}},J=function(n){return n.apply},Q=function(n){return function(e){return function(t){return J(n)(z(n.Functor0())(C(L(D)))(e))(t)}}},X=function(n){return function(e){return function(t){return function(u){return J(n)(z(n.Functor0())(e)(t))(u)}}}},K=function(n){return n.pure},Z=function(n){return function(e){return function(t){if(e)return t;if(!e)return K(n)(F);throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[e.constructor.name,t.constructor.name])}}},nn={pure:function(n){return function(e){return n}},Apply0:function(){return U}},en={pure:function(n){return[n]},Apply0:function(){return H}},tn=function(n){return n.discard},un={bind:function(n){return function(e){for(var t=[],u=0,r=n.length;u<r;u++)Array.prototype.push.apply(t,e(n[u]));return t}},Apply0:function(){return H}},rn=function(n){return n.bind},an=function(n){return I(rn(n))},on=function(n){return function(e){return function(t){return function(u){return rn(n)(e(u))(t)}}}},cn={discard:function(n){return rn(n)}},fn=function(n){return function(e){return rn(n)(e)(L(D))}};const ln=function(n){return n};var vn=ln;const sn=function(n){return function(e){return function(){for(var t=0,u=n.length;t<u;t++)e(n[t])()}}};function pn(n){return function(){return{value:n}}}const dn=function(n){return function(){return n.value}},mn=function(n){return function(e){return function(){return e.value=n}}};var wn=function(n){return function(e){return function(t){return rn(n.Bind1())(e)((function(e){return rn(n.Bind1())(t)((function(t){return K(n.Applicative0())(e(t))}))}))}}},hn={append:function(n){return function(n){return F}}},Mn={append:function(n){return function(e){return n+e}}},yn={appendRecord:function(n){return function(n){return function(n){return{}}}}},gn={append:function(n){return function(e){return 0===n.length?e:0===e.length?n:n.concat(e)}}},En=function(n){return n.appendRecord},Sn=function(n){return n.append},An={alt:Sn(gn),Functor0:function(){return V}},Fn=function(n){return n.alt};const bn=String.fromCharCode(65535),kn=String.fromCharCode(0);Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY;var Tn=function(n){return n.top},Pn={top:2147483647,bottom:-2147483648,Ord0:function(){return B}},_n={top:bn,bottom:kn,Ord0:function(){return q}},Bn=function(n){return n.bottom},qn={show:function(n){var e=n.length;return'"'+n.replace(/[\0-\x1F\x7F"\\]/g,(function(t,u){switch(t){case'"':case"\\":return"\\"+t;case"":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\v":return"\\v"}var r=u+1,a=r<e&&n[r]>="0"&&n[r]<="9"?"\\&":"";return"\\"+t.charCodeAt(0).toString(10)+a}))+'"'}},Nn={show:function(n){var e=n.toString();return isNaN(e+".0")?e:e+".0"}},Rn={show:function(n){return n.toString()}},xn={show:function(n){if(n)return"true";if(!n)return"false";throw new Error("Failed pattern match at Data.Show (line 23, column 1 - line 25, column 23): "+[n.constructor.name])}},Ln=function(n){return n.show},Dn=function(n){return{show:(e=Ln(n),function(n){for(var t=[],u=0,r=n.length;u<r;u++)t[u]=e(n[u]);return"["+t.join(",")+"]"})};var e},In=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Cn=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),On=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),zn=function(){function n(){}return n.value=new n,n}(),jn=function(){function n(){}return n.value=new n,n}(),Wn=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),$n=function(n){return{show:function(e){if(e instanceof Wn)return"(Just "+Ln(n)(e.value0)+")";if(e instanceof jn)return"Nothing";throw new Error("Failed pattern match at Data.Maybe (line 223, column 1 - line 225, column 28): "+[e.constructor.name])}}},Gn=function(n){return function(e){return function(t){if(t instanceof jn)return n;if(t instanceof Wn)return e(t.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},Vn=Gn(!0)(C(!1)),Yn={map:function(n){return function(e){return e instanceof Wn?new Wn(n(e.value0)):jn.value}}},Un=function(n){return Gn(n)(L(D))},Hn=function(){return function(n){if(n instanceof Wn)return n.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[n.constructor.name])}},Jn=function(n){return{eq:function(e){return function(t){return e instanceof jn&&t instanceof jn||e instanceof Wn&&t instanceof Wn&&h(n)(e.value0)(t.value0)}}}},Qn=function(n){return{compare:function(e){return function(t){if(e instanceof jn&&t instanceof jn)return S.value;if(e instanceof jn)return g.value;if(t instanceof jn)return E.value;if(e instanceof Wn&&t instanceof Wn)return N(n)(e.value0)(t.value0);throw new Error("Failed pattern match at Data.Maybe (line 0, column 0 - line 0, column 0): "+[e.constructor.name,t.constructor.name])}},Eq0:function(){return Jn(n.Eq0())}}},Xn={apply:function(n){return function(e){if(n instanceof Wn)return z(Yn)(n.value0)(e);if(n instanceof jn)return jn.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[n.constructor.name,e.constructor.name])}},Functor0:function(){return Yn}},Kn={bind:function(n){return function(e){if(n instanceof Wn)return e(n.value0);if(n instanceof jn)return jn.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[n.constructor.name,e.constructor.name])}},Apply0:function(){return Xn}},Zn=function(){return{pure:Wn.create,Apply0:function(){return Xn}}}(),ne={Applicative0:function(){return Zn},Bind1:function(){return Kn}},ee={alt:function(n){return function(e){return n instanceof jn?e:n}},Functor0:function(){return Yn}},te=function(){return{empty:jn.value,Alt0:function(){return ee}}}(),ue=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),re=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ae={map:function(n){return function(e){if(e instanceof ue)return new ue(e.value0);if(e instanceof re)return new re(n(e.value0));throw new Error("Failed pattern match at Data.Either (line 0, column 0 - line 0, column 0): "+[e.constructor.name])}}},oe=function(n){return function(e){return function(t){if(t instanceof ue)return n(t.value0);if(t instanceof re)return e(t.value0);throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},ie=function(){return oe(C(jn.value))(Wn.create)}(),ce={apply:function(n){return function(e){if(n instanceof ue)return new ue(n.value0);if(n instanceof re)return z(ae)(n.value0)(e);throw new Error("Failed pattern match at Data.Either (line 70, column 1 - line 72, column 30): "+[n.constructor.name,e.constructor.name])}},Functor0:function(){return ae}},fe=function(){return{pure:re.create,Apply0:function(){return ce}}}(),le={map:function(n){return function(e){return n(e)}}},ve={apply:function(n){return function(e){return n(e)}},Functor0:function(){return le}},se={bind:function(n){return function(e){return e(n)}},Apply0:function(){return ve}},pe={pure:function(n){return n},Apply0:function(){return ve}},de={Applicative0:function(){return pe},Bind1:function(){return se}},me={Ring0:function(){return P}},we={Ring0:function(){return _}},he={degree:function(n){return 1},div:function(n){return function(e){return n/e}},mod:function(n){return function(n){return 0}},CommutativeRing0:function(){return me}},Me={degree:function(n){return Math.min(Math.abs(n),2147483647)},div:function(n){return function(e){return 0===e?0:e>0?Math.floor(n/e):-Math.floor(n/-e)}},mod:function(n){return function(e){if(0===e)return 0;var t=Math.abs(e);return(n%t+t)%t}},CommutativeRing0:function(){return we}},ye={mempty:F,Semigroup0:function(){return hn}},ge={mempty:"",Semigroup0:function(){return Mn}},Ee={memptyRecord:function(n){return{}},SemigroupRecord0:function(){return yn}},Se={mempty:[],Semigroup0:function(){return gn}},Ae=function(n){return n.memptyRecord},Fe=function(n){return n.mempty},be=function(n){return function(e){return function(){return function(t){return{memptyRecord:function(u){var r=Ae(t)(l.value),a=i(n)(l.value);return f(a)(Fe(e))(r)},SemigroupRecord0:function(){return function(n){return function(){return function(e){return function(t){return{appendRecord:function(u){return function(u){return function(r){var a=En(e)(l.value)(u)(r),o=i(n)(l.value),v=f(o),s=c(o);return v(Sn(t)(s(u))(s(r)))(a)}}}}}}}}(n)()(t.SemigroupRecord0())(e.Semigroup0())}}}}}};const ke=function(n){return function(){return n}};var Te=function(n,e,t){var u,r=0;return function(a){if(2===r)return u;if(1===r)throw new ReferenceError(n+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=t(),r=2,u}},Pe={Applicative0:function(){return Be},Bind1:function(){return _e}},_e={bind:function(n){return function(e){return function(){return e(n())()}}},Apply0:function(){return Ne(0)}},Be={pure:ke,Apply0:function(){return Ne(0)}},qe=Te("functorEffect","Effect",(function(){return{map:(n=Be,function(e){return function(t){return J(n.Apply0())(K(n)(e))(t)}})};var n})),Ne=Te("applyEffect","Effect",(function(){return{apply:wn(Pe),Functor0:function(){return qe(0)}}})),Re=qe(20),xe=Ne(23),Le=function(n){return{mempty:ke(Fe(n)),Semigroup0:function(){return e=n.Semigroup0(),{append:X(xe)(Sn(e))};var e}}};const De=function(n){return function(){return n.value}};var Ie=function(n){return function(){return{value:n}}},Ce=function(n,e,t){var u,r=0;return function(a){if(2===r)return u;if(1===r)throw new ReferenceError(n+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=t(),r=2,u}},Oe=function(n){return function(n){return function(e){return function(){var t=n(e.value);return e.value=t.state,t.value}}}((function(e){var t=n(e);return{state:t,value:t}}))},ze={map:function(n){return function(e){return function(){return n(e())}}}},je={Applicative0:function(){return $e},Bind1:function(){return We}},We={bind:function(n){return function(e){return function(){return e(n())()}}},Apply0:function(){return Ge(0)}},$e={pure:function(n){return function(){return n}},Apply0:function(){return Ge(0)}},Ge=Ce("applyST","Control.Monad.ST.Internal",(function(){return{apply:wn(je),Functor0:function(){return ze}}})),Ve={liftST:vn,Monad0:function(){return Pe}},Ye=function(n){return n.liftST};const Ue=function(n){return function(e){for(var t=n>e?-1:1,u=new Array(t*(e-n)+1),r=n,a=0;r!==e;)u[a++]=r,r+=t;return u[a]=r,u}};Array.prototype.fill;const He=function(n){return n.length},Je=function(n){return function(e){return function(t){return 0===t.length?n({}):e(t[0])(t.slice(1))}}},Qe=function(n){return function(e){return e.filter(n)}},Xe=function(){function n(e,t,u,r,a,o){var i,c,f,l,v,s;for((i=a+(o-a>>1))-a>1&&n(e,t,r,u,a,i),o-i>1&&n(e,t,r,u,i,o),c=a,f=i,l=a;c<i&&f<o;)v=r[c],s=r[f],t(e(v)(s))>0?(u[l++]=s,++f):(u[l++]=v,++c);for(;c<i;)u[l++]=r[c++];for(;f<o;)u[l++]=r[f++]}return function(e){return function(t){return function(u){var r;return u.length<2?u:(r=u.slice(0),n(e,t,r,u.slice(0),0,u.length),r)}}}}(),Ke=function(n){return function(e){return function(t){return t.slice(n,e)}}},Ze=function(n){return function(e){return n[e]}},nt=function(n){return function(){return n}};const et=function(n){return function(){return n.slice()}};var tt=function(n){return e=[n],function(n){return function(){return n.push.apply(n,e)}};var e},ut=function(n){return n.not},rt=function(n){return n.disj},at={ff:!1,tt:!0,implies:function(n){return function(e){return rt(at)(ut(at)(n))(e)}},conj:function(n){return function(e){return n&&e}},disj:function(n){return function(e){return n||e}},not:function(n){return!n}},ot=function(n){return{ff:function(e){return n.ff},tt:function(e){return n.tt},implies:function(e){return function(t){return function(u){return n.implies(e(u))(t(u))}}},conj:function(e){return function(t){return function(u){return n.conj(e(u))(t(u))}}},disj:function(e){return function(t){return function(u){return rt(n)(e(u))(t(u))}}},not:function(e){return function(t){return ut(n)(e(t))}}}},it=function(n){return n.empty},ct=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),ft=function(n){return n.value1},lt=function(n){return function(e){return{show:function(t){return"(Tuple "+Ln(n)(t.value0)+" "+Ln(e)(t.value1)+")"}}}},vt=function(n){return function(e){return{append:function(t){return function(u){return new ct(Sn(n)(t.value0)(u.value0),Sn(e)(t.value1)(u.value1))}}}}},st=function(n){return function(e){return{mempty:new ct(Fe(n),Fe(e)),Semigroup0:function(){return vt(n.Semigroup0())(e.Semigroup0())}}}},pt={map:function(n){return function(e){return new ct(e.value0,n(e.value1))}}},dt=function(n){return n.value0},mt=function(n){return n.bimap},wt=function(n){return function(e){return mt(n)(e)(L(D))}},ht={bimap:function(n){return function(e){return function(t){return new ct(n(t.value0),e(t.value1))}}}},Mt=function(n){return{mempty:L(n),Semigroup0:function(){return e=n.Semigroupoid0(),{append:function(n){return function(t){return x(e)(n)(t)}}};var e}}},yt=function(){return ln},gt=yt,Et=function(){return function(){return function(n){return yt()}}},St=function(n){return n.foldr},At=function(n){return function(e){return St(n)(Fn(e.Alt0()))(it(e))}},Ft=function(n){return function(e){return function(t){return St(n)((u=Fn(e.Alt0()),function(n){return u(t(n))}))(it(e));var u}}},bt=function(n){return function(e){return function(t){return St(e)((u=Q(n.Apply0()),function(n){return u(t(n))}))(K(n)(F));var u}}},kt=function(n){return function(e){return I(bt(n)(e))}},Tt=function(n){return function(e){return bt(n)(e)(L(D))}},Pt=function(n){return n.foldl},_t={foldr:function(n){return function(e){return function(t){if(t instanceof jn)return e;if(t instanceof Wn)return n(t.value0)(e);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},foldl:function(n){return function(e){return function(t){if(t instanceof jn)return e;if(t instanceof Wn)return n(e)(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},foldMap:function(n){return function(e){return function(t){if(t instanceof jn)return Fe(n);if(t instanceof Wn)return e(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[e.constructor.name,t.constructor.name])}}}},Bt={foldr:function(n){return function(e){return function(t){for(var u=e,r=t.length-1;r>=0;r--)u=n(t[r])(u);return u}}},foldl:function(n){return function(e){return function(t){for(var u=e,r=t.length,a=0;a<r;a++)u=n(u)(t[a]);return u}}},foldMap:function(n){return(e=Bt,function(n){return function(t){return St(e)((function(e){return function(u){return Sn(n.Semigroup0())(t(e))(u)}}))(Fe(n))}})(n);var e}},qt=function(n){return n.foldMap};const Nt=function(){function n(n){return[n]}function e(n){return function(e){return[n,e]}}function t(n){return function(e){return function(t){return[n,e,t]}}}function u(n){return function(e){return n.concat(e)}}return function(r){return function(a){return function(o){return function(i){return function(c){return function f(l,v){switch(v-l){case 0:return o([]);case 1:return a(n)(i(c[l]));case 2:return r(a(e)(i(c[l])))(i(c[l+1]));case 3:return r(r(a(t)(i(c[l])))(i(c[l+1])))(i(c[l+2]));default:var s=l+2*Math.floor((v-l)/4);return r(a(u)(f(l,s)))(f(s,v))}}(0,c.length)}}}}}}();var Rt={map:function(n){return function(e){return function(t){var u=e(t);return{accum:u.accum,value:n(u.value)}}}}},xt={apply:function(n){return function(e){return function(t){var u=n(t),r=e(u.accum);return{accum:r.accum,value:u.value(r.value)}}}},Functor0:function(){return Rt}},Lt={pure:function(n){return function(e){return{accum:e,value:n}}},Apply0:function(){return xt}},Dt=function(n){return n.traverse},It={traverse:function(n){return Nt(J(n.Apply0()))(z(n.Apply0().Functor0()))(K(n))},sequence:function(n){return(e=It,function(n){return Dt(e)(n)(L(D))})(n);var e},Functor0:function(){return V},Foldable1:function(){return Bt}};const Ct=function(n){return function(e){return function(t){return function(u){return function(r){return function(a){for(var o=[],i=a;;){var c=r(i);if(n(c))return o;var f=e(c);o.push(t(f)),i=u(f)}}}}}}},Ot=function(n){return function(e){return function(t){return function(u){return function(r){return function(a){for(var o=[],i=a;;){var c=r(i);o.push(t(c));var f=u(c);if(n(f))return o;i=e(f)}}}}}}};var zt={unfoldr1:Ot(Vn)(Hn())(dt)(ft)},jt=function(n){return n.unfoldr},Wt={unfoldr:Ct(Vn)(Hn())(dt)(ft),Unfoldable10:function(){return zt}},$t=function(){return Je(C(jn.value))((function(n){return function(e){return new Wn({head:n,tail:e})}}))}(),Gt=function(n){return function(e){var t=He(e);return jt(n)((function(n){return n<t?new Wn(new ct(Ze(e)(n),n+1|0)):jn.value}))(0)}},Vt=function(n){return Xe(n)((function(n){if(n instanceof E)return 1;if(n instanceof S)return 0;if(n instanceof g)return-1;throw new Error("Failed pattern match at Data.Array (line 829, column 31 - line 832, column 11): "+[n.constructor.name])}))},Yt=function(n){return function(e){return(t=tt(e),function(n){return function(){var e=et(n)();return t(e)(),nt(e)()}})(n)();var t}},Ut=function(n){return[n]},Ht=function(n){return function(n){return function(e){return t=[],sn(e)((function(e){return function(){var u,r,a=z(ze)((u=ut(at),r=function(t){for(var u=t.length,r=0;r<u;r++)if(a=t[r],n(a)(e))return!0;var a;return!1},function(n){return u(r(n))}))(nt(t))();return Z($e)(a)(W(ze)(tt(e)(t)))()}}))(),nt(t)();var t}}(h(n))},Jt=function(){return(n=Wn.create,function(e){return function(t){return function(u){return u<0||u>=t.length?e:n(t[u])}}})(jn.value);var n}(),Qt=function(n){return Jt(n)(He(n)-1|0)},Xt=function(n){return Jt(n)(0)},Kt=function(n){return function(e){var t,u,r,a=Vt((function(e){return function(t){return n(ft(e))(ft(t))}}))((t=ct.create,function(n){return function(n){return function(e){return function(t){for(var u=e.length<t.length?e.length:t.length,r=new Array(u),a=0;a<u;a++)r[a]=n(e[a])(t[a]);return r}}}(t)(Ue(0)(He(n)-1|0))(n)})(e)),o=Xt(a);if(o instanceof jn)return[];if(o instanceof Wn)return z(V)(ft)((r=B,function(n){return Vt(function(n){return function(e){return function(t){return function(u){return N(n)(e(t))(e(u))}}}}(r)(n))})(dt)((u=function(n){return function(){return n}}(Ut(o.value0))(),sn(a)((function(e){return function(){var t,r,a,o=z(ze)((t=Hn(),r=function(n){return t(Qt(n))},function(n){return ft(r(n))}))(nt(u))();return Z($e)((a=A,function(n){return function(e){return h(w)(h(a)(n)(e))(!1)}})(n(o)(e.value1))(S.value))(W(ze)(tt(e)(u)))()}}))(),nt(u)())));throw new Error("Failed pattern match at Data.Array (line 1044, column 17 - line 1052, column 29): "+[o.constructor.name])}},Zt=function(n){return Kt(N(n))},nu=Pt(Bt),eu=function(n){return function(e){return function(t){return Je((function(e){return K(n.Applicative0())(t)}))((function(u){return function(r){return rn(n.Bind1())(e(t)(u))((function(t){return eu(n)(e)(t)(r)}))}}))}}},tu=function(){return(n=Wn.create,function(e){return function(t){return function(u){for(var r=0,a=u.length;r<a;r++)if(t(u[r]))return n(r);return e}}})(jn.value);var n}(),uu=function(){return(n=Wn.create,function(e){return function(t){return function(u){if(t<0||t>=u.length)return e;var r=u.slice();return r.splice(t,1),n(r)}}})(jn.value);var n}(),ru=function(n){return function(e){return function(t){return 0===t.length?[]:Gn(t)((function(n){return Hn()(uu(n)(t))}))(tu(n(e))(t))}}},au=I(rn(un)),ou=function(n){return au((e=Gn([])(Ut),function(t){return e(n(t))}));var e},iu=ou(L(D)),cu=function(n){return n.mapWithIndex},fu={mapWithIndex:function(n){return function(e){for(var t=e.length,u=Array(t),r=0;r<t;r++)u[r]=n(r)(e[r]);return u}},Functor0:function(){return V}},lu=function(n){return n.foldrWithIndex},vu=function(n){return n.foldlWithIndex},su={foldrWithIndex:function(n){return function(e){var t=St(Bt)((function(e){return function(t){return n(e.value0)(e.value1)(t)}}))(e),u=cu(fu)(ct.create);return function(n){return t(u(n))}}},foldlWithIndex:function(n){return function(e){var t=Pt(Bt)((function(e){return function(t){return n(t.value0)(e)(t.value1)}}))(e),u=cu(fu)(ct.create);return function(n){return t(u(n))}}},foldMapWithIndex:function(n){return(e=su,function(n){return function(t){return lu(e)((function(e){return function(u){return function(r){return Sn(n.Semigroup0())(t(e)(u))(r)}}}))(Fe(n))}})(n);var e},Foldable0:function(){return Bt}},pu=function(n){return n.foldMapWithIndex},du={traverseWithIndex:function(n){return(e=du,function(n){return function(t){var u=e.Traversable2().sequence(n),r=cu(e.FunctorWithIndex0())(t);return function(n){return u(r(n))}}})(n);var e},FunctorWithIndex0:function(){return fu},FoldableWithIndex1:function(){return su},Traversable2:function(){return It}},mu=function(){function n(){}return n.value=new n,n}(),wu=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),hu={map:function(n){var e;return e=mu.value,function(t){var u,r=e,a=!1;function o(e,u){return u instanceof wu&&u.value1 instanceof wu&&u.value1.value1 instanceof wu?(r=new wu(u,e),void(t=u.value1.value1.value1)):(a=!0,(i=e,function(e){for(var t,u,r,a=i,o=!1;!o;)r=e,t=(u=a)instanceof wu&&u.value0 instanceof wu&&u.value0.value1 instanceof wu&&u.value0.value1.value1 instanceof wu?(a=u.value1,void(e=new wu(n(u.value0.value0),new wu(n(u.value0.value1.value0),new wu(n(u.value0.value1.value1.value0),r))))):(o=!0,r);return t})((o=u)instanceof wu&&o.value1 instanceof wu&&o.value1.value1 instanceof mu?new wu(n(o.value0),new wu(n(o.value1.value0),mu.value)):o instanceof wu&&o.value1 instanceof mu?new wu(n(o.value0),mu.value):mu.value));var o,i}for(;!a;)u=o(r,t);return u}}},Mu={foldr:function(n){return function(e){var t,u=(t=mu.value,function(n){var e,u=t,r=!1;function a(e,t){if(t instanceof mu)return r=!0,e;if(t instanceof wu)return u=new wu(t.value0,e),void(n=t.value1);throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[e.constructor.name,t.constructor.name])}for(;!r;)e=a(u,n);return e}),r=Pt(Mu)(I(n))(e);return function(n){return r(u(n))}}},foldl:function(n){return function(e){return function(t){var u,r=e,a=!1;function o(e,u){if(u instanceof mu)return a=!0,e;if(u instanceof wu)return r=n(e)(u.value0),void(t=u.value1);throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[u.constructor.name])}for(;!a;)u=o(r,t);return u}}},foldMap:function(n){return function(e){return Pt(Mu)((function(t){var u=Sn(n.Semigroup0())(t);return function(n){return u(e(n))}}))(Fe(n))}}},yu={unfoldr1:function(n){return function(e){var t;return(t=e,function(e){var u,r=t,a=!1;function o(t,u){var o=n(t);if(o.value1 instanceof Wn)return r=o.value1.value0,void(e=new wu(o.value0,u));if(o.value1 instanceof jn)return a=!0,Pt(Mu)(I(wu.create))(mu.value)(new wu(o.value0,u));throw new Error("Failed pattern match at Data.List.Types (line 135, column 22 - line 137, column 61): "+[o.constructor.name])}for(;!a;)u=o(r,e);return u})(mu.value)}}},gu={unfoldr:function(n){return function(e){var t;return(t=e,function(e){var u,r=t,a=!1;function o(t,u){var o=n(t);if(o instanceof jn)return a=!0,Pt(Mu)(I(wu.create))(mu.value)(u);if(o instanceof Wn)return r=o.value0.value1,void(e=new wu(o.value0.value0,u));throw new Error("Failed pattern match at Data.List.Types (line 142, column 22 - line 144, column 52): "+[o.constructor.name])}for(;!a;)u=o(r,e);return u})(mu.value)}},Unfoldable10:function(){return yu}},Eu=function(){var n;return n=mu.value,function(e){var t,u=n,r=!1;function a(n,t){if(t instanceof mu)return r=!0,n;if(t instanceof wu)return u=new wu(t.value0,n),void(e=t.value1);throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[n.constructor.name,t.constructor.name])}for(;!r;)t=a(u,e);return t}}();const Su=function(n){throw new Error(n)};var Au=function(n){return function(){return Su(n)}()},Fu=function(){function n(){}return n.value=new n,n}(),bu=function(){function n(n,e,t,u){this.value0=n,this.value1=e,this.value2=t,this.value3=u}return n.create=function(e){return function(t){return function(u){return function(r){return new n(e,t,u,r)}}}},n}(),ku=function(){function n(n,e,t,u,r,a,o){this.value0=n,this.value1=e,this.value2=t,this.value3=u,this.value4=r,this.value5=a,this.value6=o}return n.create=function(e){return function(t){return function(u){return function(r){return function(a){return function(o){return function(i){return new n(e,t,u,r,a,o,i)}}}}}}},n}(),Tu=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(u){return new n(e,t,u)}}},n}(),Pu=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(u){return new n(e,t,u)}}},n}(),_u=function(){function n(n,e,t,u,r,a){this.value0=n,this.value1=e,this.value2=t,this.value3=u,this.value4=r,this.value5=a}return n.create=function(e){return function(t){return function(u){return function(r){return function(a){return function(o){return new n(e,t,u,r,a,o)}}}}}},n}(),Bu=function(){function n(n,e,t,u,r,a){this.value0=n,this.value1=e,this.value2=t,this.value3=u,this.value4=r,this.value5=a}return n.create=function(e){return function(t){return function(u){return function(r){return function(a){return function(o){return new n(e,t,u,r,a,o)}}}}}},n}(),qu=function(){function n(n,e,t,u,r,a){this.value0=n,this.value1=e,this.value2=t,this.value3=u,this.value4=r,this.value5=a}return n.create=function(e){return function(t){return function(u){return function(r){return function(a){return function(o){return new n(e,t,u,r,a,o)}}}}}},n}(),Nu=function(){function n(n,e,t,u){this.value0=n,this.value1=e,this.value2=t,this.value3=u}return n.create=function(e){return function(t){return function(u){return function(r){return new n(e,t,u,r)}}}},n}(),Ru=function(n){return function(e){return new bu(Fu.value,n,e,Fu.value)}},xu=function(n){return function(e){return jt(n)((function(n){var e,t=!1;function u(e){if(e instanceof mu)return t=!0,jn.value;if(e instanceof wu){if(e.value0 instanceof Fu)return void(n=e.value1);if(e.value0 instanceof bu&&e.value0.value0 instanceof Fu&&e.value0.value3 instanceof Fu)return t=!0,new Wn(new ct(new ct(e.value0.value1,e.value0.value2),e.value1));if(e.value0 instanceof bu&&e.value0.value0 instanceof Fu)return t=!0,new Wn(new ct(new ct(e.value0.value1,e.value0.value2),new wu(e.value0.value3,e.value1)));if(e.value0 instanceof bu)return void(n=new wu(e.value0.value0,new wu(Ru(e.value0.value1)(e.value0.value2),new wu(e.value0.value3,e.value1))));if(e.value0 instanceof ku)return void(n=new wu(e.value0.value0,new wu(Ru(e.value0.value1)(e.value0.value2),new wu(e.value0.value3,new wu(Ru(e.value0.value4)(e.value0.value5),new wu(e.value0.value6,e.value1))))));throw new Error("Failed pattern match at Data.Map.Internal (line 624, column 18 - line 633, column 71): "+[e.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 623, column 3 - line 623, column 19): "+[e.constructor.name])}for(;!t;)e=u(n);return e}))(new wu(e,mu.value))}},Lu=function(n){return function(e){var t=N(n);return function(n){var u,r=!1;function a(u){if(u instanceof Fu)return r=!0,jn.value;if(u instanceof bu){var a=t(e)(u.value1);return a instanceof S?(r=!0,new Wn(u.value2)):a instanceof g?void(n=u.value0):void(n=u.value3)}if(u instanceof ku){var o=t(e)(u.value1);if(o instanceof S)return r=!0,new Wn(u.value2);var i=t(e)(u.value4);return i instanceof S?(r=!0,new Wn(u.value5)):o instanceof g?void(n=u.value0):i instanceof E?void(n=u.value6):void(n=u.value3)}throw new Error("Failed pattern match at Data.Map.Internal (line 241, column 5 - line 241, column 22): "+[u.constructor.name])}for(;!r;)u=a(n);return u}}},Du={map:function(n){return function(e){if(e instanceof Fu)return Fu.value;if(e instanceof bu)return new bu(z(Du)(n)(e.value0),e.value1,n(e.value2),z(Du)(n)(e.value3));if(e instanceof ku)return new ku(z(Du)(n)(e.value0),e.value1,n(e.value2),z(Du)(n)(e.value3),e.value4,n(e.value5),z(Du)(n)(e.value6));throw new Error("Failed pattern match at Data.Map.Internal (line 116, column 1 - line 119, column 110): "+[n.constructor.name,e.constructor.name])}}},Iu=function(n){return function(e){return function(t){var u,r=n,a=e,o=!1;function i(n,e,u){if(e instanceof mu)return o=!0,u;if(e instanceof wu){if(e.value0 instanceof Tu)return r=n,a=e.value1,void(t=new bu(u,e.value0.value0,e.value0.value1,e.value0.value2));if(e.value0 instanceof Pu)return r=n,a=e.value1,void(t=new bu(e.value0.value0,e.value0.value1,e.value0.value2,u));if(e.value0 instanceof _u)return r=n,a=e.value1,void(t=new ku(u,e.value0.value0,e.value0.value1,e.value0.value2,e.value0.value3,e.value0.value4,e.value0.value5));if(e.value0 instanceof Bu)return r=n,a=e.value1,void(t=new ku(e.value0.value0,e.value0.value1,e.value0.value2,u,e.value0.value3,e.value0.value4,e.value0.value5));if(e.value0 instanceof qu)return r=n,a=e.value1,void(t=new ku(e.value0.value0,e.value0.value1,e.value0.value2,e.value0.value3,e.value0.value4,e.value0.value5,u));throw new Error("Failed pattern match at Data.Map.Internal (line 462, column 3 - line 467, column 88): "+[e.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 459, column 1 - line 459, column 80): "+[e.constructor.name,u.constructor.name])}for(;!o;)u=i(r,a,t);return u}}},Cu=function(n){return function(e){return function(t){var u,r=N(n);return u=mu.value,function(a){var o,i=u,c=!1;function f(u,o){if(o instanceof Fu)return c=!0,function(e){return function(t){var u,r=e,a=!1;function o(e,u){if(e instanceof mu)return a=!0,new bu(u.value0,u.value1,u.value2,u.value3);if(e instanceof wu){if(e.value0 instanceof Tu)return a=!0,Iu(n)(e.value1)(new ku(u.value0,u.value1,u.value2,u.value3,e.value0.value0,e.value0.value1,e.value0.value2));if(e.value0 instanceof Pu)return a=!0,Iu(n)(e.value1)(new ku(e.value0.value0,e.value0.value1,e.value0.value2,u.value0,u.value1,u.value2,u.value3));if(e.value0 instanceof _u)return r=e.value1,void(t=new Nu(new bu(u.value0,u.value1,u.value2,u.value3),e.value0.value0,e.value0.value1,new bu(e.value0.value2,e.value0.value3,e.value0.value4,e.value0.value5)));if(e.value0 instanceof Bu)return r=e.value1,void(t=new Nu(new bu(e.value0.value0,e.value0.value1,e.value0.value2,u.value0),u.value1,u.value2,new bu(u.value3,e.value0.value3,e.value0.value4,e.value0.value5)));if(e.value0 instanceof qu)return r=e.value1,void(t=new Nu(new bu(e.value0.value0,e.value0.value1,e.value0.value2,e.value0.value3),e.value0.value4,e.value0.value5,new bu(u.value0,u.value1,u.value2,u.value3)));throw new Error("Failed pattern match at Data.Map.Internal (line 498, column 5 - line 503, column 108): "+[e.value0.constructor.name,u.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 495, column 3 - line 495, column 56): "+[e.constructor.name,u.constructor.name])}for(;!a;)u=o(r,t);return u}}(u)(new Nu(Fu.value,e,t,Fu.value));if(o instanceof bu){var f=r(e)(o.value1);return f instanceof S?(c=!0,Iu(n)(u)(new bu(o.value0,e,t,o.value3))):f instanceof g?(i=new wu(new Tu(o.value1,o.value2,o.value3),u),void(a=o.value0)):(i=new wu(new Pu(o.value0,o.value1,o.value2),u),void(a=o.value3))}if(o instanceof ku){var l=r(e)(o.value1);if(l instanceof S)return c=!0,Iu(n)(u)(new ku(o.value0,e,t,o.value3,o.value4,o.value5,o.value6));var v=r(e)(o.value4);return v instanceof S?(c=!0,Iu(n)(u)(new ku(o.value0,o.value1,o.value2,o.value3,e,t,o.value6))):l instanceof g?(i=new wu(new _u(o.value1,o.value2,o.value3,o.value4,o.value5,o.value6),u),void(a=o.value0)):l instanceof E&&v instanceof g?(i=new wu(new Bu(o.value0,o.value1,o.value2,o.value4,o.value5,o.value6),u),void(a=o.value3)):(i=new wu(new qu(o.value0,o.value1,o.value2,o.value3,o.value4,o.value5),u),void(a=o.value6))}throw new Error("Failed pattern match at Data.Map.Internal (line 478, column 3 - line 478, column 55): "+[u.constructor.name,o.constructor.name])}for(;!c;)o=f(i,a);return o}}}},Ou={foldr:function(n){return function(e){return function(t){if(t instanceof Fu)return e;if(t instanceof bu)return St(Ou)(n)(n(t.value2)(St(Ou)(n)(e)(t.value3)))(t.value0);if(t instanceof ku)return St(Ou)(n)(n(t.value2)(St(Ou)(n)(n(t.value5)(St(Ou)(n)(e)(t.value6)))(t.value3)))(t.value0);throw new Error("Failed pattern match at Data.Map.Internal (line 133, column 17 - line 136, column 85): "+[t.constructor.name])}}},foldl:function(n){return function(e){return function(t){if(t instanceof Fu)return e;if(t instanceof bu)return Pt(Ou)(n)(n(Pt(Ou)(n)(e)(t.value0))(t.value2))(t.value3);if(t instanceof ku)return Pt(Ou)(n)(n(Pt(Ou)(n)(n(Pt(Ou)(n)(e)(t.value0))(t.value2))(t.value3))(t.value5))(t.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 137, column 17 - line 140, column 85): "+[t.constructor.name])}}},foldMap:function(n){return function(e){return function(t){if(t instanceof Fu)return Fe(n);if(t instanceof bu)return Sn(n.Semigroup0())(qt(Ou)(n)(e)(t.value0))(Sn(n.Semigroup0())(e(t.value2))(qt(Ou)(n)(e)(t.value3)));if(t instanceof ku)return Sn(n.Semigroup0())(qt(Ou)(n)(e)(t.value0))(Sn(n.Semigroup0())(e(t.value2))(Sn(n.Semigroup0())(qt(Ou)(n)(e)(t.value3))(Sn(n.Semigroup0())(e(t.value5))(qt(Ou)(n)(e)(t.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 141, column 17 - line 144, column 93): "+[t.constructor.name])}}}},zu={foldrWithIndex:function(n){return function(e){return function(t){if(t instanceof Fu)return e;if(t instanceof bu)return lu(zu)(n)(n(t.value1)(t.value2)(lu(zu)(n)(e)(t.value3)))(t.value0);if(t instanceof ku)return lu(zu)(n)(n(t.value1)(t.value2)(lu(zu)(n)(n(t.value4)(t.value5)(lu(zu)(n)(e)(t.value6)))(t.value3)))(t.value0);throw new Error("Failed pattern match at Data.Map.Internal (line 147, column 26 - line 150, column 120): "+[t.constructor.name])}}},foldlWithIndex:function(n){return function(e){return function(t){if(t instanceof Fu)return e;if(t instanceof bu)return vu(zu)(n)(n(t.value1)(vu(zu)(n)(e)(t.value0))(t.value2))(t.value3);if(t instanceof ku)return vu(zu)(n)(n(t.value4)(vu(zu)(n)(n(t.value1)(vu(zu)(n)(e)(t.value0))(t.value2))(t.value3))(t.value5))(t.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 151, column 26 - line 154, column 120): "+[t.constructor.name])}}},foldMapWithIndex:function(n){return function(e){return function(t){if(t instanceof Fu)return Fe(n);if(t instanceof bu)return Sn(n.Semigroup0())(pu(zu)(n)(e)(t.value0))(Sn(n.Semigroup0())(e(t.value1)(t.value2))(pu(zu)(n)(e)(t.value3)));if(t instanceof ku)return Sn(n.Semigroup0())(pu(zu)(n)(e)(t.value0))(Sn(n.Semigroup0())(e(t.value1)(t.value2))(Sn(n.Semigroup0())(pu(zu)(n)(e)(t.value3))(Sn(n.Semigroup0())(e(t.value4)(t.value5))(pu(zu)(n)(e)(t.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 155, column 26 - line 158, column 128): "+[t.constructor.name])}}},Foldable0:function(){return Ou}},ju={traverse:function(n){return function(e){return function(t){if(t instanceof Fu)return K(n)(Fu.value);if(t instanceof bu)return J(n.Apply0())(J(n.Apply0())(J(n.Apply0())(z(n.Apply0().Functor0())(bu.create)(Dt(ju)(n)(e)(t.value0)))(K(n)(t.value1)))(e(t.value2)))(Dt(ju)(n)(e)(t.value3));if(t instanceof ku)return J(n.Apply0())(J(n.Apply0())(J(n.Apply0())(J(n.Apply0())(J(n.Apply0())(J(n.Apply0())(z(n.Apply0().Functor0())(ku.create)(Dt(ju)(n)(e)(t.value0)))(K(n)(t.value1)))(e(t.value2)))(Dt(ju)(n)(e)(t.value3)))(K(n)(t.value4)))(e(t.value5)))(Dt(ju)(n)(e)(t.value6));throw new Error("Failed pattern match at Data.Map.Internal (line 160, column 1 - line 175, column 31): "+[e.constructor.name,t.constructor.name])}}},sequence:function(n){return Dt(ju)(n)(L(D))},Functor0:function(){return Du},Foldable1:function(){return Ou}},Wu=function(){return Fu.value}(),$u=function(n){return function(e){return Pt(e)((function(e){return function(t){return Cu(n)(t.value0)(t.value1)(e)}}))(Wu)}},Gu=function(n){return function(e){return function(t){return function(u){var r=e(Lu(n)(t)(u));if(r instanceof jn)return function(n){return function(e){return function(t){return Gn(t)(ft)(function(n){return function(e){var t,u=function(e){return function(t){var u,r=e,a=!1;function o(e,u){if(e instanceof mu)return a=!0,u;if(e instanceof wu)return e.value0 instanceof Tu&&e.value0.value2 instanceof Fu&&u instanceof Fu?(a=!0,Iu(n)(e.value1)(new bu(Fu.value,e.value0.value0,e.value0.value1,Fu.value))):e.value0 instanceof Pu&&e.value0.value0 instanceof Fu&&u instanceof Fu?(a=!0,Iu(n)(e.value1)(new bu(Fu.value,e.value0.value1,e.value0.value2,Fu.value))):e.value0 instanceof Tu&&e.value0.value2 instanceof bu?(r=e.value1,void(t=new ku(u,e.value0.value0,e.value0.value1,e.value0.value2.value0,e.value0.value2.value1,e.value0.value2.value2,e.value0.value2.value3))):e.value0 instanceof Pu&&e.value0.value0 instanceof bu?(r=e.value1,void(t=new ku(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3,e.value0.value1,e.value0.value2,u))):e.value0 instanceof Tu&&e.value0.value2 instanceof ku?(a=!0,Iu(n)(e.value1)(new bu(new bu(u,e.value0.value0,e.value0.value1,e.value0.value2.value0),e.value0.value2.value1,e.value0.value2.value2,new bu(e.value0.value2.value3,e.value0.value2.value4,e.value0.value2.value5,e.value0.value2.value6)))):e.value0 instanceof Pu&&e.value0.value0 instanceof ku?(a=!0,Iu(n)(e.value1)(new bu(new bu(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3),e.value0.value0.value4,e.value0.value0.value5,new bu(e.value0.value0.value6,e.value0.value1,e.value0.value2,u)))):e.value0 instanceof _u&&e.value0.value2 instanceof Fu&&e.value0.value5 instanceof Fu&&u instanceof Fu?(a=!0,Iu(n)(e.value1)(new ku(Fu.value,e.value0.value0,e.value0.value1,Fu.value,e.value0.value3,e.value0.value4,Fu.value))):e.value0 instanceof Bu&&e.value0.value0 instanceof Fu&&e.value0.value5 instanceof Fu&&u instanceof Fu?(a=!0,Iu(n)(e.value1)(new ku(Fu.value,e.value0.value1,e.value0.value2,Fu.value,e.value0.value3,e.value0.value4,Fu.value))):e.value0 instanceof qu&&e.value0.value0 instanceof Fu&&e.value0.value3 instanceof Fu&&u instanceof Fu?(a=!0,Iu(n)(e.value1)(new ku(Fu.value,e.value0.value1,e.value0.value2,Fu.value,e.value0.value4,e.value0.value5,Fu.value))):e.value0 instanceof _u&&e.value0.value2 instanceof bu?(a=!0,Iu(n)(e.value1)(new bu(new ku(u,e.value0.value0,e.value0.value1,e.value0.value2.value0,e.value0.value2.value1,e.value0.value2.value2,e.value0.value2.value3),e.value0.value3,e.value0.value4,e.value0.value5))):e.value0 instanceof Bu&&e.value0.value0 instanceof bu?(a=!0,Iu(n)(e.value1)(new bu(new ku(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3,e.value0.value1,e.value0.value2,u),e.value0.value3,e.value0.value4,e.value0.value5))):e.value0 instanceof Bu&&e.value0.value5 instanceof bu?(a=!0,Iu(n)(e.value1)(new bu(e.value0.value0,e.value0.value1,e.value0.value2,new ku(u,e.value0.value3,e.value0.value4,e.value0.value5.value0,e.value0.value5.value1,e.value0.value5.value2,e.value0.value5.value3)))):e.value0 instanceof qu&&e.value0.value3 instanceof bu?(a=!0,Iu(n)(e.value1)(new bu(e.value0.value0,e.value0.value1,e.value0.value2,new ku(e.value0.value3.value0,e.value0.value3.value1,e.value0.value3.value2,e.value0.value3.value3,e.value0.value4,e.value0.value5,u)))):e.value0 instanceof _u&&e.value0.value2 instanceof ku?(a=!0,Iu(n)(e.value1)(new ku(new bu(u,e.value0.value0,e.value0.value1,e.value0.value2.value0),e.value0.value2.value1,e.value0.value2.value2,new bu(e.value0.value2.value3,e.value0.value2.value4,e.value0.value2.value5,e.value0.value2.value6),e.value0.value3,e.value0.value4,e.value0.value5))):e.value0 instanceof Bu&&e.value0.value0 instanceof ku?(a=!0,Iu(n)(e.value1)(new ku(new bu(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3),e.value0.value0.value4,e.value0.value0.value5,new bu(e.value0.value0.value6,e.value0.value1,e.value0.value2,u),e.value0.value3,e.value0.value4,e.value0.value5))):e.value0 instanceof Bu&&e.value0.value5 instanceof ku?(a=!0,Iu(n)(e.value1)(new ku(e.value0.value0,e.value0.value1,e.value0.value2,new bu(u,e.value0.value3,e.value0.value4,e.value0.value5.value0),e.value0.value5.value1,e.value0.value5.value2,new bu(e.value0.value5.value3,e.value0.value5.value4,e.value0.value5.value5,e.value0.value5.value6)))):e.value0 instanceof qu&&e.value0.value3 instanceof ku?(a=!0,Iu(n)(e.value1)(new ku(e.value0.value0,e.value0.value1,e.value0.value2,new bu(e.value0.value3.value0,e.value0.value3.value1,e.value0.value3.value2,e.value0.value3.value3),e.value0.value3.value4,e.value0.value3.value5,new bu(e.value0.value3.value6,e.value0.value4,e.value0.value5,u)))):(a=!0,Au("The impossible happened in partial function `up`."));throw new Error("Failed pattern match at Data.Map.Internal (line 552, column 5 - line 573, column 86): "+[e.constructor.name])}for(;!a;)u=o(r,t);return u}},r=function(n){return function(e){for(var t,r,a,o=n,i=!1;!i;)r=o,t=(a=e)instanceof bu&&a.value0 instanceof Fu&&a.value3 instanceof Fu?(i=!0,u(r)(Fu.value)):a instanceof bu?(o=new wu(new Pu(a.value0,a.value1,a.value2),r),void(e=a.value3)):a instanceof ku&&a.value0 instanceof Fu&&a.value3 instanceof Fu&&a.value6 instanceof Fu?(i=!0,u(new wu(new Pu(Fu.value,a.value1,a.value2),r))(Fu.value)):a instanceof ku?(o=new wu(new qu(a.value0,a.value1,a.value2,a.value3,a.value4,a.value5),r),void(e=a.value6)):(i=!0,Au("The impossible happened in partial function `removeMaxNode`."));return t}},a=function(n){var e,t=!1;function u(e){if(e instanceof bu&&e.value3 instanceof Fu)return t=!0,{key:e.value1,value:e.value2};if(e instanceof bu)n=e.value3;else{if(e instanceof ku&&e.value6 instanceof Fu)return t=!0,{key:e.value4,value:e.value5};if(!(e instanceof ku))return t=!0,Au("The impossible happened in partial function `maxNode`.");n=e.value6}}for(;!t;)e=u(n);return e},o=N(n);return t=mu.value,function(i){var c,f=t,l=!1;function v(t,c){if(c instanceof Fu)return l=!0,jn.value;if(c instanceof bu){var v=o(e)(c.value1);if(c.value3 instanceof Fu&&v instanceof S)return l=!0,new Wn(new ct(c.value2,u(t)(Fu.value)));if(v instanceof S){var s=a(c.value0);return l=!0,new Wn(new ct(c.value2,r(new wu(new Tu(s.key,s.value,c.value3),t))(c.value0)))}return v instanceof g?(f=new wu(new Tu(c.value1,c.value2,c.value3),t),void(i=c.value0)):(f=new wu(new Pu(c.value0,c.value1,c.value2),t),void(i=c.value3))}if(c instanceof ku){var p=c.value0 instanceof Fu&&c.value3 instanceof Fu&&c.value6 instanceof Fu,d=(v=o(e)(c.value4),o(e)(c.value1));return p&&d instanceof S?(l=!0,new Wn(new ct(c.value2,Iu(n)(t)(new bu(Fu.value,c.value4,c.value5,Fu.value))))):p&&v instanceof S?(l=!0,new Wn(new ct(c.value5,Iu(n)(t)(new bu(Fu.value,c.value1,c.value2,Fu.value))))):d instanceof S?(s=a(c.value0),l=!0,new Wn(new ct(c.value2,r(new wu(new _u(s.key,s.value,c.value3,c.value4,c.value5,c.value6),t))(c.value0)))):v instanceof S?(s=a(c.value3),l=!0,new Wn(new ct(c.value5,r(new wu(new Bu(c.value0,c.value1,c.value2,s.key,s.value,c.value6),t))(c.value3)))):d instanceof g?(f=new wu(new _u(c.value1,c.value2,c.value3,c.value4,c.value5,c.value6),t),void(i=c.value0)):d instanceof E&&v instanceof g?(f=new wu(new Bu(c.value0,c.value1,c.value2,c.value4,c.value5,c.value6),t),void(i=c.value3)):(f=new wu(new qu(c.value0,c.value1,c.value2,c.value3,c.value4,c.value5),t),void(i=c.value6))}throw new Error("Failed pattern match at Data.Map.Internal (line 525, column 16 - line 548, column 80): "+[c.constructor.name])}for(;!l;)c=v(f,i);return c}}}(n)(e)(t))}}}(n)(t)(u);if(r instanceof Wn)return Cu(n)(t)(r.value0)(u);throw new Error("Failed pattern match at Data.Map.Internal (line 596, column 15 - line 598, column 25): "+[r.constructor.name])}}}},Vu=function(n){return n.compact},Yu=function(n){return n.filterMap},Uu=function(n){return{always:L(D),Monoid0:function(){return n}}},Hu={dimap:function(n){return function(e){return function(t){return function(u){return e(t(n(u)))}}}}},Ju=function(n){return n.sampleOn},Qu=function(n){return n.keepLatest},Xu=function(n){return n.fold},Ku=function(n){return function(e){return function(t){return function(u){return Yu(n.Filterable1())(ft)(Xu(n)((function(n){return function(t){return z(pt)(K(Zn))(e(n)(t.value0))}}))(t)(new ct(u,jn.value)))}}}},Zu=function(n){return n.bang},nr=function(n){return function(e){return n===e}},er=function(n){return function(e){return n(e)}},tr=function(n){return function(e){return function(t){return function(u){return function(r){return rn(n.Monad0().Bind1())(Ye(n)(pn(jn.value)))((function(a){return rn(n.Monad0().Bind1())(t((function(e){return Ye(n)(W(ze)(mn(new Wn(e))(a)))})))((function(t){return rn(n.Monad0().Bind1())(u((function(t){return rn(n.Monad0().Bind1())(Ye(n)(dn(a)))(bt(e)(_t)((function(n){return r(t(n))})))})))((function(n){return K(e)(Q(e.Apply0())(t)(n))}))}))}))}}}}},ur=function(n){return n},rr=function(n){return function(e){return function(t){return rn(n.Monad0().Bind1())(Ye(n)(pn(jn.value)))((function(u){return rn(n.Monad0().Bind1())(e((function(e){return tn(cn)(n.Monad0().Bind1())(rn(n.Monad0().Bind1())(Ye(n)(dn(u)))(Tt(n.Monad0().Applicative0())(_t)))((function(){return rn(n.Monad0().Bind1())(er(e)(t))((function(e){return Ye(n)(W(ze)(mn(new Wn(e))(u)))}))}))})))((function(e){return K(n.Monad0().Applicative0())(tn(cn)(n.Monad0().Bind1())(rn(n.Monad0().Bind1())(Ye(n)(dn(u)))(Tt(n.Monad0().Applicative0())(_t)))((function(){return e})))}))}))}}},ar={map:function(n){return function(e){return function(t){return e((function(e){return t(n(e))}))}}}},or=function(n){return function(e){return function(t){return function(u){return function(r){return rn(n.Monad0().Bind1())(Ye(n)(pn(u)))((function(u){return t((function(t){return rn(n.Monad0().Bind1())(Ye(n)(Oe(e(t))(u)))(r)}))}))}}}}},ir=function(n){return function(e){return function(t){return function(u){return t((function(t){var r=e(t);if(r instanceof Wn)return u(r.value0);if(r instanceof jn)return K(n)(F);throw new Error("Failed pattern match at FRP.Event (line 131, column 13 - line 133, column 27): "+[r.constructor.name])}))}}}},cr=function(n){return function(e){return ir(n)((function(n){var t=e(n);if(t)return new Wn(n);if(!t)return jn.value;throw new Error("Failed pattern match at FRP.Event (line 89, column 13 - line 91, column 25): "+[t.constructor.name])}))}},fr=function(n){return function(e){return rn(n.Monad0().Bind1())(Ye(n)(pn([])))((function(t){return K(n.Monad0().Applicative0())({event:function(n){return rn(e.Monad0().Bind1())(Ye(e)(Oe((function(e){return Sn(gn)(e)([n])}))(t)))((function(){return K(e.Monad0().Applicative0())(rn(e.Monad0().Bind1())(Ye(e)(Oe(ru(nr)(n))(t)))((function(){return K(e.Monad0().Applicative0())(F)})))}))},push:function(n){return rn(e.Monad0().Bind1())(Ye(e)(dn(t)))(bt(e.Monad0().Applicative0())(Bt)((function(e){return e(n)})))}})}))}},lr=function(n){return function(e){return function(t){return function(u){return rn(e.Bind1())(fr(n)(n))((function(n){var r=t(n.event);return rn(e.Bind1())(er(r.input)(n.push))((function(n){return rn(e.Bind1())(er(r.output)(u))((function(t){return K(e.Applicative0())(Q(e.Bind1().Apply0())(n)(t))}))}))}))}}}},vr=function(n){return function(e){return function(t){return function(u){return rn(n.Monad0().Bind1())(fr(n)(n))((function(r){return tn(cn)(n.Monad0().Bind1())(u(t(r.event)))((function(){return er(e)(r.push)}))}))}}}},sr=function(n){return{compact:ir(n)(L(D)),separate:function(e){return{left:ir(n)((function(n){if(n instanceof ue)return new Wn(n.value0);if(n instanceof re)return jn.value;throw new Error("Failed pattern match at FRP.Event (line 72, column 13 - line 74, column 33): "+[n.constructor.name])}))(e),right:ir(n)((function(n){if(n instanceof re)return new Wn(n.value0);if(n instanceof ue)return jn.value;throw new Error("Failed pattern match at FRP.Event (line 79, column 13 - line 81, column 32): "+[n.constructor.name])}))(e)}}}},pr=function(n){return{filter:cr(n),filterMap:ir(n),partition:function(e){return function(t){return{yes:cr(n)(e)(t),no:cr(n)((u=ut(at),function(n){return u(e(n))}))(t)};var u}},partitionMap:function(e){return function(t){return{left:Yu(pr(n))((u=oe(Wn.create)(C(jn.value)),function(n){return u(e(n))}))(t),right:Yu(pr(n))((function(n){return ie(e(n))}))(t)};var u}},Compactable0:function(){return sr(n)},Functor1:function(){return ar}}},dr=function(n){return function(e){return function(t){return z(n.Apply0().Functor0())((function(e){return K(n)(F)}))(t(e))}}},mr=function(n){return{alt:function(e){return function(t){return function(u){return J(n.Apply0())(z(n.Apply0().Functor0())((function(e){return function(t){return Q(n.Apply0())(e)(t)}}))(e(u)))(t(u))}}},Functor0:function(){return ar}}},wr=function(n){return{empty:function(e){return K(n)(K(n)(F))},Alt0:function(){return mr(n)}}},hr=function(n){return{fold:or(n),keepLatest:rr(n),sampleOn:tr(n)(n.Monad0().Applicative0()),fix:lr(n)(n.Monad0()),bang:dr(n.Monad0().Applicative0()),Plus0:function(){return wr(n.Monad0().Applicative0())},Filterable1:function(){return pr(n.Monad0().Applicative0())}}};var Mr={vb:function(n){return function(n){return function(n){return{}}}}},yr=function(n){return n.vb},gr=function(n){return function(){return function(){return function(e){return function(){return function(){return function(){return function(){return{vb:function(t){return function(t){return function(t){return function(n){return function(){return function(){return function(e){return function(t){return function(u){return f(i(n)(e))(t)(u)}}}}}}(n)()()(l.value)(F)(yr(e)(l.value)(l.value)(l.value))}}}}}}}}}}}},Er=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Sr=function(){function n(){}return n.value=new n,n}(),Ar=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Fr=function(){function n(){}return n.value=new n,n}(),br=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),kr=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Tr=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Pr=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),_r=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Br={eq:function(n){return function(e){return n instanceof Er&&e instanceof Er?n.value0===e.value0:n instanceof Sr&&e instanceof Sr}}},qr=function(){return function(n){return function(e){return function(t){return function(u){return new Pr(function(n){return function(e){return function(t){return function(t){var u=yr(e)(l.value)(l.value)(l.value);return function(e){return rn(n.Monad0().Bind1())((r=u,()=>{const n=(e,t,u,r)=>{const a=Object.keys(r);for(var o=0;o<a.length;o++)if(r[a[o]]instanceof Object&&"_____$__$_$$_vbus"===r[a[o]]._____$__$_$$_vbus){const i={},c={};n(e,i,c,r[a[o]]),t[a[o]]=i,u[a[o]]=c}else{const n=`${Math.random()}`;e[n]={},t[a[o]]=t=>()=>{const u=Object.values(e[n]);for(var r=0;r<u.length;r++)u[r](t)()},u[a[o]]=t=>()=>{const u=`${Math.random()}`;return e[n][u]=t,()=>{delete e[n][u]}}}},e={},t={},u={};return n(e,t,u,r),{p:t,e:u,s:e}}))((function(u){return tn(cn)(n.Monad0().Bind1())(e(t(u.p)(u.e)))((function(){return K(n.Monad0().Applicative0())((e=u.s,()=>{for(const n in e)delete e[n]}));var e}))}));var r}}}}}(n)(e)(t)(u))}}}}},Nr=function(n){return new Tr(n)},Rr=function(n){return new Pr(n)};const xr={};function Lr(n){return function(e){return function(t){return function(u){var r=t;function a(n){return function(t){return e(t)(n)(u[n])}}for(var o in u)hasOwnProperty.call(u,o)&&(r=n(r)(a(o)));return r}}}}function Dr(n){return function(e){var t=[];for(var u in e)hasOwnProperty.call(e,u)&&t.push(n(u)(e[u]));return t}}Object.keys||Dr((function(n){return function(){return n}}));var Ir=Dr((function(n){return function(n){return n}})),Cr=function(n){return function(){var e={};for(var t in n)hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}},Or=function(n){return function(e){return function(n){return n()}((function(){var t=Cr(e)();return n(t)(),t}))}},zr=function(n){return function(e){return Or(function(n){return function(e){return function(t){return function(){return t[n]=e,t}}}}(n)(e))}},jr=Lr(O),Wr={foldl:function(n){return jr((function(e){return function(t){return n(e)}}))},foldr:function(n){return function(e){return function(t){return St(Bt)(n)(e)(Ir(t))}}},foldMap:function(n){return function(e){return function(n){return function(e){return jr((function(t){return function(u){return function(r){return Sn(n.Semigroup0())(t)(e(u)(r))}}}))(Fe(n))}}(n)(C(e))}}},$r=function(n){return Or(function(n){return function(e){return function(){return delete e[n],e}}}(n))},Gr=function(){function n(){}return n.value=new n,n}(),Vr=function(){function n(){}return n.value=new n,n}(),Yr=function(){function n(){}return n.value=new n,n}(),Ur=function(n){return function(e){return function(t){return function(u){return function(r){return function(a){if(a instanceof Tr)return Ft(Bt)(wr(n))(Ur(n)(e)(t)(u)(r))(a.value0);if(a instanceof Pr)return Qu(hr(e))(z(ar)(Ur(n)(e)(t)(u)(r))(a.value0));if(a instanceof _r)return function(n){return n(u)(r)}(t.toElt(a.value0));if(a instanceof kr)return function(o){return rn(e.Monad0().Bind1())(Ye(e)(pn(xr)))((function(i){return rn(e.Monad0().Bind1())(er(a.value0)((function(a){return rn(e.Monad0().Bind1())(t.ids(r))((function(c){return rn(e.Monad0().Bind1())(Ye(e)(pn(K(n)(F))))((function(f){return rn(e.Monad0().Bind1())(t.ids(r))((function(l){return rn(e.Monad0().Bind1())(Ye(e)(pn(K(n)(F))))((function(v){return rn(e.Monad0().Bind1())(Ye(e)(pn([])))((function(s){return rn(e.Monad0().Bind1())(Ye(e)(pn(K(n)(F))))((function(p){return rn(e.Monad0().Bind1())(z(n.Apply0().Functor0())(Er.create)(t.ids(r)))((function(d){return rn(e.Monad0().Bind1())(Ye(e)(pn(Gr.value)))((function(m){return rn(e.Monad0().Bind1())(er(a)((function(a){return rn(e.Monad0().Bind1())(Ye(e)(dn(m)))((function(w){return a instanceof br&&w instanceof Vr?rn(e.Monad0().Bind1())(Ye(e)(dn(s)))(bt(n)(Bt)((h=t.doLogic(a.value0)(r),function(n){return o(h(n))}))):a instanceof Fr&&w instanceof Vr?tn(cn)(e.Monad0().Bind1())(W(n.Apply0().Functor0())(Ye(e)(mn(Yr.value)(m))))((function(){var a=Q(n.Apply0())(Q(n.Apply0())(Q(n.Apply0())(Q(n.Apply0())(rn(e.Monad0().Bind1())(Ye(e)(dn(s)))(bt(n)(Bt)((function(e){return kt(n)(_t)(u.parent)((function(n){return o(t.disconnectElement(r)({id:e,parent:n,scope:d}))}))}))))(fn(e.Monad0().Bind1())(Ye(e)(dn(f)))))(fn(e.Monad0().Bind1())(Ye(e)(dn(v)))))(W(n.Apply0().Functor0())(Ye(e)(Oe($r(c))(i)))))(W(n.Apply0().Functor0())(Ye(e)(Oe($r(l))(i))));return Q(n.Apply0())(W(n.Apply0().Functor0())(Ye(e)(mn(a)(p))))(a)})):a instanceof Ar&&w instanceof Gr?tn(cn)(e.Monad0().Bind1())(W(n.Apply0().Functor0())(Ye(e)(mn(Vr.value)(m))))((function(){return rn(e.Monad0().Bind1())(er(Ur(n)(e)(t)({parent:u.parent,scope:d,raiseId:function(t){return W(n.Apply0().Functor0())(Ye(e)(Oe(Sn(gn)([t]))(s)))}})(r)(a.value0))(o))((function(t){return tn(cn)(e.Monad0().Bind1())(W(n.Apply0().Functor0())(Ye(e)(Oe(zr(l)(t))(i))))((function(){return W(n.Apply0().Functor0())(Ye(e)(mn(t)(v)))}))}))})):K(n)(F);var h}))})))((function(t){return tn(cn)(e.Monad0().Bind1())(W(n.Apply0().Functor0())(Ye(e)(mn(t)(f))))((function(){return tn(cn)(e.Monad0().Bind1())(W(n.Apply0().Functor0())(Ye(e)(Oe(zr(c)(t))(i))))((function(){return fn(e.Monad0().Bind1())(Ye(e)(dn(p)))}))}))}))}))}))}))}))}))}))}))}))})))((function(t){return K(n)(tn(cn)(e.Monad0().Bind1())(rn(e.Monad0().Bind1())(Ye(e)(dn(i)))(Pt(Wr)(Q(n.Apply0()))(K(n)(F))))((function(){return t})))}))}))};throw new Error("Failed pattern match at Bolson.Control (line 521, column 17 - line 604, column 20): "+[a.constructor.name])}}}}}},Hr=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Jr=function(){return new Hr(mu.value,mu.value)}(),Qr=function(){function n(){}return n.value=new n,n}(),Xr=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Kr=function(n){return function(e){if(n instanceof Qr)return e;if(e instanceof Qr)return n;if(n instanceof Xr)return new Xr(n.value0,function(n){return function(e){return new Hr(n.value0,new wu(e,n.value1))}}(n.value1)(e));throw new Error("Failed pattern match at Data.CatList (line 108, column 1 - line 108, column 54): "+[n.constructor.name,e.constructor.name])}},Zr=function(n){return function(e){return function(t){var u;return(u=t,function(t){var r,a=u,o=!1;function i(u,r){var i,c=function(n){var e,t=!1;function u(e){if(e.value0 instanceof mu&&e.value1 instanceof mu)return t=!0,jn.value;if(!(e.value0 instanceof mu)){if(e.value0 instanceof wu)return t=!0,new Wn(new ct(e.value0.value0,new Hr(e.value0.value1,e.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 82, column 1 - line 82, column 63): "+[e.constructor.name])}n=new Hr(Eu(e.value1),mu.value)}for(;!t;)e=u(n);return e}(u);if(c instanceof jn)return o=!0,(i=function(n){return function(e){return e(n)}},function(n){return function(e){var t,u=i,r=n,a=!1;function o(n,t,o){if(o instanceof mu)return a=!0,t;if(o instanceof wu)return u=n,r=n(t)(o.value0),void(e=o.value1);throw new Error("Failed pattern match at Data.CatList (line 124, column 3 - line 124, column 59): "+[n.constructor.name,t.constructor.name,o.constructor.name])}for(;!a;)t=o(u,r,e);return t}})(e)(r);if(c instanceof Wn)return a=c.value0.value1,void(t=new wu(n(c.value0.value0),r));throw new Error("Failed pattern match at Data.CatList (line 120, column 14 - line 122, column 67): "+[c.constructor.name])}for(;!o;)r=i(a,t);return r})(mu.value)}}},na=function(n){if(n instanceof Qr)return jn.value;if(n instanceof Xr)return new Wn(new ct(n.value0,function(n){return n.value0 instanceof mu&&n.value1 instanceof mu}(n.value1)?Qr.value:Zr(Kr)(Qr.value)(n.value1)));throw new Error("Failed pattern match at Data.CatList (line 99, column 1 - line 99, column 61): "+[n.constructor.name])},ea=function(){return Qr.value}(),ta=Kr,ua={append:ta},ra=function(n,e,t){var u,r=0;return function(a){if(2===r)return u;if(1===r)throw new ReferenceError(n+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=t(),r=2,u}},aa=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),oa=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ia=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),ca=function(n){return function(e){return function(t){var u,r=!1;function a(u){var a=function(n){var e,t=!1;function u(e){var u=function(n){return function(e){return new aa(n.value0,Sn(ua)(n.value1)(e))}};if(e.value0 instanceof oa){var r=na(e.value1);if(r instanceof jn)return t=!0,new oa(e.value0.value0);if(r instanceof Wn)return void(n=u((0,r.value0.value0)(e.value0.value0))(r.value0.value1));throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[r.constructor.name])}if(e.value0 instanceof ia)return t=!0,new ia(e.value0.value0,(function(n){return u(e.value0.value1(n))(e.value1)}));throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[e.value0.constructor.name])}for(;!t;)e=u(n);return e}(u);if(a instanceof oa)return r=!0,a.value0;if(!(a instanceof ia))throw new Error("Failed pattern match at Control.Monad.Free (line 178, column 10 - line 180, column 33): "+[a.constructor.name]);t=e(z(n)(a.value1)(a.value0))}for(;!r;)u=a(t);return u}}},fa={Applicative0:function(){return sa},Bind1:function(){return va}},la={map:function(n){return function(e){return an(va)((t=K(sa),function(e){return t(n(e))}))(e);var t}}},va={bind:function(n){return function(e){return new aa(n.value0,(t=n.value1,function(n){return ta(t)(new Xr(n,Jr))})(e));var t}},Apply0:function(){return pa(0)}},sa={pure:function(n){return e=oa.create(n),new aa(e,ea);var e},Apply0:function(){return pa(0)}},pa=ra("freeApply","Control.Monad.Free",(function(){return{apply:wn(fa),Functor0:function(){return la}}})),da=function(n){return n.state},ma={liftEffect:L(D),Monad0:function(){return Pe}},wa=function(n){return n.liftEffect},ha=function(n){return{map:function(e){return function(t){return function(u){return z(n)((function(n){return new ct(e(n.value0),n.value1)}))(t(u))}}}}},Ma=function(n){return{Applicative0:function(){return Ea(n)},Bind1:function(){return ya(n)}}},ya=function(n){return{bind:function(e){return function(t){return function(u){return rn(n.Bind1())(e(u))((function(n){return t(n.value0)(n.value1)}))}}},Apply0:function(){return ga(n)}}},ga=function(n){return{apply:wn(Ma(n)),Functor0:function(){return ha(n.Bind1().Apply0().Functor0())}}},Ea=function(n){return{pure:function(e){return function(t){return K(n.Applicative0())(new ct(e,t))}},Apply0:function(){return ga(n)}}},Sa=function(n){return{state:function(e){var t=K(n.Applicative0());return function(n){return t(e(n))}},Monad0:function(){return Ma(n)}}},Aa=ca(G)((function(n){return n(F)})),Fa=gn,ba=V,ka=Bt,Ta=function(n){return Ut(n)},Pa=function(n){var e=Hn();return function(t){return e(n(t))}}(Xt),_a=function(n){return function(e){return n(e)}}(He);function Ba(n){return n.charCodeAt(0)}var qa=function(n){return n.fromEnum},Na=function(n){return function(e){return function(t){return n(e(t)-1|0)}}},Ra=function(n){return n>=Bn(Pn)&&n<=Tn(Pn)?new Wn((e=n,String.fromCharCode(e))):jn.value;var e},xa={succ:function(n){return function(e){return function(t){return n(e(t)+1|0)}}}(Ra)(Ba),pred:Na(Ra)(Ba),Ord0:function(){return q}},La=function(){return{cardinality:Ba(Tn(_n))-Ba(Bn(_n))|0,toEnum:Ra,fromEnum:Ba,Bounded0:function(){return _n},Enum1:function(){return xa}}}();const Da=function(n){return n},Ia=(isNaN,isFinite);Math.abs,Math.acos,Math.asin,Math.atan,Math.ceil,Math.cos,Math.exp;const Ca=Math.floor,Oa=(Math.log,function(n){return function(e){return n%e}});Math.round,Math.sign&&Math.sign,Math.sin,Math.sqrt,Math.tan,Math.trunc&&Math.trunc;var za=function(){return(n=Wn.create,function(e){return function(t){return(0|t)===t?n(t):e}})(jn.value);var n}(),ja=function(n){return e=Ca(n),Ia(e)?e>=Tn(Pn)?Tn(Pn):e<=Bn(Pn)?Bn(Pn):Un(0)(za(e)):0;var e},Wa=function(n){return n},$a=function(n){return n},Ga=ju,Va=function(n){return function(e){return{append:function(t){return function(u){return function(n){return function(e){return function(t){return function(u){return vu(zu)((function(t){return function(u){return function(r){return Gu(n)((a=Gn(r)(e(r)),function(n){return Wn.create(a(n))}))(t)(u);var a}}}))(u)(t)}}}}(n)(Sn(e))(t)(u)}}}}},Ya=function(n){return function(e){return{mempty:Wu,Semigroup0:function(){return Va(n)(e)}}}},Ua=Du,Ha={genericShowArgs:function(n){return[]}},Ja=function(n){return{genericShowArgs:function(e){return[Ln(n)(e)]}}},Qa=function(n){return n.genericShowArgs},Xa=function(n){return function(e){return{"genericShow'":function(t){var u=i(e)(l.value),r=Qa(n)(t);return 0===r.length?u:"("+(" ",function(n){return n.join(" ")})(Sn(gn)([u])(r))+")"}}}},Ka=function(n){return n["genericShow'"]},Za=function(n){return function(e){return{"genericShow'":function(t){if(t instanceof In)return Ka(n)(t.value0);if(t instanceof Cn)return Ka(e)(t.value0);throw new Error("Failed pattern match at Data.Show.Generic (line 26, column 1 - line 28, column 40): "+[t.constructor.name])}}}},no=function(n){return function(e){return function(t){return Ka(e)(n.from(t))}}},eo="function"==typeof Array.from,to=("undefined"!=typeof Symbol&&null!=Symbol&&void 0!==Symbol.iterator&&String.prototype[Symbol.iterator],String.prototype.fromCodePoint,"function"==typeof String.prototype.codePointAt);const uo=function(n){return function(e){return eo?function(n){return Array.from(n,e)}:n}},ro=function(n){return n.length},ao=function(n){return function(e){return e.substring(n)}},oo=function(n){return function(e){if(n>=0&&n<e.length)return e.charAt(n);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var io=function(n){return function(e){return 65536+((1024*(n-55296|0)|0)+(e-56320|0)|0)|0}},co=function(n){return 56320<=n&&n<=57343},fo=function(n){return 55296<=n&&n<=56319},lo=function(n){return z(Yn)((function(n){return new ct(n.head,n.tail)}))(function(n){var e=ro(n);if(0===e)return jn.value;if(1===e)return new Wn({head:qa(La)(oo(0)(n)),tail:""});var t=qa(La)(oo(1)(n)),u=qa(La)(oo(0)(n)),r=fo(u)&&co(t);return new Wn(r?{head:io(u)(t),tail:ao(2)(n)}:{head:u,tail:ao(1)(n)})}(n))},vo=function(n){return jt(Wt)(lo)(n)},so=function(n){return to?function(n){return n.codePointAt(0)}:n}((function(n){var e=qa(La)(oo(0)(n));if(fo(e)&&ro(n)>1){var t=qa(La)(oo(1)(n));return co(t)?io(e)(t):e}return e})),po=uo(vo)(so),mo={eq:function(n){return function(e){return n===e}}},wo={compare:function(n){return function(e){return N(B)(n)(e)}},Eq0:function(){return mo}},ho=function(){var n=qa(La);return function(e){return n(e)}}(),Mo=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),yo=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),go=yt(),Eo=function(){return Mo.create}(),So=function(){return yo.create}(),Ao=function(){var n=z(G)(z(Re)(C(!0)));return function(e){return n(e)}}(),Fo=function(n){return n.attr},bo=function(n){return n.makeText},ko=function(n){return function(e){return function(t){return z(ar)((function(t){return n.setText({id:e,text:t})}))(t)}}},To=function(n){return function(e){return function(t){return z(ar)((function(t){return function(t){if(t.value instanceof Mo)return n.setProp({id:e,key:t.key,value:t.value.value0});if(t.value instanceof yo)return n.setCb({id:e,key:t.key,value:t.value.value0});throw new Error("Failed pattern match at Deku.Control (line 75, column 26 - line 77, column 45): "+[t.value.constructor.name])}(go(t))}))(t)}}},Po=function(n){return n.makeElement},_o=function(n){return n.attributeParent},Bo=function(n){return function(e){return new _r((function(t){return function(u){return function(r){return rn(n.Bind1())(u.ids)((function(a){return tn(cn)(n.Bind1())(t.raiseId(a))((function(){return z(n.Bind1().Apply0().Functor0())(Q(n.Bind1().Apply0())(r(u.deleteFromCache({id:a}))))(er(At(Bt)(wr(n.Applicative0()))([dr(n.Applicative0())(bo(u)({id:a,parent:t.parent,scope:t.scope})),ko(u)(a)(e)]))(r))}))}))}}}))}},qo=function(n){return function(e){return Bo(n)(dr(n.Applicative0())(e))}},No=function(n){return Ur(n.MonadST5().Monad0().Applicative0())(n.MonadST5())({doLogic:function(n){return function(n){return function(e){return n.sendToTop({id:e})}}},ids:(e=gt(),function(n){return e(n).ids}),disconnectElement:function(n){return function(e){return n.disconnectElement({id:e.id,scope:e.scope,parent:e.parent,scopeEq:h(Br)})}},toElt:function(n){return n}});var e},Ro=function(n){return function(e){return function(t){return function(u){return function(r){return function(a){return function(o){return rn(n.MonadST5().Monad0().Bind1())(a.ids)((function(i){return tn(cn)(n.MonadST5().Monad0().Bind1())(r.raiseId(i))((function(){return z(n.MonadST5().Monad0().Bind1().Apply0().Functor0())(Q(n.MonadST5().Monad0().Bind1().Apply0())(o(a.deleteFromCache({id:i}))))(er(Fn(mr(n.MonadST5().Monad0().Applicative0()))(At(Bt)(wr(n.MonadST5().Monad0().Applicative0()))(Sn(gn)([dr(n.MonadST5().Monad0().Applicative0())(Po(a)({id:i,parent:r.parent,scope:r.scope,tag:e})),To(a)(i)(t)])(Gn([])((function(e){return[dr(n.MonadST5().Monad0().Applicative0())(_o(a)({id:i,parent:e}))]}))(r.parent))))(No(n)({parent:new Wn(i),scope:r.scope,raiseId:function(e){return K(n.MonadST5().Monad0().Applicative0())(F)}})(a)(u)))(o))}))}))}}}}}}},xo={Always0:function(){return Uu(Le(ye))},Always1:function(){return Uu(Le(Le(ye)))},Always2:function(){return Uu(Le(ye))},Always3:function(){return Uu(Mt(D))},Always4:function(){return Uu(Mt(D))},MonadST5:function(){return Ve}},Lo=function(n){return function(e){return function(t){return(r=n.MonadST5(),function(n){return function(e){return rn(r.Monad0().Bind1())(fr(r)(r))((function(t){return tn(cn)(r.Monad0().Bind1())(e(n(t.push)(t.event)))((function(){return K(r.Monad0().Applicative0())(K(r.Monad0().Applicative0())(F))}))}))}})((u=Hu,function(n){return u.dimap(n)(L(D))})(z(G)(e.always))(t));var u,r}}},Do=function(){function n(){}return n.value=new n,n}(),Io={attr:function(n){return function(n){return{key:"checked",value:Eo(n)}}}},Co=function(){function n(){}return n.value=new n,n}(),Oo={attr:function(n){return function(n){return{key:"class",value:Eo(n)}}}},zo=function(){function n(){}return n.value=new n,n}(),jo={attr:function(n){return function(n){return{key:"max",value:Eo(n)}}}},Wo=function(){function n(){}return n.value=new n,n}(),$o={attr:function(n){return function(n){return{key:"min",value:Eo(n)}}}},Go=function(){function n(){}return n.value=new n,n}(),Vo={attr:function(n){return function(n){return{key:"name",value:Eo(n)}}}},Yo=function(){function n(){}return n.value=new n,n}(),Uo={attr:function(n){return function(n){return{key:"click",value:So(C((e=Re,function(n){return function(t){return z(e)(C(t))(n)}})(n)(!0)))};var e}}},Ho={attr:function(n){return function(n){return{key:"click",value:So(n)}}}},Jo=function(){function n(){}return n.value=new n,n}(),Qo={attr:function(n){return function(n){return{key:"input",value:So(n)}}}},Xo=function(){function n(){}return n.value=new n,n}(),Ko={attr:function(n){return function(n){return{key:"style",value:Eo(n)}}}},Zo=function(){function n(){}return n.value=new n,n}(),ni={attr:function(n){return function(n){return{key:"value",value:Eo(n)}}}},ei=function(){function n(){}return n.value=new n,n}(),ti={attr:function(n){return function(n){return{key:"type",value:Eo(n)}}}},ui=function(n){return function(e){return function(t){return new _r(Ro(n)("button")(e)(Nr(t)))}}},ri=function(n){return function(e){return function(t){return new _r(Ro(n)("div")(e)(Nr(t)))}}},ai=function(n){return ri(n)(it(wr(n.MonadST5().Monad0().Applicative0())))},oi=function(n){return function(e){return function(t){return new _r(Ro(n)("input")(e)(Nr(t)))}}},ii=function(n){return function(n){return function(e){return function(t){return new _r(Ro(n)("label")(e)(Nr(t)))}}}(n)(it(wr(n.MonadST5().Monad0().Applicative0())))},ci=function(n){return function(n){return function(e){return function(t){return new _r(Ro(n)("li")(e)(Nr(t)))}}}(n)(it(wr(n.MonadST5().Monad0().Applicative0())))},fi=function(n){return function(n){return function(e){return function(t){return new _r(Ro(n)("ol")(e)(Nr(t)))}}}(n)(it(wr(n.MonadST5().Monad0().Applicative0())))},li=function(n){return function(e){return function(t){return new _r(Ro(n)("span")(e)(Nr(t)))}}},vi=function(n){return function(n){return function(e){return function(t){return new _r(Ro(n)("sub")(e)(Nr(t)))}}}(n)(it(wr(n.MonadST5().Monad0().Applicative0())))},si=function(n){return function(n){return function(e){return function(t){return new _r(Ro(n)("table")(e)(Nr(t)))}}}(n)(it(wr(n.MonadST5().Monad0().Applicative0())))},pi=function(n){return function(n){return function(e){return function(t){return new _r(Ro(n)("tbody")(e)(Nr(t)))}}}(n)(it(wr(n.MonadST5().Monad0().Applicative0())))},di=function(n){return function(n){return function(e){return function(t){return new _r(Ro(n)("td")(e)(Nr(t)))}}}(n)(it(wr(n.MonadST5().Monad0().Applicative0())))},mi=function(n){return function(n){return function(e){return function(t){return new _r(Ro(n)("th")(e)(Nr(t)))}}}(n)(it(wr(n.MonadST5().Monad0().Applicative0())))},wi=function(n){return function(n){return function(e){return function(t){return new _r(Ro(n)("tr")(e)(Nr(t)))}}}(n)(it(wr(n.MonadST5().Monad0().Applicative0())))},hi=function(n){return e=n,t=jn.value,u=Wn.create,null==e?t:u(e);var e,t,u},Mi=function(n){return hi(n.target)};function yi(n){return function(){return n.value}}function gi(n){return function(){return n.valueAsNumber}}var Ei=function(n){return function(e){return function(n,e,t,u){if("undefined"!=typeof window){var r=window[t];if(null!=r&&u instanceof r)return e(u)}for(var a=u;null!=a;){var o=Object.getPrototypeOf(a),i=o.constructor.name;if(i===t)return e(u);if("Object"===i)return n;a=o}return n}(jn.value,Wn.create,n,e)}},Si=Ei("HTMLInputElement");const Ai=(n,e,t,u)=>{n((n=>u.units[n].main.appendChild(u.units[e].main)))(t)},Fi=n=>e=>()=>{e.units[n.id].main.parentNode||e.units[n.parent].main.appendChild(e.units[n.id].main)},bi=n=>e=>t=>u=>()=>{var r,a=t.id;u.scopes[t.scope]||(u.scopes[t.scope]=[]),u.scopes[t.scope].push(a),n&&t.parent.value0&&(r=document.body.querySelectorAll("[data-deku-ssr-"+t.parent.value0+"]").item(0))?u.units[a]={main:r.childNodes[0],parent:t.parent,scope:t.scope}:(u.units[a]={main:document.createTextNode(""),parent:t.parent,scope:t.scope},Ai(e,a,t.parent,u))},ki=n=>e=>t=>()=>{var u=e.id,r=e.value;n&&!t.units[u]&&(dom=document.body.querySelectorAll("[data-deku-ssr-"+u+"]").item(0))&&(t.units[u]={listeners:{},parent:e.parent,scope:e.scope,main:dom},t.scopes[e.scope]||(t.scopes[e.scope]=[]),t.scopes[e.scope].push(u)),"INPUT"===t.units[u].main.tagName&&"value"===e.key?t.units[u].main.value=r:"INPUT"===t.units[u].main.tagName&&"checked"===e.key?t.units[u].main.checked="true"===r:t.units[u].main.setAttribute(e.key,r)},Ti=n=>e=>t=>()=>{var u=e.id,r=e.value;if(n&&!t.units[u]&&(dom=document.body.querySelectorAll("[data-deku-ssr-"+u+"]").item(0))&&(t.units[u]={listeners:{},parent:e.parent,scope:e.scope,main:dom},t.scopes[e.scope]||(t.scopes[e.scope]=[]),t.scopes[e.scope].push(u)),"@self@"===e.key)r(t.units[u].main)();else{t.units[u].listeners[e.key]&&t.units[u].main.removeEventListener(e.key,t.units[u].listeners[e.key]);var a=n=>r(n)();t.units[u].main.addEventListener(e.key,a),t.units[u].listeners[e.key]=a}},Pi=n=>e=>()=>{var t=n.id;e.units[t].main.nodeValue=n.text},_i=n=>e=>t=>u=>()=>{var r,a,o=t.id,i=t.html,c=t.verb,f=t.cache,l=t.parent,v=t.scope,s=t.pxScope;if(n&&t.parent.value0&&(r=document.body.querySelectorAll("[data-deku-ssr-"+o+"]").item(0)))u.units[o]={listeners:{},scope:v,parent:l,main:r};else{const n=Object.entries(f);for(var p=0;p<n.length;p++){const e=n[p][0];i=!0===n[p][1]?i.replace(c+e+c,'data-deku-attr-internal="'+e+'"'):i.replace(c+e+c,'<span style="display:contents;" data-deku-elt-internal="'+e+'"></span>')}(a=document.createElement("div")).innerHTML=i.trim(),u.units[o]={listeners:{},scope:v,parent:l,main:a.firstChild}}u.scopes[v]||(u.scopes[v]=[]),u.scopes[v].push(o),a||(a=r),a.querySelectorAll("[data-deku-attr-internal]").forEach((function(n){const e=n.getAttribute("data-deku-attr-internal")+s;u.units[e]={listeners:{},main:n,scope:v},u.scopes[v].push(e)})),a.querySelectorAll("[data-deku-elt-internal]").forEach((function(n){var e=n.getAttribute("data-deku-elt-internal");const t=e+s;u.units[e+s]={listeners:{},main:n,scope:v},u.scopes[v].push(t)})),r||Ai(e,o,l,u)},Bi=n=>e=>()=>{var t=n.id;e.units[t]={main:n.root}},qi=n=>e=>()=>{var t=n.id,u=n.parent;e.units[t].containingScope=n.scope,e.units[u].main.prepend(e.units[t].main)},Ni=n=>e=>()=>{var t=n.id;e.units[t].noop||e.units[t].containingScope&&!n.scopeEq(e.units[t].containingScope)(n.scope)||e.units[t].main.remove()},Ri=n=>e=>()=>{delete e.units[n.id]},xi=n=>e=>()=>{var t=n.id;e.units[t].main.parentNode.prepend(e.units[t].main)};Math.random;var Li=2147483647,Di=function(){return Li-1|0}(),Ii=function(n){return function(e){return Hn()(za(Oa(48271*e+n)(Li)))}}(0),Ci=function(){return da(Sa(de))((function(n){return new ct(n.newSeed,function(){var e={};for(var t in n)({}).hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.newSeed=Ii(n.newSeed),e}())}))}(),Oi=ha(le),zi=ga(de),ji=function(n){return function(e){var t=e,u=n,r=z(Oi)(Da)(Ci),a=J(zi)(z(Oi)(T(b))(r))(z(Oi)(b.mul(2))(r));return z(Oi)((function(n){return ja(u+Oa(n)(t-u+1))}))(a)}},Wi=function(){return{arbitrary:(n=-1e6,function(e){return n<=e?ji(n)(e):ji(e)(n)})(1e6)};var n}(),$i=function(){var n=z(Re)(hi);return function(e){return n((t=e,function(){return t.body}));var t}}(),Gi=ln;function Vi(n){return function(){return n.document}}const Yi=function(){return window};var Ui=function(n){return function(e){return function(){var t,u,r={units:{},scopes:{}},a=j(Re)(Ie(0))((t=(u=xo,function(n){return function(e){return function(t){return function(r){return rn(u.MonadST5().Monad0().Bind1())(t.ids)((function(a){return er(Fn(mr(u.MonadST5().Monad0().Applicative0()))(dr(u.MonadST5().Monad0().Applicative0())(t.makeRoot({id:a,root:n})))(No(u)({parent:new Wn(a),scope:new Er("rootScope"),raiseId:function(n){return K(u.MonadST5().Monad0().Applicative0())(F)}})(t)(e)))(r)}))}}}})(n)(e),function(n){return t((e=n,{ids:function(){var n,t,u,r,a=De(e)(),o=Ln(Rn)((t=Wi.arbitrary,u=t,function(n){return u(n).value0})({newSeed:(n=a,function(n){return function(e){var t=n-1|0,u=Me.mod(e)(t);return u<1?u+n|0:u}}(Di)(n)),size:5}));return W(Re)((r=T(k)(1),function(n){return function(e){return function(){var t=n(e.value);return e.value=t.state,t.value}}}((function(n){var e=r(n);return{state:e,value:e}})))(e))(),o},makeElement:(!1,n=>e=>()=>{var t=n.id;e.scopes[n.scope]||(e.scopes[n.scope]=[]),e.scopes[n.scope].push(t),e.units[t]={listeners:{},parent:n.parent,scope:n.scope,main:document.createElement(n.tag)}}),attributeParent:Fi,makeRoot:Bi,makeText:bi(!1)(Gn(F)),makePursx:_i(!1)(Gn(F)),setProp:ki(!1),setCb:Ti(!1),setText:Pi,sendToTop:xi,deleteFromCache:Ri,giveNewParent:qi,disconnectElement:Ni}));var e}))();return er(a)((function(n){return n(r)}))()}}},Hi=function(){var n={},e="Pure",t="Throw",u="Catch",r="Sync",a="Async",o="Bind",i="Bracket",c="Fork",f="Sequential",l="Map",v="Apply",s="Alt",p="Cons",d="Resume",m="Release",w="Finalizer",h="Finalized",M="Forked";function y(n,e,t,u){this.tag=n,this._1=e,this._2=t,this._3=u}function g(n){var e=function(e,t,u){return new y(n,e,t,u)};return e.tag=n,e}function E(n){return new y(e,void 0)}function S(n){try{n()}catch(n){setTimeout((function(){throw n}),0)}}function A(n,e,t){try{return e(t())}catch(e){return n(e)}}function F(n,e,t){try{return e(t)()}catch(e){return t(n(e))(),E}}var b=function(){var n=1024,e=0,t=0,u=new Array(n),r=!1;function a(){var a;for(r=!0;0!==e;)e--,a=u[t],u[t]=void 0,t=(t+1)%n,a();r=!1}return{isDraining:function(){return r},enqueue:function(o){var i;e===n&&(i=r,a(),r=i),u[(t+e)%n]=o,e++,r||a()}}}();function k(n,l,v){var s=0,M=0,g=v,E=null,T=null,_=null,B=null,q=null,N=0,R=0,x=null,L=!0;function D(v){for(var R,I,C;;)switch(R=null,I=null,C=null,M){case 2:M=1;try{g=_(g),null===B?_=null:(_=B._1,B=B._2)}catch(e){M=5,E=n.left(e),g=null}break;case 3:n.isLeft(g)?(M=5,E=g,g=null):null===_?M=5:(M=2,g=n.fromRight(g));break;case 1:switch(g.tag){case o:_&&(B=new y(p,_,B)),_=g._2,M=1,g=g._1;break;case e:null===_?(M=5,g=n.right(g._1)):(M=2,g=g._1);break;case r:M=3,g=A(n.left,n.right,g._1);break;case a:return M=4,void(g=F(n.left,g._1,(function(n){return function(){s===v&&(s++,b.enqueue((function(){s===v+1&&(M=3,g=n,D(s))})))}})));case t:M=5,E=n.left(g._1),g=null;break;case u:q=new y(p,g,null===_?q:new y(p,new y(d,_,B),q,T),T),_=null,B=null,M=1,g=g._1;break;case i:N++,q=new y(p,g,null===_?q:new y(p,new y(d,_,B),q,T),T),_=null,B=null,M=1,g=g._1;break;case c:M=3,R=k(n,l,g._2),l&&l.register(R),g._1&&R.run(),g=n.right(R);break;case f:M=1,g=P(n,l,g._1)}break;case 5:if(_=null,B=null,null===q)M=6,g=T||E||g;else switch(R=q._3,C=q._1,q=q._2,C.tag){case u:T&&T!==R&&0===N?M=5:E&&(M=1,g=C._2(n.fromLeft(E)),E=null);break;case d:T&&T!==R&&0===N||E?M=5:(_=C._1,B=C._2,M=2,g=n.fromRight(g));break;case i:N--,null===E&&(I=n.fromRight(g),q=new y(p,new y(m,C._2,I),q,R),(T===R||N>0)&&(M=1,g=C._3(I)));break;case m:q=new y(p,new y(h,g,E),q,T),M=1,g=T&&T!==R&&0===N?C._1.killed(n.fromLeft(T))(C._2):E?C._1.failed(n.fromLeft(E))(C._2):C._1.completed(n.fromRight(g))(C._2),E=null,N++;break;case w:N++,q=new y(p,new y(h,g,E),q,T),M=1,g=C._1;break;case h:N--,M=5,g=C._1,E=C._2}break;case 6:for(var O in x)x.hasOwnProperty(O)&&(L=L&&x[O].rethrow,S(x[O].handler(g)));return x=null,void(T&&E?setTimeout((function(){throw n.fromLeft(E)}),0):n.isLeft(g)&&L&&setTimeout((function(){if(L)throw n.fromLeft(g)}),0));case 0:M=1;break;case 4:return}}function I(n){return function(){if(6===M)return L=L&&n.rethrow,n.handler(g)(),function(){};var e=R++;return(x=x||{})[e]=n,function(){null!==x&&delete x[e]}}}return{kill:function(e,t){return function(){if(6===M)return t(n.right(void 0))(),function(){};var u=I({rethrow:!1,handler:function(){return t(n.right(void 0))}})();switch(M){case 0:T=n.left(e),M=6,g=T,D(s);break;case 4:null===T&&(T=n.left(e)),0===N&&(4===M&&(q=new y(p,new y(w,g(e)),q,T)),M=5,g=null,E=null,D(++s));break;default:null===T&&(T=n.left(e)),0===N&&(M=5,g=null,E=null)}return u}},join:function(n){return function(){var e=I({rethrow:!1,handler:n})();return 0===M&&D(s),e}},onComplete:I,isSuspended:function(){return 0===M},run:function(){0===M&&(b.isDraining()?D(s):b.enqueue((function(){D(s)})))}}}function T(e,t,u,r){var o=0,i={},c=0,f={},d=new Error("[ParAff] Early exit"),m=null,w=n;function h(t,u,r){var a,o,c=u,f=null,d=null,m=0,w={};n:for(;;)switch(a=null,c.tag){case M:if(c._3===n&&(a=i[c._1],w[m++]=a.kill(t,(function(n){return function(){0==--m&&r(n)()}}))),null===f)break n;c=f._2,null===d?f=null:(f=d._1,d=d._2);break;case l:c=c._2;break;case v:case s:f&&(d=new y(p,f,d)),f=c,c=c._1}if(0===m)r(e.right(void 0))();else for(o=0,a=m;o<a;o++)w[o]=w[o]();return w}function g(t,u,a){var o,i,p,w,M,y;for(e.isLeft(t)?(o=t,i=null):(i=t,o=null);;){if(p=null,w=null,M=null,y=null,null!==m)return;if(null===u)return void r(o||i)();if(u._3!==n)return;switch(u.tag){case l:null===o?(u._3=e.right(u._1(e.fromRight(i))),i=u._3):u._3=o;break;case v:if(p=u._1._3,w=u._2._3,o){if(u._3=o,M=!0,y=c++,f[y]=h(d,o===p?u._2:u._1,(function(){return function(){delete f[y],M?M=!1:null===a?g(o,null,null):g(o,a._1,a._2)}})),M)return void(M=!1)}else{if(p===n||w===n)return;i=e.right(e.fromRight(p)(e.fromRight(w))),u._3=i}break;case s:if(p=u._1._3,w=u._2._3,p===n&&e.isLeft(w)||w===n&&e.isLeft(p))return;if(p!==n&&e.isLeft(p)&&w!==n&&e.isLeft(w))o=i===p?w:p,i=null,u._3=o;else if(u._3=i,M=!0,y=c++,f[y]=h(d,i===p?u._2:u._1,(function(){return function(){delete f[y],M?M=!1:null===a?g(i,null,null):g(i,a._1,a._2)}})),M)return void(M=!1)}null===a?u=null:(u=a._1,a=a._2)}}function S(n){return function(e){return function(){delete i[n._1],n._3=e,g(e,n._2._1,n._2._2)}}}return function(){var r,a,c=1,f=u,d=null,m=null;n:for(;;)switch(r=null,a=null,c){case 1:switch(f.tag){case l:d&&(m=new y(p,d,m)),d=new y(l,f._1,n,n),f=f._2;break;case v:d&&(m=new y(p,d,m)),d=new y(v,n,f._2,n),f=f._1;break;case s:d&&(m=new y(p,d,m)),d=new y(s,n,f._2,n),f=f._1;break;default:a=o++,c=5,r=f,f=new y(M,a,new y(p,d,m),n),(r=k(e,t,r)).onComplete({rethrow:!1,handler:S(f)})(),i[a]=r,t&&t.register(r)}break;case 5:if(null===d)break n;d._1===n?(d._1=f,c=1,f=d._2,d._2=n):(d._2=f,f=d,null===m?d=null:(d=m._1,m=m._2))}for(w=f,a=0;a<o;a++)i[a].run()}(),function(n){return new y(a,(function(t){return function(){return function(n,t){var u;for(var r in m=e.left(n),f)if(f.hasOwnProperty(r))for(r in u=f[r])u.hasOwnProperty(r)&&u[r]();f=null;var o=h(n,w,t);return function(n){return new y(a,(function(n){return function(){for(var n in o)o.hasOwnProperty(n)&&o[n]();return E}}))}}(n,t)}}))}}function P(n,e,t){return new y(a,(function(u){return function(){return T(n,e,t,u)}}))}return y.EMPTY=n,y.Pure=g(e),y.Throw=g(t),y.Catch=g(u),y.Sync=g(r),y.Async=g(a),y.Bind=g(o),y.Bracket=g(i),y.Fork=g(c),y.Seq=g(f),y.ParMap=g(l),y.ParApply=g(v),y.ParAlt=g(s),y.Fiber=k,y.Supervisor=function(n){var e={},t=0,u=0;return{register:function(n){var r=t++;n.onComplete({rethrow:!0,handler:function(n){return function(){u--,delete e[r]}}})(),e[r]=n,u++},isEmpty:function(){return 0===u},killAll:function(a,o){return function(){if(0===u)return o();var i=0,c={};function f(t){c[t]=e[t].kill(a,(function(e){return function(){delete c[t],i--,n.isLeft(e)&&n.fromLeft(e)&&setTimeout((function(){throw n.fromLeft(e)}),0),0===i&&o()}}))()}for(var l in e)e.hasOwnProperty(l)&&(i++,f(l));return e={},t=0,u=0,function(n){return new y(r,(function(){for(var n in c)c.hasOwnProperty(n)&&c[n]()}))}}}}},y.Scheduler=b,y.nonCanceler=E,y}();const Ji=Hi.Pure;Hi.Throw;const Qi=Hi.Sync,Xi=Hi.Async;Hi.Seq;var Ki=function(n,e,t){var u,r=0;return function(a){if(2===r)return u;if(1===r)throw new ReferenceError(n+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=t(),r=2,u}},Zi={map:function(n){return function(e){return e.tag===Hi.Pure.tag?Hi.Pure(n(e._1)):Hi.Bind(e,(function(e){return Hi.Pure(n(e))}))}}},nc=function(){return{isLeft:function(n){if(n instanceof ue)return!0;if(n instanceof re)return!1;throw new Error("Failed pattern match at Effect.Aff (line 397, column 12 - line 399, column 21): "+[n.constructor.name])},fromLeft:function(n){if(n instanceof ue)return n.value0;if(n instanceof re)return Au("unsafeFromLeft: Right");throw new Error("Failed pattern match at Effect.Aff (line 402, column 20 - line 404, column 55): "+[n.constructor.name])},fromRight:function(n){if(n instanceof re)return n.value0;if(n instanceof ue)return Au("unsafeFromRight: Left");throw new Error("Failed pattern match at Effect.Aff (line 407, column 21 - line 409, column 54): "+[n.constructor.name])},left:ue.create,right:re.create}}(),ec=function(n){return function(){var e=function(n){return function(n,e){return function(){return Hi.Fiber(n,null,e)}}(nc,n)}(n)();return e.run(),e}},tc=function(){var n=W(Re);return function(e){return n(ec(e))}}(),uc={Applicative0:function(){return ac},Bind1:function(){return rc}},rc={bind:function(n){return function(e){return Hi.Bind(n,e)}},Apply0:function(){return oc(0)}},ac={pure:Ji,Apply0:function(){return oc(0)}},oc=Ki("applyAff","Effect.Aff",(function(){return{apply:wn(uc),Functor0:function(){return Zi}}})),ic={liftEffect:Qi,Monad0:function(){return uc}},cc=function(){var n=wa(ic);return function(e){return C(n(e))}}(),fc=function(){function n(){this.head=null,this.last=null,this.size=0}function e(n,e){this.queue=n,this.value=e,this.next=null,this.prev=null}function t(e){this.draining=!1,this.error=null,this.value=e,this.takes=new n,this.reads=new n,this.puts=new n}var u={};function r(n){try{n()}catch(n){setTimeout((function(){throw n}),0)}}function a(n){var e;switch(n.size){case 0:return null;case 1:e=n.head,n.head=null;break;case 2:e=n.last,n.head.next=null,n.last=null;break;default:e=n.last,n.last=e.prev,n.last.next=null}return e.prev=null,e.queue=null,n.size--,e.value}function o(n){var e;switch(n.size){case 0:return null;case 1:e=n.head,n.head=null;break;case 2:e=n.head,n.last.prev=null,n.head=n.last,n.last=null;break;default:e=n.head,n.head=e.next,n.head.prev=null}return e.next=null,e.queue=null,n.size--,e.value}return t.EMPTY=u,t.putLast=function(n,t){var u=new e(n,t);switch(n.size){case 0:n.head=u;break;case 1:u.prev=n.head,n.head.next=u,n.last=u;break;default:u.prev=n.last,n.last.next=u,n.last=u}return n.size++,u},t.takeLast=a,t.takeHead=o,t.deleteCell=function(n){null!==n.queue&&(n.queue.last!==n?n.queue.head!==n?(n.prev&&(n.prev.next=n.next),n.next&&(n.next.prev=n.prev),n.queue.size--,n.queue=null,n.value=null,n.next=null,n.prev=null):o(n.queue):a(n.queue))},t.drainVar=function(n,e){if(!e.draining){var t,a,i,c,f,l=e.puts,v=e.takes,s=e.reads;for(e.draining=!0;;){if(t=null,a=null,i=null,c=e.value,f=s.size,null!==e.error){for(c=n.left(e.error);t=o(l);)r(t.cb(c));for(;a=o(s);)r(a(c));for(;i=o(v);)r(i(c));break}if(c===u&&(t=o(l))&&(e.value=c=t.value),c!==u){for(i=o(v);f--&&(a=o(s));)r(a(n.right(c)));null!==i&&(e.value=u,r(i(n.right(c))))}if(null!==t&&r(t.cb(n.right(void 0))),e.value===u&&0===l.size||e.value!==u&&0===v.size)break}e.draining=!1}},t}();function lc(){return new fc(fc.EMPTY)}var vc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),sc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),pc=function(){function n(){}return n.value=new n,n}(),dc=function(){return{left:ue.create,right:re.create,nothing:jn.value,just:Wn.create,killed:vc.create,filled:sc.create,empty:pc.value}}(),mc=function(){var n=wa(ic);return function(e){return n(function(n,e){return function(){var t=e.value;return t===fc.EMPTY?n.nothing:(e.value=fc.EMPTY,fc.drainVar(n,e),n.just(t))}}(dc,e))}}(),wc=function(n){return Xi((function(e){return function(){var t=function(n){return function(e){return function(n,e,t){return function(){var u=fc.putLast(e.reads,t);return fc.drainVar(n,e),function(){fc.deleteCell(u)}}}(dc,n,e)}}(n)(e)();return cc(t)}}))},hc=wa(ic)(lc);function Mc(){return Date.now()}var yc=ur((function(n){return function(){var e,t=Yi(),u=Ie(!1)(),r=function(e,a,o){var i,c=0;return function(e){if(2===c)return i;if(1===c)throw new ReferenceError("loop was needed before it finished initializing (module "+a+", line "+e+")",a,e);return c=1,i=W(Re)((o=function(){return n(F)(),(e=Pe,function(n){return function(t){return rn(e.Bind1())(n)((function(n){return(u=e.Applicative0(),function(n){return function(e){if(!n)return e;if(n)return K(u)(F);throw new Error("Failed pattern match at Control.Applicative (line 68, column 1 - line 68, column 65): "+[n.constructor.name,e.constructor.name])}})(n)(t);var u}))}})(De(u))(r(19))();var e},function(n){return function(){return n.requestAnimationFrame(o)}})(t)),c=2,i;var o}}(0,"FRP.Event.AnimationFrame");return r(16)(),(e=!0,function(n){return function(){n.value=e}})(u)}})),gc=function(n){return{map:function(e){return function(t){return function(u){return t(z(n)((function(n){return function(t){return n(e(t))}}))(u))}}}}},Ec=function(n){return function(e){return er(n)((function(n){return function(){var t=Mc();return e({time:t,value:n})()}}))}},Sc=function(n){return n}((function(n){return z(ar)((function(n){return n.value(n.time)}))(Ec(n))})),Ac=function(n){return function(e){return Ku(hr(Ve))((function(n){return function(e){var t=Un(0)(e.prevTime),u=Un(0)(e.prevBeats),r=Et()()(Wa)(P.sub)(n.acTime)(t),a=Et()()(Wa)(function(n){return n.div}(he))(r)(n.behaviors.clength),o=gt()(a)+gt()(u);return new ct({prevTime:new Wn(n.acTime),prevBeats:new Wn(o)},{prevTime:e.prevTime,prevBeats:e.prevBeats,time:n.acTime,beats:o,epochTime:n.behaviors.epochTime})}}))((t=ar,function(n){return function(e){return function(u){return(r=z(gc(t))(n)(e),function(n){return r(n)})(z(t)(O)(u));var r}}})((function(n){return function(e){return{behaviors:n,acTime:e}}}))(J(function(n){return{apply:function(e){return function(t){return function(u){return t(e(z(n)(x(R))(u)))}}},Functor0:function(){return gc(n)}}}(ar))(z(gc(ar))((function(n){return function(e){return{clength:n,epochTime:e}}}))(n))(z(gc(ar))($a)(Sc)))(e))({prevTime:jn.value,prevBeats:jn.value});var t}},Fc=function(n){return function(e){return function(t){return function(){var u,r=ec(rn(rc)(hc)((function(u){return wa(ic)((function(){var r=er(n)((function(n){return tc(tn(cn)(rc)(W(Zi)(mc(u)))((function(){return function(n){return function(e){return Xi((function(t){return function(){var u=function(n){return function(e){return function(t){return function(n,e,t,u){return function(){var r=fc.putLast(t.puts,{cb:u,value:e});return fc.drainVar(n,t),function(){fc.deleteCell(r)}}}(dc,n,e,t)}}}(n)(e)(t)();return cc(u)}}))}}(n)(u)})))}))(),a=er(e)((function(n){return t(n(u))}))();return Q(xe)(r)(a)}))})))();return tc(rn(rc)((u=r,Xi((function(n){return z(Re)(cc)(u.join(n))}))))((function(n){return wa(ic)(n)})))}}}},bc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),kc=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(u){return new n(e,t,u)}}},n}(),Tc=function(){function n(){}return n.value=new n,n}(),Pc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),_c=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Bc=function(n){if(n instanceof bc)return n.value0;if(n instanceof kc)return n.value2;throw new Error("Failed pattern match at Parser.Proto (line 22, column 1 - line 22, column 52): "+[n.constructor.name])},qc={map:function(n){return function(e){if(e instanceof bc)return new bc(e.value0);if(e instanceof kc)return new kc(z(qc)(n)(e.value0),n(e.value1),e.value2);throw new Error("Failed pattern match at Parser.Proto (line 0, column 0 - line 0, column 0): "+[e.constructor.name])}}},Nc={map:function(n){return function(e){if(e instanceof Tc)return Tc.value;if(e instanceof Pc)return new Pc(n(e.value0));if(e instanceof _c)return new _c((t=e.value0,{stack:n(t.stack),inputs:t.inputs}),z(Nc)(n)(e.value1));var t;throw new Error("Failed pattern match at Parser.Proto (line 0, column 0 - line 0, column 0): "+[e.constructor.name])}}},Rc=function(){function n(){}return n.value=new n,n}(),xc=function(){function n(){}return n.value=new n,n}(),Lc=function(){function n(){}return n.value=new n,n}(),Dc=function(){function n(){}return n.value=new n,n}(),Ic=function(){function n(){}return n.value=new n,n}(),Cc=function(){function n(){}return n.value=new n,n}(),Oc=function(){function n(){}return n.value=new n,n}(),zc=function(){function n(){}return n.value=new n,n}(),jc=function(){function n(){}return n.value=new n,n}(),Wc=function(){function n(){}return n.value=new n,n}(),$c=function(){function n(){}return n.value=new n,n}(),Gc={show:no({to:function(n){if(n instanceof In)return Rc.value;if(n instanceof Cn&&n.value0 instanceof In)return xc.value;if(n instanceof Cn&&n.value0 instanceof Cn&&n.value0.value0 instanceof In)return Lc.value;if(n instanceof Cn&&n.value0 instanceof Cn&&n.value0.value0 instanceof Cn&&n.value0.value0.value0 instanceof In)return Dc.value;if(n instanceof Cn&&n.value0 instanceof Cn&&n.value0.value0 instanceof Cn&&n.value0.value0.value0 instanceof Cn)return Ic.value;throw new Error("Failed pattern match at Parser.ProtoG8 (line 104, column 1 - line 104, column 44): "+[n.constructor.name])},from:function(n){if(n instanceof Rc)return new In(zn.value);if(n instanceof xc)return new Cn(new In(zn.value));if(n instanceof Lc)return new Cn(new Cn(new In(zn.value)));if(n instanceof Dc)return new Cn(new Cn(new Cn(new In(zn.value))));if(n instanceof Ic)return new Cn(new Cn(new Cn(new Cn(zn.value))));throw new Error("Failed pattern match at Parser.ProtoG8 (line 104, column 1 - line 104, column 44): "+[n.constructor.name])}})(Za(Xa(Ha)({reflectSymbol:function(){return"LParen"}}))(Za(Xa(Ha)({reflectSymbol:function(){return"RParen"}}))(Za(Xa(Ha)({reflectSymbol:function(){return"Comma"}}))(Za(Xa(Ha)({reflectSymbol:function(){return"X"}}))(Xa(Ha)({reflectSymbol:function(){return"EOF"}}))))))},Vc={show:no({to:function(n){if(n instanceof In)return Cc.value;if(n instanceof Cn)return Oc.value;throw new Error("Failed pattern match at Parser.ProtoG8 (line 67, column 1 - line 67, column 48): "+[n.constructor.name])},from:function(n){if(n instanceof Cc)return new In(zn.value);if(n instanceof Oc)return new Cn(zn.value);throw new Error("Failed pattern match at Parser.ProtoG8 (line 67, column 1 - line 67, column 48): "+[n.constructor.name])}})(Za(Xa(Ha)({reflectSymbol:function(){return"RE"}}))(Xa(Ha)({reflectSymbol:function(){return"RL"}})))},Yc={show:no({to:function(n){if(n instanceof In)return zc.value;if(n instanceof Cn&&n.value0 instanceof In)return jc.value;if(n instanceof Cn&&n.value0 instanceof Cn&&n.value0.value0 instanceof In)return Wc.value;if(n instanceof Cn&&n.value0 instanceof Cn&&n.value0.value0 instanceof Cn)return $c.value;throw new Error("Failed pattern match at Parser.ProtoG8 (line 48, column 1 - line 48, column 46): "+[n.constructor.name])},from:function(n){if(n instanceof zc)return new In(zn.value);if(n instanceof jc)return new Cn(new In(zn.value));if(n instanceof Wc)return new Cn(new Cn(new In(zn.value)));if(n instanceof $c)return new Cn(new Cn(new Cn(zn.value)));throw new Error("Failed pattern match at Parser.ProtoG8 (line 48, column 1 - line 48, column 46): "+[n.constructor.name])}})(Za(Xa(Ha)({reflectSymbol:function(){return"RE1"}}))(Za(Xa(Ha)({reflectSymbol:function(){return"RE2"}}))(Za(Xa(Ha)({reflectSymbol:function(){return"RL1"}}))(Xa(Ha)({reflectSymbol:function(){return"RL2"}})))))},Uc=function(){return $u(wo)(Bt)([new ct(ho("("),new Wn(Rc.value)),new ct(ho(")"),new Wn(xc.value)),new ct(ho(","),new Wn(Lc.value)),new ct(ho("x"),new Wn(Dc.value)),new ct(ho("$"),new Wn(Ic.value)),new ct(ho(" "),jn.value),new ct(ho("\t"),jn.value),new ct(ho("\n"),jn.value)])}(),Hc={eq:function(n){return function(e){return n instanceof Rc&&e instanceof Rc||n instanceof xc&&e instanceof xc||n instanceof Lc&&e instanceof Lc||n instanceof Dc&&e instanceof Dc||n instanceof Ic&&e instanceof Ic}}},Jc={compare:function(n){return function(e){if(n instanceof Rc&&e instanceof Rc)return S.value;if(n instanceof Rc)return g.value;if(e instanceof Rc)return E.value;if(n instanceof xc&&e instanceof xc)return S.value;if(n instanceof xc)return g.value;if(e instanceof xc)return E.value;if(n instanceof Lc&&e instanceof Lc)return S.value;if(n instanceof Lc)return g.value;if(e instanceof Lc)return E.value;if(n instanceof Dc&&e instanceof Dc)return S.value;if(n instanceof Dc)return g.value;if(e instanceof Dc)return E.value;if(n instanceof Ic&&e instanceof Ic)return S.value;throw new Error("Failed pattern match at Parser.ProtoG8 (line 0, column 0 - line 0, column 0): "+[n.constructor.name,e.constructor.name])}},Eq0:function(){return Hc}},Qc={eq:function(n){return function(e){return n instanceof Cc&&e instanceof Cc||n instanceof Oc&&e instanceof Oc}}},Xc={compare:function(n){return function(e){if(n instanceof Cc&&e instanceof Cc)return S.value;if(n instanceof Cc)return g.value;if(e instanceof Cc)return E.value;if(n instanceof Oc&&e instanceof Oc)return S.value;throw new Error("Failed pattern match at Parser.ProtoG8 (line 0, column 0 - line 0, column 0): "+[n.constructor.name,e.constructor.name])}},Eq0:function(){return Qc}},Kc={eq:function(n){return function(e){return n instanceof zc&&e instanceof zc||n instanceof jc&&e instanceof jc||n instanceof Wc&&e instanceof Wc||n instanceof $c&&e instanceof $c}}},Zc=function(){var n,e=z(Yn)((n=Gt(gu),function(e){return n((t=iu(e),(u=Qt(t))instanceof Wn&&u.value0 instanceof Ic?t:Sn(gn)(t)([Ic.value])));var t,u})),t=Dt(It)(Zn)(I(Lu(wo))(Uc));return function(n){return e(t(po(n)))}}(),nf=function(){function n(){}return n.value=new n,n}(),ef=function(){function n(){}return n.value=new n,n}(),tf=function(){function n(){}return n.value=new n,n}(),uf=function(){function n(){}return n.value=new n,n}(),rf=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),af=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),of=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),cf=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ff=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),lf=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),vf=function(n){return n},sf=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),pf=function(n){return n instanceof ff?new Wn(n.value0):jn.value},df=function(n){return n instanceof cf?new Wn(n.value0):jn.value},mf=function(n){return function(e){return function(t){return function(u){var r=function(t){if(t instanceof bc)return[vi(u)([qo(u.MonadST5().Monad0())(Ln(n)(t.value0))])];if(t instanceof kc)return Sn(gn)(r(t.value0))(Sn(gn)([qo(u.MonadST5().Monad0())(Ln(e)(t.value1))])([vi(u)([qo(u.MonadST5().Monad0())(Ln(n)(t.value2))])]));throw new Error("Failed pattern match at Parser.Main (line 623, column 3 - line 623, column 54): "+[t.constructor.name])};return Nr(r(t))}}}},wf={append:function(n){return function(e){if(n instanceof rf&&e instanceof rf)return new rf(n.value0);if(n instanceof rf&&e instanceof of)return new of(n.value0,e.value1);if(n instanceof of&&e instanceof rf)return new of(n.value0,n.value1);if(n instanceof of&&e instanceof of)return new of(n.value0,Sn(Fa)(n.value1)(e.value1));if(n instanceof rf&&e instanceof af)return new of(n.value0,e.value0);if(n instanceof af&&e instanceof rf)return new of(e.value0,n.value0);if(n instanceof af&&e instanceof af)return new af(Sn(Fa)(n.value0)(e.value0));if(n instanceof of&&e instanceof af)return new of(n.value0,Sn(Fa)(n.value1)(e.value0));if(n instanceof af&&e instanceof of)return new of(e.value0,Sn(Fa)(n.value0)(e.value1));throw new Error("Failed pattern match at Parser.Main (line 233, column 1 - line 243, column 72): "+[n.constructor.name,e.constructor.name])}}},hf=function(n){var e=$t(n.rule.value1);if(e instanceof jn)return{nonTerminal:Wu,terminal:Wu};if(e instanceof Wn){var t=K(en)({pName:n.pName,rName:n.rName,rule:new lf(Sn(gn)(n.rule.value0)([e.value0.head]),e.value0.tail),lookahead:n.lookahead});if(e.value0.head instanceof cf)return{nonTerminal:Ru(e.value0.head.value0)(t),terminal:Wu};if(e.value0.head instanceof ff)return{nonTerminal:Wu,terminal:Ru(e.value0.head.value0)(t)};throw new Error("Failed pattern match at Parser.Main (line 398, column 8 - line 406, column 10): "+[e.value0.head.constructor.name])}throw new Error("Failed pattern match at Parser.Main (line 385, column 47 - line 406, column 10): "+[e.constructor.name])},Mf=function(n){return function(e){return function(t){return(u=be({reflectSymbol:function(){return"nonTerminal"}})(Ya(n)(gn))()(be({reflectSymbol:function(){return"terminal"}})(Ya(e)(gn))()(Ee)),r={mempty:Ae(u)(l.value),Semigroup0:function(){return n=u.SemigroupRecord0(),{append:En(n)(l.value)};var n}},qt(Bt)(r))(hf)(t);var u,r}}},yf=function(n){return n instanceof cf},gf=function(n){var e,t=(e=yf,function(n){var t=function(t){var u,r=!1;function a(u){var a=Jt(n)(u);if(a instanceof Wn)return e(a.value0)?void(t=u+1|0):(r=!0,new Wn(u));if(a instanceof jn)return r=!0,jn.value;throw new Error("Failed pattern match at Data.Array (line 964, column 5 - line 966, column 25): "+[a.constructor.name])}for(;!r;)u=a(t);return u}(0);if(t instanceof Wn&&0===t.value0)return{init:[],rest:n};if(t instanceof Wn)return{init:Ke(0)(t.value0)(n),rest:Ke(t.value0)(He(n))(n)};if(t instanceof jn)return{init:n,rest:[]};throw new Error("Failed pattern match at Data.Array (line 951, column 3 - line 957, column 30): "+[t.constructor.name])})(n);return{following:ou(df)(t.init),continue:rn(Kn)(Xt(t.rest))(pf)}},Ef=function(n){return function(e){return function(t){return function(u){var r,a,o,i,c=(a=hr(n),o=Yu(a.Filterable1())((function(n){return j(Yn)(n.last)((function(e){return{last:e,now:n.now}}))})),i=function(n){return function(e){return Yu(n.Filterable1())(L(D))(Xu(n)((function(n){return function(e){if(e instanceof jn)return new Wn({now:n,last:jn.value});if(e instanceof Wn)return new Wn({now:n,last:new Wn(e.value0.now)});throw new Error("Failed pattern match at FRP.Event.Class (line 56, column 3 - line 56, column 50): "+[n.constructor.name,e.constructor.name])}}))(e)(jn.value))}}(a),function(n){return o(i(n))})(t),f=Qu(hr(n))(z(ar)(Ft(Bt)(wr(n.Monad0().Applicative0()))(dr(n.Monad0().Applicative0())))(j(ar)(c)((function(n){return function(n){return function(e){return n>e?Ue(e)(n-1|0):n<e?Ue(n)(e-1|0):[]}}(n.last)(n.now)}))));return(r=B,function(n){return function(e){return function(t){return function(u){return rn(n.Monad0().Bind1())(Ye(n)(pn(Wu)))((function(a){return tn(cn)(n.Monad0().Bind1())(u(t((function(e){return function(t){return tn(cn)(n.Monad0().Bind1())(W(n.Monad0().Bind1().Apply0().Functor0())(Ye(n)(Oe(Gu(r)((function(n){if(n instanceof jn)return new Wn([t]);if(n instanceof Wn)return new Wn(Sn(gn)(n.value0)([t]));throw new Error("Failed pattern match at FRP.Event (line 243, column 44 - line 245, column 37): "+[n.constructor.name])}))(e))(a))))((function(){return K(n.Monad0().Applicative0())(W(n.Monad0().Bind1().Apply0().Functor0())(Ye(n)(Oe(Gu(r)((function(n){if(n instanceof jn)return jn.value;if(n instanceof Wn)return new Wn(ru(nr)(t)(n.value0));throw new Error("Failed pattern match at FRP.Event (line 246, column 51 - line 248, column 53): "+[n.constructor.name])}))(e))(a))))}))}}))))((function(){return rn(n.Monad0().Bind1())(er(e)((function(e){return rn(n.Monad0().Bind1())(Ye(n)(dn(a)))((function(t){var u=Lu(r)(e)(t);if(u instanceof jn)return K(n.Monad0().Applicative0())(F);if(u instanceof Wn)return kt(n.Monad0().Applicative0())(Bt)(u.value0)((function(n){return n(F)}));throw new Error("Failed pattern match at FRP.Event (line 251, column 5 - line 253, column 38): "+[u.constructor.name])}))})))((function(e){return K(n.Monad0().Applicative0())(tn(cn)(n.Monad0().Bind1())(W(n.Monad0().Bind1().Apply0().Functor0())(Ye(n)(mn(Wu)(a))))((function(){return e})))}))}))}))}}}})(n)(f)((function(t){var r,a,o=(a=(r=at,function(n){return function(e){return function(t){return Fn(mr(n.Monad0().Applicative0()))(dr(n.Monad0().Applicative0())(e))(Xu(hr(n))((function(n){return function(n){return ut(r)(n)}}))(t)(e))}}})(n)(e),function(n){return a(t(n))});return u(o)}))}}}},Sf=function(n){return function(n){return function(e){return rn(ya(fa))((t=Sa(fa),da(t)((function(n){return new ct(n,n)}))))((function(t){return tn(cn)(ya(fa))(function(n){return function(e){return da(n)((function(n){return new ct(F,e)}))}}(Sa(fa))(t+1|0))((function(){return K(Ea(fa))((function(u){return new ct(t,j(ar)(u(t))((function(t){return Fo(n)(Xo.value)(e+(t?"":"display:none;"))})))}))}))}));var t}}},Af=function(n){return function(n){return Sf()(n)("")}},Ff={to:function(n){if(n instanceof In)return new cf(n.value0);if(n instanceof Cn)return new ff(n.value0);throw new Error("Failed pattern match at Parser.Main (line 161, column 1 - line 161, column 58): "+[n.constructor.name])},from:function(n){if(n instanceof cf)return new In(n.value0);if(n instanceof ff)return new Cn(n.value0);throw new Error("Failed pattern match at Parser.Main (line 161, column 1 - line 161, column 58): "+[n.constructor.name])}},bf=function(n){return function(e){return{show:function(t){return no(Ff)(Za(Xa(Ja(n))({reflectSymbol:function(){return"NonTerminal"}}))(Xa(Ja(e))({reflectSymbol:function(){return"Terminal"}})))(t)}}}},kf=function(n){return function(e){return function(t){return function(u){return li(u)(dr(u.MonadST5().Monad0().Applicative0())(Fo(Oo)(Co.value)("zipper")))([li(u)(dr(u.MonadST5().Monad0().Applicative0())(Fo(Oo)(Co.value)("before")))(z(V)((o=qo(u.MonadST5().Monad0()),i=Ln(bf(n)(e)),function(n){return o(i(n))}))(t.value0)),li(u)(dr(u.MonadST5().Monad0().Applicative0())(Fo(Oo)(Co.value)("after")))(z(V)((r=qo(u.MonadST5().Monad0()),a=Ln(bf(n)(e)),function(n){return r(a(n))}))(t.value1))]);var r,a,o,i}}}},Tf=function(n){return function(e){return function(t){return function(u){return function(r){return function(n){return function(n){return function(e){return function(t){return new _r(Ro(n)("ul")(e)(Nr(t)))}}}(n)(it(wr(n.MonadST5().Monad0().Applicative0())))}(r)(z(V)((a=ci(r),function(u){return a((o=u,function(n){return function(e){return function(t){return function(u){return function(r){return[li(r)(dr(r.MonadST5().Monad0().Applicative0())(Fo(Oo)(Co.value)("rule name")))([qo(r.MonadST5().Monad0())(Ln(e)(u.rName))]),qo(r.MonadST5().Monad0())(": "),kf(n)(t)(u.rule)(r),qo(r.MonadST5().Monad0())(" "),li(r)(dr(r.MonadST5().Monad0().Applicative0())(Fo(Oo)(Co.value)("lookahead")))([qo(r.MonadST5().Monad0())(Ln(Dn(t))(u.lookahead))])]}}}}}(n)(e)(t)(o)(r)));var o}))(u));var a}}}}},Pf={to:function(n){return new sf(n.value0,n.value1)},from:function(n){return new On(n.value0,n.value1)}},_f=function(n){return{show:function(e){return no(Pf)(Xa((t=Ja(n),function(n){return{genericShowArgs:function(e){return Sn(gn)(Qa(t)(e.value0))(Qa(n)(e.value1))}}})(Ja(Dn(_f(n)))))({reflectSymbol:function(){return"Layer"}}))(e);var t}}},Bf=function(n){return function(e){return function(t){return function(u){return function(r){return function(a){var o,i=(o=function(a){return function(n){return function(e){return function(t){return function(u){return function(r){return function(a){if(a instanceof ue&&a.value0 instanceof jn)return j(ha(la))(Af(r.MonadST5())(Ko))(z(G)((function(n){return ri(r)(n.value1)([qo(r.MonadST5().Monad0())("Step "+Ln(Rn)(n.value0)+": Parse error")])})));if(a instanceof ue&&a.value0 instanceof Wn)return j(ha(la))(Af(r.MonadST5())(Ko))(z(G)((function(n){var t=function(n){return n instanceof kc&&n.value0 instanceof kc&&n.value0.value0 instanceof bc&&n.value0.value1 instanceof re&&n.value1 instanceof ue?new Wn(n.value0.value1.value0):jn.value}(a.value0.value0);return t instanceof Wn?ri(r)(n.value1)([qo(r.MonadST5().Monad0())("Step "+Ln(Rn)(n.value0)+": "+Ln(_f(e))(t.value0))]):ri(r)(n.value1)([qo(r.MonadST5().Monad0())("Step "+Ln(Rn)(n.value0)+": Something went wrong")])})));if(a instanceof re)return j(ha(la))(Sf(r.MonadST5())(Ko)("display: flex; justify-content: space-between;"))(z(G)((function(e){return ri(r)(e.value1)([ai(r)([qo(r.MonadST5().Monad0())("Step "+Ln(Rn)(e.value0)+": "),mf(t)(n)(a.value0.stack)(r)]),ai(r)([qo(r.MonadST5().Monad0())(Ln(u)(a.value0.inputs))])])})));throw new Error("Failed pattern match at Parser.Main (line 659, column 1 - line 671, column 43): "+[a.constructor.name])}}}}}}(function(n){return function(e){return{show:function(t){if(t instanceof ue)return"(Left "+Ln(n)(t.value0)+")";if(t instanceof re)return"(Right "+Ln(e)(t.value0)+")";throw new Error("Failed pattern match at Data.Either (line 173, column 1 - line 175, column 46): "+[t.constructor.name])}}}}(t)(_f(u)))(u)(e)(function(n){return{show:function(e){return e instanceof mu?"Nil":"("+(t=Mu,function(n){return function(e){return function(u){return Pt(t)((function(t){return function(u){return t.init?{init:!1,acc:u}:{init:!1,acc:Sn(n.Semigroup0())(t.acc)(Sn(n.Semigroup0())(e)(u))}}}))({init:!0,acc:Fe(n)})(u).acc}}})(ge)(" : ")(z(hu)(Ln(n))(e))+" : Nil)";var t}}}(n))(r)(a)},function(n){if(n instanceof Tc)return j(ha(la))(o(new ue(jn.value)))(z(G)((function(n){return[n]})));if(n instanceof Pc)return j(ha(la))(o(new ue(new Wn(n.value0))))(z(G)((function(n){return[n]})));if(n instanceof _c)return J(ga(fa))(z(ha(la))(X(U)((function(n){return function(e){return Sn(gn)([n])(e)}})))(o(new re(n.value0))))(i(n.value1));throw new Error("Failed pattern match at Parser.Main (line 700, column 7 - line 706, column 68): "+[n.constructor.name])});return z(ha(la))(z(G)(Nr))(i(a))}}}}}},qf=function(){return[{pName:Cc.value,rName:zc.value,rule:[new ff(Rc.value),new cf(Oc.value),new ff(xc.value)]},{pName:Cc.value,rName:jc.value,rule:[new ff(Dc.value)]},{pName:Oc.value,rName:Wc.value,rule:[new cf(Cc.value)]},{pName:Oc.value,rName:$c.value,rule:[new cf(Oc.value),new ff(Lc.value),new cf(Cc.value)]}]}(),Nf=function(){var n=z(G)(z(Yn))(z(hu))((function(n){return n instanceof Ic?jn.value:new Wn(n)}));return function(e){return n(Zc(e))}}(),Rf={map:function(n){return function(e){if(e instanceof rf)return new rf(e.value0);if(e instanceof af)return new af(z(ba)(n)(e.value0));if(e instanceof of)return new of(e.value0,z(ba)(n)(e.value1));throw new Error("Failed pattern match at Parser.Main (line 0, column 0 - line 0, column 0): "+[e.constructor.name])}}},xf=function(n){return function(e){return function(t){return function(u){return function(r){return function(a){return function(o){return function(i){var c,f,l,v,s,p,d=function(n){return function(e){return function(t){var u=function(n){if(n instanceof cf)return new ct([],[n.value0]);if(n instanceof ff)return new ct([n.value0],[]);throw new Error("Failed pattern match at Parser.Main (line 577, column 5 - line 577, column 43): "+[n.constructor.name])};return mt(ht)(Zt(e))(Zt(n))(qt(Bt)(st(Se)(Se))((function(n){return qt(Bt)(st(Se)(Se))((function(n){return Sn(vt(gn)(gn))(new ct([],[n.pName]))((e=u,function(n){return Sn(vt(gn)(gn))(qt(Bt)(st(Se)(Se))(e)(n.value0))(qt(Bt)(st(Se)(Se))(e)(n.value1))})(n.rule));var e}))(n.items)}))(t))}}}(r)(a)(o),m=(c=qo(i.MonadST5().Monad0()),f=Ln(u),function(n){return c(f(n))}),w=(l=qo(i.MonadST5().Monad0()),v=Ln(t),function(n){return l(v(n))}),h=wi(i)(z(V)((s=mi(i),p=K(en),function(n){return s(p(n))}))(Sn(gn)([qo(i.MonadST5().Monad0())("")])(Sn(gn)(z(V)(m)(d.value0))(z(V)(w)(d.value1))))),M=j(V)(o)((function(t){return wi(i)((u=mi(i)([qo(i.MonadST5().Monad0())(Ln(n)(t.sName))]),function(n){return Sn(gn)([u])(n)})(z(V)((o=di(i),c=K(en),function(t){return o(c(function(t){if(t instanceof jn)return qo(i.MonadST5().Monad0())("");if(t instanceof Wn&&t.value0 instanceof rf)return qo(i.MonadST5().Monad0())("s"+Ln(n)(t.value0.value0));if(t instanceof Wn&&t.value0 instanceof af)return qo(i.MonadST5().Monad0())(qt(ka)(ge)((function(n){return"r"+Ln(e)(n)}))(t.value0.value0));if(t instanceof Wn&&t.value0 instanceof of)return qo(i.MonadST5().Monad0())("s"+Ln(n)(t.value0.value0)+qt(ka)(ge)((function(n){return"r"+Ln(e)(n)}))(t.value0.value1));throw new Error("Failed pattern match at Parser.Main (line 589, column 5 - line 589, column 41): "+[t.constructor.name])}(t)))}))(function(n){return Sn(gn)(z(V)((function(e){return z(Yn)(z(Rf)(ft))(Lu(a)(e)(gt()(n.advance)))}))(d.value0))(z(V)((function(e){return z(Yn)(rf.create)(Lu(r)(e)(n.receive))}))(d.value1))}(t))));var u,o,c}));return si(i)(K(en)(pi(i)(Sn(gn)([h])(M))))}}}}}}}},Lf={map:function(n){return function(e){return new sf(n(e.value0),z(V)(z(Lf)(n))(e.value1))}}},Df=function(n){return function(e){return{eq:function(t){return function(u){return t instanceof cf&&u instanceof cf?h(n)(t.value0)(u.value0):t instanceof ff&&u instanceof ff&&h(e)(t.value0)(u.value0)}}}}},If=function(n){return function(e){return{eq:function(t){return function(u){return h(M(Df(n)(e)))(t.value0)(u.value0)&&h(M(Df(n)(e)))(t.value1)(u.value1)}}}}},Cf=function(n){return function(e){return function(t){var u=nu((function(u){return function(r){var a,o=(a=It,function(n){return function(e){return function(t){return Dt(a)(Lt)((function(e){return function(t){return n(t)(e)}}))(t)(e)}}})((function(u){return function(a){return h(e)(a.rName)(r.rName)&&h(If(n)(t))(a.rule)(r.rule)?{accum:!0,value:{rName:a.rName,pName:a.pName,rule:a.rule,lookahead:Ht(t)(Sn(gn)(a.lookahead)(r.lookahead))}}:{accum:u,value:a}}}))(!1)(u);return o.accum?o.value:Sn(gn)(o.value)([r])}}))([]);return function(n){return u(n)}}}},Of=function(n){return function(e){return function(t){return{eq:function(u){return function(r){return h(M(p()(y(y(y(y(v)()({reflectSymbol:function(){return"rule"}})(If(n)(t)))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n))()({reflectSymbol:function(){return"lookahead"}})(M(t)))))(u)(r)||(a=Cf(n)(e)(t)(u),o=Cf(n)(e)(t)(r),i=Cf(n)(e)(t)(Sn(gn)(a)(o)),c=Cf(n)(e)(t)(Sn(gn)(o)(a)),h(M(p()(y(y(y(y(v)()({reflectSymbol:function(){return"rule"}})(If(n)(t)))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n))()({reflectSymbol:function(){return"lookahead"}})(M(t)))))(a)(i)&&h(M(p()(y(y(y(y(v)()({reflectSymbol:function(){return"rule"}})(If(n)(t)))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n))()({reflectSymbol:function(){return"lookahead"}})(M(t)))))(o)(c));var a,o,i,c}}}}}},zf=function(n){if(n instanceof rf)return new Wn(new ue(n.value0));if(n instanceof of)return new Wn(new ue(n.value0));if(n instanceof af)return 1===_a(n.value0)?new Wn(new re(Pa(n.value0))):jn.value;throw new Error("Failed pattern match at Parser.Main (line 549, column 1 - line 549, column 60): "+[n.constructor.name])},jf=function(n){return function(e){return function(t){return function(u){return function(r){var a=$u(n)(Bt)(cu(fu)((function(n){return function(e){return new ct(e.sName,n)}}))(r)),o=function(e){return rn(Kn)(Lu(n)(e)(a))(Jt(r))};return{promote:ue.create,step:function(n){return function(e){return rn(Kn)(rn(Kn)(o(n))(function(n){return function(e){return Lu(u)(n)(e.advance)}}(e)))(zf)}},goto:function(n){return function(r){return rn(Kn)(o(Bc(r)))((function(a){return rn(Kn)((i=n,function(n){return Ft(Bt)(te)((function(n){return 0===n.rule.value1.length&&h(e.Eq0())(n.pName)(i.value0)&&h(t)(n.rName)(i.value1)?new Wn(n.rule.value0):jn.value}))(n.items)})(a))(function(n){return function(t){return function(r){return rn(Kn)(eu(ne)((function(n){return function(t){if(t instanceof ff)return n.value1 instanceof kc&&n.value1.value1 instanceof ue&&h(u.Eq0())(t.value0)(n.value1.value1.value0)?new Wn(new ct(Sn(gn)(n.value0)([n.value1.value1]),n.value1.value0)):Au("expected token on stack");if(t instanceof cf)return n.value1 instanceof kc&&n.value1.value1 instanceof re&&h(e.Eq0())(n.value1.value1.value0.value0.value0)(t.value0)?new Wn(new ct(Sn(gn)(n.value0)([n.value1.value1]),n.value1.value0)):Au("expected terminal on stack");throw new Error("Failed pattern match at Parser.Main (line 528, column 34 - line 536, column 62): "+[t.constructor.name])}}))(new ct([],t))(r.slice().reverse()))((function(t){return z(Yn)(kc.create(t.value1)(new re(new sf(n,ou(ie)(t.value0)))))(function(n){return function(t){return rn(Kn)(o(t))((u=Lu(e)(n.value0),function(n){return u(n.receive)}));var u}}(n)(Bc(t.value1)))}))}}}(n)(r));var i}))}}}}}}}},Wf=function(n){return function(e){return function(t){return function(u){return function(r){var a,o=n,i=e,c=t,f=u,l=!1;function v(n,e,t,u,a){var v=function(n){return function(e){return function(t){return an(un)(function(n){return function(e){return function(t){var u,r=function(n){return rn(Kn)($t(n.value1))((function(n){if(n.head instanceof cf){var e=gf(n.tail);return new Wn({nonterminal:n.head.value0,following:e.following,continue:e.continue})}return jn.value}))}(t.rule);if(r instanceof jn)return[];if(r instanceof Wn)return function(n){return function(e){return function(t){var u=Qe((function(e){return h(n)(e.pName)(t)}))(e);return function(n){return j(V)(u)((function(e){return{pName:e.pName,rName:e.rName,rule:new lf([],e.rule),lookahead:n}}))}}}}(n)(e)(r.value0.nonterminal)(function(n){return function(e){return function(t){return function(u){var r=function(n){return function(e){return function(t){var u=$t(e);return u instanceof Wn?a(n)(u.value0.head)(u.value0.tail)(t):t}}},a=function(e){return function(t){return function(u){return function(a){var o,i=(o=function(e){return h(n)(e.pName)(t)},function(n){for(var e=[],t=[],u=0;u<n.length;u++){var r=n[u];o(r)?e.push(r):t.push(r)}return{yes:e,no:t}})(e);return rn(un)(i.yes)((function(n){return function(n){if(n.continue instanceof Wn)return r(i.no)(n.following)([n.continue.value0]);if(n.continue instanceof jn)return r(i.no)(Sn(gn)(n.following)(u))(a);throw new Error("Failed pattern match at Parser.Main (line 374, column 9 - line 376, column 65): "+[n.continue.constructor.name])}(gf(n.rule))}))}}}};return r(e)(t)(u)}}}}(n)(e)(r.value0.following)((u=r.value0.continue,function(n){if(u instanceof Wn)return[u.value0];if(u instanceof jn)return n;throw new Error("Failed pattern match at Parser.Main (line 322, column 33 - line 324, column 23): "+[u.constructor.name])})(t.lookahead)));throw new Error("Failed pattern match at Parser.Main (line 334, column 26 - line 338, column 68): "+[r.constructor.name])}}}(n)(e))(t)}}}(e)(u)(a);if(0===He(v))return l=!0,a;var s=Sn(function(n){return function(e){return function(t){return{append:function(u){return function(r){return Cf(n)(e)(t)(Sn(gn)(u)(r))}}}}}}(e)(n)(t))(a)(v);if(h(Of(e)(n)(t))(s)(a))return l=!0,a;o=n,i=e,c=t,f=u,r=s}for(;!l;)a=v(o,i,c,f,r);return a}}}}},$f=function(n){return function(e){return function(t){return function(u){return function(r){var a,o=n,i=e,c=t,f=u,l=!1;function v(n,e,t,u,a){var v=function(n){return function(e){return function(t){return function(u){return function(r){return Ht(Of(n.Eq0())(e)(t.Eq0()))(Sn(gn)(r)(rn(un)(r)(function(n){return function(e){return function(t){return function(u){return function(r){return Ht(Of(n.Eq0())(e)(t.Eq0()))(z(V)((a=Wf(e)(n.Eq0())(t.Eq0())(u),o=Cf(n.Eq0())(e)(t.Eq0()),function(n){return a(o(ft(n)))}))(function(n){return function(e){return function(t){var u=Mf(n)(e)(t);return Fn(An)(z(V)(wt(ht)(ff.create))(xu(Wt)(u.terminal)))(z(V)(wt(ht)(cf.create))(xu(Wt)(u.nonTerminal)))}}}(n)(t)(r)));var a,o}}}}}(n)(e)(t)(u))))}}}}}(n)(e)(t)(u)(a);if(h(M(Of(n.Eq0())(e)(t.Eq0())))(v)(a))return l=!0,a;o=n,i=e,c=t,f=u,r=v}for(;!l;)a=v(o,i,c,f,r);return a}}}}},Gf=function(n){return function(e){return function(t){return function(u){return function(r){return function(a){return z(ae)(vf)(du.traverseWithIndex(fe)((function(o){return function(i){var c,f=z(Ua)(af.create)(function(n){return function(e){return qt(Bt)(Ya(n)(Fa))((function(e){return z(Ua)(Ta)(function(n){return function(e){return 0===e.rule.value1.length?$u(n)(Bt)(Y(V)(z(V)(ct.create)(e.lookahead))(new ct(e.pName,e.rName))):Wu}}(n)(e))}))(e)}}(t)(i)),l=Mf(n)(t)(i),v=function(o){return Gn(new ue(o))(re.create)(z(Yn)(u)(tu(h(Of(n.Eq0())(e)(t.Eq0()))(Wf(e)(n.Eq0())(t.Eq0())(r)(Cf(n.Eq0())(e)(t.Eq0())(o))))(a)))};return J(ce)(z(ae)((function(n){return function(e){return{sName:u(o),items:i,advance:Sn(Va(t)(wf))(n)(f),receive:e}}}))(Dt(Ga)(fe)((c=z(ae)(rf.create),function(n){return c(v(n))}))(l.terminal)))(Dt(ju)(fe)(v)(gt()(l.nonTerminal)))}}))(a))}}}}}},Vf={bimap:function(n){return function(e){return function(t){if(t instanceof cf)return new cf(n(t.value0));if(t instanceof ff)return new ff(e(t.value0));throw new Error("Failed pattern match at Parser.Main (line 166, column 1 - line 168, column 46): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}}},Yf=function(n){return function(e){var t=j(V)(n)((function(n){return{pName:new Wn(n.pName),rName:new Wn(n.rName),rule:z(V)(mt(Vf)(Wn.create)(Wn.create))(n.rule)}})),u={pName:jn.value,rName:jn.value,rule:[new cf(new Wn(e)),new ff(jn.value)]};return{augmented:Sn(gn)([u])(t),start:{pName:jn.value,rName:jn.value,rule:new lf([],u.rule),lookahead:[]}}}},Uf=function(){return Yf(qf)(Cc.value)}(),Hf=function(n){return(e=Xc,function(n){return function(t){return function(u){return function(r){var a=Yf(u)(r);return $f(Qn(e))(Jn(n))(Qn(t))(a.augmented)([Wf(Jn(n))(Jn(e.Eq0()))(Jn(t.Eq0()))(a.augmented)(Cf(Jn(e.Eq0()))(Jn(n))(Jn(t.Eq0()))([a.start]))])}}}})(Kc)(Jc)(qf)(Cc.value);var e},Jf=function(n){return(e=function(n){return Au("state generation did not work")},function(n){return n instanceof re?n.value0:e()})(Gf(Qn(Xc))(Jn(Kc))(Qn(Jc))(T(k)(1))(Uf.augmented)(Hf()));var e},Qf=function(){var n=jf(B)(Qn(Xc))(Jn(Kc))(Qn(Jc));return function(e){return n(Jf())}}(),Xf=function(){return n=qr()(Ve)(gr({reflectSymbol:function(){return"addRule"}})()()(gr({reflectSymbol:function(){return"changeRules"}})()()(gr({reflectSymbol:function(){return"changeText"}})()()(gr({reflectSymbol:function(){return"removeRule"}})()()(Mr)()()()())()()()())()()()())()()()())(l.value)((function(n){return function(e){var t,u,r,a,o,i,c,f=Fn(mr(Be))(dr(Be)(""))(e.changeText),v=Fn(mr(Be))(dr(Be)([]))(Xu(hr(Ve))((function(n){return function(e){if(n instanceof ue)return Yt(e)(n.value0);if(n instanceof re)return Qe((t=ut(ot(ot(at)))(h(d))(n.value0),function(n){return t(dt(n))}))(e);var t;throw new Error("Failed pattern match at Parser.Main (line 781, column 13 - line 783, column 73): "+[n.constructor.name])}}))(Fn(mr(Be))(z(ar)(ue.create)(e.addRule))(z(ar)(re.create)(e.removeRule)))([])),s=(er(v)((t=ma,function(n){var e=wa(t),u=function(n){return function(e){return t=Ln(n)(e),function(){console.log(t)};var t}}(n);return function(n){return e(u(n))}})(Dn(lt(Rn)(lt(qn)(qn)))))(),[oi(xo)(Ft(Bt)(wr(Be))(dr(Be))([Fo(Qo)(Jo.value)(Ao((function(e){return kt(Be)(_t)(rn(Kn)(Mi(e))(Si))(on(_e)(yi)(n.changeText))})))]))([])]);return ai(xo)([(c=xo,function(n){return function(e){return function(t){return new _r(Ro(n)("style")(e)(Nr(t)))}}}(c)(it(wr(c.MonadST5().Monad0().Applicative0()))))(K(en)(qo(Pe)("\n              .before { color: lightgray; }\n            "))),Rr(Lo(xo)(Uu(Le(ye)))((function(t){return function(u){var r,a=Fn(mr(Be))(dr(Be)(new ct("","")))(Xu(hr(Ve))((function(n){return function(e){return n.value0?new ct(dt(e),n.value1):new ct(n.value1,ft(e))}}))(u)(new ct("",""))),o=Fn(mr(Be))(dr(Be)(0))(z(ar)(z(G)(T(k)(1))(dt))(e.addRule)),i=[oi(xo)(Ft(Bt)(wr(Be))(dr(Be))([Fo(Qo)(Jo.value)(Ao((function(n){return kt(Be)(_t)(rn(Kn)(Mi(n))(Si))(on(_e)(yi)((e=ct.create(!1),function(n){return t(e(n))})));var e})))]))([]),oi(xo)(Ft(Bt)(wr(Be))(dr(Be))([Fo(Qo)(Jo.value)(Ao((function(n){return kt(Be)(_t)(rn(Kn)(Mi(n))(Si))(on(_e)(yi)((e=ct.create(!0),function(n){return t(e(n))})));var e})))]))([]),ui(xo)(Fc(a)(Fc(o)(dr(Be)((function(e){return function(t){return Fo(Uo)(Yo.value)(tc(rn(rc)(wc(e))((function(e){return rn(rc)(wc(t))((function(t){return wa(ic)(n.addRule(new ct(e,t)))}))}))))}})))))([qo(Pe)("Add")])];return ai(xo)(Sn(gn)(i)(K(en)((r=z(ar)((function(e){return Qu(hr(Ve))(Lo(xo)(Uu(Le(ye)))((function(t){return function(u){return Fn(mr(Be))(dr(Be)(new Ar(ai(xo)([qo(Pe)(dt(e.value1)),qo(Pe)(" : "),qo(Pe)(ft(e.value1)),qo(Pe)(" "),ui(xo)(dr(Be)(Fo(Uo)(Yo.value)(Q(xe)(t(Fr.value))(n.removeRule(e.value0)))))([qo(Pe)("Delete")])]))))(u)}})))}))(e.addRule),new kr(r)))))}}))),si(xo)(K(en)(pi(xo)(z(V)((o=wi(xo),i=z(V)(di(xo)),function(n){return o(i(n))}))([[[qo(Pe)("E")],[qo(Pe)(":")],[qo(Pe)("("),qo(Pe)("L"),qo(Pe)(")")],[qo(Pe)("data E")],[qo(Pe)("=")],[qo(Pe)("E1"),qo(Pe)(" "),qo(Pe)("L")]],[[],[qo(Pe)("|")],[qo(Pe)("x")],[],[qo(Pe)("|")],[qo(Pe)("E2")]],[[qo(Pe)("L")],[qo(Pe)(":")],[qo(Pe)("E")],[qo(Pe)("data L")],[qo(Pe)("=")],[qo(Pe)("L1"),qo(Pe)(" "),qo(Pe)("E")]],[[],[qo(Pe)("|")],[qo(Pe)("L"),qo(Pe)(","),qo(Pe)("E")],[],[qo(Pe)("|")],[qo(Pe)("L2"),qo(Pe)(" "),qo(Pe)("L"),qo(Pe)(" "),qo(Pe)("E")]]])))),ai(xo)(K(en)(fi(xo)(z(V)((r=ci(xo),a=K(en),function(n){return r(a((e=n,Tf($n(Vc))($n(Yc))($n(Gc))(e)(xo))));var e}))(Hf())))),ai(xo)(K(en)(xf(Rn)($n(Yc))($n(Vc))($n(Gc))(Qn(Xc))(Qn(Jc))(Jf())(xo))),ai(xo)(s),ai(xo)(K(en)(I((u=Ve,function(n){return function(e){var t;return new kr(Qu(hr(u))(vr(u)((t=e,Ku(hr(u))((function(n){return function(e){return new ct(e+1|0,new ct(n,e))}}))(t)(0)))((function(e){return z(ar)((function(t){return Fn(mr(u.Monad0().Applicative0()))(Zu(hr(u))(new Ar(n(t.value0))))(z(ar)(C(Fr.value))(pr(u.Monad0().Applicative0()).filter((r=h(d)(t.value1+1|0),function(n){return r(ft(n))}))(e)));var r}))(e)}))))}}))(f)((function(n){var e,t,u=(e=Rn,function(n){return function(t){return function(u){return function(r){return function(a){if(a instanceof jn)return K(Ea(fa))(K(nn)(qo(u.MonadST5().Monad0())("Parse error")));if(a instanceof Wn)return Bf(r)(e)(n)(t)(u)(a.value0);throw new Error("Failed pattern match at Parser.Main (line 632, column 1 - line 632, column 212): "+[a.constructor.name])}}}}})($n(Gc))($n(Yc))(xo)($n(Gc))(z(Yn)(z(Nc)(z(qc)(z(ae)(z(Lf)(ft)))))(Y(Yn)(z(Yn)((t=Qf(F),function(n){return function(e){var u=function(n){var e=function(n){return function(e){if(e.inputs instanceof mu)return new ue(new Wn(e.stack));if(e.inputs instanceof wu){var t=n.step(Bc(e.stack))(e.inputs.value0);if(t instanceof jn)return new ue(jn.value);if(t instanceof Wn&&t.value0 instanceof ue){var u=new kc(e.stack,n.promote(e.inputs.value0),t.value0.value0);return new re({stack:u,inputs:e.inputs.value1})}if(t instanceof Wn&&t.value0 instanceof re){var r=n.goto(t.value0.value0)(e.stack);if(r instanceof jn)return new ue(jn.value);if(r instanceof Wn)return new re({stack:r.value0,inputs:e.inputs});throw new Error("Failed pattern match at Parser.Proto (line 65, column 9 - line 67, column 65): "+[r.constructor.name])}throw new Error("Failed pattern match at Parser.Proto (line 59, column 24 - line 67, column 65): "+[t.constructor.name])}throw new Error("Failed pattern match at Parser.Proto (line 57, column 3 - line 67, column 65): "+[e.inputs.constructor.name])}}(t)(n);if(e instanceof ue&&e.value0 instanceof jn)return Tc.value;if(e instanceof ue&&e.value0 instanceof Wn)return new Pc(e.value0.value0);if(e instanceof re)return new _c(e.value0,u(e.value0));throw new Error("Failed pattern match at Parser.Proto (line 73, column 15 - line 76, column 43): "+[e.constructor.name])},r=function(n){return function(e){return{stack:new bc(e),inputs:n}}}(n)(e);return new _c(r,u(r))}}))(Nf(n)))(1))),r=Aa(u(0));return qr()(Ve)(gr({reflectSymbol:function(){return"animationTick"}})()()(gr({reflectSymbol:function(){return"rate"}})()()(gr({reflectSymbol:function(){return"slider"}})()()(gr({reflectSymbol:function(){return"startState"}})()()(gr({reflectSymbol:function(){return"toggleLeft"}})()()(gr({reflectSymbol:function(){return"toggleRight"}})()()(Mr)()()()())()()()())()()()())()()()())()()()())()()()())(l.value)((function(n){return function(e){var t,u=Fn(mr(Be))(e.startState)(dr(Be)(jn.value)),a=Fn(mr(Be))(e.rate)(dr(Be)(1)),o=Vu(sr(Be))(Ku(hr(Ve))((function(n){return function(e){var t=n.value0?0:e.target;return t>n.value1.beats?new ct({target:t},jn.value):new ct({target:t+1},new Wn(n))}}))(e.animationTick)({target:0})),i=(t=function(n){return function(e){return function(t){return function(u){return n(e(t))(e(u))}}}}(h(d))(dt),function(n){return function(e){return function(u){return Vu(sr(n))(Ku(hr(e))((function(n){return function(e){var u=new Wn(n);return new ct(u,h(Jn(w))(J(Xn)(z(Yn)(t)(e))(u))(new Wn(!0))?jn.value:new Wn(n))}}))(u)(jn.value))}}})(Be)(Ve)(Fn(mr(Be))(dr(Be)(new ct(r.value1,nf.value)))(Ku(hr(Ve))((function(n){return function(e){var t,u=(t=B,function(n){return function(e){return function(u){return function(n){return function(e){return function(t){var u=N(n)(e)(t);if(u instanceof g)return e;if(u instanceof S)return e;if(u instanceof E)return t;throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[u.constructor.name])}}}(t)(e)(function(n){return function(e){return function(t){var u=N(n)(e)(t);if(u instanceof g)return t;if(u instanceof S)return e;if(u instanceof E)return e;throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[u.constructor.name])}}}(t)(n)(u))}}})(0)(r.value1)(n.value0(e));return new ct(u,new ct(u,n.value1))}}))(At(Bt)(wr(Be))([$(ar)(new ct((function(n){return n-1|0}),ef.value))(e.toggleLeft),$(ar)(new ct((function(n){return n+1|0}),ef.value))(e.toggleRight),z(ar)((function(n){return n.value0?new ct((function(n){return n===r.value1?0:n+1|0}),uf.value):new ct((function(n){return n+1|0}),uf.value)}))(o),z(ar)((function(n){return e=C(ja(n)),new ct(e,tf.value);var e}))(e.slider)]))(r.value1)));return Rr(Qu(hr(Ve))(vr(Ve)(i)((function(t){return Ef(Ve)(!0)(z(ar)(dt)(t))((function(o){var c,f,l,v,s,p,d=r.value0(o);return ai(xo)([ai(xo)([ui(xo)(At(Bt)(wr(Be))([j(ar)((l=hr(Ve),function(n){return function(e){return Fn(l.Plus0().Alt0())(Ju(l)(n)(e))(Ju(l)(e)(z(l.Filterable1().Functor1())(O)(n)))}})(a)(z(ar)(ct.create)(u)))((function(t){return Fo(Uo)(Yo.value)(function(){if(t.value0 instanceof Wn)return function(){return t.value0.value0(),n.startState(jn.value)()};if(t.value0 instanceof jn){var u=(a=gt(),function(n){return a(n)/1e3});return function(){var a=z(Re)(u)(Mc)(),o=er(function(n){return function(e){return function(t){return function(u){return function(r){return rn(n.Monad0().Bind1())(Ye(n)(pn(K(n.Monad0().Applicative0())(F))))((function(a){return rn(n.Monad0().Bind1())(er(u)((function(u){return e(u)?Q(n.Monad0().Bind1().Apply0())(fn(n.Monad0().Bind1())(Ye(n)(dn(a))))(t):r(u)})))((function(e){return tn(cn)(n.Monad0().Bind1())(W(n.Monad0().Bind1().Apply0().Functor0())(Ye(n)(mn(e)(a))))((function(){return K(n.Monad0().Applicative0())(fn(n.Monad0().Bind1())(Ye(n)(dn(a))))}))}))}))}}}}}(Ve)((function(n){return dt(n.value1)===r.value1&&!n.value0.value0}))(n.startState(jn.value))(Ju(hr(Ve))(i)(z(ar)(ct.create)(Ku(hr(Ve))((function(n){return function(e){return new ct(!1,new ct(e,n))}}))(Ac(function(n){return function(e){return function(t){return Ju(n)(Fn(n.Plus0().Alt0())(Zu(n)(e))(t))}}}(hr(Ve))(t.value1)(e.rate))(z(ar)((function(n){return u(n.time)-a}))(Ec(yc))))(!0)))))((function(e){return n.animationTick(e.value0)}))();return n.startState(new Wn(o))()}}var a;throw new Error("Failed pattern match at Parser.Main (line 921, column 43 - line 944, column 74): "+[t.value0.constructor.name])}())}))]))([Bo(Pe)(j(ar)(u)((function(n){if(n instanceof Wn)return"Pause";if(n instanceof jn)return"Play";throw new Error("Failed pattern match at Parser.Main (line 948, column 56 - line 950, column 60): "+[n.constructor.name])})))])]),ai(xo)([qo(Pe)("Speed"),(f=xo,li(f)(it(wr(f.MonadST5().Monad0().Applicative0()))))(fn(un)(z(V)((function(e){return[oi(xo)(Ft(Bt)(wr(Be))(dr(Be))([Fo(ti)(ei.value)("radio"),Fo(Io)(Do.value)(Ln(xn)("1x"===e.value1)),Fo(Vo)(Go.value)("speed"),Fo(ni)(Zo.value)(Ln(Nn)(e.value0)),Fo(Ho)(Yo.value)(Ao((function(t){return n.rate(e.value0)})))]))([]),ii(xo)([qo(Pe)(e.value1)])]}))([new ct(1,"1x"),new ct(.36787944117144233,"ex"),new ct(.3183098861837907,"pix")])))]),ai(xo)([oi(xo)(At(Bt)(wr(Be))([dr(Be)(Fo(ti)(ei.value)("range")),dr(Be)(Fo($o)(Wo.value)("0")),dr(Be)(Fo(jo)(zo.value)(Ln(Rn)(r.value1))),j(ar)(Yu(pr(Be))((function(n){return n.value1 instanceof tf?jn.value:new Wn(n.value0)}))(t))((function(n){return Fo(ni)(Zo.value)(Ln(Rn)(n))})),(v=Be,s=Fn(mr(v))(dr(v)(Fo(ti)(ei.value)("range"))),p=z(ar)((function(n){return Fo(Qo)(Jo.value)(Ao((function(e){return kt(Be)(_t)(rn(Kn)(Mi(e))(Si))(on(_e)(gi)(n))})))})),function(n){return s(p(n))})(j(ar)(u)((function(e){if(e instanceof jn)return n.slider;if(e instanceof Wn)return function(t){return Q(xe)(Q(xe)(n.slider(t))(e.value0))(n.startState(jn.value))};throw new Error("Failed pattern match at Parser.Main (line 984, column 65 - line 988, column 72): "+[e.constructor.name])})))]))([])]),(c=function(e){return(t=ar,function(n){return z(t)(Fo(n)(Yo.value))})(Uo)(j(ar)(u)((function(t){if(t instanceof jn)return e(F);if(t instanceof Wn)return Q(xe)(Q(xe)(e(F))(t.value0))(n.startState(jn.value));throw new Error("Failed pattern match at Parser.Main (line 996, column 37 - line 1000, column 68): "+[t.constructor.name])})));var t},ai(xo)([ui(xo)(c(n.toggleLeft))([qo(Pe)("<")]),ui(xo)(c(n.toggleRight))([qo(Pe)(">")])])),ai(xo)([d])])}))}))))}}))}))))])}})),W(Re)((e=n,function(){var n=rn(_e)(rn(_e)(Yi)(Vi))($i)();return Gn(Fe(Le(Le(ye))))((function(n){return Ui(n)(e)}))(z(Yn)(Gi)(n))()}));var n,e}();Xf()})();