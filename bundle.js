(()=>{"use strict";var n={576:(n,e,t)=>{t.d(e,{Z:()=>i});var r=t(81),u=t.n(r),o=t(645),a=t.n(o)()(u());a.push([n.id,"@import url(https://fonts.googleapis.com/css2?family=Cormorant:ital,wght@0,600;1,600&family=Fira+Code:wght@300;400;700&family=Oswald:wght@200..700&family=Sofia&family=Amaranth:ital,wght@0,400;0,700;1,400;1,700&display=swap);"]),a.push([n.id,'/*\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n/**/\n\nbody {\n  font-size: 18px;\n  background: #043147;\n  color: #f0e8d4;\n  font-family: "Cormorant";\n  margin: 0;\n}\nbody, .parse-table > thead > tr > th:not(:first-child), .parse-table tr > th:first-child {\n  background: #043147;\n}\n::-moz-selection {\n  background-color: rgb(3 182 140 / 46%);\n  color: white;\n  text-shadow: none;\n}\n::selection {\n  background-color: rgb(3 182 140 / 46%);\n  color: white;\n  text-shadow: none;\n}\n\ntable {\n  white-space: nowrap;\n}\n\n.unusable {\n  opacity: 0.45;\n}\n.clickable {\n  cursor: pointer;\n}\n\n.widgets.focus-mode {\n  width: 100vw;\n  height: 100vh;\n  display: grid;\n  grid-template-columns: repeat(2, 50vw);\n  grid-auto-flow: row;\n  grid-auto-rows: 50vh;\n  overflow: auto;\n  -ms-scroll-snap-type: both mandatory;\n      scroll-snap-type: both mandatory;\n}\n\n@media (max-width: 760px) {\n  .widgets.focus-mode {\n    grid-template-columns: repeat(1, 100vw);\n  }\n}\n@media (max-height: 500px) {\n  .widgets.focus-mode {\n    grid-auto-rows: 100vh;\n  }\n}\n.widgets.focus-mode > :not(.widget) {\n  display: none;\n}\n.widgets.focus-mode > .widget {\n  flex: 0 0 auto;\n  align-self: stretch;\n  overflow: auto;\n  border: 1px solid gray;\n  box-sizing: border-box;\n  scroll-snap-align: start;\n}\n.widgets.focus-mode > .widget > :only-child {\n  padding: 10px;\n  width: -webkit-max-content;\n  width: -moz-max-content;\n  width: max-content;\n  height: -webkit-max-content;\n  height: -moz-max-content;\n  height: max-content;\n}\n.widgets.focus-mode > .widget > table {\n  width: -webkit-max-content;\n  width: -moz-max-content;\n  width: max-content;\n}\n\n\n.keyword {\n  font-family: "Sofia";\n  color: #918b8e;\n}\n.keyword, .terminal, .meta, .cmd, .non-terminal, .rule, .state {\n  line-height: 1em;\n}\n.terminal {\n  font-weight: bolder;\n  font-family: "Fira Code";\n  color: #c2d3d3;\n}\n.selected {\n  text-decoration: underline;\n}\n.terminal:not(:last-child) {\n  letter-spacing: 1.5px;\n}\n.terminal.clickable {\n  padding: 0 0.2em;\n}\n.meta {\n  font-family: "Oswald";\n  font-weight: 300;\n  color: #7a6565;\n  font-size: 1em;\n  line-height: 1em;\n  margin: 0 calc(0.1em + 1.5px) 0 0.1em;\n}\n.cmd {\n  color: #cc82a9;\n  font-weight: 600;\n  font-family: "Cormorant";\n  font-style: italic;\n}\n.non-terminal, .rule {\n  font-family: "Oswald";\n  font-weight: 200;\n  color: #47cf6e;\n  margin: 0 3.5px 0 2px;\n}\n.non-terminal:last-child, .rule:last-child {\n  margin: 0 2px 0 2px;\n}\n.rule {\n  font-weight: 400;\n  color: #2c9f9b;\n}\n.state {\n  font-family: "Cormorant";\n  font-variant-numeric: lining-nums tabular-nums;\n  color: #ccb11c;\n}\n\n.stack .meta, .stack .rule, .stack > .terminal {\n  margin: 0;\n  letter-spacing: normal;\n}\n.stack > sub {\n  margin: 0 1px;\n}\n.full.stack {\n  display: flex;\n  flex-direction: row;\n}\n.full.stack > .terminal {\n  border: solid .1em #7a6565;\n  border-radius: .2em;\n  display: inline-block;\n  height: -webkit-fit-content;\n  height: -moz-fit-content;\n  height: fit-content;\n  margin: 0 .2em .5em;\n  padding: .1em .2em 0;\n}\n.full.stack > sub {\n  margin-top: .5em;\n  text-decoration: underline;\n  -webkit-text-decoration-color: #ccb11c;\n          text-decoration-color: #ccb11c;\n}\n.full.stack > :nth-last-child(2), .full.stack > .AST:nth-last-child(2) > li > .node {\n  border-color: lightgreen;\n}\n.parse-steps {\n  position: relative;\n  width: 100%;\n}\n.parse-steps > div {\n  top: 2em;\n  position: absolute;\n  width: 100%;\n}\n.parse-steps > span {\n  position: absolute;\n}\n.layer .rule, .layer .meta {\n  margin: 0;\n}\n.AST ol.layer {\n  margin: 0;\n}\n\n\n/* https://www.cssscript.com/clean-tree-diagram/ */\n/* https://codepen.io/ross-angus/pen/jwxMjL */\n\n/* It\'s supposed to look like a tree diagram */\n.AST, .AST ol, .AST li {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    position: relative;\n}\n\n.AST {\n    margin: 0;\n    text-align: center;\n}\n.AST, .AST ol {\n    display: table;\n}\n.AST ol {\n  width: 100%;\n}\n    .AST li {\n        display: table-cell;\n        padding: .5em 0 0;\n        vertical-align: top;\n    }\n        /* _________ */\n        .AST li:before {\n            outline: solid 1px #7a6565;\n            content: "";\n            left: 0;\n            position: absolute;\n            right: 0;\n            top: 0;\n        }\n        .AST .node:hover + ol li:before {\n            outline-color: green;\n        }\n        .AST li:first-child:before {left: 50%;}\n        .AST li:last-child:before {right: 50%;}\n\n        .AST .node {\n            border: solid .1em #7a6565;\n            border-radius: .2em;\n            display: inline-block;\n            margin: 0 .2em .5em;\n            padding: .1em .2em 0;\n            position: relative;\n        }\n        .AST .node:hover, .AST .node:hover + ol .node {\n          border-color: green;\n        }\n\n            /* | */\n            .AST ol:before,\n            .AST .node:before {\n                outline: solid 1px #7a6565;\n                content: "";\n                height: .45em;\n                left: 50%;\n                position: absolute;\n            }\n            .AST .node:hover + ol .node:before, .AST .node:hover + ol:before, .AST .node:hover + ol ol:before {\n                outline-color: green;\n            }\n            .AST ol:before {\n                top: -.5em;\n            }\n            .AST .node:before {\n                top: -.55em;\n            }\n\n/* The root node doesn\'t connect upwards */\n.AST > li {margin-top: 0; padding-top: 0}\n    .AST > li:before,\n    .AST > li:after,\n    .AST > li > .node:before {\n      outline: none;\n    }\n\n\n\n\n.zipper > .parsed:not(:last-child) > * {\n  /*color: black;*/\n  opacity: 0.45;\n}\n.zipper > .parsed {\n  --line-height: 2.8ex;\n  --line-color: #7a6565;\n  background-image: linear-gradient(transparent calc(var(--line-height) - 1px),var(--line-color) calc(var(--line-height) - 1px),var(--line-color) calc(var(--line-height) + 1px),transparent calc(var(--line-height) + 1px));\n  /**/\n}\n.zipper > .parsed:last-child {\n  /*color: #575a5e;/**/\n  /*--line-color: #1f4f4c;/**/\n}\n.zipper > :not(.parsed) {\n  /*\n  --line-height: 2.8ex;\n  --line-color: #80a8a8;\n  background-image: linear-gradient(transparent calc(var(--line-height) - 1px),var(--line-color) calc(var(--line-height) - 1px),var(--line-color) calc(var(--line-height) + 1px),transparent calc(var(--line-height) + 1px));\n  /**/\n}\ntd > .zipper {\n  width: 100%;\n  display: inline-block;\n}\n.zipper:hover > :not(.parsed) > :first-child {\n  outline: 2px solid cyan;\n  outline-offset: 2px;\n}\n.zipper:hover > .parsed:last-child {\n  outline: 2px solid #00a42f;\n  outline-offset: 2px;\n}\n.zipper > :not(.parsed)::before {\n  content: "•";\n  font-family: "Fira Code";\n  line-height: 1em;\n  color: cyan;\n}\n.zipper.reducible::after {\n  content: "•";\n  font-family: "Fira Code";\n  line-height: 1em;\n  color: #ce4e7a;\n}\n.reducible > .terminal {\n  color: #ce4e7a;\n}\n/*\n.zipper > .parsed::after, .cursor {\n  content: "";\n  border-right: 2px solid #0757b0;\n  border-color: #444;\n  margin-left: -1px;\n  margin-right: -1px;\n  animation: blink 2s infinite;\n}\n/**/\n@-webkit-keyframes blink {\n  from {\n    opacity: 1;\n  }\n  30% {\n    opacity: 0.3;\n  }\n  80% {\n    opacity: 1;\n  }\n  to {\n    opacity: 1;\n  }\n}\n@keyframes blink {\n  from {\n    opacity: 1;\n  }\n  30% {\n    opacity: 0.3;\n  }\n  80% {\n    opacity: 1;\n  }\n  to {\n    opacity: 1;\n  }\n}\n.zipper .parsed:not(:last-child) .terminal, .zipper .parsed:not(:last-child) .non-terminal {\n  /*color: inherit;/**/\n}\n.lookahead {\n  margin-left: 1em;\n  opacity: 0.8;\n}\n\n.conflict {\n  --line-height: 2.8ex;\n  --line-color: #bb194f;\n  background-image: linear-gradient(transparent calc(var(--line-height) - 1px),var(--line-color) calc(var(--line-height) - 1px),var(--line-color) calc(var(--line-height) + 1px),transparent calc(var(--line-height) + 1px));\n}\n.conflict .cmd {\n  color: #bb194f;\n}\n\n\ntable.grammar td:last-child {\n  padding-left: 1em;\n}\n.state-table {\n  border-spacing: 0;\n  border-collapse: collapse;\n}\n.state-table tbody.active {\n  background-color: #463d10;\n}\n.state-table tbody.hover {\n  background-color: #4b4731;\n}\n.state-table tbody tr th {\n  text-align: right;\n  padding-right: 1em;\n}\n.state-table tbody tr td:last-child {\n  padding-left: 1em;\n}\n.state-table tbody tr:last-child td {\n  border-bottom: 1px solid #afafafc2;\n}\n.state-table tbody tr:first-child th:first-child {\n  vertical-align: top;\n}\n.state-table tbody tr:first-child:not(:last-child) th:first-child .state {\n  position: -webkit-sticky;\n  position: sticky;\n  top: 0;\n}\n.parse-table {\n  border-collapse: separate;\n  border-spacing: 0;\n  /*border-collapse: collapse;/**/\n}\n.parse-table th {\n  font-weight: inherit;\n}\nth.first, td.first {\n  border-left: 1px solid #afafafc2;\n}\n.parse-table > thead {\n  position: -webkit-sticky;\n  position: sticky;\n  z-index: 1;\n  top: -1px;\n}\n/*\n.parse-table > thead > tr > th:nth-child(2) {\n  border-left: 1px solid transparent;\n}\n.parse-table > thead > tr > th:last-child {\n  border-right: 1px solid transparent;\n}\n/**/\n.parse-table thead th, .parse-table tr:last-child td:not(:first-child) {\n  border-bottom: 1px solid #afafafc2;\n}\n.parse-table tbody tr th:first-child {\n  text-align: right;\n  padding: 0 0.5em;\n  position: -webkit-sticky;\n  position: sticky;\n  left: 0;\n}\n.parse-table tbody tr th {\n  border-right: 1px solid #afafafc2;\n}\n.parse-table tbody tr td:last-child {\n  border-right: 1px solid #afafafc2;\n}\n.parse-table tbody td {\n  text-align: left;\n}\n.parse-table tr.active, .parse-table tr.active > th {\n  background-color: #463d10;\n}\n.parse-table tr.hover, .parse-table tr.hover > th {\n  background-color: #4b4731;\n}\n.parse-table td {\n  padding: 0 0.75em;\n}\n\n.parse-table > thead > tr > th {\n  vertical-align: bottom;\n}\n.pileup {\n  display: flex;\n  flex-direction: column;\n}\n.pileup > :last-child {\n  margin-top: 0.2em;\n  border-top: 1px solid gray;\n  padding-top: 0.2em;\n}\n\n.explorer-table tr.active {\n}\n.explorer-table tr.inactive {\n  opacity: 0.65;\n}\n\n\n\nbutton {\n  font-family: "Amaranth";\n  font-size: 0.9em;\n  line-height: 1.2;\n  border-radius: 1em;\n  color: #2372ffbb;\n  border: 2px solid #2372ffaa;\n  background: none;\n  padding: 0 0.5em;\n  margin: 0 0.25em;\n  transition: border-color 0.2s, color 0.2s, box-shadow 0.1s ease-out, transform 0.1s ease-out;\n  box-shadow: 1px 1px 0.5px 0.5px transparent, inset 1px 1px 0px 1.5px transparent;\n  /* https://stackoverflow.com/questions/3461441/prevent-flicker-on-webkit-transition-of-webkit-transform */\n  -webkit-backface-visibility: hidden;\n  transform: translate(0, -2px);\n}\nbutton.big {\n  padding-top: 0.2em;\n  padding-bottom: 0.25em;\n}\nbutton:not(:disabled):not(.disabled):hover {\n  transition: border-color 0.1s, color 0.1s, box-shadow 0.1s ease-out, transform 0.1s ease-out;\n  color: #2372ffff;\n  box-shadow: 1px 1px 0.5px 0.5px #2372ff44, inset 1px 1px 0px 1.5px #0002;\n}\n@media (hover: hover) and (pointer: fine) {\n  button:not(:disabled):not(.disabled):not(:hover) {\n    border-color: #2372ff55;\n  }\n}\nbutton:not(:disabled):not(.disabled):active {\n  color: #2372ffff;\n  border-color: #2372ffff;\n  box-shadow: 0px 0px 0px 0px transparent, inset 1px 1px 0px 0.5px #0002;\n  transform: translate(1.1px, calc(1.1px - 2px));\n}\nbutton:focus-visible {\n  outline: 1px solid white;\n  color: #2372ffff;\n}\nbutton:disabled, button.disabled {\n  border-color: #2372ff55;\n}\n\nbutton.delete {\n  color: #ff004dbb;\n  border: 2px solid #ff004daa;\n}\nbutton.delete:not(:disabled):not(.disabled):hover {\n  color: #ff004dff;\n  box-shadow: 1px 1px 0.5px 0.5px #ff004d44, inset 1px 1px 0px 1.5px #0002;\n}\n@media (hover: hover) and (pointer: fine) {\n  button.delete:not(:disabled):not(.disabled):not(:hover) {\n    border-color: #ff004d55;\n  }\n}\nbutton.delete:not(:disabled):not(.disabled):active {\n  color: #ff004dff;\n  border-color: #ff004dff;\n  box-shadow: 0px 0px 0px 0px transparent, inset 1px 1px 0px 0.5px #0002;\n}\nbutton.delete:focus-visible {\n  color: #ff004dff;\n}\nbutton.delete:disabled, button.delete.disabled {\n  border-color: #ff004d55;\n}\n\nbutton:disabled, button.disabled {\n  color: transparent;\n  background: repeating-linear-gradient(\n    12deg,\n    #707070,\n    #707070 4px,\n    #888888 4px,\n    #888888 8px\n  );\n  -webkit-background-clip: text;\n          background-clip: text;\n}\n\nlabel {\n  margin: 2px;\n  position: relative;\n  display: inline-block;\n  border-radius: 4px;\n}\nlabel > span {\n  font-family: "Amaranth";\n  font-weight: 400;\n  font-style: italic;\n  font-size: 12px;\n  display: block;\n  position: absolute;\n  padding: 0 4px;\n  top: -1px;\n  left: 5px;\n  background: #043147;\n  letter-spacing: normal;\n  color: #f0e8d4;\n  color: #2372ff;\n  line-height: 3px;\n}\nlabel > span:last-child {\n  left: initial;\n  right: 4px;\n}\nlabel.range {\n  margin-top: 10px;\n}\nlabel.range > span {\n  top: -8px;\n}\nlabel > input {\n  background: none;\n  border: none;\n  padding: 0 8px;\n  margin: 0;\n  font: inherit;\n  color: inherit;\n  height: 34px;\n  border-style: solid;\n  border-width: 1px;\n  border-color: #2372ffaa;\n  border-radius: 4px;\n  transition: border-color 0.2s;\n}\n@media (hover: hover) and (pointer: fine) {\n  label > input:not(:hover) {\n    border-color: #2373ff55;\n  }\n}\nlabel > input:not([type=range]):focus {\n  outline: none;\n  border-color: #2372ff;\n}\nlabel > input[type=range] {\n  border: none;\n  padding: 0;\n  height: auto;\n}\n\n\n\n\n.flex {\n  display: flex;\n}\n.justify-between {\n  justify-content: space-between;\n}\n.hidden {\n  visibility: hidden;\n}\n\nh1 {\n  text-align: center;\n  font-size: 45px;\n  font-weight: 300;\n  font-feature-settings: "ss01" 1;\n  /*\n    background-color: #f1ede2;\n    color: #f0e8d412;\n    text-shadow: 0px 2px 3px #3a383375;\n    -webkit-background-clip: text;\n    -moz-background-clip: text;\n    background-clip: text;\n  */\n}\nh2, h3, h4, h5 {\n  font-weight: 500;\n  font-feature-settings: "ss01" 1;\n}\nh2 {\n  text-align: center;\n  font-size: 34px;\n  margin-top: 2em;\n  margin-bottom: 1em;\n  font-weight: 500;\n}\nh3 {\n  font-size: 30px;\n  border-bottom-width: 1px;\n  border-bottom-style: solid;\n  line-height: 0.9;\n}\nh4 {\n  font-size: 26px;\n  font-family: \'Cormorant Upright\';\n}\nh5 {\n  font-size: 22px;\n  font-style: italic;\n  text-shadow: none;\n  font-weight: 700;\n}\nh5 em {\n  font-style: normal;\n}\n\n\n\n\n.Box::before, .Example::before, .Details::before, .Error::before, .Warning::before, .Key_Idea::before, .Bonus::before, .Note::before {\n  background: #043147;\n}\n\n.Error {\n  transition: border-image 0.4s;\n  transition: border-image 0.4s, -o-border-image 0.4s;\n  border-color: rgba(255, 0, 77, 0.6);\n  border-image-source: radial-gradient(ellipse at 50% 50%, rgba(255, 0, 77, 0.3), rgba(255, 0, 77, 0.5));\n}\n.Error:hover {\n  border-image-source: radial-gradient(ellipse at 50% 50%, #ff0055, rgba(255, 0, 77, 0.8));\n}\n.Error::before {\n  color: #ff004d;\n}\n.Error::-moz-selection, .Error *::-moz-selection {\n  background-color: rgba(255, 0, 77, 0.4);\n}\n.Error::selection, .Error *::selection {\n  background-color: rgba(255, 0, 77, 0.4);\n}\n\n.Box, .Example, .Details, .Error, .Warning, .Key_Idea, .Bonus, .Note {\n  border-style: solid;\n  border-width: 1px;\n  border-image-slice: 1;\n  padding: 8px;\n  /*margin: 0 -9px;*/\n}\n.Box > :first-child, .Example > :first-child, .Details > :first-child, .Error > :first-child, .Warning > :first-child, .Key_Idea > :first-child, .Bonus > :first-child, .Note > :first-child {\n  margin-top: 0;\n}\n.Box > :last-child, .Example > :last-child, .Details > :last-child, .Error > :last-child, .Warning > :last-child, .Key_Idea > :last-child, .Bonus > :last-child, .Note > :last-child {\n  margin-bottom: 0;\n}\n.Box[data-box-name]::before, [data-box-name].Example::before, [data-box-name].Details::before, [data-box-name].Error::before, [data-box-name].Warning::before, [data-box-name].Key_Idea::before, [data-box-name].Bonus::before, [data-box-name].Note::before {\n  content: attr(data-box-name);\n}\n.Box::before, .Example::before, .Details::before, .Error::before, .Warning::before, .Key_Idea::before, .Bonus::before, .Note::before {\n  font-family: "Amaranth";\n  font-weight: 400;\n  font-style: italic;\n  font-size: 0.92em;\n  transform: translateY(-1.2em);\n  display: block;\n  position: absolute;\n  padding: 0 4px;\n}\n\n.Error::before {\n  content: "Error";\n}\n.Error[data-box-name]::before {\n  content: attr(data-box-name);\n}\n',""]);const i=a},645:n=>{n.exports=function(n){var e=[];return e.toString=function(){return this.map((function(e){var t="",r=void 0!==e[5];return e[4]&&(t+="@supports (".concat(e[4],") {")),e[2]&&(t+="@media ".concat(e[2]," {")),r&&(t+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),t+=n(e),r&&(t+="}"),e[2]&&(t+="}"),e[4]&&(t+="}"),t})).join("")},e.i=function(n,t,r,u,o){"string"==typeof n&&(n=[[null,n,void 0]]);var a={};if(r)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(a[c]=!0)}for(var l=0;l<n.length;l++){var f=[].concat(n[l]);r&&a[f[0]]||(void 0!==o&&(void 0===f[5]||(f[1]="@layer".concat(f[5].length>0?" ".concat(f[5]):""," {").concat(f[1],"}")),f[5]=o),t&&(f[2]?(f[1]="@media ".concat(f[2]," {").concat(f[1],"}"),f[2]=t):f[2]=t),u&&(f[4]?(f[1]="@supports (".concat(f[4],") {").concat(f[1],"}"),f[4]=u):f[4]="".concat(u)),e.push(f))}},e}},81:n=>{n.exports=function(n){return n[1]}},379:n=>{var e=[];function t(n){for(var t=-1,r=0;r<e.length;r++)if(e[r].identifier===n){t=r;break}return t}function r(n,r){for(var o={},a=[],i=0;i<n.length;i++){var c=n[i],l=r.base?c[0]+r.base:c[0],f=o[l]||0,v="".concat(l," ").concat(f);o[l]=f+1;var s=t(v),d={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==s)e[s].references++,e[s].updater(d);else{var p=u(d,r);r.byIndex=i,e.splice(i,0,{identifier:v,updater:p,references:1})}a.push(v)}return a}function u(n,e){var t=e.domAPI(e);return t.update(n),function(e){if(e){if(e.css===n.css&&e.media===n.media&&e.sourceMap===n.sourceMap&&e.supports===n.supports&&e.layer===n.layer)return;t.update(n=e)}else t.remove()}}n.exports=function(n,u){var o=r(n=n||[],u=u||{});return function(n){n=n||[];for(var a=0;a<o.length;a++){var i=t(o[a]);e[i].references--}for(var c=r(n,u),l=0;l<o.length;l++){var f=t(o[l]);0===e[f].references&&(e[f].updater(),e.splice(f,1))}o=c}}},569:n=>{var e={};n.exports=function(n,t){var r=function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(n){t=null}e[n]=t}return e[n]}(n);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},216:n=>{n.exports=function(n){var e=document.createElement("style");return n.setAttributes(e,n.attributes),n.insert(e,n.options),e}},565:(n,e,t)=>{n.exports=function(n){var e=t.nc;e&&n.setAttribute("nonce",e)}},795:n=>{n.exports=function(n){var e=n.insertStyleElement(n);return{update:function(t){!function(n,e,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var u=void 0!==t.layer;u&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,u&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var o=t.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(r,n,e.options)}(e,n,t)},remove:function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(e)}}}},589:n=>{n.exports=function(n,e){if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}}},e={};function t(r){var u=e[r];if(void 0!==u)return u.exports;var o=e[r]={id:r,exports:{}};return n[r](o,o.exports,t),o.exports}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var r in e)t.o(e,r)&&!t.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:e[r]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),t.nc=void 0,(()=>{var n=t(379),e=t.n(n),r=t(795),u=t.n(r),o=t(569),a=t.n(o),i=t(565),c=t.n(i),l=t(216),f=t.n(l),v=t(589),s=t.n(v),d=t(576),p={};p.styleTagTransform=s(),p.setAttributes=c(),p.insert=a().bind(null,"head"),p.domAPI=u(),p.insertStyleElement=f(),e()(d.Z,p),d.Z&&d.Z.locals&&d.Z.locals;var m={compose:function(n){return function(e){return function(t){return n(e(t))}}}},h=function(n){return n.compose},w=function(n){return n.identity},M={identity:function(n){return n},Semigroupoid0:function(){return m}},b=function(n){return function(e){return function(t){return function(r){return n(e(t))(e(r))}}}},S=function(n){return function(e){return function(t){return n(t)(e)}}},y=function(n){return function(e){return n}},g=function(n){return function(e){return e(n)}};const A=void 0;var T=function(){function n(){}return n.value=new n,n}(),x=function(n){return n.map},E=function(n){return function(e){return function(t){return x(n)(t)(e)}}},F=function(n){return x(n)(y(A))},k=function(n){return function(e){return function(t){return x(n)(y(t))(e)}}},N=function(n){return function(e){return x(n)(y(e))}},B={map:h(m)},P={map:function(n){return function(e){for(var t=e.length,r=new Array(t),u=0;u<t;u++)r[u]=n(e[u]);return r}}},q=function(n){return function(e){return function(t){return x(n)((function(n){return n(t)}))(e)}}},I=function(n){return n.zero},C={add:function(n){return function(e){return n+e}},zero:0,mul:function(n){return function(e){return n*e}},one:1},D={add:function(n){return function(e){return n+e|0}},zero:0,mul:function(n){return function(e){return n*e|0}},one:1},z=function(n){return n.mul},R=function(n){return n.add},O={sub:function(n){return function(e){return n-e}},Semiring0:function(){return C}},_={sub:function(n){return function(e){return n-e|0}},Semiring0:function(){return D}},L={Ring0:function(){return O}},j={Ring0:function(){return _}},W=function(n){return function(e){return n===e}},U=function(n){return n.reflectSymbol};const $=function(n){return function(e){return e[n]}},V=function(n){return function(e){return function(t){var r={};for(var u in t)({}).hasOwnProperty.call(t,u)&&(r[u]=t[u]);return r[n]=e,r}}};var Y={eq:W},K={eqRecord:function(n){return function(n){return function(n){return!0}}}},G=function(n){return n.eqRecord},H=function(){return function(n){return{eq:G(n)(T.value)}}},J={eq:W},Z={eq:W},Q={eq:W},X={eq:W},nn=function(n){return n.eq},en=function(n){return{eq:(e=nn(n),function(n){return function(t){if(n.length!==t.length)return!1;for(var r=0;r<n.length;r++)if(!e(n[r])(t[r]))return!1;return!0}})};var e},tn=function(n){return function(){return function(e){return function(t){return{eqRecord:function(r){return function(r){return function(u){var o=G(n)(T.value)(r)(u),a=U(e)(T.value),i=$(a);return nn(t)(i(r))(i(u))&&o}}}}}}}},rn=function(n){return function(e){return function(t){return nn(X)(nn(n)(e)(t))(!1)}}},un=function(n){return n.mod},on={degree:function(n){return 1},div:function(n){return function(e){return n/e}},mod:function(n){return function(n){return 0}},CommutativeRing0:function(){return L}},an={degree:function(n){return Math.min(Math.abs(n),2147483647)},div:function(n){return function(e){return 0===e?0:e>0?Math.floor(n/e):-Math.floor(n/-e)}},mod:function(n){return function(e){if(0===e)return 0;var t=Math.abs(e);return(n%t+t)%t}},CommutativeRing0:function(){return j}},cn=function(n){return n.div},ln=function(){function n(){}return n.value=new n,n}(),fn=function(){function n(){}return n.value=new n,n}(),vn=function(){function n(){}return n.value=new n,n}(),sn={append:function(n){return function(e){if(n instanceof ln)return ln.value;if(n instanceof fn)return fn.value;if(n instanceof vn)return e;throw new Error("Failed pattern match at Data.Ordering (line 21, column 1 - line 24, column 18): "+[n.constructor.name,e.constructor.name])}}},dn={eq:function(n){return function(e){return n instanceof ln&&e instanceof ln||n instanceof fn&&e instanceof fn||n instanceof vn&&e instanceof vn}}},pn={append:function(n){return function(n){return A}}},mn={append:function(n){return function(e){return n+e}}},hn={appendRecord:function(n){return function(n){return function(n){return{}}}}},wn={append:function(n){return function(e){return 0===n.length?e:0===e.length?n:n.concat(e)}}},Mn=function(n){return n.appendRecord},bn=function(n){return n.append},Sn=function(n){return{append:function(e){return function(t){return function(r){return bn(n)(e(r))(t(r))}}}}},yn={mempty:A,Semigroup0:function(){return pn}},gn={mempty:"",Semigroup0:function(){return mn}},An={memptyRecord:function(n){return{}},SemigroupRecord0:function(){return hn}},Tn={mempty:[],Semigroup0:function(){return wn}},xn=function(n){return n.memptyRecord},En=function(n){return n.mempty},Fn=function(n){return function(e){return function(){return function(t){return{memptyRecord:function(r){var u=xn(t)(T.value),o=U(n)(T.value);return V(o)(En(e))(u)},SemigroupRecord0:function(){return function(n){return function(){return function(e){return function(t){return{appendRecord:function(r){return function(r){return function(u){var o=Mn(e)(T.value)(r)(u),a=U(n)(T.value),i=V(a),c=$(a);return i(bn(t)(c(r))(c(u)))(o)}}}}}}}}(n)()(t.SemigroupRecord0())(e.Semigroup0())}}}}}},kn=function(n){return{always:w(M),Monoid0:function(){return n}}},Nn=function(n){return n.always},Bn={alt:bn(wn),Functor0:function(){return P}},Pn=function(n){return n.alt},qn={apply:function(n){return function(e){return function(t){return n(t)(e(t))}}},Functor0:function(){return B}},In={apply:function(n){return function(e){for(var t=n.length,r=e.length,u=new Array(t*r),o=0,a=0;a<t;a++)for(var i=n[a],c=0;c<r;c++)u[o++]=i(e[c]);return u}},Functor0:function(){return P}},Cn=function(n){return n.apply},Dn=function(n){return function(e){return function(t){return Cn(n)(x(n.Functor0())(y(w(M)))(e))(t)}}},zn=function(n){return function(e){return function(t){return function(r){return Cn(n)(x(n.Functor0())(e)(t))(r)}}}};const Rn=String.fromCharCode(65535),On=String.fromCharCode(0);Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY;var _n=function(n){return function(e){return function(t){return function(r){return function(u){return r<u?n:r===u?e:t}}}}};const Ln=_n,jn=_n,Wn=_n,Un=_n;var $n=function(){return{compare:Wn(ln.value)(vn.value)(fn.value),Eq0:function(){return Y}}}(),Vn=function(){return{compare:jn(ln.value)(vn.value)(fn.value),Eq0:function(){return J}}}(),Yn=function(){return{compare:Ln(ln.value)(vn.value)(fn.value),Eq0:function(){return Z}}}(),Kn=function(){return{compare:Un(ln.value)(vn.value)(fn.value),Eq0:function(){return Q}}}(),Gn=function(n){return n.compare},Hn=function(n){return function(e){return function(t){var r=Gn(n)(e)(t);if(r instanceof ln)return t;if(r instanceof vn)return e;if(r instanceof fn)return e;throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[r.constructor.name])}}},Jn=function(n){return function(e){return function(t){var r=Gn(n)(e)(t);if(r instanceof ln)return e;if(r instanceof vn)return e;if(r instanceof fn)return t;throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[r.constructor.name])}}},Zn=function(n){return n.top},Qn={top:2147483647,bottom:-2147483648,Ord0:function(){return Yn}},Xn={top:Rn,bottom:On,Ord0:function(){return Kn}},ne=function(n){return n.bottom},ee={show:function(n){var e=n.length;return'"'+n.replace(/[\0-\x1F\x7F"\\]/g,(function(t,r){switch(t){case'"':case"\\":return"\\"+t;case"":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\v":return"\\v"}var u=r+1,o=u<e&&n[u]>="0"&&n[u]<="9"?"\\&":"";return"\\"+t.charCodeAt(0).toString(10)+o}))+'"'}},te={show:function(n){var e=n.toString();return isNaN(e+".0")?e:e+".0"}},re={show:function(n){return n.toString()}},ue={show:function(n){if(n)return"true";if(!n)return"false";throw new Error("Failed pattern match at Data.Show (line 23, column 1 - line 25, column 23): "+[n.constructor.name])}},oe=function(n){return n.show},ae=function(n){return n.pure},ie=function(n){return function(e){return function(t){if(e)return t;if(!e)return ae(n)(A);throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[e.constructor.name,t.constructor.name])}}},ce={pure:function(n){return function(e){return n}},Apply0:function(){return qn}},le={pure:function(n){return[n]},Apply0:function(){return In}},fe=function(){function n(){}return n.value=new n,n}(),ve=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),se=function(n){return{mempty:fe.value,Semigroup0:function(){return function(n){return{append:function(e){return function(t){if(e instanceof fe)return t;if(t instanceof fe)return e;if(e instanceof ve&&t instanceof ve)return new ve(bn(n)(e.value0)(t.value0));throw new Error("Failed pattern match at Data.Maybe (line 182, column 1 - line 185, column 43): "+[e.constructor.name,t.constructor.name])}}}}(n)}}},de=function(n){return function(e){return function(t){if(t instanceof fe)return n;if(t instanceof ve)return e(t.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},pe=de(!0)(y(!1)),me=de(!1)(y(!0)),he={map:function(n){return function(e){return e instanceof ve?new ve(n(e.value0)):fe.value}}},we=function(n){return de(n)(w(M))},Me=function(){return function(n){if(n instanceof ve)return n.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[n.constructor.name])}},be=function(n){return{eq:function(e){return function(t){return e instanceof fe&&t instanceof fe||e instanceof ve&&t instanceof ve&&nn(n)(e.value0)(t.value0)}}}},Se={apply:function(n){return function(e){if(n instanceof ve)return x(he)(n.value0)(e);if(n instanceof fe)return fe.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[n.constructor.name,e.constructor.name])}},Functor0:function(){return he}},ye={bind:function(n){return function(e){if(n instanceof ve)return e(n.value0);if(n instanceof fe)return fe.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[n.constructor.name,e.constructor.name])}},Apply0:function(){return Se}},ge=function(){return{pure:ve.create,Apply0:function(){return Se}}}(),Ae={Applicative0:function(){return ge},Bind1:function(){return ye}},Te={alt:function(n){return function(e){return n instanceof fe?e:n}},Functor0:function(){return he}},xe=function(){return{empty:fe.value,Alt0:function(){return Te}}}(),Ee={Applicative0:function(){return ge},Plus1:function(){return xe}},Fe=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ke=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Ne=function(n){return de(new Fe(n))(ke.create)},Be={map:function(n){return function(e){if(e instanceof Fe)return new Fe(e.value0);if(e instanceof ke)return new ke(n(e.value0));throw new Error("Failed pattern match at Data.Either (line 0, column 0 - line 0, column 0): "+[e.constructor.name])}}},Pe=function(n){return function(e){return function(t){if(t instanceof Fe)return n(t.value0);if(t instanceof ke)return e(t.value0);throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},qe=function(){return Pe(y(fe.value))(ve.create)}(),Ie={apply:function(n){return function(e){if(n instanceof Fe)return new Fe(n.value0);if(n instanceof ke)return x(Be)(n.value0)(e);throw new Error("Failed pattern match at Data.Either (line 70, column 1 - line 72, column 30): "+[n.constructor.name,e.constructor.name])}},Functor0:function(){return Be}},Ce={bind:Pe((function(n){return function(e){return new Fe(n)}}))((function(n){return function(e){return e(n)}})),Apply0:function(){return Ie}},De=function(){return{pure:ke.create,Apply0:function(){return Ie}}}(),ze={empty:[],Alt0:function(){return Bn}},Re=function(n){return n.empty},Oe=function(n){return n.discard},_e={bind:function(n){return function(e){return function(t){return e(n(t))(t)}}},Apply0:function(){return qn}},Le={bind:function(n){return function(e){for(var t=[],r=0,u=n.length;r<u;r++)Array.prototype.push.apply(t,e(n[r]));return t}},Apply0:function(){return In}},je=function(n){return n.bind},We=function(n){return S(je(n))},Ue=function(n){return function(e){return function(t){return function(r){return je(n)(e(r))(t)}}}},$e={discard:function(n){return je(n)}},Ve=function(n){return function(e){return je(n)(e)(w(M))}},Ye=function(n){return n.not},Ke=function(n){return n.ff},Ge=function(n){return n.disj},He={ff:!1,tt:!0,implies:function(n){return function(e){return Ge(He)(Ye(He)(n))(e)}},conj:function(n){return function(e){return n&&e}},disj:function(n){return function(e){return n||e}},not:function(n){return!n}},Je=function(n){return{ff:function(e){return Ke(n)},tt:function(e){return n.tt},implies:function(e){return function(t){return function(r){return n.implies(e(r))(t(r))}}},conj:function(e){return function(t){return function(r){return n.conj(e(r))(t(r))}}},disj:function(e){return function(t){return function(r){return Ge(n)(e(r))(t(r))}}},not:function(e){return function(t){return Ye(n)(e(t))}}}},Ze=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Qe=function(n){return n.value1},Xe=function(n){return function(e){return{append:function(t){return function(r){return new Ze(bn(n)(t.value0)(r.value0),bn(e)(t.value1)(r.value1))}}}}},nt=function(n){return function(e){return{mempty:new Ze(En(n),En(e)),Semigroup0:function(){return Xe(n.Semigroup0())(e.Semigroup0())}}}},et={map:function(n){return function(e){return new Ze(e.value0,n(e.value1))}}},tt=function(n){return n.value0},rt=function(n){return n.bimap},ut=function(n){return function(e){return rt(n)(e)(w(M))}},ot={bimap:function(n){return function(e){return function(t){return new Ze(n(t.value0),e(t.value1))}}}},at={bimap:function(n){return function(e){return function(t){if(t instanceof Fe)return new Fe(n(t.value0));if(t instanceof ke)return new ke(e(t.value0));throw new Error("Failed pattern match at Data.Bifunctor (line 32, column 1 - line 34, column 36): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}}},it=function(n){return{mempty:w(n),Semigroup0:function(){return e=n.Semigroupoid0(),{append:function(n){return function(t){return h(e)(n)(t)}}};var e}}};const ct=function(n){return n};var lt=function(){return ct},ft=lt,vt=function(){return function(){return function(n){return lt()}}},st=function(n){return n.foldr},dt=function(n){return function(e){return st(n)(Pn(e.Alt0()))(Re(e))}},pt=function(n){return function(e){return function(t){return st(n)((r=Pn(e.Alt0()),function(n){return r(t(n))}))(Re(e));var r}}},mt=function(n){return function(e){return function(t){return st(e)((r=Dn(n.Apply0()),function(n){return r(t(n))}))(ae(n)(A));var r}}},ht=function(n){return function(e){return S(mt(n)(e))}},wt=function(n){return function(e){return mt(n)(e)(w(M))}},Mt=function(n){return n.foldl},bt=function(n){return function(e){return Mt(n)(R(e))(I(e))}},St={foldr:function(n){return function(e){return function(t){if(t instanceof fe)return e;if(t instanceof ve)return n(t.value0)(e);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},foldl:function(n){return function(e){return function(t){if(t instanceof fe)return e;if(t instanceof ve)return n(e)(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},foldMap:function(n){return function(e){return function(t){if(t instanceof fe)return En(n);if(t instanceof ve)return e(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[e.constructor.name,t.constructor.name])}}}},yt={foldr:function(n){return function(e){return function(t){for(var r=e,u=t.length-1;u>=0;u--)r=n(t[u])(r);return r}}},foldl:function(n){return function(e){return function(t){for(var r=e,u=t.length,o=0;o<u;o++)r=n(r)(t[o]);return r}}},foldMap:function(n){return(e=yt,function(n){return function(t){return st(e)((function(e){return function(r){return bn(n.Semigroup0())(t(e))(r)}}))(En(n))}})(n);var e}},gt=function(n){return n.foldMap},At=function(n){return function(e){return lt()(gt(n)(function(n){return{mempty:Ke(n),Semigroup0:function(){return function(n){return{append:function(e){return function(t){return Ge(n)(e)(t)}}}}(n)}}}(e)))}},Tt={map:function(n){return function(e){return n(e)}}},xt={apply:function(n){return function(e){return n(e)}},Functor0:function(){return Tt}},Et={bind:function(n){return function(e){return e(n)}},Apply0:function(){return xt}},Ft={pure:function(n){return n},Apply0:function(){return xt}},kt={Applicative0:function(){return Ft},Bind1:function(){return Et}},Nt=function(n){return n.mapWithIndex},Bt={mapWithIndex:function(n){return function(e){for(var t=e.length,r=Array(t),u=0;u<t;u++)r[u]=n(u)(e[u]);return r}},Functor0:function(){return P}},Pt=function(n){return n.foldrWithIndex},qt=function(n){return n.foldlWithIndex},It={foldrWithIndex:function(n){return function(e){var t=st(yt)((function(e){return function(t){return n(e.value0)(e.value1)(t)}}))(e),r=Nt(Bt)(Ze.create);return function(n){return t(r(n))}}},foldlWithIndex:function(n){return function(e){var t=Mt(yt)((function(e){return function(t){return n(t.value0)(e)(t.value1)}}))(e),r=Nt(Bt)(Ze.create);return function(n){return t(r(n))}}},foldMapWithIndex:function(n){return(e=It,function(n){return function(t){return Pt(e)((function(e){return function(r){return function(u){return bn(n.Semigroup0())(t(e)(r))(u)}}}))(En(n))}})(n);var e},Foldable0:function(){return yt}},Ct=function(n){return n.foldMapWithIndex};const Dt=function(){function n(n){return[n]}function e(n){return function(e){return[n,e]}}function t(n){return function(e){return function(t){return[n,e,t]}}}function r(n){return function(e){return n.concat(e)}}return function(u){return function(o){return function(a){return function(i){return function(c){return function l(f,v){switch(v-f){case 0:return a([]);case 1:return o(n)(i(c[f]));case 2:return u(o(e)(i(c[f])))(i(c[f+1]));case 3:return u(u(o(t)(i(c[f])))(i(c[f+1])))(i(c[f+2]));default:var s=f+2*Math.floor((v-f)/4);return u(o(r)(l(f,s)))(l(s,v))}}(0,c.length)}}}}}}();var zt={map:function(n){return function(e){return function(t){var r=e(t);return{accum:r.accum,value:n(r.value)}}}}},Rt={apply:function(n){return function(e){return function(t){var r=n(t),u=e(r.accum);return{accum:u.accum,value:r.value(u.value)}}}},Functor0:function(){return zt}},Ot={pure:function(n){return function(e){return{accum:e,value:n}}},Apply0:function(){return Rt}},_t=function(n){return n.traverse},Lt={traverse:function(n){return function(e){return function(t){if(t instanceof fe)return ae(n)(fe.value);if(t instanceof ve)return x(n.Apply0().Functor0())(ve.create)(e(t.value0));throw new Error("Failed pattern match at Data.Traversable (line 115, column 1 - line 119, column 33): "+[e.constructor.name,t.constructor.name])}}},sequence:function(n){return function(e){if(e instanceof fe)return ae(n)(fe.value);if(e instanceof ve)return x(n.Apply0().Functor0())(ve.create)(e.value0);throw new Error("Failed pattern match at Data.Traversable (line 115, column 1 - line 119, column 33): "+[e.constructor.name])}},Functor0:function(){return he},Foldable1:function(){return St}},jt={traverse:function(n){return Dt(Cn(n.Apply0()))(x(n.Apply0().Functor0()))(ae(n))},sequence:function(n){return(e=jt,function(n){return _t(e)(n)(w(M))})(n);var e},Functor0:function(){return P},Foldable1:function(){return yt}},Wt=function(n){return n.sequence},Ut=function(n){return function(e){return function(t){return function(r){return _t(n)(Ot)((function(n){return function(t){return e(t)(n)}}))(r)(t)}}}},$t={traverseWithIndex:function(n){return(e=$t,function(n){return function(t){var r=Wt(e.Traversable2())(n),u=Nt(e.FunctorWithIndex0())(t);return function(n){return r(u(n))}}})(n);var e},FunctorWithIndex0:function(){return Bt},FoldableWithIndex1:function(){return It},Traversable2:function(){return jt}};const Vt=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){for(var a=[],i=o;;){var c=u(i);if(n(c))return a;var l=e(c);a.push(t(l)),i=r(l)}}}}}}},Yt=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){for(var a=[],i=o;;){var c=u(i);a.push(t(c));var l=r(c);if(n(l))return a;i=e(l)}}}}}}};var Kt={unfoldr1:Yt(pe)(Me())(tt)(Qe)},Gt=function(n){return n.unfoldr},Ht={unfoldr:Vt(pe)(Me())(tt)(Qe),Unfoldable10:function(){return Kt}},Jt=function(){function n(){}return n.value=new n,n}(),Zt=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Qt={map:function(n){var e;return e=Jt.value,function(t){var r,u=e,o=!1;function a(e,r){return r instanceof Zt&&r.value1 instanceof Zt&&r.value1.value1 instanceof Zt?(u=new Zt(r,e),void(t=r.value1.value1.value1)):(o=!0,(i=e,function(e){for(var t,r,u,o=i,a=!1;!a;)u=e,t=(r=o)instanceof Zt&&r.value0 instanceof Zt&&r.value0.value1 instanceof Zt&&r.value0.value1.value1 instanceof Zt?(o=r.value1,void(e=new Zt(n(r.value0.value0),new Zt(n(r.value0.value1.value0),new Zt(n(r.value0.value1.value1.value0),u))))):(a=!0,u);return t})((a=r)instanceof Zt&&a.value1 instanceof Zt&&a.value1.value1 instanceof Jt?new Zt(n(a.value0),new Zt(n(a.value1.value0),Jt.value)):a instanceof Zt&&a.value1 instanceof Jt?new Zt(n(a.value0),Jt.value):Jt.value));var a,i}for(;!o;)r=a(u,t);return r}}},Xt={foldr:function(n){return function(e){var t,r=(t=Jt.value,function(n){var e,r=t,u=!1;function o(e,t){if(t instanceof Jt)return u=!0,e;if(t instanceof Zt)return r=new Zt(t.value0,e),void(n=t.value1);throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[e.constructor.name,t.constructor.name])}for(;!u;)e=o(r,n);return e}),u=Mt(Xt)(S(n))(e);return function(n){return u(r(n))}}},foldl:function(n){return function(e){return function(t){var r,u=e,o=!1;function a(e,r){if(r instanceof Jt)return o=!0,e;if(r instanceof Zt)return u=n(e)(r.value0),void(t=r.value1);throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[r.constructor.name])}for(;!o;)r=a(u,t);return r}}},foldMap:function(n){return function(e){return Mt(Xt)((function(t){var r=bn(n.Semigroup0())(t);return function(n){return r(e(n))}}))(En(n))}}},nr={traverse:function(n){return function(e){var t=x(n.Apply0().Functor0())(Mt(Xt)(S(Zt.create))(Jt.value)),r=Mt(Xt)((function(t){var r=zn(n.Apply0())(S(Zt.create))(t);return function(n){return r(e(n))}}))(ae(n)(Jt.value));return function(n){return t(r(n))}}},sequence:function(n){return _t(nr)(n)(w(M))},Functor0:function(){return Qt},Foldable1:function(){return Xt}},er={unfoldr1:function(n){return function(e){var t;return(t=e,function(e){var r,u=t,o=!1;function a(t,r){var a=n(t);if(a.value1 instanceof ve)return u=a.value1.value0,void(e=new Zt(a.value0,r));if(a.value1 instanceof fe)return o=!0,Mt(Xt)(S(Zt.create))(Jt.value)(new Zt(a.value0,r));throw new Error("Failed pattern match at Data.List.Types (line 135, column 22 - line 137, column 61): "+[a.constructor.name])}for(;!o;)r=a(u,e);return r})(Jt.value)}}},tr={unfoldr:function(n){return function(e){var t;return(t=e,function(e){var r,u=t,o=!1;function a(t,r){var a=n(t);if(a instanceof fe)return o=!0,Mt(Xt)(S(Zt.create))(Jt.value)(r);if(a instanceof ve)return u=a.value0.value1,void(e=new Zt(a.value0.value0,r));throw new Error("Failed pattern match at Data.List.Types (line 142, column 22 - line 144, column 52): "+[a.constructor.name])}for(;!o;)r=a(u,e);return r})(Jt.value)}},Unfoldable10:function(){return er}};const rr=function(n){throw new Error(n)};var ur=function(n){return function(){return rr(n)}()};function or(n){return n.charCodeAt(0)}var ar=function(n){return function(e){if(e)return ae(n.Applicative0())(A);if(!e)return Re(n.Plus1());throw new Error("Failed pattern match at Control.Alternative (line 48, column 1 - line 48, column 54): "+[e.constructor.name])}},ir=function(n){return n.fromEnum},cr=function(n){return function(e){return function(t){return n(e(t)+1|0)}}},lr=function(n){return function(e){return function(t){return n(e(t)-1|0)}}},fr=function(n){return n>=ne(Qn)&&n<=Zn(Qn)?new ve((e=n,String.fromCharCode(e))):fe.value;var e},vr={succ:cr(fr)(or),pred:lr(fr)(or),Ord0:function(){return Kn}},sr=function(){return{cardinality:or(Zn(Xn))-or(ne(Xn))|0,toEnum:fr,fromEnum:or,Bounded0:function(){return Xn},Enum1:function(){return vr}}}();const dr=function(n){return function(e){return function(t){return function(r){return n(e,t,r)}}}};var pr=m,mr=M,hr={mapRecordWithIndexBuilder:function(n){return function(n){return w(mr)}}},wr=function(n){return n.mapRecordWithIndexBuilder},Mr=function(n){return function(e){return function(t){return function(){return function(){return{mapRecordWithIndexBuilder:function(r){return function(r){return h(pr)(function(n){return function(e){return function(t){return function(r){return function(n){return function(e){return function(t){return t[n]=e(t[n]),t}}}(U(n)(e))(t)(r)}}}}(n)(T.value)(e.mappingWithIndex(r)(T.value)))(wr(t)(T.value)(r))}}}}}}}},br=function(n){return{mappingWithIndex:function(e){return function(t){return n.mapping(e)}}}},Sr=function(){function n(){}return n.value=new n,n}(),yr=function(n){return{mapping:function(e){return x(B)(Nn(n))}}},gr=ct;const Ar=function(n){return function(e){return function(){for(var t=0,r=n.length;t<r;t++)e(n[t])()}}};function Tr(n){return function(){return{value:n}}}const xr=function(n){return function(){return n.value}},Er=function(n){return function(e){return function(){return e.value=n}}};var Fr=function(n){return function(e){return function(t){return je(n.Bind1())(e)((function(e){return je(n.Bind1())(t)((function(t){return ae(n.Applicative0())(e(t))}))}))}}};const kr=function(n){return function(){return n}};var Nr=function(n,e,t){var r,u=0;return function(o){if(2===u)return r;if(1===u)throw new ReferenceError(n+" was needed before it finished initializing (module "+e+", line "+o+")",e,o);return u=1,r=t(),u=2,r}},Br={Applicative0:function(){return qr},Bind1:function(){return Pr}},Pr={bind:function(n){return function(e){return function(){return e(n())()}}},Apply0:function(){return Cr(0)}},qr={pure:kr,Apply0:function(){return Cr(0)}},Ir=Nr("functorEffect","Effect",(function(){return{map:(n=qr,function(e){return function(t){return Cn(n.Apply0())(ae(n)(e))(t)}})};var n})),Cr=Nr("applyEffect","Effect",(function(){return{apply:Fr(Br),Functor0:function(){return Ir(0)}}})),Dr=Ir(20),zr=Cr(23),Rr=function(n){return{append:zn(zr)(bn(n))}},Or=function(n){return{mempty:kr(En(n)),Semigroup0:function(){return Rr(n.Semigroup0())}}};const _r=function(n){return function(){return n.value}};var Lr=function(n){return function(){return{value:n}}},jr=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Wr=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Ur=function(n){return n.tailRecM},$r={tailRecM:function(n){var e=function(n){return function(e){return function(e){var t,r=!1;function u(t){if(!(t instanceof jr)){if(t instanceof Wr)return r=!0,t.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 93, column 3 - line 93, column 25): "+[t.constructor.name])}e=n(t.value0)}for(;!r;)t=u(e);return t}(n(e))}}((function(e){return n(e)}));return function(n){return e(n)}},Monad0:function(){return kt}},Vr=function(n,e,t){var r,u=0;return function(o){if(2===u)return r;if(1===u)throw new ReferenceError(n+" was needed before it finished initializing (module "+e+", line "+o+")",e,o);return u=1,r=t(),u=2,r}},Yr=function(n){return function(n){return function(e){return function(){var t=n(e.value);return e.value=t.state,t.value}}}((function(e){var t=n(e);return{state:t,value:t}}))},Kr={map:function(n){return function(e){return function(){return n(e())}}}},Gr={Applicative0:function(){return Jr},Bind1:function(){return Hr}},Hr={bind:function(n){return function(e){return function(){return e(n())()}}},Apply0:function(){return Zr(0)}},Jr={pure:function(n){return function(){return n}},Apply0:function(){return Zr(0)}},Zr=Vr("applyST","Control.Monad.ST.Internal",(function(){return{apply:Fr(Gr),Functor0:function(){return Kr}}})),Qr=Zr(46),Xr={liftST:gr,Monad0:function(){return Br}},nu=function(n){return n.liftST};Array.prototype.fill;const eu=function(n){return n.length},tu=function(n){return function(e){return function(t){return 0===t.length?n({}):e(t[0])(t.slice(1))}}},ru=function(n){return function(e){return e.filter(n)}},uu=function(n){return function(e){for(var t=[],r=[],u=0;u<e.length;u++){var o=e[u];n(o)?t.push(o):r.push(o)}return{yes:t,no:r}}},ou=function(){function n(e,t,r,u,o,a){var i,c,l,f,v,s;for((i=o+(a-o>>1))-o>1&&n(e,t,u,r,o,i),a-i>1&&n(e,t,u,r,i,a),c=o,l=i,f=o;c<i&&l<a;)v=u[c],s=u[l],t(e(v)(s))>0?(r[f++]=s,++l):(r[f++]=v,++c);for(;c<i;)r[f++]=u[c++];for(;l<a;)r[f++]=u[l++]}return function(e){return function(t){return function(r){var u;return r.length<2?r:(u=r.slice(0),n(e,t,u,r.slice(0),0,r.length),u)}}}}(),au=function(n){return function(e){return function(t){return t.slice(n,e)}}},iu=function(n){return function(e){return n[e]}},cu=function(n){return function(){return n}};const lu=function(n){return function(){return n.slice()}};var fu=function(n){return e=[n],function(n){return function(){return n.push.apply(n,e)}};var e},vu=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),su=function(n){return function(){var e=xr(n.value1)();return n.value0(e)}},du=function(n){return function(){var e=xr(n.value1)();return Yr((function(n){return n+1|0}))(n.value1)(),n.value0(e)}},pu=function(n){return x(Kr)(vu.create(n))(Tr(0))},mu=function(n){return function(e){return function(){for(var t=Tr(!1)();x(Kr)(Ye(He))(xr(t))();)!function(){var r=du(n)();if(r instanceof ve)return e(r.value0)();if(r instanceof fe)return F(Kr)(Er(!0)(t))();throw new Error("Failed pattern match at Data.Array.ST.Iterator (line 42, column 5 - line 44, column 47): "+[r.constructor.name])}();return{}}}},hu=function(){return iu},wu=function(){return tu(y(fe.value))((function(n){return function(e){return new ve({head:n,tail:e})}}))}(),Mu=function(n){return ou(n)((function(n){if(n instanceof fn)return 1;if(n instanceof vn)return 0;if(n instanceof ln)return-1;throw new Error("Failed pattern match at Data.Array (line 829, column 31 - line 832, column 11): "+[n.constructor.name])}))},bu=function(n){return[n]},Su=function(n){return 0===eu(n)},yu=function(n){return function(n){return function(e){return t=[],Ar(e)((function(e){return function(){var r,u,o,a=x(Kr)((r=Ye(He),o=function(t){return n(t)(e)},u=function(n){for(var e=n.length,t=0;t<e;t++)if(o(n[t]))return!0;return!1},function(n){return r(u(n))}))(cu(t))();return ie(Jr)(a)(F(Kr)(fu(e)(t)))()}}))(),cu(t)();var t}}(nn(n))},gu=function(n){return function(e){return function(n){return function(e){return function(t){for(var r=e.length<t.length?e.length:t.length,u=new Array(r),o=0;o<r;o++)u[o]=n(e[o])(t[o]);return u}}}(n)((0,function(n){for(var e=0>n?-1:1,t=new Array(e*(n-0)+1),r=0,u=0;r!==n;)t[u++]=r,r+=e;return t[u]=r,t})(eu(e)-1|0))(e)}},Au=function(){return(n=ve.create,function(e){return function(t){return function(r){return r<0||r>=t.length?e:n(t[r])}}})(fe.value);var n}(),Tu=function(n){return Au(n)(0)},xu=function(n){return e=Gn(n),function(n){var t,r=Mu((function(n){return function(t){return e(Qe(n))(Qe(t))}}))(gu(Ze.create)(n)),u=Tu(r);if(u instanceof fe)return[];if(u instanceof ve)return x(P)(Qe)(function(n){return function(e){return Mu(function(n){return function(e){return function(t){return function(r){return Gn(n)(e(t))(e(r))}}}}(n)(e))}}(Yn)(tt)((t=function(n){return function(){return n}}(bu(u.value0))(),Ar(r)((function(n){return function(){var r,u,o=x(Kr)((r=Me(),u=function(n){return r(function(n){return Au(n)(eu(n)-1|0)}(n))},function(n){return Qe(u(n))}))(cu(t))();return ie(Jr)(rn(dn)(e(o)(n.value1))(vn.value))(F(Kr)(fu(n)(t)))()}}))(),cu(t)())));throw new Error("Failed pattern match at Data.Array (line 1044, column 17 - line 1052, column 29): "+[u.constructor.name])};var e},Eu=function(n){return function(e){return t=[],r=pu((function(n){return Au(e)(n)}))(),mu(r)((function(e){return F(Kr)((function(){var u,o=[];fu(e)(o)(),(u=n(e),function(n){return function(e){return function(){for(var t,r=Tr(!1)();x(Kr)(Ye(He))(xr(r))();)(t=su(n)())instanceof ve&&u(t.value0)?(fu(t.value0)(e)(),F(Kr)(du(n))()):F(Kr)(Er(!0)(r))();return{}}}})(r)(o)();var a=cu(o)();return fu(a)(t)()}))}))(),cu(t)();var t,r}},Fu=st(yt),ku=Mt(yt),Nu=function(n){return gt(yt)(n)},Bu=function(n){return function(e){return function(t){return tu((function(e){return ae(n.Applicative0())(t)}))((function(r){return function(u){return je(n.Bind1())(e(t)(r))((function(t){return Bu(n)(e)(t)(u)}))}}))}}},Pu=function(){return(n=ve.create,function(e){return function(t){return function(r){for(var u=0,o=r.length;u<o;u++)if(t(r[u]))return n(u);return e}}})(fe.value);var n}(),qu=function(n){return function(e){return x(he)(hu()(e))(Pu(n)(e))}},Iu=function(n){return function(e){return n<1?e:au(n)(eu(e))(e)}},Cu=function(){return(n=ve.create,function(e){return function(t){return function(r){if(t<0||t>=r.length)return e;var u=r.slice();return u.splice(t,1),n(u)}}})(fe.value);var n}(),Du=function(n){return function(e){return function(t){return 0===t.length?[]:de(t)((function(n){return Me()(Cu(n)(t))}))(Pu(n(e))(t))}}},zu=S(je(Le)),Ru=function(n){return zu((e=de([])(bu),function(t){return e(n(t))}));var e},Ou=function(){return n=Jt.value,function(e){var t,r=n,u=!1;function o(n,t){if(t instanceof Jt)return u=!0,n;if(t instanceof Zt)return r=new Zt(t.value0,n),void(e=t.value1);throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[n.constructor.name,t.constructor.name])}for(;!u;)t=o(r,e);return t};var n}(),_u=function(){function n(){}return n.value=new n,n}(),Lu=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}},n}(),ju=function(){function n(n,e,t,r,u,o,a){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=o,this.value6=a}return n.create=function(e){return function(t){return function(r){return function(u){return function(o){return function(a){return function(i){return new n(e,t,r,u,o,a,i)}}}}}}},n}(),Wu=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),Uu=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),$u=function(){function n(n,e,t,r,u,o){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=o}return n.create=function(e){return function(t){return function(r){return function(u){return function(o){return function(a){return new n(e,t,r,u,o,a)}}}}}},n}(),Vu=function(){function n(n,e,t,r,u,o){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=o}return n.create=function(e){return function(t){return function(r){return function(u){return function(o){return function(a){return new n(e,t,r,u,o,a)}}}}}},n}(),Yu=function(){function n(n,e,t,r,u,o){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=o}return n.create=function(e){return function(t){return function(r){return function(u){return function(o){return function(a){return new n(e,t,r,u,o,a)}}}}}},n}(),Ku=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}},n}(),Gu=function(n){return function(e){return new Lu(_u.value,n,e,_u.value)}},Hu=function(n){return function(e){return Gt(n)((function(n){var e,t=!1;function r(e){if(e instanceof Jt)return t=!0,fe.value;if(e instanceof Zt){if(e.value0 instanceof _u)return void(n=e.value1);if(e.value0 instanceof Lu&&e.value0.value0 instanceof _u&&e.value0.value3 instanceof _u)return t=!0,new ve(new Ze(new Ze(e.value0.value1,e.value0.value2),e.value1));if(e.value0 instanceof Lu&&e.value0.value0 instanceof _u)return t=!0,new ve(new Ze(new Ze(e.value0.value1,e.value0.value2),new Zt(e.value0.value3,e.value1)));if(e.value0 instanceof Lu)return void(n=new Zt(e.value0.value0,new Zt(Gu(e.value0.value1)(e.value0.value2),new Zt(e.value0.value3,e.value1))));if(e.value0 instanceof ju)return void(n=new Zt(e.value0.value0,new Zt(Gu(e.value0.value1)(e.value0.value2),new Zt(e.value0.value3,new Zt(Gu(e.value0.value4)(e.value0.value5),new Zt(e.value0.value6,e.value1))))));throw new Error("Failed pattern match at Data.Map.Internal (line 624, column 18 - line 633, column 71): "+[e.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 623, column 3 - line 623, column 19): "+[e.constructor.name])}for(;!t;)e=r(n);return e}))(new Zt(e,Jt.value))}},Ju=function(n){return function(e){var t=Gn(n);return function(n){var r,u=!1;function o(r){if(r instanceof _u)return u=!0,fe.value;if(r instanceof Lu){var o=t(e)(r.value1);return o instanceof vn?(u=!0,new ve(r.value2)):o instanceof ln?void(n=r.value0):void(n=r.value3)}if(r instanceof ju){var a=t(e)(r.value1);if(a instanceof vn)return u=!0,new ve(r.value2);var i=t(e)(r.value4);return i instanceof vn?(u=!0,new ve(r.value5)):a instanceof ln?void(n=r.value0):i instanceof fn?void(n=r.value6):void(n=r.value3)}throw new Error("Failed pattern match at Data.Map.Internal (line 241, column 5 - line 241, column 22): "+[r.constructor.name])}for(;!u;)r=o(n);return r}}},Zu=function(n){return function(e){return function(t){return me(Ju(n)(e)(t))}}},Qu={map:function(n){return function(e){if(e instanceof _u)return _u.value;if(e instanceof Lu)return new Lu(x(Qu)(n)(e.value0),e.value1,n(e.value2),x(Qu)(n)(e.value3));if(e instanceof ju)return new ju(x(Qu)(n)(e.value0),e.value1,n(e.value2),x(Qu)(n)(e.value3),e.value4,n(e.value5),x(Qu)(n)(e.value6));throw new Error("Failed pattern match at Data.Map.Internal (line 116, column 1 - line 119, column 110): "+[n.constructor.name,e.constructor.name])}}},Xu=function(n){return function(e){return function(t){var r,u=n,o=e,a=!1;function i(n,e,r){if(e instanceof Jt)return a=!0,r;if(e instanceof Zt){if(e.value0 instanceof Wu)return u=n,o=e.value1,void(t=new Lu(r,e.value0.value0,e.value0.value1,e.value0.value2));if(e.value0 instanceof Uu)return u=n,o=e.value1,void(t=new Lu(e.value0.value0,e.value0.value1,e.value0.value2,r));if(e.value0 instanceof $u)return u=n,o=e.value1,void(t=new ju(r,e.value0.value0,e.value0.value1,e.value0.value2,e.value0.value3,e.value0.value4,e.value0.value5));if(e.value0 instanceof Vu)return u=n,o=e.value1,void(t=new ju(e.value0.value0,e.value0.value1,e.value0.value2,r,e.value0.value3,e.value0.value4,e.value0.value5));if(e.value0 instanceof Yu)return u=n,o=e.value1,void(t=new ju(e.value0.value0,e.value0.value1,e.value0.value2,e.value0.value3,e.value0.value4,e.value0.value5,r));throw new Error("Failed pattern match at Data.Map.Internal (line 462, column 3 - line 467, column 88): "+[e.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 459, column 1 - line 459, column 80): "+[e.constructor.name,r.constructor.name])}for(;!a;)r=i(u,o,t);return r}}},no=function(n){return function(e){return function(t){var r,u=Gn(n);return r=Jt.value,function(o){var a,i=r,c=!1;function l(r,a){if(a instanceof _u)return c=!0,function(e){return function(t){var r,u=e,o=!1;function a(e,r){if(e instanceof Jt)return o=!0,new Lu(r.value0,r.value1,r.value2,r.value3);if(e instanceof Zt){if(e.value0 instanceof Wu)return o=!0,Xu(n)(e.value1)(new ju(r.value0,r.value1,r.value2,r.value3,e.value0.value0,e.value0.value1,e.value0.value2));if(e.value0 instanceof Uu)return o=!0,Xu(n)(e.value1)(new ju(e.value0.value0,e.value0.value1,e.value0.value2,r.value0,r.value1,r.value2,r.value3));if(e.value0 instanceof $u)return u=e.value1,void(t=new Ku(new Lu(r.value0,r.value1,r.value2,r.value3),e.value0.value0,e.value0.value1,new Lu(e.value0.value2,e.value0.value3,e.value0.value4,e.value0.value5)));if(e.value0 instanceof Vu)return u=e.value1,void(t=new Ku(new Lu(e.value0.value0,e.value0.value1,e.value0.value2,r.value0),r.value1,r.value2,new Lu(r.value3,e.value0.value3,e.value0.value4,e.value0.value5)));if(e.value0 instanceof Yu)return u=e.value1,void(t=new Ku(new Lu(e.value0.value0,e.value0.value1,e.value0.value2,e.value0.value3),e.value0.value4,e.value0.value5,new Lu(r.value0,r.value1,r.value2,r.value3)));throw new Error("Failed pattern match at Data.Map.Internal (line 498, column 5 - line 503, column 108): "+[e.value0.constructor.name,r.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 495, column 3 - line 495, column 56): "+[e.constructor.name,r.constructor.name])}for(;!o;)r=a(u,t);return r}}(r)(new Ku(_u.value,e,t,_u.value));if(a instanceof Lu){var l=u(e)(a.value1);return l instanceof vn?(c=!0,Xu(n)(r)(new Lu(a.value0,e,t,a.value3))):l instanceof ln?(i=new Zt(new Wu(a.value1,a.value2,a.value3),r),void(o=a.value0)):(i=new Zt(new Uu(a.value0,a.value1,a.value2),r),void(o=a.value3))}if(a instanceof ju){var f=u(e)(a.value1);if(f instanceof vn)return c=!0,Xu(n)(r)(new ju(a.value0,e,t,a.value3,a.value4,a.value5,a.value6));var v=u(e)(a.value4);return v instanceof vn?(c=!0,Xu(n)(r)(new ju(a.value0,a.value1,a.value2,a.value3,e,t,a.value6))):f instanceof ln?(i=new Zt(new $u(a.value1,a.value2,a.value3,a.value4,a.value5,a.value6),r),void(o=a.value0)):f instanceof fn&&v instanceof ln?(i=new Zt(new Vu(a.value0,a.value1,a.value2,a.value4,a.value5,a.value6),r),void(o=a.value3)):(i=new Zt(new Yu(a.value0,a.value1,a.value2,a.value3,a.value4,a.value5),r),void(o=a.value6))}throw new Error("Failed pattern match at Data.Map.Internal (line 478, column 3 - line 478, column 55): "+[r.constructor.name,a.constructor.name])}for(;!c;)a=l(i,o);return a}}}},eo={foldr:function(n){return function(e){return function(t){if(t instanceof _u)return e;if(t instanceof Lu)return st(eo)(n)(n(t.value2)(st(eo)(n)(e)(t.value3)))(t.value0);if(t instanceof ju)return st(eo)(n)(n(t.value2)(st(eo)(n)(n(t.value5)(st(eo)(n)(e)(t.value6)))(t.value3)))(t.value0);throw new Error("Failed pattern match at Data.Map.Internal (line 133, column 17 - line 136, column 85): "+[t.constructor.name])}}},foldl:function(n){return function(e){return function(t){if(t instanceof _u)return e;if(t instanceof Lu)return Mt(eo)(n)(n(Mt(eo)(n)(e)(t.value0))(t.value2))(t.value3);if(t instanceof ju)return Mt(eo)(n)(n(Mt(eo)(n)(n(Mt(eo)(n)(e)(t.value0))(t.value2))(t.value3))(t.value5))(t.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 137, column 17 - line 140, column 85): "+[t.constructor.name])}}},foldMap:function(n){return function(e){return function(t){if(t instanceof _u)return En(n);if(t instanceof Lu)return bn(n.Semigroup0())(gt(eo)(n)(e)(t.value0))(bn(n.Semigroup0())(e(t.value2))(gt(eo)(n)(e)(t.value3)));if(t instanceof ju)return bn(n.Semigroup0())(gt(eo)(n)(e)(t.value0))(bn(n.Semigroup0())(e(t.value2))(bn(n.Semigroup0())(gt(eo)(n)(e)(t.value3))(bn(n.Semigroup0())(e(t.value5))(gt(eo)(n)(e)(t.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 141, column 17 - line 144, column 93): "+[t.constructor.name])}}}},to={foldrWithIndex:function(n){return function(e){return function(t){if(t instanceof _u)return e;if(t instanceof Lu)return Pt(to)(n)(n(t.value1)(t.value2)(Pt(to)(n)(e)(t.value3)))(t.value0);if(t instanceof ju)return Pt(to)(n)(n(t.value1)(t.value2)(Pt(to)(n)(n(t.value4)(t.value5)(Pt(to)(n)(e)(t.value6)))(t.value3)))(t.value0);throw new Error("Failed pattern match at Data.Map.Internal (line 147, column 26 - line 150, column 120): "+[t.constructor.name])}}},foldlWithIndex:function(n){return function(e){return function(t){if(t instanceof _u)return e;if(t instanceof Lu)return qt(to)(n)(n(t.value1)(qt(to)(n)(e)(t.value0))(t.value2))(t.value3);if(t instanceof ju)return qt(to)(n)(n(t.value4)(qt(to)(n)(n(t.value1)(qt(to)(n)(e)(t.value0))(t.value2))(t.value3))(t.value5))(t.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 151, column 26 - line 154, column 120): "+[t.constructor.name])}}},foldMapWithIndex:function(n){return function(e){return function(t){if(t instanceof _u)return En(n);if(t instanceof Lu)return bn(n.Semigroup0())(Ct(to)(n)(e)(t.value0))(bn(n.Semigroup0())(e(t.value1)(t.value2))(Ct(to)(n)(e)(t.value3)));if(t instanceof ju)return bn(n.Semigroup0())(Ct(to)(n)(e)(t.value0))(bn(n.Semigroup0())(e(t.value1)(t.value2))(bn(n.Semigroup0())(Ct(to)(n)(e)(t.value3))(bn(n.Semigroup0())(e(t.value4)(t.value5))(Ct(to)(n)(e)(t.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 155, column 26 - line 158, column 128): "+[t.constructor.name])}}},Foldable0:function(){return eo}},ro={traverse:function(n){return function(e){return function(t){if(t instanceof _u)return ae(n)(_u.value);if(t instanceof Lu)return Cn(n.Apply0())(Cn(n.Apply0())(Cn(n.Apply0())(x(n.Apply0().Functor0())(Lu.create)(_t(ro)(n)(e)(t.value0)))(ae(n)(t.value1)))(e(t.value2)))(_t(ro)(n)(e)(t.value3));if(t instanceof ju)return Cn(n.Apply0())(Cn(n.Apply0())(Cn(n.Apply0())(Cn(n.Apply0())(Cn(n.Apply0())(Cn(n.Apply0())(x(n.Apply0().Functor0())(ju.create)(_t(ro)(n)(e)(t.value0)))(ae(n)(t.value1)))(e(t.value2)))(_t(ro)(n)(e)(t.value3)))(ae(n)(t.value4)))(e(t.value5)))(_t(ro)(n)(e)(t.value6));throw new Error("Failed pattern match at Data.Map.Internal (line 160, column 1 - line 175, column 31): "+[e.constructor.name,t.constructor.name])}}},sequence:function(n){return _t(ro)(n)(w(M))},Functor0:function(){return Qu},Foldable1:function(){return eo}},uo=function(){return _u.value}(),oo=function(n){return function(e){return Mt(e)((function(e){return function(t){return no(n)(t.value0)(t.value1)(e)}}))(uo)}},ao=function(n){return function(e){return function(t){return function(r){var u=e(Ju(n)(t)(r));if(u instanceof fe)return function(n){return function(e){return function(t){return de(t)(Qe)(function(n){return function(e){var t,r=function(e){return function(t){var r,u=e,o=!1;function a(e,r){if(e instanceof Jt)return o=!0,r;if(e instanceof Zt)return e.value0 instanceof Wu&&e.value0.value2 instanceof _u&&r instanceof _u?(o=!0,Xu(n)(e.value1)(new Lu(_u.value,e.value0.value0,e.value0.value1,_u.value))):e.value0 instanceof Uu&&e.value0.value0 instanceof _u&&r instanceof _u?(o=!0,Xu(n)(e.value1)(new Lu(_u.value,e.value0.value1,e.value0.value2,_u.value))):e.value0 instanceof Wu&&e.value0.value2 instanceof Lu?(u=e.value1,void(t=new ju(r,e.value0.value0,e.value0.value1,e.value0.value2.value0,e.value0.value2.value1,e.value0.value2.value2,e.value0.value2.value3))):e.value0 instanceof Uu&&e.value0.value0 instanceof Lu?(u=e.value1,void(t=new ju(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3,e.value0.value1,e.value0.value2,r))):e.value0 instanceof Wu&&e.value0.value2 instanceof ju?(o=!0,Xu(n)(e.value1)(new Lu(new Lu(r,e.value0.value0,e.value0.value1,e.value0.value2.value0),e.value0.value2.value1,e.value0.value2.value2,new Lu(e.value0.value2.value3,e.value0.value2.value4,e.value0.value2.value5,e.value0.value2.value6)))):e.value0 instanceof Uu&&e.value0.value0 instanceof ju?(o=!0,Xu(n)(e.value1)(new Lu(new Lu(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3),e.value0.value0.value4,e.value0.value0.value5,new Lu(e.value0.value0.value6,e.value0.value1,e.value0.value2,r)))):e.value0 instanceof $u&&e.value0.value2 instanceof _u&&e.value0.value5 instanceof _u&&r instanceof _u?(o=!0,Xu(n)(e.value1)(new ju(_u.value,e.value0.value0,e.value0.value1,_u.value,e.value0.value3,e.value0.value4,_u.value))):e.value0 instanceof Vu&&e.value0.value0 instanceof _u&&e.value0.value5 instanceof _u&&r instanceof _u?(o=!0,Xu(n)(e.value1)(new ju(_u.value,e.value0.value1,e.value0.value2,_u.value,e.value0.value3,e.value0.value4,_u.value))):e.value0 instanceof Yu&&e.value0.value0 instanceof _u&&e.value0.value3 instanceof _u&&r instanceof _u?(o=!0,Xu(n)(e.value1)(new ju(_u.value,e.value0.value1,e.value0.value2,_u.value,e.value0.value4,e.value0.value5,_u.value))):e.value0 instanceof $u&&e.value0.value2 instanceof Lu?(o=!0,Xu(n)(e.value1)(new Lu(new ju(r,e.value0.value0,e.value0.value1,e.value0.value2.value0,e.value0.value2.value1,e.value0.value2.value2,e.value0.value2.value3),e.value0.value3,e.value0.value4,e.value0.value5))):e.value0 instanceof Vu&&e.value0.value0 instanceof Lu?(o=!0,Xu(n)(e.value1)(new Lu(new ju(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3,e.value0.value1,e.value0.value2,r),e.value0.value3,e.value0.value4,e.value0.value5))):e.value0 instanceof Vu&&e.value0.value5 instanceof Lu?(o=!0,Xu(n)(e.value1)(new Lu(e.value0.value0,e.value0.value1,e.value0.value2,new ju(r,e.value0.value3,e.value0.value4,e.value0.value5.value0,e.value0.value5.value1,e.value0.value5.value2,e.value0.value5.value3)))):e.value0 instanceof Yu&&e.value0.value3 instanceof Lu?(o=!0,Xu(n)(e.value1)(new Lu(e.value0.value0,e.value0.value1,e.value0.value2,new ju(e.value0.value3.value0,e.value0.value3.value1,e.value0.value3.value2,e.value0.value3.value3,e.value0.value4,e.value0.value5,r)))):e.value0 instanceof $u&&e.value0.value2 instanceof ju?(o=!0,Xu(n)(e.value1)(new ju(new Lu(r,e.value0.value0,e.value0.value1,e.value0.value2.value0),e.value0.value2.value1,e.value0.value2.value2,new Lu(e.value0.value2.value3,e.value0.value2.value4,e.value0.value2.value5,e.value0.value2.value6),e.value0.value3,e.value0.value4,e.value0.value5))):e.value0 instanceof Vu&&e.value0.value0 instanceof ju?(o=!0,Xu(n)(e.value1)(new ju(new Lu(e.value0.value0.value0,e.value0.value0.value1,e.value0.value0.value2,e.value0.value0.value3),e.value0.value0.value4,e.value0.value0.value5,new Lu(e.value0.value0.value6,e.value0.value1,e.value0.value2,r),e.value0.value3,e.value0.value4,e.value0.value5))):e.value0 instanceof Vu&&e.value0.value5 instanceof ju?(o=!0,Xu(n)(e.value1)(new ju(e.value0.value0,e.value0.value1,e.value0.value2,new Lu(r,e.value0.value3,e.value0.value4,e.value0.value5.value0),e.value0.value5.value1,e.value0.value5.value2,new Lu(e.value0.value5.value3,e.value0.value5.value4,e.value0.value5.value5,e.value0.value5.value6)))):e.value0 instanceof Yu&&e.value0.value3 instanceof ju?(o=!0,Xu(n)(e.value1)(new ju(e.value0.value0,e.value0.value1,e.value0.value2,new Lu(e.value0.value3.value0,e.value0.value3.value1,e.value0.value3.value2,e.value0.value3.value3),e.value0.value3.value4,e.value0.value3.value5,new Lu(e.value0.value3.value6,e.value0.value4,e.value0.value5,r)))):(o=!0,ur("The impossible happened in partial function `up`."));throw new Error("Failed pattern match at Data.Map.Internal (line 552, column 5 - line 573, column 86): "+[e.constructor.name])}for(;!o;)r=a(u,t);return r}},u=function(n){return function(e){for(var t,u,o,a=n,i=!1;!i;)u=a,t=(o=e)instanceof Lu&&o.value0 instanceof _u&&o.value3 instanceof _u?(i=!0,r(u)(_u.value)):o instanceof Lu?(a=new Zt(new Uu(o.value0,o.value1,o.value2),u),void(e=o.value3)):o instanceof ju&&o.value0 instanceof _u&&o.value3 instanceof _u&&o.value6 instanceof _u?(i=!0,r(new Zt(new Uu(_u.value,o.value1,o.value2),u))(_u.value)):o instanceof ju?(a=new Zt(new Yu(o.value0,o.value1,o.value2,o.value3,o.value4,o.value5),u),void(e=o.value6)):(i=!0,ur("The impossible happened in partial function `removeMaxNode`."));return t}},o=function(n){var e,t=!1;function r(e){if(e instanceof Lu&&e.value3 instanceof _u)return t=!0,{key:e.value1,value:e.value2};if(e instanceof Lu)n=e.value3;else{if(e instanceof ju&&e.value6 instanceof _u)return t=!0,{key:e.value4,value:e.value5};if(!(e instanceof ju))return t=!0,ur("The impossible happened in partial function `maxNode`.");n=e.value6}}for(;!t;)e=r(n);return e},a=Gn(n);return t=Jt.value,function(i){var c,l=t,f=!1;function v(t,c){if(c instanceof _u)return f=!0,fe.value;if(c instanceof Lu){var v=a(e)(c.value1);if(c.value3 instanceof _u&&v instanceof vn)return f=!0,new ve(new Ze(c.value2,r(t)(_u.value)));if(v instanceof vn){var s=o(c.value0);return f=!0,new ve(new Ze(c.value2,u(new Zt(new Wu(s.key,s.value,c.value3),t))(c.value0)))}return v instanceof ln?(l=new Zt(new Wu(c.value1,c.value2,c.value3),t),void(i=c.value0)):(l=new Zt(new Uu(c.value0,c.value1,c.value2),t),void(i=c.value3))}if(c instanceof ju){var d=c.value0 instanceof _u&&c.value3 instanceof _u&&c.value6 instanceof _u,p=(v=a(e)(c.value4),a(e)(c.value1));return d&&p instanceof vn?(f=!0,new ve(new Ze(c.value2,Xu(n)(t)(new Lu(_u.value,c.value4,c.value5,_u.value))))):d&&v instanceof vn?(f=!0,new ve(new Ze(c.value5,Xu(n)(t)(new Lu(_u.value,c.value1,c.value2,_u.value))))):p instanceof vn?(s=o(c.value0),f=!0,new ve(new Ze(c.value2,u(new Zt(new $u(s.key,s.value,c.value3,c.value4,c.value5,c.value6),t))(c.value0)))):v instanceof vn?(s=o(c.value3),f=!0,new ve(new Ze(c.value5,u(new Zt(new Vu(c.value0,c.value1,c.value2,s.key,s.value,c.value6),t))(c.value3)))):p instanceof ln?(l=new Zt(new $u(c.value1,c.value2,c.value3,c.value4,c.value5,c.value6),t),void(i=c.value0)):p instanceof fn&&v instanceof ln?(l=new Zt(new Vu(c.value0,c.value1,c.value2,c.value4,c.value5,c.value6),t),void(i=c.value3)):(l=new Zt(new Yu(c.value0,c.value1,c.value2,c.value3,c.value4,c.value5),t),void(i=c.value6))}throw new Error("Failed pattern match at Data.Map.Internal (line 525, column 16 - line 548, column 80): "+[c.constructor.name])}for(;!f;)c=v(l,i);return c}}}(n)(e)(t))}}}(n)(t)(r);if(u instanceof ve)return no(n)(t)(u.value0)(r);throw new Error("Failed pattern match at Data.Map.Internal (line 596, column 15 - line 598, column 25): "+[u.constructor.name])}}}},io=function(n){return function(e){return function(t){return function(r){return qt(to)((function(t){return function(r){return function(u){return ao(n)((o=de(u)(e(u)),function(n){return ve.create(o(n))}))(t)(r);var o}}}))(r)(t)}}}},co={compact:function(n){return t=[],r=pu((function(e){return Au(n)(e)}))(),mu(r)((e=F(Kr),function(n){return e(function(n){if(n instanceof fe)return ae(Jr)(0);if(n instanceof ve)return fu(n.value0)(t);throw new Error("Failed pattern match at Data.Compactable (line 111, column 34 - line 113, column 35): "+[n.constructor.name])}(n))}))(),cu(t)();var e,t,r},separate:function(n){return t=[],r=[],u=pu((function(e){return Au(n)(e)}))(),mu(u)((e=F(Kr),function(n){return e(function(n){if(n instanceof Fe)return fu(n.value0)(t);if(n instanceof ke)return fu(n.value0)(r);throw new Error("Failed pattern match at Data.Compactable (line 122, column 34 - line 124, column 31): "+[n.constructor.name])}(n))}))(),Cn(Qr)(x(Kr)((function(n){return function(e){return{left:n,right:e}}}))(cu(t)))(cu(r))();var e,t,r,u}},lo=function(n){return n.compact},fo={partitionMap:function(n){return Mt(yt)((function(e){return function(t){var r=n(t);if(r instanceof Fe)return{left:bn(wn)(e.left)([r.value0]),right:e.right};if(r instanceof ke)return{right:bn(wn)(e.right)([r.value0]),left:e.left};throw new Error("Failed pattern match at Data.Filterable (line 149, column 16 - line 151, column 50): "+[r.constructor.name])}}))({left:[],right:[]})},partition:uu,filterMap:Ru,filter:ru,Compactable0:function(){return co},Functor1:function(){return P}},vo=function(n){return n.filterMap},so={dimap:function(n){return function(e){return function(t){return function(r){return e(t(n(r)))}}}}},po=function(n){return n.dimap},mo=function(n){return function(e){return po(n)(e)(w(M))}},ho=function(n){return function(e){return function(t){return function(n){return io(n)(y)}(n)(e)(t)}}},wo=function(n){return function(e){return function(t){return Zu(n)(e)(t)}}},Mo=function(n){return function(e){return function(t){return no(n)(e)(A)(t)}}},bo=uo,So=function(n){return function(e){return Mt(n)((function(n){return function(t){return Mo(e)(t)(n)}}))(bo)}},yo=function(n){return{mempty:bo,Semigroup0:function(){return function(n){return{append:ho(n)}}(n)}}},go=function(n){return n.sampleOn},Ao=function(n){return n.keepLatest},To=function(n){return n.fold},xo=function(n){return function(e){return function(t){return function(r){return vo(n.Filterable1())(Qe)(To(n)((function(n){return function(t){return x(et)(ae(ge))(e(n)(t.value0))}}))(t)(new Ze(r,fe.value)))}}}},Eo=function(n){return function(e){return function(t){return Pn(n.Plus0().Alt0())(go(n)(e)(t))(go(n)(t)(x(n.Filterable1().Functor1())(g)(e)))}}},Fo=function(n){return n.bang},ko=function(n){return function(e){return n===e}},No=function(n){return function(e){return function(t){return function(r){return po(so)((function(e){return function(r){return ft()(Nn(n)(y(e(r))))(ae(t)(A))}}))(Nn(e))(r)}}}},Bo=function(n){return function(e){return n(e)}},Po=function(n){return function(e){return function(t){return function(r){return function(u){return je(n.Monad0().Bind1())(nu(n)(Tr(fe.value)))((function(o){return je(n.Monad0().Bind1())(t((function(e){return nu(n)(F(Kr)(Er(new ve(e))(o)))})))((function(t){return je(n.Monad0().Bind1())(r((function(t){return je(n.Monad0().Bind1())(nu(n)(xr(o)))(mt(e)(St)((function(n){return u(t(n))})))})))((function(n){return ae(e)(Dn(e.Apply0())(t)(n))}))}))}))}}}}},qo=function(n){return n},Io=function(n){return function(e){return function(t){return je(n.Monad0().Bind1())(nu(n)(Tr(fe.value)))((function(r){return je(n.Monad0().Bind1())(e((function(e){return Oe($e)(n.Monad0().Bind1())(je(n.Monad0().Bind1())(nu(n)(xr(r)))(wt(n.Monad0().Applicative0())(St)))((function(){return je(n.Monad0().Bind1())(Bo(e)(t))((function(e){return nu(n)(F(Kr)(Er(new ve(e))(r)))}))}))})))((function(e){return ae(n.Monad0().Applicative0())(Oe($e)(n.Monad0().Bind1())(je(n.Monad0().Bind1())(nu(n)(xr(r)))(wt(n.Monad0().Applicative0())(St)))((function(){return e})))}))}))}}},Co={map:function(n){return function(e){return function(t){return e((function(e){return t(n(e))}))}}}},Do=function(n){return function(e){return function(t){return function(r){return po(so)(x(B)(Nn(n)))((function(n){return ft()(Nn(e)(y(n)))(ae(t)(ae(t)(A)))}))(r)}}}},zo=function(n){return function(e){return function(t){return function(r){return function(u){return je(n.Monad0().Bind1())(nu(n)(Tr(r)))((function(r){return t((function(t){return je(n.Monad0().Bind1())(nu(n)(Yr(e(t))(r)))(u)}))}))}}}}},Ro=function(n){return function(e){return function(t){return function(r){return t((function(t){var u=e(t);if(u instanceof ve)return r(u.value0);if(u instanceof fe)return ae(n)(A);throw new Error("Failed pattern match at FRP.Event (line 131, column 13 - line 133, column 27): "+[u.constructor.name])}))}}}},Oo=function(n){return function(e){return Ro(n)((function(n){var t=e(n);if(t)return new ve(n);if(!t)return fe.value;throw new Error("Failed pattern match at FRP.Event (line 89, column 13 - line 91, column 25): "+[t.constructor.name])}))}},_o=function(n){return function(e){return je(n.Monad0().Bind1())(nu(n)(Tr([])))((function(t){return ae(n.Monad0().Applicative0())({event:function(n){return je(e.Monad0().Bind1())(nu(e)(Yr((function(e){return bn(wn)(e)([n])}))(t)))((function(){return ae(e.Monad0().Applicative0())(je(e.Monad0().Bind1())(nu(e)(Yr(Du(ko)(n))(t)))((function(){return ae(e.Monad0().Applicative0())(A)})))}))},push:function(n){return je(e.Monad0().Bind1())(nu(e)(xr(t)))(mt(e.Monad0().Applicative0())(yt)((function(e){return e(n)})))}})}))}},Lo=function(n){return function(e){return function(t){return function(r){return je(e.Bind1())(_o(n)(n))((function(n){var u=t(n.event);return je(e.Bind1())(Bo(u.input)(n.push))((function(n){return je(e.Bind1())(Bo(u.output)(r))((function(t){return ae(e.Applicative0())(Dn(e.Bind1().Apply0())(n)(t))}))}))}))}}}},jo=function(n){return function(e){return function(t){return function(r){return je(n.Monad0().Bind1())(_o(n)(n))((function(u){return Oe($e)(n.Monad0().Bind1())(r(t(u.event)))((function(){return Bo(e)(u.push)}))}))}}}},Wo=function(n){return{compact:Ro(n)(w(M)),separate:function(e){return{left:Ro(n)((function(n){if(n instanceof Fe)return new ve(n.value0);if(n instanceof ke)return fe.value;throw new Error("Failed pattern match at FRP.Event (line 72, column 13 - line 74, column 33): "+[n.constructor.name])}))(e),right:Ro(n)((function(n){if(n instanceof ke)return new ve(n.value0);if(n instanceof Fe)return fe.value;throw new Error("Failed pattern match at FRP.Event (line 79, column 13 - line 81, column 32): "+[n.constructor.name])}))(e)}}}},Uo=function(n){return{filter:Oo(n),filterMap:Ro(n),partition:function(e){return function(t){return{yes:Oo(n)(e)(t),no:Oo(n)((r=Ye(He),function(n){return r(e(n))}))(t)};var r}},partitionMap:function(e){return function(t){return{left:vo(Uo(n))((r=Pe(ve.create)(y(fe.value)),function(n){return r(e(n))}))(t),right:vo(Uo(n))((function(n){return qe(e(n))}))(t)};var r}},Compactable0:function(){return Wo(n)},Functor1:function(){return Co}}},$o=function(n){return function(e){return function(t){return x(n.Apply0().Functor0())((function(e){return ae(n)(A)}))(t(e))}}},Vo=function(n){return{alt:function(e){return function(t){return function(r){return Cn(n.Apply0())(x(n.Apply0().Functor0())((function(e){return function(t){return Dn(n.Apply0())(e)(t)}}))(e(r)))(t(r))}}},Functor0:function(){return Co}}},Yo=function(n){return{empty:function(e){return ae(n)(ae(n)(A))},Alt0:function(){return Vo(n)}}},Ko=function(n){return{fold:zo(n),keepLatest:Io(n),sampleOn:Po(n)(n.Monad0().Applicative0()),fix:Lo(n)(n.Monad0()),bang:$o(n.Monad0().Applicative0()),Plus0:function(){return Yo(n.Monad0().Applicative0())},Filterable1:function(){return Uo(n.Monad0().Applicative0())}}};var Go={vb:function(n){return function(n){return function(n){return{}}}}},Ho=function(n){return n.vb},Jo=function(n){return function(){return function(){return function(e){return function(){return function(){return function(){return function(){return{vb:function(t){return function(t){return function(t){return function(n){return function(){return function(){return function(e){return function(t){return function(r){return V(U(n)(e))(t)(r)}}}}}}(n)()()(T.value)(A)(Ho(e)(T.value)(T.value)(T.value))}}}}}}}}}}}},Zo=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Qo=function(){function n(){}return n.value=new n,n}(),Xo=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),na=function(){function n(){}return n.value=new n,n}(),ea=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ta=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ra=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ua=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),oa=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),aa={eq:function(n){return function(e){return n instanceof Zo&&e instanceof Zo?n.value0===e.value0:n instanceof Qo&&e instanceof Qo}}},ia=function(n){return new ra(n)},ca=function(n){return new ua(n)},la={Always0:function(){return kn(Or(yn))},Always1:function(){return kn(Or(Or(yn)))},Always2:function(){return kn(Or(yn))},Always3:function(){return kn(it(M))},Always4:function(){return kn(it(M))},MonadST5:function(){return Xr}},fa=function(){return function(n){return function(){return function(e){return function(t){return function(r){return function(u){return new ua((o=n.MonadST5(),function(n){return function(e){return function(e){var t=Ho(n)(T.value)(T.value)(T.value);return function(n){return je(o.Monad0().Bind1())((r=t,()=>{const n=(e,t,r,u)=>{const o=Object.keys(u);for(var a=0;a<o.length;a++)if(u[o[a]]instanceof Object&&"_____$__$_$$_vbus"===u[o[a]]._____$__$_$$_vbus){const i={},c={};n(e,i,c,u[o[a]]),t[o[a]]=i,r[o[a]]=c}else{const n=`${Math.random()}`;e[n]={},t[o[a]]=t=>()=>{const r=Object.values(e[n]);for(var u=0;u<r.length;u++)r[u](t)()},r[o[a]]=t=>()=>{const r=`${Math.random()}`;return e[n][r]=t,()=>{delete e[n][r]}}}},e={},t={},u={};return n(e,t,u,r),{p:t,e:u,s:e}}))((function(t){return Oe($e)(o.Monad0().Bind1())(n(e(t.p)(t.e)))((function(){return ae(o.Monad0().Applicative0())((n=t.s,()=>{for(const e in n)delete n[e]}));var n}))}));var r}}}})(t)(r)(mo(so)((a=function(n){return{hmap:(e=wr(n)(T.value),function(n){return function(n){return function(e){return n(function(n){var e={};for(var t in n)({}).hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}(e))}}(e(n))})};var e}(e),a.hmap(Sr.value)))(u)));var o,a}}}}}}},va=function(n){return function(e){return function(t){return(r=n.MonadST5(),function(n){return function(e){return je(r.Monad0().Bind1())(_o(r)(r))((function(t){return Oe($e)(r.Monad0().Bind1())(e(n(t.push)(t.event)))((function(){return ae(r.Monad0().Applicative0())(ae(r.Monad0().Applicative0())(A))}))}))}})(mo(so)(x(B)(Nn(e)))(t));var r}}};const sa={};function da(n){return function(e){return function(t){return function(r){var u=t;function o(n){return function(t){return e(t)(n)(r[n])}}for(var a in r)hasOwnProperty.call(r,a)&&(u=n(u)(o(a)));return u}}}}function pa(n){return function(e){var t=[];for(var r in e)hasOwnProperty.call(e,r)&&t.push(n(r)(e[r]));return t}}Object.keys||pa((function(n){return function(){return n}}));var ma=pa((function(n){return function(n){return n}})),ha=function(n){return function(){var e={};for(var t in n)hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}},wa=function(n){return function(e){return function(n){return n()}((function(){var t=ha(e)();return n(t)(),t}))}},Ma=function(n){return function(e){return wa(function(n){return function(e){return function(t){return function(){return t[n]=e,t}}}}(n)(e))}},ba=da(g),Sa={foldl:function(n){return ba((function(e){return function(t){return n(e)}}))},foldr:function(n){return function(e){return function(t){return st(yt)(n)(e)(ma(t))}}},foldMap:function(n){return function(e){return function(n){return function(e){return ba((function(t){return function(r){return function(u){return bn(n.Semigroup0())(t)(e(r)(u))}}}))(En(n))}}(n)(y(e))}}},ya=function(n){return wa(function(n){return function(e){return function(){return delete e[n],e}}}(n))},ga=function(){function n(){}return n.value=new n,n}(),Aa=function(){function n(){}return n.value=new n,n}(),Ta=function(){function n(){}return n.value=new n,n}(),xa=function(n){return function(e){return function(t){var r;return new ta(Ao(Ko(n))(jo(n)((r=t,xo(Ko(n))((function(n){return function(e){return new Ze(e+1|0,new Ze(n,e))}}))(r)(0)))((function(t){return x(Co)((function(r){return Pn(Vo(n.Monad0().Applicative0()))(Fo(Ko(n))(new Xo(e(r.value0))))(x(Co)(y(na.value))(Uo(n.Monad0().Applicative0()).filter((u=nn(Z)(r.value1+1|0),function(n){return u(Qe(n))}))(t)));var u}))(t)}))))}}},Ea=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){if(o instanceof ra)return pt(yt)(Yo(n))(Ea(n)(e)(t)(r)(u))(o.value0);if(o instanceof ua)return Ao(Ko(e))(x(Co)(Ea(n)(e)(t)(r)(u))(o.value0));if(o instanceof oa)return function(n){return n(r)(u)}(t.toElt(o.value0));if(o instanceof ta)return function(a){return je(e.Monad0().Bind1())(nu(e)(Tr(sa)))((function(i){return je(e.Monad0().Bind1())(Bo(o.value0)((function(o){return je(e.Monad0().Bind1())(t.ids(u))((function(c){return je(e.Monad0().Bind1())(nu(e)(Tr(ae(n)(A))))((function(l){return je(e.Monad0().Bind1())(t.ids(u))((function(f){return je(e.Monad0().Bind1())(nu(e)(Tr(ae(n)(A))))((function(v){return je(e.Monad0().Bind1())(nu(e)(Tr([])))((function(s){return je(e.Monad0().Bind1())(nu(e)(Tr(ae(n)(A))))((function(d){return je(e.Monad0().Bind1())(x(n.Apply0().Functor0())(Zo.create)(t.ids(u)))((function(p){return je(e.Monad0().Bind1())(nu(e)(Tr(ga.value)))((function(m){return je(e.Monad0().Bind1())(Bo(o)((function(o){return je(e.Monad0().Bind1())(nu(e)(xr(m)))((function(h){return o instanceof ea&&h instanceof Aa?je(e.Monad0().Bind1())(nu(e)(xr(s)))(mt(n)(yt)((w=t.doLogic(o.value0)(u),function(n){return a(w(n))}))):o instanceof na&&h instanceof Aa?Oe($e)(e.Monad0().Bind1())(F(n.Apply0().Functor0())(nu(e)(Er(Ta.value)(m))))((function(){var o=Dn(n.Apply0())(Dn(n.Apply0())(Dn(n.Apply0())(Dn(n.Apply0())(je(e.Monad0().Bind1())(nu(e)(xr(s)))(mt(n)(yt)((function(e){return ht(n)(St)(r.parent)((function(n){return a(t.disconnectElement(u)({id:e,parent:n,scope:p}))}))}))))(Ve(e.Monad0().Bind1())(nu(e)(xr(l)))))(Ve(e.Monad0().Bind1())(nu(e)(xr(v)))))(F(n.Apply0().Functor0())(nu(e)(Yr(ya(c))(i)))))(F(n.Apply0().Functor0())(nu(e)(Yr(ya(f))(i))));return Dn(n.Apply0())(F(n.Apply0().Functor0())(nu(e)(Er(o)(d))))(o)})):o instanceof Xo&&h instanceof ga?Oe($e)(e.Monad0().Bind1())(F(n.Apply0().Functor0())(nu(e)(Er(Aa.value)(m))))((function(){return je(e.Monad0().Bind1())(Bo(Ea(n)(e)(t)({parent:r.parent,scope:p,raiseId:function(t){return F(n.Apply0().Functor0())(nu(e)(Yr(bn(wn)([t]))(s)))}})(u)(o.value0))(a))((function(t){return Oe($e)(e.Monad0().Bind1())(F(n.Apply0().Functor0())(nu(e)(Yr(Ma(f)(t))(i))))((function(){return F(n.Apply0().Functor0())(nu(e)(Er(t)(v)))}))}))})):ae(n)(A);var w}))})))((function(t){return Oe($e)(e.Monad0().Bind1())(F(n.Apply0().Functor0())(nu(e)(Er(t)(l))))((function(){return Oe($e)(e.Monad0().Bind1())(F(n.Apply0().Functor0())(nu(e)(Yr(Ma(c)(t))(i))))((function(){return Ve(e.Monad0().Bind1())(nu(e)(xr(d)))}))}))}))}))}))}))}))}))}))}))}))})))((function(t){return ae(n)(Oe($e)(e.Monad0().Bind1())(je(e.Monad0().Bind1())(nu(e)(xr(i)))(Mt(Sa)(Dn(n.Apply0()))(ae(n)(A))))((function(){return t})))}))}))};throw new Error("Failed pattern match at Bolson.Control (line 521, column 17 - line 604, column 20): "+[o.constructor.name])}}}}}},Fa=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ka=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Na=lt(),Ba=function(){return Fa.create}(),Pa=function(){return ka.create}(),qa=function(){var n=x(B)(x(Dr)(y(!0)));return function(e){return n(e)}}(),Ia=function(n){return n.attr},Ca=function(n){return n.makeText},Da=function(n){return function(e){return function(t){return x(Co)((function(t){return n.setText({id:e,text:t})}))(t)}}},za=function(n){return function(e){return function(t){return x(Co)((function(t){return function(t){if(t.value instanceof Fa)return n.setProp({id:e,key:t.key,value:t.value.value0});if(t.value instanceof ka)return n.setCb({id:e,key:t.key,value:t.value.value0});throw new Error("Failed pattern match at Deku.Control (line 75, column 26 - line 77, column 45): "+[t.value.constructor.name])}(Na(t))}))(t)}}},Ra=function(n){return n.makeElement},Oa=function(n){return n.attributeParent},_a=function(n){return function(e){return new oa((function(t){return function(r){return function(u){return je(n.Bind1())(r.ids)((function(o){return Oe($e)(n.Bind1())(t.raiseId(o))((function(){return x(n.Bind1().Apply0().Functor0())(Dn(n.Bind1().Apply0())(u(r.deleteFromCache({id:o}))))(Bo(dt(yt)(Yo(n.Applicative0()))([$o(n.Applicative0())(Ca(r)({id:o,parent:t.parent,scope:t.scope})),Da(r)(o)(e)]))(u))}))}))}}}))}},La=function(n){return function(e){return _a(n)($o(n.Applicative0())(e))}},ja=function(n){return Ea(n.MonadST5().Monad0().Applicative0())(n.MonadST5())({doLogic:function(n){return function(e){return function(t){return e.sendToPos({id:t,pos:n})}}},ids:(t=ft(e),function(n){return t(n).ids}),disconnectElement:function(n){return function(e){return n.disconnectElement({id:e.id,scope:e.scope,parent:e.parent,scopeEq:nn(aa)})}},toElt:function(n){return n}});var e,t},Wa=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){return function(a){return je(n.MonadST5().Monad0().Bind1())(o.ids)((function(i){return Oe($e)(n.MonadST5().Monad0().Bind1())(u.raiseId(i))((function(){return x(n.MonadST5().Monad0().Bind1().Apply0().Functor0())(Dn(n.MonadST5().Monad0().Bind1().Apply0())(a(o.deleteFromCache({id:i}))))(Bo(Pn(Vo(n.MonadST5().Monad0().Applicative0()))(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))(bn(wn)([$o(n.MonadST5().Monad0().Applicative0())(Ra(o)({id:i,parent:u.parent,scope:u.scope,tag:e})),za(o)(i)(t)])(de([])((function(e){return[$o(n.MonadST5().Monad0().Applicative0())(Oa(o)({id:i,parent:e}))]}))(u.parent))))(ja(n)({parent:new ve(i),scope:u.scope,raiseId:function(e){return ae(n.MonadST5().Monad0().Applicative0())(A)}})(o)(r)))(a))}))}))}}}}}}};const Ua=(n,e,t,r)=>{n((n=>r.units[n].main.appendChild(r.units[e].main)))(t)},$a=n=>e=>()=>{e.units[n.id].main.parentNode||e.units[n.parent].main.appendChild(e.units[n.id].main)},Va=n=>e=>t=>r=>()=>{var u,o=t.id;if(r.scopes[t.scope]||(r.scopes[t.scope]=[]),r.scopes[t.scope].push(o),r.hydrating&&n&&t.parent.value0&&(u=document.body.querySelectorAll("[data-deku-ssr-"+t.parent.value0+"]").item(0))){var a=0;if(1===u.childNodes.length)u.prepend(document.createTextNode(""));else for(a=0;a<u.childNodes.length;a++)if(8===u.childNodes[a].nodeType&&u.childNodes[a].nodeValue===o){a-=1;break}r.units[o]={main:u.childNodes[a],parent:t.parent,scope:t.scope}}else r.units[o]={main:document.createTextNode(""),parent:t.parent,scope:t.scope},Ua(e,o,t.parent,r)},Ya=n=>e=>t=>()=>{var r=e.id,u=e.value;t.hydrating&&n&&!t.units[r]&&(dom=document.body.querySelectorAll("[data-deku-ssr-"+r+"]").item(0))&&(t.units[r]={listeners:{},parent:e.parent,scope:e.scope,main:dom},t.scopes[e.scope]||(t.scopes[e.scope]=[]),t.scopes[e.scope].push(r)),"INPUT"===t.units[r].main.tagName&&"value"===e.key?t.units[r].main.value=u:"INPUT"===t.units[r].main.tagName&&"checked"===e.key?t.units[r].main.checked="true"===u:t.units[r].main.setAttribute(e.key,u)},Ka=n=>e=>t=>()=>{var r=e.id,u=e.value;if(t.hydrating&&n&&!t.units[r]&&(dom=document.body.querySelectorAll("[data-deku-ssr-"+r+"]").item(0))&&(t.units[r]={listeners:{},parent:e.parent,scope:e.scope,main:dom},t.scopes[e.scope]||(t.scopes[e.scope]=[]),t.scopes[e.scope].push(r)),"@self@"===e.key)u(t.units[r].main)();else{t.units[r].listeners[e.key]&&t.units[r].main.removeEventListener(e.key,t.units[r].listeners[e.key]);var o=n=>u(n)();t.units[r].main.addEventListener(e.key,o),t.units[r].listeners[e.key]=o}},Ga=n=>e=>()=>{var t=n.id;e.units[t].main.nodeValue=n.text},Ha=n=>e=>t=>r=>()=>{var u,o,a=t.id,i=t.html,c=t.verb,l=t.cache,f=t.parent,v=t.scope,s=t.pxScope;if(r.hydrating&&n&&t.parent.value0&&(u=document.body.querySelectorAll("[data-deku-ssr-"+a+"]").item(0)))r.units[a]={listeners:{},scope:v,parent:f,main:u};else{const n=Object.entries(l);for(var d=0;d<n.length;d++){const e=n[d][0];i=!0===n[d][1]?i.replace(c+e+c,'data-deku-attr-internal="'+e+'"'):i.replace(c+e+c,'<span style="display:contents;" data-deku-elt-internal="'+e+'"></span>')}(o=document.createElement("div")).innerHTML=i.trim(),r.units[a]={listeners:{},scope:v,parent:f,main:o.firstChild}}r.scopes[v]||(r.scopes[v]=[]),r.scopes[v].push(a),o||(o=u),o.querySelectorAll("[data-deku-attr-internal]").forEach((function(n){const e=n.getAttribute("data-deku-attr-internal")+s;r.units[e]={listeners:{},main:n,scope:v},r.scopes[v].push(e)})),o.querySelectorAll("[data-deku-elt-internal]").forEach((function(n){var e=n.getAttribute("data-deku-elt-internal");const t=e+s;r.units[e+s]={listeners:{},main:n,scope:v},r.scopes[v].push(t)})),u||Ua(e,a,f,r)},Ja=n=>e=>()=>{var t=n.id;e.units[t]={main:n.root}},Za=n=>e=>()=>{var t=n.id,r=n.parent;e.units[t].containingScope=n.scope,e.units[r].main.prepend(e.units[t].main)},Qa=n=>e=>()=>{var t=n.id;e.units[t].noop||e.units[t].containingScope&&!n.scopeEq(e.units[t].containingScope)(n.scope)||e.units[t].main.remove()},Xa=n=>e=>()=>{delete e.units[n.id]},ni=n=>e=>()=>{var t=n.id,r=n.pos,u=e.units[t].main.parentNode;u.insertBefore(e.units[t].main,u.children.length<=r?u.children[u.children.length-1]:r<0?u.children[0]:u.children[r])},ei=function(n){return n},ti=(isNaN,isFinite);Math.abs,Math.acos,Math.asin,Math.atan,Math.ceil,Math.cos,Math.exp;const ri=Math.floor,ui=(Math.log,function(n){return function(e){return n%e}}),oi=Math.round;Math.sign&&Math.sign,Math.sin,Math.sqrt,Math.tan,Math.trunc&&Math.trunc;var ai=function(){return(n=ve.create,function(e){return function(t){return(0|t)===t?n(t):e}})(fe.value);var n}(),ii=function(n){return ti(n)?n>=Zn(Qn)?Zn(Qn):n<=ne(Qn)?ne(Qn):we(0)(ai(n)):0},ci=function(n){return ii(oi(n))},li=function(n){return ii(ri(n))};const fi=Math.random;var vi=function(n){return function(e){return function(){var t=fi();return li((e-n+1)*t+n)}}},si=2147483647,di=function(){return si-1|0}(),pi=function(n){return function(n){return function(e){var t=n-1|0,r=un(an)(e)(t);return r<1?r+n|0:r}}(di)(n)},mi=x(Dr)(pi)(vi(1)(di)),hi=function(n){return function(e){return Me()(ai(ui(48271*e+n)(si)))}},wi=hi(0),Mi=function(n){return n.resize},bi=function(n){return n},Si={append:function(n){return function(n){return n}}},yi=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),gi=function(){function n(){}return n.value=new n,n}(),Ai=wn,Ti=P,xi=yt,Ei={foldMap1:function(n){return(e=Ei,function(n){return function(t){return function(r){var u=e.foldl1(bn(t)),o=x(n)(r);return function(n){return u(o(n))}}}})(Ti)(n);var e},foldr1:function(n){return function(e){for(var t=e[e.length-1],r=e.length-2;r>=0;r--)t=n(e[r])(t);return t}},foldl1:function(n){return function(e){for(var t=e[0],r=e.length,u=1;u<r;u++)t=n(t)(e[u]);return t}},Foldable0:function(){return xi}},Fi=function(n){return bu(n)},ki=function(n){return eu(n)>0?new ve(n):fe.value},Ni=function(n){var e=Me();return function(t){return e(n(t))}}(Tu),Bi=function(n){return function(e){return n(e)}},Pi=Bi(eu),qi=function(n){return t=n,r=Eu((function(n){return function(e){return nn(dn)(t(n)(e))(vn.value)}})),u=Mu(t),e=Bi((function(n){return r(u(n))})),function(n){return e(n)};var e,t,r,u};const Ii=function(n){return n.length},Ci=function(n){return function(e){return e.substring(n)}};var Di=function(){return(n=ve.create,function(e){return function(t){return function(r){var u=r.indexOf(t);return-1===u?e:n(u)}}})(fe.value);var n}(),zi=function(n){return""===n},Ri=$n,Oi=function(n){return""===n?fe.value:new ve(n)},_i=Y,Li=function(n){return n.state},ji=function(n){return Li(n)((function(n){return new Ze(n,n)}))},Wi={liftEffect:w(M),Monad0:function(){return Br}},Ui=function(n){return n.liftEffect},$i=function(n){return{map:function(e){return function(t){return function(r){return x(n)((function(n){return new Ze(e(n.value0),n.value1)}))(t(r))}}}}},Vi=function(n){return{Applicative0:function(){return Gi(n)},Bind1:function(){return Yi(n)}}},Yi=function(n){return{bind:function(e){return function(t){return function(r){return je(n.Bind1())(e(r))((function(n){return t(n.value0)(n.value1)}))}}},Apply0:function(){return Ki(n)}}},Ki=function(n){return{apply:Fr(Vi(n)),Functor0:function(){return $i(n.Bind1().Apply0().Functor0())}}},Gi=function(n){return{pure:function(e){return function(t){return ae(n.Applicative0())(new Ze(e,t))}},Apply0:function(){return Ki(n)}}},Hi=function(n){return{tailRecM:function(e){return function(t){var r=function(t){var r=e(t.value0);return je(n.Monad0().Bind1())(r(t.value1))((function(e){return ae(n.Monad0().Applicative0())(function(){if(e.value0 instanceof jr)return new jr(new Ze(e.value0.value0,e.value1));if(e.value0 instanceof Wr)return new Wr(new Ze(e.value0.value0,e.value1));throw new Error("Failed pattern match at Control.Monad.State.Trans (line 87, column 16 - line 89, column 40): "+[e.value0.constructor.name])}())}))};return function(e){return Ur(n)(r)(new Ze(t,e))}}},Monad0:function(){return Vi(n.Monad0())}}},Ji=function(n){return{state:function(e){var t=ae(n.Applicative0());return function(n){return t(e(n))}},Monad0:function(){return Vi(n)}}},Zi=function(n){return e=n,t=ft(),function(n){return t(e(n))};var e,t},Qi=function(n){return function(n){return Li(Ji(kt))((function(e){return Zi(n(e))(e)}))}((function(e){return n(e.size)}))},Xi=function(n){return function(e){return function(t){return e<=0?ae(n.Monad0().Applicative0())(Jt.value):Ur(n)((function(e){return 0===e.value1?ae(n.Monad0().Applicative0())(new Wr(e.value0)):E(n.Monad0().Bind1().Apply0().Functor0())(t)((function(n){return new jr(new Ze(new Zt(n,e.value0),e.value1-1|0))}))}))(new Ze(Jt.value,e))}}},nc=Hi($r),ec=Vi(kt),tc=Xi(nc),rc=function(){return Li(Ji(kt))((function(n){return new Ze(n.newSeed,function(){var e={};for(var t in n)({}).hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.newSeed=wi(n.newSeed),e}())}))}(),uc=$i(Tt),oc=x(uc)((function(n){return n/si}))(rc),ac=function(n){return function(e){return x(uc)(Gt(Ht)((function(n){return x(he)((function(n){return new Ze(n.head,n.tail)}))(function(n){if(n instanceof Jt)return fe.value;if(n instanceof Zt)return new ve({head:n.value0,tail:n.value1});throw new Error("Failed pattern match at Data.List (line 259, column 1 - line 259, column 66): "+[n.constructor.name])}(n))})))(tc(n)(e))}},ic=function(n){return e=n,function(n){return e(n).value0};var e},cc=function(n){return function(){var e=mi();return ic(n)({newSeed:e,size:10})}},lc=function(n){return function(e){return function(t){return ic(ac(e)(t))({newSeed:n,size:e})}}},fc=Ki(kt),vc=function(n){return function(e){var t=e,r=n,u=x(uc)(ei)(rc),o=Cn(fc)(x(uc)(R(C))(u))(x(uc)(z(C)(2))(u));return x(uc)((function(n){return li(r+ui(n)(t-r+1))}))(o)}},sc=function(n){return function(e){return n<=e?vc(n)(e):vc(e)(n)}},dc={chooseInt:sc,chooseFloat:function(n){return function(e){var t,r,u=function(n){return.5*n},o=u(Jn(Vn)(n)(e)),a=u(Hn(Vn)(n)(e));return x(uc)((t=R(C)(o),r=z(C)(a-o),function(n){return 2*t(r(n))}))(oc)}},chooseBool:x(uc)((function(n){return n<.5}))(oc),resize:function(n){return function(e){return Qi((function(t){return(r=n(t),function(n){return Li(Ji(kt))((function(e){return x(et)((function(n){return{size:e.size,newSeed:n.newSeed}}))(Zi(n)({newSeed:e.newSeed,size:r}))}))})(e);var r}))}},sized:Qi,Monad0:function(){return ec}},pc=function(){return{arbitrary:sc(-1e6)(1e6)}}(),mc=function(n){return function(e){return function(n,e,t,r){if("undefined"!=typeof window){var u=window[t];if(null!=u&&r instanceof u)return e(r)}for(var o=r;null!=o;){var a=Object.getPrototypeOf(o),i=a.constructor.name;if(i===t)return e(r);if("Object"===i)return n;o=a}return n}(fe.value,ve.create,n,e)}},hc=function(n){return e=n,t=fe.value,r=ve.create,null==e?t:r(e);var e,t,r},wc=function(){var n=x(Dr)(hc);return function(e){return n((t=e,function(){return t.body}));var t}}(),Mc=ct;function bc(n){return function(){return n.value}}function Sc(n){return function(){return n.valueAsNumber}}var yc=mc("HTMLInputElement");function gc(n){return function(){return n.document}}var Ac=ct;const Tc=function(){return window};var xc=function(n){return function(e){return function(){var t,r,u={units:{},scopes:{}},o=E(Dr)(Lr(0))((r=(t=la,function(n){return function(e){return function(r){return function(u){return je(t.MonadST5().Monad0().Bind1())(r.ids)((function(o){return Bo(Pn(Vo(t.MonadST5().Monad0().Applicative0()))($o(t.MonadST5().Monad0().Applicative0())(r.makeRoot({id:o,root:n})))(ja(t)({parent:new ve(o),scope:new Zo("rootScope"),raiseId:function(n){return ae(t.MonadST5().Monad0().Applicative0())(A)}})(r)(e)))(u)}))}}}})(n)(e),function(n){return r((e=n,{ids:function(){var n,t=_r(e)(),r=oe(re)(ic(pc.arbitrary)({newSeed:pi(t),size:5}));return F(Dr)((n=R(D)(1),function(n){return function(e){return function(){var t=n(e.value);return e.value=t.state,t.value}}}((function(e){var t=n(e);return{state:t,value:t}})))(e))(),r},makeElement:n=>e=>()=>{var t=n.id;e.scopes[n.scope]||(e.scopes[n.scope]=[]),e.scopes[n.scope].push(t),e.hydrating,e.units[t]={listeners:{},parent:n.parent,scope:n.scope,main:document.createElement(n.tag)}},attributeParent:$a,makeRoot:Ja,makeText:Va(!1)(de(A)),makePursx:Ha(!1)(de(A)),setProp:Ya(!1),setCb:Ka(!1),setText:Ga,sendToPos:ni,deleteFromCache:Xa,giveNewParent:Za,disconnectElement:Qa}));var e}))();return Bo(o)((function(n){return n(u)}))()}}},Ec=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Fc=function(){return new Ec(Jt.value,Jt.value)}(),kc=function(){function n(){}return n.value=new n,n}(),Nc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Bc=function(n){return function(e){if(n instanceof kc)return e;if(e instanceof kc)return n;if(n instanceof Nc)return new Nc(n.value0,function(n){return function(e){return new Ec(n.value0,new Zt(e,n.value1))}}(n.value1)(e));throw new Error("Failed pattern match at Data.CatList (line 108, column 1 - line 108, column 54): "+[n.constructor.name,e.constructor.name])}},Pc=function(n){return function(e){return function(t){var r;return(r=t,function(t){var u,o=r,a=!1;function i(r,u){var i,c=function(n){var e,t=!1;function r(e){if(e.value0 instanceof Jt&&e.value1 instanceof Jt)return t=!0,fe.value;if(!(e.value0 instanceof Jt)){if(e.value0 instanceof Zt)return t=!0,new ve(new Ze(e.value0.value0,new Ec(e.value0.value1,e.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 82, column 1 - line 82, column 63): "+[e.constructor.name])}n=new Ec(Ou(e.value1),Jt.value)}for(;!t;)e=r(n);return e}(r);if(c instanceof fe)return a=!0,(i=function(n){return function(e){return e(n)}},function(n){return function(e){var t,r=i,u=n,o=!1;function a(n,t,a){if(a instanceof Jt)return o=!0,t;if(a instanceof Zt)return r=n,u=n(t)(a.value0),void(e=a.value1);throw new Error("Failed pattern match at Data.CatList (line 124, column 3 - line 124, column 59): "+[n.constructor.name,t.constructor.name,a.constructor.name])}for(;!o;)t=a(r,u,e);return t}})(e)(u);if(c instanceof ve)return o=c.value0.value1,void(t=new Zt(n(c.value0.value0),u));throw new Error("Failed pattern match at Data.CatList (line 120, column 14 - line 122, column 67): "+[c.constructor.name])}for(;!a;)u=i(o,t);return u})(Jt.value)}}},qc=function(n){if(n instanceof kc)return fe.value;if(n instanceof Nc)return new ve(new Ze(n.value0,function(n){return n.value0 instanceof Jt&&n.value1 instanceof Jt}(n.value1)?kc.value:Pc(Bc)(kc.value)(n.value1)));throw new Error("Failed pattern match at Data.CatList (line 99, column 1 - line 99, column 61): "+[n.constructor.name])},Ic=function(){return kc.value}(),Cc=Bc,Dc={append:Cc},zc=function(n,e,t){var r,u=0;return function(o){if(2===u)return r;if(1===u)throw new ReferenceError(n+" was needed before it finished initializing (module "+e+", line "+o+")",e,o);return u=1,r=t(),u=2,r}},Rc=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Oc=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),_c=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Lc=function(n){return function(e){return function(t){var r,u=!1;function o(r){var o=function(n){var e,t=!1;function r(e){var r=function(n){return function(e){return new Rc(n.value0,bn(Dc)(n.value1)(e))}};if(e.value0 instanceof Oc){var u=qc(e.value1);if(u instanceof fe)return t=!0,new Oc(e.value0.value0);if(u instanceof ve)return void(n=r((0,u.value0.value0)(e.value0.value0))(u.value0.value1));throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[u.constructor.name])}if(e.value0 instanceof _c)return t=!0,new _c(e.value0.value0,(function(n){return r(e.value0.value1(n))(e.value1)}));throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[e.value0.constructor.name])}for(;!t;)e=r(n);return e}(r);if(o instanceof Oc)return u=!0,o.value0;if(!(o instanceof _c))throw new Error("Failed pattern match at Control.Monad.Free (line 178, column 10 - line 180, column 33): "+[o.constructor.name]);t=e(x(n)(o.value1)(o.value0))}for(;!u;)r=o(t);return r}}},jc={Applicative0:function(){return $c},Bind1:function(){return Uc}},Wc={map:function(n){return function(e){return We(Uc)((t=ae($c),function(e){return t(n(e))}))(e);var t}}},Uc={bind:function(n){return function(e){return new Rc(n.value0,(t=n.value1,function(n){return Cc(t)(new Nc(n,Fc))})(e));var t}},Apply0:function(){return Vc(0)}},$c={pure:function(n){return e=Oc.create(n),new Rc(e,Ic);var e},Apply0:function(){return Vc(0)}},Vc=zc("freeApply","Control.Monad.Free",(function(){return{apply:Fr(jc),Functor0:function(){return Wc}}})),Yc={proof:function(n){return n},Coercible0:function(){}},Kc=function(n){return n.proof((function(n){return n}))},Gc=function(n){return function(n){return y(n)}},Hc=function(n){return{apply:function(e){return function(t){return function(r){return Cn(n)(e(r))(t(r))}}},Functor0:function(){return e=n.Functor0(),{map:(t=x(e),function(n){return e=t(n),function(n){return function(t){return e(n(t))}};var e})};var e,t}}},Jc=function(n){return{Applicative0:function(){return e=n.Applicative0(),{pure:(t=ae(e),function(n){return y(t(n))}),Apply0:function(){return Hc(e.Apply0())}};var e,t},Bind1:function(){return e=n.Bind1(),{bind:function(n){return function(t){return function(r){return je(e)(n(r))((function(n){return t(n)(r)}))}}},Apply0:function(){return Hc(e.Apply0())}};var e}}},Zc=function(n){return{liftEffect:(e=Gc(n.Monad0()),t=Ui(n),function(n){return e(t(n))}),Monad0:function(){return Jc(n.Monad0())}};var e,t},Qc=Lc(B)((function(n){return n(A)}));function Xc(n,e,t,r,u,o,a){return null==a?n():"boolean"==typeof a?e(a):"number"==typeof a?t(a):"string"==typeof a?r(a):"[object Array]"===Object.prototype.toString.call(a)?u(a):o(a)}var nl=function(){return(n=fe.value,function(e){return function(t){return t(n)(e)}})(ve.create);var n}(),el=nl((function(n){return function(e){return function(t){return Xc(y(n),y(n),y(n),e,y(n),y(n),t)}}})),tl=nl((function(n){return function(e){return function(t){return Xc(y(n),y(n),y(n),y(n),e,y(n),t)}}})),rl=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ul=function(){var n=ut(at)((function(n){return new rl("JSON")}));return function(e){return n((t=e,function(n,e,t){try{return e(JSON.parse(t))}catch(e){return n(e.message)}}(Fe.create,ke.create,t)));var t}}(),ol=function(n){return n},al=function(n){return n},il=ro,cl=function(n){return function(e){return{append:function(t){return function(r){return io(n)(bn(e))(t)(r)}}}}},ll=function(n){return function(e){return{mempty:uo,Semigroup0:function(){return cl(n)(e)}}}},fl=Qu,vl="function"==typeof Array.from,sl="undefined"!=typeof Symbol&&null!=Symbol&&void 0!==Symbol.iterator&&"function"==typeof String.prototype[Symbol.iterator],dl="function"==typeof String.prototype.fromCodePoint,pl="function"==typeof String.prototype.codePointAt;const ml=function(n){return dl?function(e){return e.length<1e4?String.fromCodePoint.apply(String,e):e.map(n).join("")}:function(e){return e.map(n).join("")}},hl=function(n){return dl?String.fromCodePoint:n},wl=function(n){return function(e){return sl?function(n){for(var t="",r=n[Symbol.iterator](),u=0;u<e;++u){var o=r.next();if(o.done)return t;t+=o.value}return t}:n(e)}},Ml=function(n){return function(e){return vl?function(n){return Array.from(n,e)}:n}},bl=function(n){return function(e){if(n>=0&&n<e.length)return e.charAt(n);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var Sl=function(n){return function(e){return 65536+((1024*(n-55296|0)|0)+(e-56320|0)|0)|0}},yl=function(n){return 56320<=n&&n<=57343},gl=function(n){return 55296<=n&&n<=56319},Al=function(n){var e=Ii(n);if(0===e)return fe.value;if(1===e)return new ve({head:ir(sr)(bl(0)(n)),tail:""});var t=ir(sr)(bl(1)(n)),r=ir(sr)(bl(0)(n)),u=gl(r)&&yl(t);return new ve(u?{head:Sl(r)(t),tail:Ci(2)(n)}:{head:r,tail:Ci(1)(n)})},Tl=function(n){return x(he)((function(n){return new Ze(n.head,n.tail)}))(Al(n))},xl=function(n){return Gt(Ht)(Tl)(n)},El=function(n){return pl?function(n){return n.codePointAt(0)}:n}((function(n){var e=ir(sr)(bl(0)(n));if(gl(e)&&Ii(n)>1){var t=ir(sr)(bl(1)(n));return yl(t)?Sl(e)(t):e}return e})),Fl=Ml(xl)(El),kl=function(n){return eu(Fl(n))},Nl=function(){var n,e=(n=sr,function(e){return function(t){return function(r){var u=n.toEnum(r);if(u instanceof ve)return u.value0;if(u instanceof fe)return r<ir(n)(ne(n.Bounded0()))?e:t;throw new Error("Failed pattern match at Data.Enum (line 158, column 33 - line 160, column 62): "+[u.constructor.name])}}})(ne(Xn))(Zn(Xn));return function(n){return e(n)}}(),Bl=function(n){if(n<=65535)return Nl(n);var e=cn(an)(n-65536|0)(1024)+55296|0,t=un(an)(n-65536|0)(1024)+56320|0;return Nl(e)+Nl(t)},Pl=ml(Bl),ql=hl(Bl),Il=function(n){return function(e){if(n<1)return"";var t=Al(e);return t instanceof ve?ql(t.value0.head)+Il(n-1|0)(t.value0.tail):e}},Cl=wl(Il),Dl={eq:function(n){return function(e){return n===e}}},zl={compare:function(n){return function(e){return Gn(Yn)(n)(e)}},Eq0:function(){return Dl}},Rl=function(n){return function(e){return Ci(Ii(Cl(n)(e)))(e)}},Ol=function(){var n=ir(sr);return function(e){return n(e)}}(),_l=function(n){return n},Ll=function(n){return kl(n)},jl=function(){function n(){}return n.value=new n,n}(),Wl={attr:function(n){return function(n){return{key:"checked",value:Ba(n)}}}},Ul=function(){function n(){}return n.value=new n,n}(),$l={attr:function(n){return function(n){return{key:"class",value:Ba(n)}}}},Vl={attr:function(n){return function(n){return{key:"class",value:Ba(n)}}}},Yl={attr:function(n){return function(n){return{key:"class",value:Ba(n)}}}},Kl={attr:function(n){return function(n){return{key:"class",value:Ba(n)}}}},Gl={attr:function(n){return function(n){return{key:"class",value:Ba(n)}}}},Hl={attr:function(n){return function(n){return{key:"class",value:Ba(n)}}}},Jl={attr:function(n){return function(n){return{key:"class",value:Ba(n)}}}},Zl={attr:function(n){return function(n){return{key:"class",value:Ba(n)}}}},Ql={attr:function(n){return function(n){return{key:"class",value:Ba(n)}}}},Xl={attr:function(n){return function(n){return{key:"class",value:Ba(n)}}}},nf={attr:function(n){return function(n){return{key:"class",value:Ba(n)}}}},ef=function(){function n(){}return n.value=new n,n}(),tf={attr:function(n){return function(n){return{key:"max",value:Ba(n)}}}},rf=function(){function n(){}return n.value=new n,n}(),uf={attr:function(n){return function(n){return{key:"min",value:Ba(n)}}}},of=function(){function n(){}return n.value=new n,n}(),af={attr:function(n){return function(n){return{key:"name",value:Ba(n)}}}},cf=function(){function n(){}return n.value=new n,n}(),lf={attr:function(n){return function(n){return{key:"click",value:Pa(y(k(Dr)(n)(!0)))}}}},ff={attr:function(n){return function(n){return{key:"click",value:Pa(n)}}}},vf=function(){function n(){}return n.value=new n,n}(),sf={attr:function(n){return function(n){return{key:"input",value:Pa(n)}}}},df=function(){function n(){}return n.value=new n,n}(),pf={attr:function(n){return function(n){return{key:"mouseenter",value:Pa(y(k(Dr)(n)(!0)))}}}},mf=function(){function n(){}return n.value=new n,n}(),hf={attr:function(n){return function(n){return{key:"mouseleave",value:Pa(y(k(Dr)(n)(!0)))}}}},wf=function(){function n(){}return n.value=new n,n}(),Mf={attr:function(n){return function(n){return{key:"placeholder",value:Ba(n)}}}},bf=function(){function n(){}return n.value=new n,n}(),Sf={attr:function(n){return function(n){return{key:"rowspan",value:Ba(n)}}}},yf=function(){function n(){}return n.value=new n,n}(),gf={attr:function(n){return function(n){return{key:"style",value:Ba(n)}}}},Af=function(){function n(){}return n.value=new n,n}(),Tf={attr:function(n){return function(n){return{key:"value",value:Ba(n)}}}},xf=function(){function n(){}return n.value=new n,n}(),Ef={attr:function(n){return function(n){return{key:"type",value:Ba(n)}}}},Ff=function(n){return function(n){return function(e){return function(t){return new oa(Wa(n)("br")(e)(ia(t)))}}}(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},kf=function(n){return function(e){return function(t){return new oa(Wa(n)("button")(e)(ia(t)))}}},Nf=function(n){return function(e){return function(t){return new oa(Wa(n)("div")(e)(ia(t)))}}},Bf=function(n){return Nf(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},Pf=function(n){return function(n){return function(e){return function(t){return new oa(Wa(n)("em")(e)(ia(t)))}}}(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},qf=function(n){return function(n){return function(e){return function(t){return new oa(Wa(n)("h2")(e)(ia(t)))}}}(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},If=function(n){return function(e){return function(t){return new oa(Wa(n)("input")(e)(ia(t)))}}},Cf=function(n){return function(e){return function(t){return new oa(Wa(n)("label")(e)(ia(t)))}}},Df=function(n){return Cf(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},zf=function(n){return function(e){return function(t){return new oa(Wa(n)("li")(e)(ia(t)))}}},Rf=function(n){return zf(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},Of=function(n){return function(e){return function(t){return new oa(Wa(n)("ol")(e)(ia(t)))}}},_f=function(n){return function(e){return function(t){return new oa(Wa(n)("span")(e)(ia(t)))}}},Lf=function(n){return _f(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},jf=function(n){return function(n){return function(e){return function(t){return new oa(Wa(n)("sub")(e)(ia(t)))}}}(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},Wf=function(n){return function(e){return function(t){return new oa(Wa(n)("table")(e)(ia(t)))}}},Uf=function(n){return Wf(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},$f=function(n){return function(e){return function(t){return new oa(Wa(n)("tbody")(e)(ia(t)))}}},Vf=function(n){return $f(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},Yf=function(n){return function(e){return function(t){return new oa(Wa(n)("td")(e)(ia(t)))}}},Kf=function(n){return Yf(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},Gf=function(n){return function(e){return function(t){return new oa(Wa(n)("th")(e)(ia(t)))}}},Hf=function(n){return function(n){return function(e){return function(t){return new oa(Wa(n)("thead")(e)(ia(t)))}}}(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},Jf=function(n){return function(e){return function(t){return new oa(Wa(n)("tr")(e)(ia(t)))}}},Zf=function(n){return Jf(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},Qf=function(n){return function(n){return function(e){return function(t){return new oa(Wa(n)("ul")(e)(ia(t)))}}}(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))},Xf=function(n){return hc(n.target)},nv=function(n){var e=Pn(Vo(n))($o(n)(Ia(Ef)(xf.value)("range"))),t=x(Co)((function(n){return Ia(sf)(vf.value)(qa((function(e){return ht(qr)(St)(je(ye)(Xf(e))(yc))(Ue(Pr)(Sc)(n))})))}));return function(n){return e(t(n))}},ev=function(n){var e=Ui(n);return function(n){return e((t=n,function(){console.log(t)}));var t}};function tv(){return Date.now()}var rv=qo((function(n){return function(){var e,t=Tc(),r=Lr(!1)(),u=function(e,o,a){var i,c=0;return function(e){if(2===c)return i;if(1===c)throw new ReferenceError("loop was needed before it finished initializing (module "+o+", line "+e+")",o,e);return c=1,i=F(Dr)((a=function(){return n(A)(),(e=Br,function(n){return function(t){return je(e.Bind1())(n)((function(n){return(r=e.Applicative0(),function(n){return function(e){if(!n)return e;if(n)return ae(r)(A);throw new Error("Failed pattern match at Control.Applicative (line 68, column 1 - line 68, column 65): "+[n.constructor.name,e.constructor.name])}})(n)(t);var r}))}})(_r(r))(u(19))();var e},function(n){return function(){return n.requestAnimationFrame(a)}})(t)),c=2,i;var a}}(0,"FRP.Event.AnimationFrame");return u(16)(),(e=!0,function(n){return function(){n.value=e}})(r)}})),uv=function(n){return{map:function(e){return function(t){return function(r){return t(x(n)((function(n){return function(t){return n(e(t))}}))(r))}}}}},ov=function(n){return function(e){return Bo(n)((function(n){return function(){var t=tv();return e({time:t,value:n})()}}))}},av=function(n){return n}((function(n){return x(Co)((function(n){return n.value(n.time)}))(ov(n))})),iv=function(n){return function(e){return xo(Ko(Xr))((function(n){return function(e){var t=we(0)(e.prevTime),r=we(0)(e.prevBeats),u=vt()()(ol)(O.sub)(n.acTime)(t),o=vt()()(ol)(cn(on))(u)(n.behaviors.clength),a=ft()(o)+ft()(r);return new Ze({prevTime:new ve(n.acTime),prevBeats:new ve(a)},{prevTime:e.prevTime,prevBeats:e.prevBeats,time:n.acTime,beats:a,epochTime:n.behaviors.epochTime})}}))((t=Co,function(n){return function(e){return function(r){return function(n){return function(e){return n(e)}}(x(uv(t))(n)(e))(x(t)(g)(r))}}})((function(n){return function(e){return{behaviors:n,acTime:e}}}))(Cn(function(n){return{apply:function(e){return function(t){return function(r){return t(e(x(n)(h(m))(r)))}}},Functor0:function(){return uv(n)}}}(Co))(x(uv(Co))((function(n){return function(e){return{clength:n,epochTime:e}}}))(n))(x(uv(Co))(al)(av)))(e))({prevTime:fe.value,prevBeats:fe.value});var t}},cv=function(){function n(){this.head=null,this.last=null,this.size=0}function e(n,e){this.queue=n,this.value=e,this.next=null,this.prev=null}function t(e){this.draining=!1,this.error=null,this.value=e,this.takes=new n,this.reads=new n,this.puts=new n}var r={};function u(n){try{n()}catch(n){setTimeout((function(){throw n}),0)}}function o(n){var e;switch(n.size){case 0:return null;case 1:e=n.head,n.head=null;break;case 2:e=n.last,n.head.next=null,n.last=null;break;default:e=n.last,n.last=e.prev,n.last.next=null}return e.prev=null,e.queue=null,n.size--,e.value}function a(n){var e;switch(n.size){case 0:return null;case 1:e=n.head,n.head=null;break;case 2:e=n.head,n.last.prev=null,n.head=n.last,n.last=null;break;default:e=n.head,n.head=e.next,n.head.prev=null}return e.next=null,e.queue=null,n.size--,e.value}return t.EMPTY=r,t.putLast=function(n,t){var r=new e(n,t);switch(n.size){case 0:n.head=r;break;case 1:r.prev=n.head,n.head.next=r,n.last=r;break;default:r.prev=n.last,n.last.next=r,n.last=r}return n.size++,r},t.takeLast=o,t.takeHead=a,t.deleteCell=function(n){null!==n.queue&&(n.queue.last!==n?n.queue.head!==n?(n.prev&&(n.prev.next=n.next),n.next&&(n.next.prev=n.prev),n.queue.size--,n.queue=null,n.value=null,n.next=null,n.prev=null):a(n.queue):o(n.queue))},t.drainVar=function(n,e){if(!e.draining){var t,o,i,c,l,f=e.puts,v=e.takes,s=e.reads;for(e.draining=!0;;){if(t=null,o=null,i=null,c=e.value,l=s.size,null!==e.error){for(c=n.left(e.error);t=a(f);)u(t.cb(c));for(;o=a(s);)u(o(c));for(;i=a(v);)u(i(c));break}if(c===r&&(t=a(f))&&(e.value=c=t.value),c!==r){for(i=a(v);l--&&(o=a(s));)u(o(n.right(c)));null!==i&&(e.value=r,u(i(n.right(c))))}if(null!==t&&u(t.cb(n.right(void 0))),e.value===r&&0===f.size||e.value!==r&&0===v.size)break}e.draining=!1}},t}(),lv=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),fv=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),vv=function(){function n(){}return n.value=new n,n}(),sv=function(){return{left:Fe.create,right:ke.create,nothing:fe.value,just:ve.create,killed:lv.create,filled:fv.create,empty:vv.value}}(),dv=function(n){return function(e){return function(t){return function(){var r=new cv(cv.EMPTY),u=Bo(n)((function(n){return F(Dr)(Dn(zr)(function(n,e){return function(){var t=e.value;return t===cv.EMPTY?n.nothing:(e.value=cv.EMPTY,cv.drainVar(n,e),n.just(t))}}(sv,r))(function(n){return function(e){return function(n,e,t){return function(){return t.value===cv.EMPTY&&null===t.error&&(t.value=e,cv.drainVar(n,t),!0)}}(sv,n,e)}}(n)(r)))}))(),o=Bo(e)((function(n){return t(n(r))}))();return Dn(zr)(u)(o)}}}},pv=function(n){return function(e){return function(t){return function(r){return Do(e.Always2())(e.Always3())(e.MonadST5().Monad0().Applicative0())(dv(No(e.Always4())(e.Always1())(e.MonadST5().Monad0().Applicative0())(t))(No(e.Always4())(e.Always1())(e.MonadST5().Monad0().Applicative0())(x(Co)(function(n){return function(e){return function(t){return je(n.Monad0().Bind1())(Ui(n)(function(n,e){return function(){return e.value===cv.EMPTY?n.nothing:n.just(e.value)}}(sv,t)))(mt(n.Monad0().Applicative0())(St)(e))}}}(n))(r))))}}}},mv=function(n){return n.readersT},hv=function(n){return{readersT:(e=x(B)(mv(n)),function(n){return e(n)})};var e};Array.isArray;var wv=ct;const Mv=function(n,e,t){try{return e(function(n){return n.replace(/[!'()*]/g,(function(n){return"%"+n.charCodeAt(0).toString(16)}))}(encodeURIComponent(t)))}catch(e){return n(e)}};function bv(n,e,t){try{return e(decodeURIComponent(t))}catch(e){return n(e)}}var Sv=function(){return dr(Mv)(y(fe.value))(ve.create)}(),yv=function(){return dr(bv)(y(fe.value))(ve.create)}(),gv=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Av=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),Tv=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),xv=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Ev=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),Fv=function(n){if(n instanceof gv)return n.value0;if(n instanceof Av)return n.value2;throw new Error("Failed pattern match at Parser.Proto (line 22, column 1 - line 22, column 52): "+[n.constructor.name])},kv=function(n){return function(e){return function(t){var r=function(e){var t=function(n){return function(e){if(e.inputs instanceof Jt)return new Fe(new ve(e.stack));if(e.inputs instanceof Zt){var t=n.step(Fv(e.stack))(e.inputs.value0);if(t instanceof fe)return new Fe(fe.value);if(t instanceof ve&&t.value0 instanceof Fe){var r=new Av(e.stack,n.promote(e.inputs.value0),t.value0.value0);return new ke({next:{stack:r,inputs:e.inputs.value1},action:new Fe(e.inputs.value0)})}if(t instanceof ve&&t.value0 instanceof ke){var u=n.goto(t.value0.value0)(e.stack);if(u instanceof fe)return new Fe(fe.value);if(u instanceof ve)return new ke({next:{stack:u.value0,inputs:e.inputs},action:new ke(t.value0.value0)});throw new Error("Failed pattern match at Parser.Proto (line 65, column 9 - line 67, column 95): "+[u.constructor.name])}throw new Error("Failed pattern match at Parser.Proto (line 59, column 24 - line 67, column 95): "+[t.constructor.name])}throw new Error("Failed pattern match at Parser.Proto (line 57, column 3 - line 67, column 95): "+[e.inputs.constructor.name])}}(n)(e);if(t instanceof Fe&&t.value0 instanceof fe)return new Tv(e);if(t instanceof Fe&&t.value0 instanceof ve)return new xv(e,t.value0.value0);if(t instanceof ke)return new Ev(e,t.value0.action,r(t.value0.next));throw new Error("Failed pattern match at Parser.Proto (line 73, column 15 - line 76, column 67): "+[t.constructor.name])},u=function(n){return function(e){return{stack:new gv(e),inputs:n}}}(e)(t);return r(u)}}};function Nv(n){return function(){return n.search}}var Bv,Pv,qv,Iv,Cv,Dv,zv,Rv=function(){function n(){}return n.value=new n,n}(),Ov=function(){function n(){}return n.value=new n,n}(),_v=function(){function n(){}return n.value=new n,n}(),Lv=function(){function n(){}return n.value=new n,n}(),jv=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Wv=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Uv=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),$v=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Vv=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Yv=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Kv=function(n){return n},Gv=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Hv=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Jv=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Zv=function(n){return qa((function(e){return ht(qr)(St)(je(ye)(Xf(e))(yc))(Ue(Pr)(bc)(n))}))},Qv=function(n){return n instanceof Vv?new ve(n.value0):fe.value},Xv=function(n){if(n instanceof jv)return new ve(n.value0);if(n instanceof Uv)return new ve(n.value0);if(n instanceof Wv)return fe.value;throw new Error("Failed pattern match at Parser.Main (line 547, column 1 - line 547, column 50): "+[n.constructor.name])},ns=function(n){return function(n){if(n instanceof Vv)return e=n.value0,_l(ql(e));var e;if(n instanceof $v)return n.value0;throw new Error("Failed pattern match at Parser.Main (line 650, column 1 - line 650, column 36): "+[n.constructor.name])}(n)},es=gt(yt)(gn)((function(n){if(n instanceof $v)return n.value0;if(n instanceof Vv)return ql(n.value0);throw new Error("Failed pattern match at Parser.Main (line 944, column 29 - line 946, column 39): "+[n.constructor.name])})),ts=function(n){return n instanceof $v?new ve(n.value0):fe.value},rs=function(n){return Tu(n.value1)},us={append:function(n){return function(e){if(n instanceof jv&&e instanceof jv)return new jv(n.value0);if(n instanceof jv&&e instanceof Uv)return new Uv(n.value0,e.value1);if(n instanceof Uv&&e instanceof jv)return new Uv(n.value0,n.value1);if(n instanceof Uv&&e instanceof Uv)return new Uv(n.value0,bn(Ai)(n.value1)(e.value1));if(n instanceof jv&&e instanceof Wv)return new Uv(n.value0,e.value0);if(n instanceof Wv&&e instanceof jv)return new Uv(e.value0,n.value0);if(n instanceof Wv&&e instanceof Wv)return new Wv(bn(Ai)(n.value0)(e.value0));if(n instanceof Uv&&e instanceof Wv)return new Uv(n.value0,bn(Ai)(n.value1)(e.value0));if(n instanceof Wv&&e instanceof Uv)return new Uv(e.value0,bn(Ai)(n.value0)(e.value1));throw new Error("Failed pattern match at Parser.Main (line 553, column 1 - line 563, column 72): "+[n.constructor.name,e.constructor.name])}}},os=function(n){if(n instanceof Gv)return new Fe(n.value0);if(n instanceof Hv)return new ke(new Jv(n.value0,Ru((function(n){return qe(os(n))}))(n.value1)));throw new Error("Failed pattern match at Parser.Main (line 840, column 1 - line 840, column 55): "+[n.constructor.name])},as=function(n){return function(e){return ia(x(P)((t=function(n){return function(n){return function(e){return function(t){return new oa(Wa(n)("p")(e)(ia(t)))}}}(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))}(e),r=ae(le),u=La(e.MonadST5().Monad0()),function(n){return t(r(u(n)))}))(n));var t,r,u}},is=function(n){return function(e){var t=Al(e);if(t instanceof ve){var r=function(n){return function(e){return qu((function(n){return Cl(Ll(n))(e)===n}))(n)}}(n)(e);if(r instanceof ve)return bn(wn)([new $v(r.value0)])(is(n)(Rl(Ll(r.value0))(e)));if(r instanceof fe)return bn(wn)([new Vv(t.value0.head)])(is(n)(t.value0.tail));throw new Error("Failed pattern match at Parser.Main (line 938, column 5 - line 940, column 58): "+[r.constructor.name])}if(t instanceof fe)return[];throw new Error("Failed pattern match at Parser.Main (line 936, column 25 - line 941, column 16): "+[t.constructor.name])}},cs=function(n){return 1===n.length?new ve(n[0]):fe.value},ls=function(n){var e=wu(n.rule.value1);if(e instanceof fe)return{nonTerminal:uo,terminal:uo};if(e instanceof ve){var t=ae(le)({pName:n.pName,rName:n.rName,rule:new Yv(bn(wn)(n.rule.value0)([e.value0.head]),e.value0.tail),lookahead:n.lookahead});if(e.value0.head instanceof $v)return{nonTerminal:Gu(e.value0.head.value0)(t),terminal:uo};if(e.value0.head instanceof Vv)return{nonTerminal:uo,terminal:Gu(e.value0.head.value0)(t)};throw new Error("Failed pattern match at Parser.Main (line 754, column 7 - line 762, column 12): "+[e.value0.head.constructor.name])}throw new Error("Failed pattern match at Parser.Main (line 740, column 47 - line 762, column 12): "+[e.constructor.name])},fs=function(n){return function(e){return function(t){return Nu((r=Fn({reflectSymbol:function(){return"nonTerminal"}})(ll(n)(wn))()(Fn({reflectSymbol:function(){return"terminal"}})(ll(e)(wn))()(An)),{mempty:xn(r)(T.value),Semigroup0:function(){return n=r.SemigroupRecord0(),{append:Mn(n)(T.value)};var n}}))(ls)(t);var r}}},vs=function(n){return function(n){return function(e){return function(t){return function(r){return function(u){return je(n.Monad0().Bind1())(_o(n)(n))((function(o){return je(n.Monad0().Bind1())(nu(n)(Tr(t)))((function(t){var a=function(e){return Oe($e)(n.Monad0().Bind1())(je(n.Monad0().Bind1())(nu(n)(xr(t)))(e))((function(){return Bo(o.event)(e)}))};return Oe($e)(n.Monad0().Bind1())(u(r(a)))((function(){return Bo(e)(o.push)}))}))}))}}}}}},ss=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){return jo(e)(To(Ko(e))(t)(r)(u))((function(e){return o(Pn(Vo(n))($o(n)(u))(e))}))}}}}}},ds=function(n){return function(e){return function(t){return function(r){if(r instanceof ve)return $o(n)(Ia(e)(t)(r.value0));if(r instanceof fe)return Re(Yo(n));throw new Error("Failed pattern match at Parser.Main (line 957, column 1 - line 957, column 100): "+[t.constructor.name,r.constructor.name])}}}},ps=function(n){return function(e){return function(t){return function(r){return x(n)((function(n){return Ia(e)(t)(n)}))(r)}}}},ms=function(){var n=Mu(bn(Sn(Sn(sn)))(b(S(Gn(Yn)))(Ll))(Gn(Ri))),e=xu(Ri);return function(t){return n(e(t))}}(),hs=function(n){var e=ms(E(P)(n)((function(n){return n.pName}))),t=is(e);return E(P)(n)((function(n){var e={};for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e.rule=t(n.rule),e}))},ws=function(){var n=Ru((function(n){return E(he)(Oi(n.pName))((function(e){return{pName:e,rule:n.rule,rName:n.rName}}))}));return function(e){return hs(n(e))}}(),Ms=function(n){var e,t=!1;function r(e){if(e instanceof Tv)return t=!0,Fv(e.value0.stack);if(e instanceof xv)return t=!0,Fv(e.value1);if(!(e instanceof Ev))throw new Error("Failed pattern match at Parser.Main (line 1832, column 1 - line 1832, column 33): "+[e.constructor.name]);n=e.value2}for(;!t;)e=r(n);return e},bs=function(n){return n instanceof $v},Ss=function(n){var e,t=(e=bs,function(n){var t=function(t){var r,u=!1;function o(r){var o=Au(n)(r);if(o instanceof ve)return e(o.value0)?void(t=r+1|0):(u=!0,new ve(r));if(o instanceof fe)return u=!0,fe.value;throw new Error("Failed pattern match at Data.Array (line 964, column 5 - line 966, column 25): "+[o.constructor.name])}for(;!u;)r=o(t);return r}(0);if(t instanceof ve&&0===t.value0)return{init:[],rest:n};if(t instanceof ve)return{init:au(0)(t.value0)(n),rest:au(t.value0)(eu(n))(n)};if(t instanceof fe)return{init:n,rest:[]};throw new Error("Failed pattern match at Data.Array (line 951, column 3 - line 957, column 30): "+[t.constructor.name])})(n);return{following:Ru(ts)(t.init),continue:je(ye)(Tu(t.rest))(Qv)}},ys=function(){var n;return{encode:function(n){return E(P)(ft()(n.augmented))((function(n){return[n.pName,es(n.rule),n.rName]}))},decode:(n=ye,function(e){return function(t){return function(r){return We(n)(e)(t(r))}}})((function(n){return e=hs(n),je(ye)(Au(e)(0))((function(n){return 2===n.rule.length&&n.rule[0]instanceof $v&&n.rule[1]instanceof Vv?new ve({augmented:e,entry:n.rule[0].value0,eof:n.rule[1].value0,start:{lookahead:[],pName:n.pName,rName:n.rName,rule:new Yv([],n.rule)}}):fe.value}));var e}))(Ue(ye)(tl)(Ue(ye)(_t(jt)(ge)(tl))(_t(jt)(ge)((function(n){return Cn(Se)(Cn(Se)(x(he)((function(n){return function(e){return function(t){return{pName:n,rule:e,rName:t}}}}))(We(ye)(Oi)(We(ye)(el)(Au(n)(0)))))(We(ye)(el)(Au(n)(1))))(We(ye)(el)(Au(n)(2)))})))))}}(),gs=function(n){return function(n){return function(e){return je(Yi(jc))(ji(Ji(jc)))((function(t){return Oe($e)(Yi(jc))((r=Ji(jc),function(n){return Li(r)((function(e){return new Ze(A,n)}))})(t+1|0))((function(){return ae(Gi(jc))((function(r){return new Ze(t,E(Co)(r(t))((function(t){return Ia(n)(Ul.value)(e+(t?"":" hidden"))})))}))}));var r}))}}},As=function(n){return function(n){return gs()(n)("")}},Ts=function(n){return function(n){return je(Yi(jc))(ji(Ji(jc)))((function(e){return ae(Gi(jc))((function(t){return new Ze(e,E(Co)(t(e))((function(e){return Ia(n)(Ul.value)(e?"":" hidden")})))}))}))}},xs=function(n){return function(e){return Nu(yo(n))((function(e){return So(yt)(n)(Ru(Qv)(e.rule))}))(e)}},Es={map:function(n){return function(e){if(e instanceof jv)return new jv(e.value0);if(e instanceof Wv)return new Wv(x(Ti)(n)(e.value0));if(e instanceof Uv)return new Uv(e.value0,x(Ti)(n)(e.value1));throw new Error("Failed pattern match at Parser.Main (line 0, column 0 - line 0, column 0): "+[e.constructor.name])}}},Fs={map:function(n){return function(e){return new Jv(n(e.value0),x(P)(x(Fs)(n))(e.value1))}}},ks=function(n){var e,t,r,u,o=(t=zl,r=_t(nr)(ge),u=function(n){var e=xs(n);return function(t){return r=e(t),function(e){return wo(n)(e)(r)?new ve(e):fe.value};var r}}(t),function(n){return r(u(n))})(n.augmented),a=(e=tr,function(n){var t=eu(n);return Gt(e)((function(e){return e<t?new ve(new Ze(hu()(n)(e),e+1|0)):fe.value}))(0)});return function(n){return o(a(Fl(n)))}},Ns=function(n){var e=ks(n),t=Ve(_e)((function(e){var t,r;return(t=ql(n.eof),r=Di(t),function(n){return me(r(n))})(e)?w(M):S(bn(mn))(ql(n.eof))}));return function(n){return e(t(n))}},Bs=function(n){return function(e){return function(t){return function(r){return function(u){var o={pName:n,rName:e,rule:[new $v(u),new Vv(t)]};return{augmented:bn(wn)([o])(r),start:{pName:n,rName:e,rule:new Yv([],o.rule),lookahead:[]},eof:t,entry:u}}}}}},Ps=function(n){return function(e){return je(Ce)(Ne("Need at least 1 rule in the grammar")(Tu(e)))((function(t){var r,u,o=ms(bn(wn)([n.top])(E(P)(e)((function(n){return n.pName})))),a=is(o),i=S(Ut(jt))(bo)((function(n){return function(e){var t,r=""!==e.rName?e.rName:(t=n,function(n){return function(e){for(var r,u,o,a,i,c=t,l=n,f=!1;!f;)u=c,a=e,void 0,i=(o=l)+oe(re)(a),r=wo($n)(i)(u)?(c=u,l=o,void(e=a+1|0)):(f=!0,i);return r}})(e.pName)(1);return{value:{rule:a(e.rule),rName:r,pName:e.pName},accum:Mo($n)(r)(n)}}}))(e).value,c=we(t.pName)(n.entry),l={pName:n.top,rName:n.topName,rule:[new $v(c),new Vv(n.eof)]},f={pName:l.pName,rName:l.rName,rule:new Yv([],l.rule),lookahead:[]};return Oe($e)(Ce)((u=eu(xu($n)(bn(wn)(E(P)(i)((function(n){return n.rName})))([n.topName])))!==(1+eu(e)|0),u?new Fe("Rule names need to be unique: "+oe({show:(r=oe(ee),function(n){for(var e=[],t=0,u=n.length;t<u;t++)e[t]=r(n[t]);return"["+e.join(",")+"]"})})(E(P)(i)((function(n){return n.rName})))):ae(De)(A)))((function(){return Oe($e)(Ce)((r=Ye(Je(He))(me)(qu((t=nn(_i)(c),function(n){return t(function(n){return n.pName}(n))}))(e)),r?new Fe("Top-level does not refer to nonterminal"):ae(De)(A)))((function(){return Oe($e)(Ce)(wo(zl)(n.eof)(xs(zl)(i))?new Fe("Grammar references EOF symbol"):ae(De)(A))((function(){return Oe($e)(Ce)((t=wo(Ri)(n.top)((e=Ri,function(n){return Nu(yo(e))((function(n){return So(yt)(e)(Ru(ts)(n.rule))}))(n)})(i)),t?new Fe("Grammar references top rule"):ae(De)(A)))((function(){return ae(De)({augmented:bn(wn)([l])(i),start:f,eof:n.eof,entry:c})}));var e,t}))}));var t,r}))}))}},qs=function(n){return function(e){return{eq:function(t){return function(r){return t instanceof $v&&r instanceof $v?nn(n)(t.value0)(r.value0):t instanceof Vv&&r instanceof Vv&&nn(e)(t.value0)(r.value0)}}}}},Is=function(n){return function(e){return{eq:function(t){return function(r){return nn(en(qs(n)(e)))(t.value0)(r.value0)&&nn(en(qs(n)(e)))(t.value1)(r.value1)}}}}},Cs=function(n){return function(e){return function(t){var r=ku((function(r){return function(u){var o=Ut(jt)((function(r){return function(o){return nn(e)(o.rName)(u.rName)&&nn(Is(n)(t))(o.rule)(u.rule)?{accum:!0,value:{rName:o.rName,pName:o.pName,rule:o.rule,lookahead:yu(t)(bn(wn)(o.lookahead)(u.lookahead))}}:{accum:r,value:o}}}))(!1)(r);return o.accum?o.value:bn(wn)(o.value)([u])}}))([]);return function(n){return r(n)}}}},Ds=function(n){return function(e){return function(t){return{eq:function(r){return function(u){return nn(en(H()(tn(tn(tn(tn(K)()({reflectSymbol:function(){return"rule"}})(Is(n)(t)))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n))()({reflectSymbol:function(){return"lookahead"}})(en(t)))))(r)(u)||(o=Cs(n)(e)(t)(r),a=Cs(n)(e)(t)(u),i=Cs(n)(e)(t)(bn(wn)(o)(a)),c=Cs(n)(e)(t)(bn(wn)(a)(o)),nn(en(H()(tn(tn(tn(tn(K)()({reflectSymbol:function(){return"rule"}})(Is(n)(t)))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n))()({reflectSymbol:function(){return"lookahead"}})(en(t)))))(o)(i)&&nn(en(H()(tn(tn(tn(tn(K)()({reflectSymbol:function(){return"rule"}})(Is(n)(t)))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n))()({reflectSymbol:function(){return"lookahead"}})(en(t)))))(a)(c));var o,a,i,c}}}}}},zs=function(n){return function(e){return function(t){return function(r){var u=function(u){var o=function(n){return Fu(function(n){return Du(nn(n))}(n))}(H()(tn(tn(tn(K)()({reflectSymbol:function(){return"rule"}})(en(qs(n)(t))))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n)))(r)(x(P)((function(n){return n.production}))(u)),a=vo(fo)((function(e){return x(he)((function(n){return{production:e,produced:Ve(Le)(n)}}))(_t(jt)(ge)((t=u,function(e){if(e instanceof $v)return E(he)(qu((r=nn(n)(e.value0),function(n){return r(n.production.pName)}))(t))((function(n){return n.produced}));var r;if(e instanceof Vv)return ae(ge)([e.value0]);throw new Error("Failed pattern match at Parser.Main (line 178, column 3 - line 179, column 76): "+[t.constructor.name,e.constructor.name])}))(e.rule));var t}))(o);return bn(wn)(u)(a)};return function(r){var o,a=!1;function i(o){var i=u(o);if(nn(en(H()(tn(tn(K)()({reflectSymbol:function(){return"production"}})(H()(tn(tn(tn(K)()({reflectSymbol:function(){return"rule"}})(en(qs(n)(t))))()({reflectSymbol:function(){return"rName"}})(e))()({reflectSymbol:function(){return"pName"}})(n))))()({reflectSymbol:function(){return"produced"}})(en(t)))))(i)(o))return a=!0,o;r=i}for(;!a;)o=i(r);return o}([])}}}},Rs=function(n){return function(e){return function(t){return Cn(qn)((function(n){return function(e){return{grammar:n,produced:e}}}))((r=zs(n)(e)(t),function(n){return r(n.augmented)}));var r}}},Os=Me()(Oi("TOP")),_s=Ol("␄"),Ls=Bs(Os)("TOP")(_s)(ws([{pName:"Additive",rName:"A:Add",rule:"Additive+Multiplicative"},{pName:"Additive",rName:"A<-M",rule:"Multiplicative"},{pName:"Multiplicative",rName:"M:Mul",rule:"Multiplicative*Unit"},{pName:"Multiplicative",rName:"M<-U",rule:"Unit"},{pName:"Unit",rName:"U:Val",rule:"Number"},{pName:"Unit",rName:"U<-A",rule:"(Additive)"},{pName:"Number",rName:"N<-D",rule:"Digit"},{pName:"Digit",rName:"0",rule:"0"},{pName:"Digit",rName:"1",rule:"1"},{pName:"Digit",rName:"2",rule:"2"}]))(Me()(Oi("Additive"))),js=function(n){return function(e){return function(t){return function(r){return lo(Wo(e))(xo(Ko(t))((function(e){return function(t){var r=new ve(e);return new Ze(r,nn(be(X))(Cn(Se)(x(he)(n)(t))(r))(new ve(!0))?fe.value:new ve(e))}}))(r)(fe.value))}}}},Ws=function(n){if(n instanceof jv)return new ve(new Fe(n.value0));if(n instanceof Uv)return new ve(new Fe(n.value0));if(n instanceof Wv)return 1===Pi(n.value0)?new ve(new ke(Ni(n.value0))):fe.value;throw new Error("Failed pattern match at Parser.Main (line 927, column 1 - line 927, column 60): "+[n.constructor.name])},Us=function(n){return function(e){return function(t){return function(r){return function(u){var o=oo(n)(yt)(Nt(Bt)((function(n){return function(e){return new Ze(e.sName,n)}}))(u)),a=function(e){return je(ye)(Ju(n)(e)(o))(Au(u))};return{promote:Gv.create,step:function(n){return function(e){return je(ye)(je(ye)(a(n))(function(n){return function(e){return Ju(r)(n)(e.advance)}}(e)))(Ws)}},goto:function(n){return function(u){return je(ye)(a(Fv(u)))((function(o){return je(ye)((i=n,function(n){return pt(yt)(xe)((function(n){return 0===n.rule.value1.length&&nn(e.Eq0())(n.pName)(i.value0)&&nn(t)(n.rName)(i.value1)?new ve(n.rule.value0):fe.value}))(n.items)})(o))(function(n){return function(t){return function(u){return je(ye)(Bu(Ae)((function(n){return function(t){if(t instanceof Vv)return n.value1 instanceof Av&&n.value1.value1 instanceof Gv&&nn(r.Eq0())(t.value0)(n.value1.value1.value0)?new ve(new Ze(bn(wn)([n.value1.value1])(n.value0),n.value1.value0)):ur("expected token on stack");if(t instanceof $v)return n.value1 instanceof Av&&n.value1.value1 instanceof Hv&&nn(e.Eq0())(n.value1.value1.value0.value0)(t.value0)?new ve(new Ze(bn(wn)([n.value1.value1])(n.value0),n.value1.value0)):ur("expected terminal on stack");throw new Error("Failed pattern match at Parser.Main (line 863, column 34 - line 871, column 62): "+[t.constructor.name])}}))(new Ze([],t))(u.slice().reverse()))((function(t){return x(he)(Av.create(t.value1)(new Hv(n,t.value0)))(function(n){return function(t){return je(ye)(a(t))((r=Ju(e)(n.value0),function(n){return r(n.receive)}));var r}}(n)(Fv(t.value1)))}))}}}(n)(u));var i}))}}}}}}}},$s=function(){var n=bt(yt)(D),e=x(P)((function(n){return n instanceof Vv?1:0}));return function(t){return n(e(t))}}(),Vs=function(){var n=bt(yt)(D),e=x(P)((function(n){return bs(n)?1:0}));return function(t){return n(e(t))}}(),Ys=function(n){return function(e){return function(t){return function(r){return function(u){var o,a=n,i=e,c=t,l=r,f=!1;function v(n,e,t,r,o){var v=function(n){return function(e){return function(t){return We(Le)(function(n){return function(e){return function(t){var r,u=function(n){return je(ye)(wu(n.value1))((function(n){if(n.head instanceof $v){var e=Ss(n.tail);return new ve({nonterminal:n.head.value0,following:e.following,continue:e.continue})}return fe.value}))}(t.rule);if(u instanceof fe)return[];if(u instanceof ve)return function(n){return function(e){return function(t){var r=ru((function(e){return nn(n)(e.pName)(t)}))(e);return function(n){return E(P)(r)((function(e){return{pName:e.pName,rName:e.rName,rule:new Yv([],e.rule),lookahead:n}}))}}}}(n)(e)(u.value0.nonterminal)(function(n){return function(e){return function(t){return function(r){var u=function(n){return function(e){return function(t){var r=wu(e);return r instanceof ve?o(n)(r.value0.head)(r.value0.tail)(t):t}}},o=function(e){return function(t){return function(r){return function(o){var a=uu((function(e){return nn(n)(e.pName)(t)}))(e);return je(Le)(a.yes)((function(n){return function(n){if(n.continue instanceof ve)return u(a.no)(n.following)([n.continue.value0]);if(n.continue instanceof fe)return u(a.no)(bn(wn)(n.following)(r))(o);throw new Error("Failed pattern match at Parser.Main (line 730, column 9 - line 732, column 65): "+[n.continue.constructor.name])}(Ss(n.rule))}))}}}};return u(e)(t)(r)}}}}(n)(e)(u.value0.following)((r=u.value0.continue,function(n){if(r instanceof ve)return[r.value0];if(r instanceof fe)return n;throw new Error("Failed pattern match at Parser.Main (line 678, column 33 - line 680, column 23): "+[r.constructor.name])})(t.lookahead)));throw new Error("Failed pattern match at Parser.Main (line 690, column 26 - line 694, column 68): "+[u.constructor.name])}}}(n)(e))(t)}}}(e)(r)(o);if(Su(v))return f=!0,o;var s=bn(function(n){return function(e){return function(t){return{append:function(r){return function(u){return Cs(n)(e)(t)(bn(wn)(r)(u))}}}}}}(e)(n)(t))(o)(v);if(nn(Ds(e)(n)(t))(s)(o))return f=!0,o;a=n,i=e,c=t,l=r,u=s}for(;!f;)o=v(a,i,c,l,u);return o}}}}},Ks=function(n){return function(e){return function(t){return function(r){return function(u){var o,a=n,i=e,c=t,l=r,f=!1;function v(n,e,t,r,o){var v=function(n){return function(e){return function(t){return function(r){return function(u){return yu(Ds(n.Eq0())(e)(t.Eq0()))(bn(wn)(u)(je(Le)(u)(function(n){return function(e){return function(t){return function(r){return function(u){return yu(Ds(n.Eq0())(e)(t.Eq0()))(x(P)((o=Ys(e)(n.Eq0())(t.Eq0())(r),a=Cs(n.Eq0())(e)(t.Eq0()),function(n){return o(a(Qe(n)))}))(function(n){return function(e){return function(t){var r=fs(n)(e)(t);return Pn(Bn)(x(P)(ut(ot)(Vv.create))(Hu(Ht)(r.terminal)))(x(P)(ut(ot)($v.create))(Hu(Ht)(r.nonTerminal)))}}}(n)(t)(u)));var o,a}}}}}(n)(e)(t)(r))))}}}}}(n)(e)(t)(r)(o);if(nn(en(Ds(n.Eq0())(e)(t.Eq0())))(v)(o))return f=!0,o;a=n,i=e,c=t,l=r,u=v}for(;!f;)o=v(a,i,c,l,u);return o}}}}},Gs=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){return x(Be)(Kv)($t.traverseWithIndex(De)((function(a){return function(i){var c,l=x(fl)(Wv.create)(function(n){return function(e){return gt(yt)(ll(n)(Ai))((function(e){return x(fl)(Fi)(function(n){return function(e){return 0===e.rule.value1.length?oo(n)(yt)(q(P)(x(P)(Ze.create)(e.lookahead))(new Ze(e.pName,e.rName))):uo}}(n)(e))}))(e)}}(t)(i)),f=fs(n)(t)(i),v=function(a){return Ne(a)(x(he)(r)(Pu(nn(Ds(n.Eq0())(e)(t.Eq0()))(Ys(e)(n.Eq0())(t.Eq0())(u)(Cs(n.Eq0())(e)(t.Eq0())(a))))(o)))};return Cn(Ie)(x(Be)((function(n){return function(e){return{sName:r(a),items:i,advance:bn(cl(t)(us))(n)(l),receive:e}}}))(_t(il)(De)((c=x(Be)(jv.create),function(n){return c(v(n))}))(f.terminal)))(_t(ro)(De)(v)(ft()(f.nonTerminal)))}}))(o))}}}}}},Hs=function(n){return function(e){return function(t){return function(r){return x(he)((function(n){return e.sized((function(t){return function(n){return function(e){return function(t){return je(n.Monad0().Bind1())(n.chooseInt(0)((r=e.Foldable0(),function(n){return Mt(r)((function(e){return function(t){return R(n)(n.one)(e)}}))(I(n))})(D)(t)-1|0))((function(r){return ae(n.Monad0().Applicative0())(function(n){return function(e){return function(t){return(r=e,function(e){var u,o=r,a=!1;function i(r,u){if(u instanceof yi&&u.value1 instanceof gi)return a=!0,u.value0;if(u instanceof yi&&r<=0)return a=!0,u.value0;if(u instanceof yi)return o=r-1|0,void(e=u.value1);if(u instanceof gi)return a=!0,ft()(n.foldMap1(Si)(bi)(t));throw new Error("Failed pattern match at Control.Monad.Gen (line 128, column 5 - line 128, column 26): "+[r.constructor.name,u.constructor.name])}for(;!a;)u=i(o,e);return u})(st(n.Foldable0())(yi.create)(gi.value)(t));var r}}}(e)(r)(t))}));var r}}}(e)(Ei)((r=t,function(n){var e=E(Ti)(n)((function(n){return new Ze(Vs(n.rule),n)})),t=ki(Bi(ru((function(n){return n.value0<=r})))(e));if(t instanceof fe)return x(Ti)(Qe)(Ni(qi(bn(Sn(Sn(sn)))(b(Gn(Yn))(tt))(b(Gn(Yn))((function(n){return eu(Qe(n).rule)}))))(e)));if(t instanceof ve)return x(Ti)(Qe)(t.value0);throw new Error("Failed pattern match at Parser.Main (line 140, column 5 - line 146, column 30): "+[t.constructor.name])})(n));var r}))}))(ki(function(n){return function(e){return function(t){return vo(fo)((function(e){return rn(n)(e.production.pName)(t)?fe.value:new ve({rule:e.production.rule,produced:e.produced})}))(e)}}}(n)(t)(r)))}}}},Js=function(n){return function(e){return function(t){return function(r){return E(he)(Hs(n)(e)(t)(r))((function(r){return je(e.Monad0().Bind1())(r)((function(r){return function(n){return function(e){return Mi(n)((function(n){return t=n-e|0,cn(an)(t)(2);var t}))}}(e)($s(r.rule))(Zs(n)(e)(t)(r))}))}))}}}},Zs=function(n){return function(e){return function(t){return function(r){return we(ae(e.Monad0().Applicative0())(r.produced))(function(n){return function(e){return function(t){return function(r){return x(he)((o=x(e.Monad0().Bind1().Apply0().Functor0())(Ve(Le)),a=Wt(jt)(e.Monad0().Applicative0()),function(n){return o(a(n))}))((u=ge,function(n){return function(e){return function(t){return _t(n)(u)(t)(e)}}})(jt)(r)((function(r){if(r instanceof Vv)return new ve(ae(e.Monad0().Applicative0())([r.value0]));if(r instanceof $v)return Js(n)(e)(t)(r.value0);throw new Error("Failed pattern match at Parser.Main (line 231, column 14 - line 233, column 41): "+[r.constructor.name])})));var u,o,a}}}}(n)(e)(t)(r.rule))}}}},Qs=function(){var n,e=de("")(Pl),t=(n=_i,function(e){return function(e){return function(e){return q(he)(x(he)(ic)(Js(n)(dc)(e.produced)(e.grammar.entry)))({size:15,newSeed:pi(12345678)})}}})(Y)(Dl);return function(n){return e(t(n))}}(),Xs=function(n){return function(e){return function(t){return function(r){return(u=e.Monad0().Applicative0(),function(n){return function(e){return function(t){return function(r){return Pn(Vo(u))($o(u)(r))(To(Ko(n))(e)(t)(r))}}}})(e)((function(e){return function(e){return Ye(n)(e)}}))(r)(t);var u}}}},nd=function(n){return function(e){return function(t){return function(r){return function(u){var o,a=(o=Ko(e),function(n){return vo(o.Filterable1())(w(M))(To(o)((function(n){return function(e){if(e instanceof fe)return new ve({now:n,last:fe.value});if(e instanceof ve)return new ve({now:n,last:new ve(e.value0.now)});throw new Error("Failed pattern match at FRP.Event.Class (line 56, column 3 - line 56, column 50): "+[n.constructor.name,e.constructor.name])}}))(n)(fe.value))})(r),i=Ao(Ko(e))(E(Co)(a)((function(t){return nn(be(n.Eq0()))(t.last)(new ve(t.now))?Re(Yo(e.Monad0().Applicative0())):Pn(Vo(e.Monad0().Applicative0()))(pt(St)(Yo(e.Monad0().Applicative0()))($o(e.Monad0().Applicative0()))(t.last))($o(e.Monad0().Applicative0())(t.now))})));return function(n){return function(e){return function(t){return function(r){return function(u){return je(e.Monad0().Bind1())(nu(e)(Tr(uo)))((function(o){return Oe($e)(e.Monad0().Bind1())(u(r((function(t){return function(r){return Oe($e)(e.Monad0().Bind1())(F(e.Monad0().Bind1().Apply0().Functor0())(nu(e)(Yr(ao(n)((function(n){if(n instanceof fe)return new ve([r]);if(n instanceof ve)return new ve(bn(wn)(n.value0)([r]));throw new Error("Failed pattern match at FRP.Event (line 243, column 44 - line 245, column 37): "+[n.constructor.name])}))(t))(o))))((function(){return ae(e.Monad0().Applicative0())(F(e.Monad0().Bind1().Apply0().Functor0())(nu(e)(Yr(ao(n)((function(n){if(n instanceof fe)return fe.value;if(n instanceof ve)return new ve(Du(ko)(r)(n.value0));throw new Error("Failed pattern match at FRP.Event (line 246, column 51 - line 248, column 53): "+[n.constructor.name])}))(t))(o))))}))}}))))((function(){return je(e.Monad0().Bind1())(Bo(t)((function(t){return je(e.Monad0().Bind1())(nu(e)(xr(o)))((function(r){var u=Ju(n)(t)(r);if(u instanceof fe)return ae(e.Monad0().Applicative0())(A);if(u instanceof ve)return ht(e.Monad0().Applicative0())(yt)(u.value0)((function(n){return n(A)}));throw new Error("Failed pattern match at FRP.Event (line 251, column 5 - line 253, column 38): "+[u.constructor.name])}))})))((function(n){return ae(e.Monad0().Applicative0())(Oe($e)(e.Monad0().Bind1())(F(e.Monad0().Bind1().Apply0().Functor0())(nu(e)(Er(uo)(o))))((function(){return n})))}))}))}))}}}}}(n)(e)(i)((function(n){return u((function(r){return Xs(He)(e)(t)(n(r))}))}))}}}}},ed=function(n){return function(e){return function(t){return function(r){return $o(n)(Ia(e)(t)(r))}}}},td=function(n){return function(e){return function(t){return function(r){return function(u){return nn(n)(u)(r)?ed(e)(t)(Ul.value)("first"):Re(Yo(e))}}}}},rd=function(n){return function(e){return function(t){return function(r){return function(u){return Df(u)([Lf(u)([La(u.MonadST5().Monad0())(n)]),If(u)(dt(yt)(Yo(u.MonadST5().Monad0().Applicative0()))([ps(Co)(Mf)(wf.value)(""===e?Re(Yo(u.MonadST5().Monad0().Applicative0())):$o(u.MonadST5().Monad0().Applicative0())(e)),ps(Co)(Tf)(Af.value)(""===t?Re(Yo(u.MonadST5().Monad0().Applicative0())):$o(u.MonadST5().Monad0().Applicative0())(t)),ed(u.MonadST5().Monad0().Applicative0())(sf)(vf.value)(Zv(r))]))([])])}}}}},ud=function(n){return function(e){return function(t){return function(r){return function(u){return Df(n)([Lf(n)([La(n.MonadST5().Monad0())(e)]),If(n)(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([ps(Co)(Mf)(wf.value)(""===t?Re(Yo(n.MonadST5().Monad0().Applicative0())):$o(n.MonadST5().Monad0().Applicative0())(t)),ps(Co)(Tf)(Af.value)(r),ed(n.MonadST5().Monad0().Applicative0())(sf)(vf.value)(Zv(u))]))([])])}}}}},od=function(n){return function(e){return function(t){return _f(t)(Pn(Vo(t.MonadST5().Monad0().Applicative0()))(ds(t.MonadST5().Monad0().Applicative0())(lf)(cf.value)(n))(ed(t.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("cmd"+(me(n)?" clickable":""))))([La(t.MonadST5().Monad0())(e)])}}},ad=function(n){return function(e){return function(t){return _f(t)(Pn(Vo(t.MonadST5().Monad0().Applicative0()))(ds(t.MonadST5().Monad0().Applicative0())(lf)(cf.value)(n))(ed(t.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("meta"+(me(n)?" clickable":""))))([La(t.MonadST5().Monad0())(e)])}}},id=function(n){return function(e){return function(t){return _f(t)(Pn(Vo(t.MonadST5().Monad0().Applicative0()))(ds(t.MonadST5().Monad0().Applicative0())(lf)(cf.value)(n))(ed(t.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("non-terminal"+(me(n)?" clickable":""))))([La(t.MonadST5().Monad0())(e)])}}},cd=function(n){return function(e){return function(t){return _f(t)(Pn(Vo(t.MonadST5().Monad0().Applicative0()))(ds(t.MonadST5().Monad0().Applicative0())(lf)(cf.value)(n))(ed(t.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("rule"+(me(n)?" clickable":""))))([La(t.MonadST5().Monad0())(e)])}}},ld=function(n){return function(e){return function(t){return _f(t)(Pn(Vo(t.MonadST5().Monad0().Applicative0()))(ds(t.MonadST5().Monad0().Applicative0())(lf)(cf.value)(n))(ed(t.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("state"+(me(n)?" clickable":""))))([La(t.MonadST5().Monad0())(oe(re)(e))])}}},fd=function(n){return function(e){return function(t){return _f(t)(Pn(Vo(t.MonadST5().Monad0().Applicative0()))(ds(t.MonadST5().Monad0().Applicative0())(lf)(cf.value)(n))(ed(t.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("terminal"+(me(n)?" clickable":""))))([La(t.MonadST5().Monad0())(ql(e))])}}},vd=function(n){return function(e){return function(t){return fa()(n)()(Mr({reflectSymbol:function(){return"amt"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"randomMany"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"size"}})(br(yr(n.Always2())))(hr)()())()())()())(Jo({reflectSymbol:function(){return"amt"}})()()(Jo({reflectSymbol:function(){return"randomMany"}})()()(Jo({reflectSymbol:function(){return"size"}})()()(Go)()()()())()()()())()()()())(T.value)((function(r){return function(u){var o,a=de([])(lc(pi(1234))(15))(Js(_i)(dc)(e.produced)(e.grammar.start.pName));return Bf(n)([Bf(n)([Cf(n)(ed(n.MonadST5().Monad0().Applicative0())(Ql)(Ul.value)("range"))([Lf(n)([La(n.MonadST5().Monad0())("Simple")]),If(n)(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([ed(n.MonadST5().Monad0().Applicative0())(Ef)(xf.value)("range"),ed(n.MonadST5().Monad0().Applicative0())(uf)(rf.value)("0"),ed(n.MonadST5().Monad0().Applicative0())(tf)(ef.value)("100"),nv(n.MonadST5().Monad0().Applicative0())($o(n.MonadST5().Monad0().Applicative0())((function(n){return r.size(ci(n))})))]))([]),Lf(n)([La(n.MonadST5().Monad0())("Complex")])]),Cf(n)(ed(n.MonadST5().Monad0().Applicative0())(Ql)(Ul.value)("range"))([Lf(n)([La(n.MonadST5().Monad0())("Few")]),If(n)(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([ed(n.MonadST5().Monad0().Applicative0())(Ef)(xf.value)("range"),ed(n.MonadST5().Monad0().Applicative0())(uf)(rf.value)("1"),ed(n.MonadST5().Monad0().Applicative0())(tf)(ef.value)("30"),ed(n.MonadST5().Monad0().Applicative0())(Tf)(Af.value)("15"),nv(n.MonadST5().Monad0().Applicative0())($o(n.MonadST5().Monad0().Applicative0())((function(n){return r.amt(ci(n))})))]))([]),Lf(n)([La(n.MonadST5().Monad0())("Many")])]),kf(n)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))(ed(n.MonadST5().Monad0().Applicative0())(nf)(Ul.value)(""))(ps(Co)(lf)(cf.value)(Eo(Ko(n.MonadST5()))(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(15))(u.amt))(E(Co)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(50))(u.size))((function(n){return function(t){return We(Pr)(mt(qr)(St)(r.randomMany))((u=e.grammar.start.pName,function(n){return function(t){return _t(Lt)(qr)((r=t,o=function(n){return function(){var e=mi();return lc(e)(r)(n)}},a=Mi(dc)(y(n)),function(n){return o(a(n))}))(Js(_i)(dc)(e.produced)(u));var r,o,a}})(n)(t));var u}}))))))([La(n.MonadST5().Monad0())("Random")])]),Qf(n)(ae(le)(xa(n.MonadST5())((o=x(P)((function(e){return zf(n)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))(ed(n.MonadST5().Monad0().Applicative0())(Zl)(Ul.value)("clickable"))(ed(n.MonadST5().Monad0().Applicative0())(lf)(cf.value)(t(e))))(x(P)((function(e){return fd(En(se(Rr(pn))))(e)(n)}))(e))})),function(n){return ia(o(n))}))(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(a))(u.randomMany))))])}}))}}},sd=function(n){return function(e){if(n instanceof Gv)return[_f(e)(ed(e.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("leaf node"))([fd(En(se(Rr(pn))))(n.value0)(e)])];if(n instanceof Hv)return[_f(e)(ed(e.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("node"))([cd(En(se(Rr(pn))))(n.value0.value1)(e)]),Of(e)(ed(e.MonadST5().Monad0().Applicative0())(Jl)(Ul.value)("layer"))(E(P)(n.value1)((function(n){return Rf(e)(sd(n)(e))})))];throw new Error("Failed pattern match at Parser.Main (line 1137, column 1 - line 1137, column 31): "+[n.constructor.name])}},dd=function(n){return function(e){return Of(e)(ed(e.MonadST5().Monad0().Applicative0())(Jl)(Ul.value)("AST CST"))([Rf(e)(sd(n)(e))])}},pd=function(n){return function(e){return function(t){return function(r){return function(n){return function(e){return function(t){return new ua(va(n)(e)(t))}}}(n)(n.Always2())((function(u){return function(o){var a,i=Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(fe.value))(o),c=(a=Ri,function(n){return function(e){var t=function(n){if(n instanceof $v)return new Ze([],[n.value0]);if(n instanceof Vv)return new Ze([n.value0],[]);throw new Error("Failed pattern match at Parser.Main (line 1011, column 3 - line 1011, column 43): "+[n.constructor.name])};return rt(ot)(xu(n))(xu(a))(gt(yt)(nt(Tn)(Tn))((function(n){return gt(yt)(nt(Tn)(Tn))((function(n){return bn(Xe(wn)(wn))(new Ze([],[n.pName]))((e=t,function(n){return bn(Xe(wn)(wn))(gt(yt)(nt(Tn)(Tn))(e)(n.value0))(gt(yt)(nt(Tn)(Tn))(e)(n.value1))})(n.rule));var e}))(n.items)}))(e))}})(zl)(r),l=function(e){return _f(n)(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([ed(n.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("state hoverable"),ed(n.MonadST5().Monad0().Applicative0())(pf)(df.value)(u(new ve(e))),ed(n.MonadST5().Monad0().Applicative0())(hf)(mf.value)(u(fe.value))]))([La(n.MonadST5().Monad0())(oe(re)(e))])},f=Zf(n)(Nt(Bt)((function(e){var t=Gf(n)(td(Z)(n.MonadST5().Monad0().Applicative0())(Vl)(eu(c.value0)+1|0)(e)),r=ae(le);return function(n){return t(r(n))}}))(bn(wn)([La(n.MonadST5().Monad0())("")])(bn(wn)(x(P)((function(e){return fd(En(se(Rr(pn))))(e)(n)}))(c.value0))(x(P)((function(e){return Nf(n)(ed(n.MonadST5().Monad0().Applicative0())(Xl)(Ul.value)("pileup"))(bn(wn)(x(P)((function(e){return cd(En(se(Rr(pn))))(e)(n)}))((r=e,vo(fo)((function(n){return nn(_i)(n.pName)(r)?new ve(n.rName):fe.value}))(t))))([id(En(se(Rr(pn))))(e)(n)]));var r}))(c.value1))))),v=E(P)(r)((function(t){return Jf(n)(ps(Co)($l)(Ul.value)((u=t.sName,Eo(Ko(n.MonadST5()))(x(Co)((function(n){return n?" active ":""}))(e.getCurrentState(u)))(E(Co)(i)((function(n){return bn(mn)(nn(be(Z))(n)(new ve(u))?" hover ":"")}))))))((r=function(n){return Gf(n)(Re(Yo(n.MonadST5().Monad0().Applicative0())))}(n)([l(t.sName)]),function(n){return bn(wn)([r])(n)})(Nt(Bt)((function(e){return Yf(n)(td(Z)(n.MonadST5().Monad0().Applicative0())(Yl)(eu(c.value0))(e))}))(function(e){var t;return bn(wn)(x(P)((t=ae(le),function(r){return t(function(e){if(e instanceof fe)return ia([]);if(e instanceof ve&&e.value0 instanceof jv)return Lf(n)([od(En(se(Rr(pn))))("s")(n),l(e.value0.value0)]);if(e instanceof ve&&e.value0 instanceof Wv)return _f(n)(Pi(e.value0.value0)>1?ed(n.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("conflict"):Re(Yo(n.MonadST5().Monad0().Applicative0())))(gt(xi)(Tn)((function(e){return[od(En(se(Rr(pn))))("r")(n),cd(En(se(Rr(pn))))(e)(n)]}))(e.value0.value0));if(e instanceof ve&&e.value0 instanceof Uv)return _f(n)(ed(n.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("conflict"))(bn(wn)([od(En(se(Rr(pn))))("s")(n),l(e.value0.value0)])(gt(xi)(Tn)((function(e){return[od(En(se(Rr(pn))))("r")(n),cd(En(se(Rr(pn))))(e)(n)]}))(e.value0.value1)));throw new Error("Failed pattern match at Parser.Main (line 1046, column 7 - line 1046, column 43): "+[e.constructor.name])}((u=r,x(he)(x(Es)(Qe))(Ju(zl)(u)(ft()(e.advance))))));var u}))(c.value0))(x(P)((function(t){return function(e){if(e instanceof fe)return[];if(e instanceof ve)return[od(En(se(Rr(pn))))("g")(n),l(e.value0)];throw new Error("Failed pattern match at Parser.Main (line 1054, column 7 - line 1054, column 30): "+[e.constructor.name])}((r=t,Ju(Ri)(r)(e.receive)));var r}))(c.value1))}(t))));var r,u}));return Wf(n)(ed(n.MonadST5().Monad0().Applicative0())(Gl)(Ul.value)("parse-table"))([Hf(n)([f]),Vf(n)(v)])}}))}}}},md=function(n){return function(e){return function(t){if(e instanceof $v)return id(n)(e.value0)(t);if(e instanceof Vv)return fd(n)(e.value0)(t);throw new Error("Failed pattern match at Parser.Main (line 1539, column 1 - line 1539, column 74): "+[n.constructor.name,e.constructor.name])}}},hd=function(n){return function(e){return function(t){return fa()(n)()(Mr({reflectSymbol:function(){return"focus"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"select"}})(br(yr(n.Always2())))(hr)()())()())(Jo({reflectSymbol:function(){return"focus"}})()()(Jo({reflectSymbol:function(){return"select"}})()()(Go)()()()())()()()())(T.value)((function(r){return function(u){return ca(vs(n.MonadST5().Monad0().Applicative0())(n.MonadST5())(u.select)([new $v(e.grammar.start.pName)])((function(o){var a,i=(a=Ct(It)(Tn)((function(n){return function(e){return de([])((function(e){return[new Ze(n,e)]}))(ts(e))}})),function(n){return Tu(a(n))});return ca(vs(n.MonadST5().Monad0().Applicative0())(n.MonadST5())(Pn(Vo(n.MonadST5().Monad0().Applicative0()))(u.focus)(x(Co)(i)(o)))(new ve(new Ze(0,e.grammar.start.pName)))((function(u){var a,i,c=E(Co)(o)((function(n){var e=_t(jt)(ge)(Qv)(n);if(e instanceof fe)return fe.value;if(e instanceof ve)return new ve(t(e.value0));throw new Error("Failed pattern match at Parser.Main (line 1868, column 13 - line 1870, column 46): "+[e.constructor.name])}));return Bf(n)([Lf(n)([xa(n.MonadST5())((i=Nt(Bt)((function(e){return function(t){if(t instanceof $v)return _f(n)(ps(Co)(Hl)(Ul.value)(E(Co)(u)((a=At(St)(He)((o=nn(Z)(e),function(n){return o(tt(n))})),function(n){return a(n)?"selected":""}))))([id(new ve(r.focus(new ve(new Ze(e,t.value0)))))(t.value0)(n)]);var o,a;if(t instanceof Vv)return fd(En(se(Rr(pn))))(t.value0)(n);throw new Error("Failed pattern match at Parser.Main (line 1862, column 11 - line 1865, column 67): "+[e.constructor.name,t.constructor.name])}})),function(n){return ia(i(n))}))(o)]),kf(n)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))(x(Co)(ps(B)(nf)(Ul.value)(de("disabled")(En((a=gn,{mempty:function(n){return En(a)},Semigroup0:function(){return Sn(a.Semigroup0())}})))))(c))(x(Co)(ps(B)(lf)(cf.value)(wt(qr)(St)))(c)))([La(n.MonadST5().Monad0())("Send")]),kf(n)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))(ed(n.MonadST5().Monad0().Applicative0())(nf)(Ul.value)("delete"))(ed(n.MonadST5().Monad0().Applicative0())(lf)(cf.value)(r.select([new $v(e.grammar.start.pName)]))))([La(n.MonadST5().Monad0())("Reset")]),Wf(n)(ed(n.MonadST5().Monad0().Applicative0())(Gl)(Ul.value)("explorer-table"))([Vf(n)(E(P)(e.grammar.augmented)((function(t){var a,i,c,l,f=go(Ko(n.MonadST5()))(o)(E(Co)(u)((function(n){return function(e){return je(ye)(n)((function(n){return Oe($e)(ye)(ar(Ee)(nn(_i)(n.value1)(t.pName)))((function(){return Oe($e)(ye)(ar(Ee)(n.value0<=eu(e)))((function(){return ae(ge)(bn(wn)((r=n.value0,function(n){return r<1?[]:au(0)(r)(n)})(e))(bn(wn)(t.rule)(Iu(n.value0+1|0)(e))));var r}))}))}))}}))),v=x(Co)(At(St)(He)((a=nn(_i)(t.pName),function(n){return a(Qe(n))})))(u);return Jf(n)(ps(Co)($l)(Ul.value)((l=v,E(Co)(l)((function(n){return n?"active":"inactive"})))))(x(P)((i=Kf(n),c=ae(le),function(n){return i(c(n))}))([id(En(se(Rr(pn))))(t.pName)(n),ad(En(se(Rr(pn))))(" : ")(n),ia(x(P)((function(e){return md(En(se(Rr(pn))))(e)(n)}))(t.rule)),Lf(n)([ad(En(se(Rr(pn))))(" #")(n),cd(En(se(Rr(pn))))(t.rName)(n)]),Lf(n)([La(n.MonadST5().Monad0())(" "),kf(n)(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([x(Co)(x(B)(ps(B)(nf)(Ul.value)(bn(mn)("select")))((function(n){return n?En(gn):" disabled"})))(v),x(Co)(ps(B)(lf)(cf.value)(mt(qr)(St)(r.select)))(f)]))([La(n.MonadST5().Monad0())("Select")])]),function(){var r,u=qu((r=nn(H()(tn(tn(tn(K)()({reflectSymbol:function(){return"rule"}})(en(qs(_i)(Dl))))()({reflectSymbol:function(){return"rName"}})(Y))()({reflectSymbol:function(){return"pName"}})(_i)))(t),function(n){return r(n.production)}))(e.produced);if(u instanceof fe)return La(n.MonadST5().Monad0())("Unproduceable");if(u instanceof ve)return Lf(n)([Pf(n)([La(n.MonadST5().Monad0())("e.g. ")]),ia(x(P)((function(e){return fd(En(se(Rr(pn))))(e)(n)}))(u.value0.produced))]);throw new Error("Failed pattern match at Parser.Main (line 1912, column 23 - line 1918, column 30): "+[u.constructor.name])}()]))})))])])})))})))}}))}}},wd=function(n){return function(e){return function(t){return function(r){return function(u){return S(xa(n.MonadST5()))(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(t))(Do(n.Always2())(n.Always3())(n.MonadST5().Monad0().Applicative0())(r)))((function(t){return fa()(n)()(Mr({reflectSymbol:function(){return"entry"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"eof"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"pName"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"rName"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"rule"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"top"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"topName"}})(br(yr(n.Always2())))(hr)()())()())()())()())()())()())()())(Jo({reflectSymbol:function(){return"entry"}})()()(Jo({reflectSymbol:function(){return"eof"}})()()(Jo({reflectSymbol:function(){return"pName"}})()()(Jo({reflectSymbol:function(){return"rName"}})()()(Jo({reflectSymbol:function(){return"rule"}})()()(Jo({reflectSymbol:function(){return"top"}})()()(Jo({reflectSymbol:function(){return"topName"}})()()(Go)()()()())()()()())()()()())()()()())()()()())()()()())()()()())(T.value)((function(r){return function(o){return fa()(n)()(Mr({reflectSymbol:function(){return"addRule"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"errorMessage"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"removeRule"}})(br(yr(n.Always2())))(hr)()())()())()())(Jo({reflectSymbol:function(){return"addRule"}})()()(Jo({reflectSymbol:function(){return"errorMessage"}})()()(Jo({reflectSymbol:function(){return"removeRule"}})()()(Go)()()()())()()()())()()()())(T.value)((function(a){return function(i){var c,l=Pn(Vo(n.MonadST5().Monad0().Applicative0()))(x(Co)(Fe.create)(i.addRule))(x(Co)(ke.create)(i.removeRule)),f=(c=Tu(ft()(t.augmented)))instanceof ve&&2===c.value0.rule.length&&c.value0.rule[0]instanceof $v&&c.value0.rule[1]instanceof Vv?{top:c.value0.pName,entry:c.value0.rule[0].value0,eof:ql(c.value0.rule[1].value0),topName:c.value0.rName}:{top:Os,entry:"",eof:ql(_s),topName:"TOP"},v=Nt(Bt)((function(n){return function(e){return new Ze(n,{rule:gt(yt)(gn)(ns)(e.rule),pName:e.pName,rName:e.rName})}}))(Iu(1)(ft()(t.augmented))),s=Eo(Ko(n.MonadST5()))(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(f.top))(o.top))(Eo(Ko(n.MonadST5()))(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(f.entry))(o.entry))(Eo(Ko(n.MonadST5()))(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(f.eof))(o.eof))(Eo(Ko(n.MonadST5()))(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(f.topName))(o.topName))($o(n.MonadST5().Monad0().Applicative0())((function(n){return function(e){return function(t){return function(r){return{topName:n,eof:e,entry:t,top:r}}}}})))))),d=Eo(Ko(n.MonadST5()))(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(""))(o.pName))(Eo(Ko(n.MonadST5()))(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(""))(o.rule))(E(Co)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(""))(o.rName))((function(n){return function(e){return function(t){return{rName:n,rule:e,pName:t}}}})))),p=x(Co)(R(D)(eu(v)))(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(0))(x(Co)(x(B)(R(D)(1))(tt))(i.addRule)));return ca(ss(n.MonadST5().Monad0().Applicative0())(n.MonadST5())((function(n){return function(e){if(n instanceof Fe)return(t=e,function(n){return(e=fu(n),function(n){return function(){var t=lu(n)();return e(t)(),cu(t)()}})(t)();var e})(n.value0);var t,r;if(n instanceof ke)return ru((r=Ye(Je(Je(He)))(nn(Z))(n.value0),function(n){return r(tt(n))}))(e);throw new Error("Failed pattern match at Parser.Main (line 1655, column 17 - line 1657, column 77): "+[n.constructor.name])}}))(l)(v)((function(t){var c,l,m,h,w,M,b=Eo(Ko(n.MonadST5()))(t)(E(Co)(s)((function(n){return function(e){return{top:we(Os)(Oi(n.top)),entry:Pn(Te)(Oi(n.entry))(E(he)(Tu(e))((function(n){return function(n){return n.pName}(Qe(n))}))),eof:we(_s)(cs(Fl(n.eof))),topName:n.topName}}}))),S=(M=en(_i),function(n){return function(e){return js(nn(M))(n)(e)}})(n.MonadST5().Monad0().Applicative0())(n.MonadST5())(x(Co)(ms)(Eo(Ko(n.MonadST5()))(x(Co)(x(P)((function(n){return function(n){return n.pName}(Qe(n))})))(t))(x(Co)((c=bn(wn),l=ae(le),m=we(Os),function(n){return c(l(m(Oi(n))))}))(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(f.top))(o.top))))),y=Eo(Ko(n.MonadST5()))(x(Co)(x(P)(Qe))(t))(E(Co)(b)(Ps));return Bf(n)([Bf(n)([xa(n.MonadST5())((function(e){if(e instanceof fe)return ca(Re(Yo(n.MonadST5().Monad0().Applicative0())));if(e instanceof ve)return Nf(n)(ed(n.MonadST5().Monad0().Applicative0())(Xl)(Ul.value)("Error"))([La(n.MonadST5().Monad0())(e.value0)]);throw new Error("Failed pattern match at Parser.Main (line 1706, column 64 - line 1708, column 72): "+[e.constructor.name])}))(i.errorMessage)]),Bf(n)([_f(n)(ed(n.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("non-terminal"))([Ve(_e)(rd("Top name"))(f.top)(r.top)(n)]),_f(n)(ed(n.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("non-terminal"))([rd("Entrypoint")("")(f.entry)(r.entry)(n)]),_f(n)(ed(n.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("terminal"))([Ve(_e)(rd("Final token"))(f.eof)(r.eof)(n)]),_f(n)(ed(n.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("rule"))([Ve(_e)(rd("Top rule name"))(f.topName)(r.topName)(n)])]),Uf(n)([Zf(n)([Kf(n)([xa(n.MonadST5())((function(e){return id(En(se(Rr(pn))))(e)(n)}))(E(Co)(b)((function(n){return n.top})))]),Kf(n)([ad(En(se(Rr(pn))))(" : ")(n)]),Kf(n)([Lf(n)([xa(n.MonadST5())(de(La(n.MonadST5().Monad0())("—"))((function(e){return id(En(se(Rr(pn))))(e)(n)})))(E(Co)(b)((function(n){return n.entry})))]),Lf(n)([xa(n.MonadST5())((function(e){return fd(En(se(Rr(pn))))(e)(n)}))(E(Co)(b)((function(n){return n.eof})))])]),Kf(n)([ad(En(se(Rr(pn))))(" #")(n),Lf(n)([xa(n.MonadST5())((function(e){return cd(En(se(Rr(pn))))(e)(n)}))(E(Co)(b)((function(n){return n.topName})))])])]),Vf(n)(ae(le)((w=x(Co)((function(e){return Ao(Ko(n.MonadST5()))(va(n)(n.Always2())((function(t){return function(r){return Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(new Xo(Zf(n)(x(P)((u=Kf(n),o=ae(le),function(n){return u(o(n))}))([id(En(se(Rr(pn))))(e.value1.pName)(n),ad(En(se(Rr(pn))))(" : ")(n),Lf(n)([xa(n.MonadST5())((function(t){return ia(x(P)((function(e){return md(En(se(Rr(pn))))(e)(n)}))(is(t)(e.value1.rule)))}))(S)]),Lf(n)([ad(En(se(Rr(pn))))(" #")(n),cd(En(se(Rr(pn))))(e.value1.rName)(n)]),Lf(n)([La(n.MonadST5().Monad0())(" "),kf(n)(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([ed(n.MonadST5().Monad0().Applicative0())(nf)(Ul.value)("delete"),ed(n.MonadST5().Monad0().Applicative0())(lf)(cf.value)(Dn(zr)(t(na.value))(a.removeRule(e.value0)))]))([La(n.MonadST5().Monad0())("Delete")])])])))))(r);var u,o}})))}))(Pn(Vo(n.MonadST5().Monad0().Applicative0()))(pt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0()))(v))(i.addRule)),new ta(w))))]),Bf(n)([_f(n)(ed(n.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("non-terminal"))([rd("Nonterminal name")("")("")(r.pName)(n)]),ad(En(se(Rr(pn))))(" : ")(n),_f(n)(ed(n.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("terminal"))([rd("Value")("")("")(r.rule)(n)]),ad(En(se(Rr(pn))))(" #")(n),_f(n)(ed(n.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("rule"))([rd("Rule name")("")("")(r.rName)(n)]),kf(n)(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([ed(n.MonadST5().Monad0().Applicative0())(nf)(Ul.value)("big"),ps(Co)(lf)(cf.value)(pv(Wi)(n)(d)(pv(Zc(Wi))(n)(p)(x(Co)(mv(hv(hv((h=Yc,{readersT:Kc(h)})))))($o(n.MonadST5().Monad0().Applicative0())((function(n){return function(e){return function(){a.errorMessage(fe.value)();var t=Oi(e.pName);if(t instanceof fe)return a.errorMessage(new ve("Need name for the non-terminal."))();if(t instanceof ve)return a.addRule(new Ze(n,function(){var n={};for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n.pName=t.value0,n}()))();throw new Error("Failed pattern match at Parser.Main (line 1777, column 37 - line 1779, column 100): "+[t.constructor.name])}}}))))))]))([La(n.MonadST5().Monad0())("Add rule")])]),""===e?ia([]):Bf(n)(ae(le)(kf(n)(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([ed(n.MonadST5().Monad0().Applicative0())(nf)(Ul.value)("big"),E(Co)(y)((function(n){return Ia(lf)(cf.value)((function(){if(a.errorMessage(fe.value)(),n instanceof Fe)return a.errorMessage(new ve(n.value0))();if(n instanceof ke)return u(n.value0)();throw new Error("Failed pattern match at Parser.Main (line 1791, column 29 - line 1793, column 57): "+[n.constructor.name])}))}))]))([La(n.MonadST5().Monad0())(e)])))])})))}}))}}))}))}}}}},Md=function(n){return function(e){return _f(e)(ed(e.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("zipper"+(Su(n.value1)?" reducible":"")))([_f(e)(ed(e.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("parsed"))(E(P)(n.value0)((function(n){return md(En(se(Rr(pn))))(n)(e)}))),Su(n.value1)?ia(Re(ze)):_f(e)(Re(Yo(e.MonadST5().Monad0().Applicative0())))(E(P)(n.value1)((function(n){return md(En(se(Rr(pn))))(n)(e)})))])}},bd=function(n){return function(e){return function(t){return function(r){return[0===e?ld(En(se(Rr(pn))))(n.sName)(r):La(r.MonadST5().Monad0())(""),id(En(se(Rr(pn))))(t.pName)(r),ad(En(se(Rr(pn))))(": ")(r),Md(t.rule)(r),(u=Su(t.rule.value1)?" reducible":"",function(n){return function(e){return _f(e)(ed(e.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("lookahead"+u))(bn(wn)([ad(En(se(Rr(pn))))("{ ")(e)])(bn(wn)((t=yt,function(n){return function(e){return function(r){return Mt(t)((function(t){return function(r){return t.init?{init:!1,acc:r}:{init:!1,acc:bn(n.Semigroup0())(t.acc)(bn(n.Semigroup0())(e)(r))}}}))({init:!0,acc:En(n)})(r).acc}}})(Tn)([ad(En(se(Rr(pn))))(", ")(e)])(E(P)(n)((function(n){return[fd(En(se(Rr(pn))))(n)(e)]}))))([ad(En(se(Rr(pn))))(" }")(e)])));var t}})(t.lookahead)(r),ia([ad(En(se(Rr(pn))))(" #")(r),cd(En(se(Rr(pn))))(t.rName)(r)]),function(){var e,u=(e=Ri,function(n){return function(t){return Ue(ye)(rs)((function(r){if(r instanceof $v)return Ju(e)(r.value0)(t.receive);if(r instanceof Vv)return je(ye)(Ju(n)(r.value0)(ft()(t.advance)))(Xv);throw new Error("Failed pattern match at Parser.Main (line 618, column 50 - line 620, column 62): "+[r.constructor.name])}))}})(zl)(n)(t.rule);if(u instanceof fe)return ia([]);if(u instanceof ve)return ia([ad(En(se(Rr(pn))))(" —> ")(r),ld(En(se(Rr(pn))))(u.value0)(r)]);throw new Error("Failed pattern match at Parser.Main (line 1286, column 5 - line 1288, column 72): "+[u.constructor.name])}()];var u}}}},Sd=function(n){return function(e){return function(t){return Wf(n)(ed(n.MonadST5().Monad0().Applicative0())(Gl)(Ul.value)("state-table"))(E(P)(t)((function(t){return $f(n)(ps(Co)(Kl)(Ul.value)((a=t.sName,x(Co)((function(n){return n?"active":""}))(e.getCurrentState(a)))))((r=(o=t,function(n){return function(e){return Nt(Bt)((function(n){return function(t){return bd(o)(n)(t)(e)}}))(n)}})(t.items)(n),u=eu(r),Nt(Bt)((function(e){var t=Zf(n),r=Nt(Bt)((function(t){var r,o=(r=u,function(e){return function(t){return 0===e&&0===t?Gf(n)(ed(n.MonadST5().Monad0().Applicative0())(Sf)(bf.value)(oe(re)(r))):0===t?y(ia([])):Kf(n)}})(e)(t),a=ae(le);return function(n){return o(a(n))}}));return function(n){return t(r(n))}}))(r)));var r,u,o,a})))}}},yd=function(n){return function(e){var t,r,u=(t=function(e){return function(n){return function(e){if(e.value1 instanceof Fe)return E($i(Wc))(Ts(n.MonadST5())(Hl))(x(B)((function(t){return _f(n)(t.value1)([od(En(se(Rr(pn))))("s")(n),ld(En(se(Rr(pn))))(e.value0)(n)])})));if(e.value1 instanceof ke)return E($i(Wc))(Ts(n.MonadST5())(Hl))(x(B)((function(t){return _f(n)(t.value1)([od(En(se(Rr(pn))))("r")(n),cd(En(se(Rr(pn))))(e.value1.value0.value1)(n),ad(En(se(Rr(pn))))(" —> ")(n),od(En(se(Rr(pn))))("g")(n),ld(En(se(Rr(pn))))(e.value0)(n)])})));throw new Error("Failed pattern match at Parser.Main (line 1222, column 1 - line 1226, column 43): "+[e.constructor.name])}}(n)(e)},r=function(e){return function(n){return function(e){if(e instanceof Fe&&e.value0 instanceof fe)return E($i(Wc))(As(n.MonadST5())(Xl))(x(B)((function(e){return Nf(n)(e.value1)([La(n.MonadST5().Monad0())("Step "+oe(re)(e.value0)+": Parse error")])})));if(e instanceof Fe&&e.value0 instanceof ve)return E($i(Wc))(As(n.MonadST5())(Xl))(x(B)((function(t){var r=function(n){return n instanceof Av&&n.value0 instanceof Av&&n.value0.value0 instanceof gv&&n.value0.value1 instanceof Hv&&n.value1 instanceof Gv?new ve(n.value0.value1):fe.value}(e.value0.value0);return r instanceof ve&&x(Be)(x(Fs)(Qe))(os(r.value0))instanceof ke?Nf(n)(t.value1)([La(n.MonadST5().Monad0())("Step the last: "),dd(r.value0)(n)]):Nf(n)(t.value1)([La(n.MonadST5().Monad0())("Step the last: Something went wrong")])})));if(e instanceof ke)return E($i(Wc))(gs(n.MonadST5())(Xl)("flex justify-between"))(x(B)((function(t){return Nf(n)(t.value1)([Bf(n)([La(n.MonadST5().Monad0())("Step "+oe(re)(t.value0)+": "),(r=e.value0.stack,function(n){var e=function(t){if(t instanceof gv)return[jf(n)([ld(En(se(Rr(pn))))(t.value0)(n)])];if(t instanceof Av)return bn(wn)(e(t.value0))(bn(wn)([dd(t.value1)(n)])([jf(n)([ld(En(se(Rr(pn))))(t.value2)(n)])]));throw new Error("Failed pattern match at Parser.Main (line 1096, column 3 - line 1096, column 57): "+[t.constructor.name])};return _f(n)(ed(n.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("full stack"))(e(r))})(n)]),Bf(n)(gt(Xt)(Tn)((function(e){return[fd(En(se(Rr(pn))))(e)(n)]}))(e.value0.inputs))]);var r})));throw new Error("Failed pattern match at Parser.Main (line 1199, column 1 - line 1207, column 43): "+[e.constructor.name])}}(n)(e)},function(n){if(n instanceof Tv)return Cn(Ki(jc))(x($i(Wc))(zn(qn)((function(n){return function(e){return[n,e]}})))(r(new ke(n.value0))))(r(new Fe(fe.value)));if(n instanceof xv)return Cn(Ki(jc))(x($i(Wc))(zn(qn)((function(n){return function(e){return[n,e]}})))(r(new ke(n.value0))))(r(new Fe(new ve(n.value1))));if(n instanceof Ev)return Cn(Ki(jc))(Cn(Ki(jc))(x($i(Wc))((e=qn,function(n){return function(t){return function(r){return function(u){return Cn(e)(Cn(e)(x(e.Functor0())(n)(t))(r))(u)}}}})((function(n){return function(e){return function(t){return bn(wn)([n,e])(t)}}})))(r(new ke(n.value0))))(t(new Ze(function(n){if(n instanceof Tv)return Fv(n.value0.stack);if(n instanceof xv)return Fv(n.value0.stack);if(n instanceof Ev)return Fv(n.value0.stack);throw new Error("Failed pattern match at Parser.Main (line 1837, column 1 - line 1837, column 34): "+[n.constructor.name])}(n.value2),n.value1))))(u(n.value2));var e;throw new Error("Failed pattern match at Parser.Main (line 1248, column 7 - line 1254, column 107): "+[n.constructor.name])});return x($i(Wc))(x(B)(ia))(u(e))}},gd=function(n){return function(e){return function(t){return function(r){return fa()(n)()(Mr({reflectSymbol:function(){return"changeText"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"errorMessage"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"focusMode"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"grammar"}})(br(yr(n.Always2())))(hr)()())()())()())()())(Jo({reflectSymbol:function(){return"changeText"}})()()(Jo({reflectSymbol:function(){return"errorMessage"}})()()(Jo({reflectSymbol:function(){return"focusMode"}})()()(Jo({reflectSymbol:function(){return"grammar"}})()()(Go)()()()())()()()())()()()())()()()())(T.value)((function(u){return function(o){return ca(ss(n.MonadST5().Monad0().Applicative0())(n.MonadST5())(y)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))(Do(n.Always2())(n.Always3())(n.MonadST5().Monad0().Applicative0())(t))(o.grammar))(e)((function(a){var i,c,l,f,v=function(e){return function(t){return Nf(n)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))(ed(n.MonadST5().Monad0().Applicative0())(Xl)(Ul.value)("widget"))(ed(n.MonadST5().Monad0().Applicative0())(gf)(yf.value)("order: "+oe(re)(e))))([Bf(n)([kf(n)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))(ed(n.MonadST5().Monad0().Applicative0())(lf)(cf.value)(u.focusMode(A)))(ed(n.MonadST5().Monad0().Applicative0())(nf)(Ul.value)("big")))([La(n.MonadST5().Monad0())("Toggle dashboard mode")]),Ff(n)([]),Ff(n)([]),t])])}},s=function(n){return u.changeText(new Ze(!0,Pl(n)))},d=Qs(Rs(_i)(Y)(Dl)(e)),p=Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(d))(vo(Uo(n.MonadST5().Monad0().Applicative0()))((function(n){return n.value0?new ve(n.value1):fe.value}))(o.changeText)),m=Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(d))(x(Co)(Qe)(o.changeText)),h=x(Co)(Pe(y([]))(w(M)))(E(Co)(a)((function(n){return Gs(Ri)(Y)(zl)(R(D)(1))(n.augmented)(function(n){return function(e){return function(t){return function(r){return function(u){return Ks(n)(e)(t)(r)([Ys(e)(n.Eq0())(t.Eq0())(r)(Cs(n.Eq0())(e)(t.Eq0())([u]))])}}}}}(Ri)(Y)(zl)(n.augmented)(n.start))}))),g=x(Co)(Us(Yn)(Ri)(Y)(zl))(h),B=x(Co)(Rs(_i)(Y)(Dl))(a),I=x(Co)((i=zl,c=function(n){return xu(i)(Nu(Tn)((function(n){return Ru(Qv)(n.rule)}))(n))},function(n){return c(n.augmented)}))(a),C=x(Co)((l=function(n){return function(e){return xu(n)(Nu(Tn)((function(n){return Ru(ts)(n.rule)}))(e))}}(Ri),function(n){return l(n.augmented)}))(a),z=x(Co)(ks)(a),O=Eo(Ko(n.MonadST5()))(m)(z),_=go(Ko(n.MonadST5()))(g)(E(Co)(O)((function(n){return function(e){return q(he)(x(he)(kv(e))(n))(1)}}))),L=x(Co)(de(0)(Ms))(_),j=x(Co)(Ns)(a),W=Eo(Ko(n.MonadST5()))(m)(j),U=go(Ko(n.MonadST5()))(g)(E(Co)(W)((function(n){return function(e){return q(he)(x(he)(kv(e))(n))(1)}})));return ca((f=n.MonadST5().Monad0().Applicative0(),function(n){return function(e){return function(t){return function(r){return jo(n)(e)((function(n){return r(Pn(Vo(f))($o(f)(t))(n))}))}}}})(n.MonadST5())(L)(0)((function(i){return ca(jo(n.MonadST5())(h)((function(c){var l=Ao(Ko(n.MonadST5()))(k(Co)(c)(nd(Yn)(n.MonadST5())(!1)(i)(w(M))));return ca(jo(n.MonadST5())(go(Ko(n.MonadST5()))(l)(x(Co)(Ze.create)(c)))((function(l){var f=go(Ko(n.MonadST5()))(c)(E(Co)(i)((function(n){return function(e){return qu((t=nn(Z)(n),function(n){return t(n.sName)}))(e);var t}}))),d=E(Co)(f)((function(n){if(n instanceof fe)return uo;if(n instanceof ve)return n.value0.receive;throw new Error("Failed pattern match at Parser.Main (line 2135, column 38 - line 2137, column 47): "+[n.constructor.name])})),h=function(e){var t=E(Co)(d)(Zu(Ri)(e)),r=pv(Wi)(n)(B)(pv(Zc(Wi))(n)(m)($o(n.MonadST5().Monad0().Applicative0())((function(n){return function(t){return function(){var r=x(Dr)(de("")(Pl))(Wt(Lt)(qr)(x(he)(cc)(Js(_i)(dc)(t.produced)(e))))();return u.changeText(new Ze(!0,n+r))()}}}))));return function(n){return function(e){return function(t){return function(r){return _f(n)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))(ps(Co)(lf)(cf.value)(vo(Uo(n.MonadST5().Monad0().Applicative0()))(w(M))(t)))(ps(Co)(Hl)(Ul.value)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())("non-terminal"))(x(Co)(bn(mn)("non-terminal "))(e)))))([La(n.MonadST5().Monad0())(r)])}}}}(n)(x(Co)(bn(mn)("clickable"))(E(Co)(t)((function(n){return n?"":" unusable"}))))(x(Co)(ve.create)(r))(e)},g=E(Co)(f)((function(n){if(n instanceof fe)return uo;if(n instanceof ve)return n.value0.advance;throw new Error("Failed pattern match at Parser.Main (line 2131, column 38 - line 2133, column 60): "+[n.constructor.name])})),k=function(e){var t=function(){if(e instanceof ve)return E(Co)(g)(Zu(zl)(e.value0));if(e instanceof fe)return E(Co)(m)(Ye(Je(He))(zi));throw new Error("Failed pattern match at Parser.Main (line 2145, column 27 - line 2147, column 64): "+[e.constructor.name])}(),r=function(){if(e instanceof fe)return Ol("⌫");if(e instanceof ve)return e.value0;throw new Error("Failed pattern match at Parser.Main (line 2148, column 29 - line 2150, column 36): "+[e.constructor.name])}(),o=pv(Wi)(n)(m)($o(n.MonadST5().Monad0().Applicative0())((function(n){return u.changeText(new Ze(!0,function(){if(e instanceof ve)return n+ql(e.value0);if(e instanceof fe)return Cl(kl(n)-1|0)(n);throw new Error("Failed pattern match at Parser.Main (line 2142, column 47 - line 2144, column 69): "+[e.constructor.name])}()))})));return function(n){return function(e){return function(t){return function(r){return _f(n)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))(ps(Co)(lf)(cf.value)(vo(Uo(n.MonadST5().Monad0().Applicative0()))(w(M))(t)))(ps(Co)(Hl)(Ul.value)(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())("terminal"))(x(Co)(bn(mn)("terminal "))(e)))))([La(n.MonadST5().Monad0())(ql(r))])}}}}(n)(x(Co)(bn(mn)("clickable"))(E(Co)(t)((function(n){return n?"":" unusable"}))))(x(Co)(ve.create)(o))(r)};return Nf(n)(ps(Co)(Xl)(Ul.value)(x(Co)(bn(mn)("widgets"))(x(Co)((function(n){return n?" focus-mode":""}))(Xs(He)(n.MonadST5())(!1)(o.focusMode)))))([Bf(n)([xa(n.MonadST5())((function(e){if(e instanceof fe)return ca(Re(Yo(n.MonadST5().Monad0().Applicative0())));if(e instanceof ve)return Nf(n)(ed(n.MonadST5().Monad0().Applicative0())(Xl)(Ul.value)("Error"))([La(n.MonadST5().Monad0())(e.value0)]);throw new Error("Failed pattern match at Parser.Main (line 2162, column 58 - line 2164, column 72): "+[e.constructor.name])}))(o.errorMessage)]),qf(n)([La(n.MonadST5().Monad0())("Input a grammar")]),as(["Craft a grammar out of a set of rules. Each rule consists of a nonterminal name, then a colon followed by a sequence of nonterminals and terminals. Each rule must also have a unique name, which will be used to refer to it during parsing and when displaying parse trees. If ommitted, an automatic rule name will be supplied based on the nonterminal name.","The top rule is controlled by the upper input boxes (LR(1) grammars often require a top rule that contains a unique terminal to terminate each input), while the lower input boxes are for adding a new rule. The nonterminals are automatically parsed out of the entered rule, which is otherwise assumed to consist of terminals.","Click “Use grammar” to see the current set of rules in action! It may take a few seconds, depending on the size of the grammar and how many states it produces."])(n),v(1)(wd(n)("Use grammar")(e)(t)(bn(Sn(Rr(pn)))(u.grammar)(r))),qf(n)([La(n.MonadST5().Monad0())("Generate random matching inputs")]),as(["This will randomly generate some inputs that conform to the grammar. Click on one to send it to be tested down below!"])(n),v(5)(xa(n.MonadST5())(S(vd(n))(s))(B)),qf(n)([La(n.MonadST5().Monad0())("List of parsing states")]),as(["To construct the LR(1) parse table, the possible states are enumerated. Each state represents partial progress of some rules in the grammar. The center dot “•” represents the dividing line between already-parsed and about-to-be-parsed.","Each state starts from a few seed rules, which are then closed by adding all nonterminals that could be parsed next. Then new states are explored by advancing on terminals or nonterminals, each of which generates some new seed items. That is, if multiple rules will advance on the same (non)terminal, they will collectively form the seed items for a state. (This state may have been recorded already, in which case nothing further is done.)","When a full rule is parsed, it is eligible to be reduced, but this is only done when one of its lookaheads come next (highlighted in red)."])(n),v(3)(xa(n.MonadST5())((function(e){return Sd(n)({getCurrentState:e.value1})(e.value0)}))(l)),qf(n)([La(n.MonadST5().Monad0())("Table of states and parse actions")]),as(["Once the states are enumerated, the table of parse actions can be read off:","Terminals can be “shifted” onto the stack, transitioning to a new state seeded by pushing through that terminal in all applicable rules in the current state.","Completely parsed rules will be “reduced” when their lookahead appears, popping the values matching the rule off of the stack and replacing it with the corresponding nonterminal, which then is received by the last state not involved in the rule.","Nonterminals received from another state trigger “gotos” to indicate the next state.","Two types of conflicts may occur: if a terminal indicates both a shift and reduce actions (shift–reduce conflict) or multiple reduce actions (reduce–reduce conflict). Note that there cannot be multiple shift actions at once, so most implementations (including this one) choose to do the shift action in the case of shift–reduce conflict."])(n),v(4)(xa(n.MonadST5())((function(e){return pd(n)({getCurrentState:e.value1.value1})(e.value0)(e.value1.value0)}))(go(Ko(n.MonadST5()))(x(Co)((function(n){return n.augmented}))(a))(x(Co)(S(Ze.create))(l)))),qf(n)([La(n.MonadST5().Monad0())("Explore building trees in the grammar")]),as(["Each rule can be read as a transition: “this nonterminal may be replaced with this sequence of terminals and nonterminals”. Build a tree by following these state transitions, and when it consists of only terminals, send it off to be parsed below!"])(n),v(6)(xa(n.MonadST5())(S(hd(n))(s))(B)),qf(n)([La(n.MonadST5().Monad0())("Input custom text to see parsing step-by-step")]),as(["Text entered here (which may also be generated by the above widgets) will be parsed step-by-step, and the final parse tree displayed if the parse succeeded. (Note that the closing terminal is automatically appended, if necessary.) Check the state tables above to see what state the current input ends up in, and the valid next terminals will be highlighted for entry."])(n),v(2)(Bf(n)([Bf(n)([Lf(n)(ae(le)(xa(n.MonadST5())((function(n){return ia(E(P)(bn(wn)([fe.value])(x(P)(ve.create)(n)))(k))}))(I))),Lf(n)(ae(le)(xa(n.MonadST5())((function(n){return ia(E(P)(n)(h))}))(C)))]),Bf(n)([_f(n)(ed(n.MonadST5().Monad0().Applicative0())(Hl)(Ul.value)("terminal"))([ud(n)("Source text")("")(p)((function(n){return u.changeText(new Ze(!1,n))}))])]),Bf(n)(ae(le)(S(xa(n.MonadST5()))(U)((function(e){var t=function(n){return function(e){if(e instanceof fe)return ae(Gi(jc))(ae(ce)(La(n.MonadST5().Monad0())("Parse error")));if(e instanceof ve)return yd(n)(e.value0);throw new Error("Failed pattern match at Parser.Main (line 1158, column 1 - line 1158, column 121): "+[e.constructor.name])}}(n)(e),r=Qc(t(0));return fa()(n)()(Mr({reflectSymbol:function(){return"animationTick"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"rate"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"slider"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"startState"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"toggleLeft"}})(br(yr(n.Always2())))(Mr({reflectSymbol:function(){return"toggleRight"}})(br(yr(n.Always2())))(hr)()())()())()())()())()())()())(Jo({reflectSymbol:function(){return"animationTick"}})()()(Jo({reflectSymbol:function(){return"rate"}})()()(Jo({reflectSymbol:function(){return"slider"}})()()(Jo({reflectSymbol:function(){return"startState"}})()()(Jo({reflectSymbol:function(){return"toggleLeft"}})()()(Jo({reflectSymbol:function(){return"toggleRight"}})()()(Go)()()()())()()()())()()()())()()()())()()()())()()()())(T.value)((function(e){return function(t){var u=Pn(Vo(n.MonadST5().Monad0().Applicative0()))(t.startState)($o(n.MonadST5().Monad0().Applicative0())(fe.value)),o=Pn(Vo(n.MonadST5().Monad0().Applicative0()))(t.rate)($o(n.MonadST5().Monad0().Applicative0())(1)),a=lo(Wo(n.MonadST5().Monad0().Applicative0()))(xo(Ko(n.MonadST5()))((function(n){return function(e){var t=n.value0?0:e.target;return t>n.value1.beats?new Ze({target:t},fe.value):new Ze({target:t+1},new ve(n))}}))(t.animationTick)({target:0})),i=js(b(nn(Z))(tt))(n.MonadST5().Monad0().Applicative0())(n.MonadST5())(Pn(Vo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0())(new Ze(0,Rv.value)))(xo(Ko(n.MonadST5()))((function(n){return function(e){var t=function(n){return function(e){return function(t){return function(r){return Jn(n)(t)(Hn(n)(e)(r))}}}}(Yn)(0)(r.value1-1|0)(n.value0(e));return new Ze(t,new Ze(t,n.value1))}}))(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([N(Co)(new Ze((function(n){return n-1|0}),Ov.value))(t.toggleLeft),N(Co)(new Ze((function(n){return n+1|0}),Ov.value))(t.toggleRight),x(Co)((function(n){return n.value0?new Ze((function(n){return n===(r.value1-1|0)?0:n+1|0}),Lv.value):new Ze((function(n){return n+1|0}),Lv.value)}))(a),x(Co)((function(n){return e=y(li(n)),new Ze(e,_v.value);var e}))(t.slider)]))(0)));return ca(Ao(Ko(n.MonadST5()))(jo(n.MonadST5())(i)((function(a){return nd(Yn)(n.MonadST5())(!1)(x(Co)(tt)(a))((function(c){var l,f=r.value0(c);return Bf(n)([Bf(n)([kf(n)(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([E(Co)(Eo(Ko(n.MonadST5()))(o)(x(Co)(Ze.create)(u)))((function(u){return Ia(lf)(cf.value)(function(){if(u.value0 instanceof ve)return function(){return u.value0.value0(),e.startState(fe.value)()};if(u.value0 instanceof fe){var o=(a=ft(),function(n){return a(n)/1e3});return function(){var a,c,l=x(Dr)(o)(tv)(),f=Bo((a=Xr,function(n){return function(e){return function(t){return function(r){return je(a.Monad0().Bind1())(nu(a)(Tr(ae(a.Monad0().Applicative0())(A))))((function(u){return je(a.Monad0().Bind1())(Bo(t)((function(t){return n(t)?Dn(a.Monad0().Bind1().Apply0())(Ve(a.Monad0().Bind1())(nu(a)(xr(u))))(e):r(t)})))((function(n){return Oe($e)(a.Monad0().Bind1())(F(a.Monad0().Bind1().Apply0().Functor0())(nu(a)(Er(n)(u))))((function(){return ae(a.Monad0().Applicative0())(Ve(a.Monad0().Bind1())(nu(a)(xr(u))))}))}))}))}}}})((function(n){return tt(n.value1)===(r.value1-1|0)&&!n.value0.value0}))(e.startState(fe.value))(go(Ko(Xr))(No(n.Always4())(n.Always1())(n.MonadST5().Monad0().Applicative0())(i))(x(Co)(Ze.create)(xo(Ko(Xr))((function(n){return function(e){return new Ze(!1,new Ze(e,n))}}))(iv((c=Ko(Xr),function(n){return function(e){return go(c)(Pn(c.Plus0().Alt0())(Fo(c)(n))(e))}})(u.value1)(No(n.Always4())(n.Always1())(n.MonadST5().Monad0().Applicative0())(t.rate)))(x(Co)((function(n){return o(n.time)-l}))(ov(rv))))(!0)))))((function(n){return e.animationTick(n.value0)}))();return e.startState(new ve(f))()}}var a;throw new Error("Failed pattern match at Parser.Main (line 2266, column 53 - line 2289, column 84): "+[u.value0.constructor.name])}())}))]))([_a(n.MonadST5().Monad0())(E(Co)(u)((function(n){if(n instanceof ve)return"Pause";if(n instanceof fe)return"Play";throw new Error("Failed pattern match at Parser.Main (line 2293, column 66 - line 2295, column 70): "+[n.constructor.name])})))])]),Bf(n)([La(n.MonadST5().Monad0())("Speed"),Lf(n)(Ve(Le)(x(P)((function(t){return[If(n)(pt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))($o(n.MonadST5().Monad0().Applicative0()))([Ia(Ef)(xf.value)("radio"),Ia(Wl)(jl.value)(oe(ue)("1x"===t.value1)),Ia(af)(of.value)("speed"),Ia(Tf)(Af.value)(oe(te)(t.value0)),Ia(ff)(cf.value)(qa((function(n){return e.rate(t.value0)})))]))([]),Df(n)([La(n.MonadST5().Monad0())(t.value1)])]}))([new Ze(1,"1x"),new Ze(.36787944117144233,"ex"),new Ze(.3183098861837907,"pix")])))]),Bf(n)([If(n)(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([ed(n.MonadST5().Monad0().Applicative0())(Ef)(xf.value)("range"),ed(n.MonadST5().Monad0().Applicative0())(uf)(rf.value)("0"),ed(n.MonadST5().Monad0().Applicative0())(tf)(ef.value)(oe(re)(r.value1-1|0)),ed(n.MonadST5().Monad0().Applicative0())(Tf)(Af.value)("0"),E(Co)(vo(Uo(n.MonadST5().Monad0().Applicative0()))((function(n){return n.value1 instanceof _v?fe.value:new ve(n.value0)}))(a))((function(n){return Ia(Tf)(Af.value)(oe(re)(n))})),nv(n.MonadST5().Monad0().Applicative0())(E(Co)(u)((function(n){if(n instanceof fe)return e.slider;if(n instanceof ve)return function(t){return Dn(zr)(Dn(zr)(e.slider(t))(n.value0))(e.startState(fe.value))};throw new Error("Failed pattern match at Parser.Main (line 2330, column 75 - line 2334, column 82): "+[n.constructor.name])})))]))([])]),(l=function(n){return(t=Co,function(n){return x(t)(Ia(n)(cf.value))})(lf)(E(Co)(u)((function(t){if(t instanceof fe)return n(A);if(t instanceof ve)return Dn(zr)(Dn(zr)(n(A))(t.value0))(e.startState(fe.value));throw new Error("Failed pattern match at Parser.Main (line 2342, column 47 - line 2346, column 78): "+[t.constructor.name])})));var t},Bf(n)([kf(n)(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([l(e.toggleLeft)]))([La(n.MonadST5().Monad0())("<")]),kf(n)(dt(yt)(Yo(n.MonadST5().Monad0().Applicative0()))([l(e.toggleRight)]))([La(n.MonadST5().Monad0())(">")])])),Nf(n)(ed(n.MonadST5().Monad0().Applicative0())(Xl)(Ul.value)("parse-steps"))([f])])}))}))))}}))}))))]))])})))})))})))})))}}))}}}};qv=Tc(),Iv=function(n){var e=function(n){return JSON.stringify(n)}(ys.encode(n)),t=Me()(Sv(e));return function(){var n,r=function(n){return function(){return n.history}}(qv)();return(n=wv(e),function(e){return function(t){return function(r){return function(){return r.pushState(n,e,t)}}}})("")("?grammar="+t)(r)()}},Cv=function(){var n=je(Pr)(function(n){return function(){return n.location}}(qv))(Nv)(),e=function(n){return x(he)((function(e){return kl((t=e,function(n){return n.substr(0,t)})(n));var t}))(Di("grammar=")(n))}(n);if(e instanceof fe)return N(Dr)(fe.value)(ev(Wi)("No grammar in query"))();if(e instanceof ve){var t=Rl(e.value0+kl("grammar=")|0)(n),r=yv(t);if(r instanceof fe)return N(Dr)(fe.value)(ev(Wi)("Failed to decode URL"))();if(r instanceof ve){var u=ul(r.value0);if(u instanceof Fe)return N(Dr)(fe.value)(ev(Wi)("Failed to parse JSON: "+r.value0))();if(u instanceof ke){var o=ys.decode(u.value0);if(o instanceof fe)return N(Dr)(fe.value)(ev(Wi)("Failed to decode"))();if(o instanceof ve)return new ve(o.value0);throw new Error("Failed pattern match at Parser.Main (line 2060, column 19 - line 2062, column 44): "+[o.constructor.name])}throw new Error("Failed pattern match at Parser.Main (line 2057, column 15 - line 2062, column 44): "+[u.constructor.name])}throw new Error("Failed pattern match at Parser.Main (line 2054, column 11 - line 2062, column 44): "+[r.constructor.name])}throw new Error("Failed pattern match at Parser.Main (line 2048, column 7 - line 2062, column 44): "+[e.constructor.name])},Dv=function(n){return function(){var e,t,r=(e=function(e){return We(Pr)(mt(qr)(St)(n))(Cv)},function(){return function(n){return e()()}})();return(t=r,function(n){return function(e){return function(){return e.addEventListener("popstate",t,n)}}})(!1)(Ac(qv))(),function(n){return function(e){return function(t){return function(){return t.removeEventListener("popstate",n,e)}}}}(r)(!1)(Ac(qv))}},zv=x(Dr)(we(Ls))(Cv)(),(Bv=function(n){return gd(n)(zv)(Dv)(Iv)}(la),F(Dr)((Pv=Bv,function(){var n=je(Pr)(je(Pr)(Tc)(gc))(wc)();return de(En(Or(Or(yn))))((function(n){return xc(n)(Pv)}))(x(he)(Mc)(n))()})))()})()})();